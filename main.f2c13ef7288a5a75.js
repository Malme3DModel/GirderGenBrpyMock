var uH=Math.pow;(self.webpackChunkthreeTest=self.webpackChunkthreeTest||[]).push([[179],{53:(sc,Vo,xs)=>{"use strict";function Mn(n){return"function"==typeof n}function Vn(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const ei=Vn(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Yr(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ei{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const o of t)o.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(Mn(i))try{i()}catch(o){e=o instanceof ei?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{bo(o)}catch(l){e=null!=e?e:[],l instanceof ei?e=[...e,...l.errors]:e.push(l)}}if(e)throw new ei(e)}}add(e){var t;if(e&&e!==this)if(this.closed)bo(e);else{if(e instanceof Ei){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Yr(t,e)}remove(e){const{_finalizers:t}=this;t&&Yr(t,e),e instanceof Ei&&e._removeParent(this)}}Ei.EMPTY=(()=>{const n=new Ei;return n.closed=!0,n})();const Or=Ei.EMPTY;function rr(n){return n instanceof Ei||n&&"closed"in n&&Mn(n.remove)&&Mn(n.add)&&Mn(n.unsubscribe)}function bo(n){Mn(n)?n():n.unsubscribe()}const Wi={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Mt={setTimeout(n,e,...t){const{delegate:i}=Mt;return null!=i&&i.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=Mt;return((null==e?void 0:e.clearTimeout)||clearTimeout)(n)},delegate:void 0};function ht(n){Mt.setTimeout(()=>{const{onUnhandledError:e}=Wi;if(!e)throw n;e(n)})}function Nn(){}const hn=Jr("C",void 0,void 0);function Jr(n,e,t){return{kind:n,value:e,error:t}}let Kr=null;function yr(n){if(Wi.useDeprecatedSynchronousErrorHandling){const e=!Kr;if(e&&(Kr={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Kr;if(Kr=null,t)throw i}}else n()}class Uo extends Ei{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,rr(e)&&e.add(this)):this.destination=z_}static create(e,t,i){return new zo(e,t,i)}next(e){this.isStopped?th(function Nt(n){return Jr("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?th(function X(n){return Jr("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?th(hn,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const U_=Function.prototype.bind;function Qd(n,e){return U_.call(n,e)}class Lx{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){eh(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){eh(i)}else eh(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){eh(t)}}}class zo extends Uo{constructor(e,t,i){let r;if(super(),Mn(e)||!e)r={next:null!=e?e:void 0,error:null!=t?t:void 0,complete:null!=i?i:void 0};else{let o;this&&Wi.useDeprecatedNextContext?(o=Object.create(e),o.unsubscribe=()=>this.unsubscribe(),r={next:e.next&&Qd(e.next,o),error:e.error&&Qd(e.error,o),complete:e.complete&&Qd(e.complete,o)}):r=e}this.destination=new Lx(r)}}function eh(n){Wi.useDeprecatedSynchronousErrorHandling?function wo(n){Wi.useDeprecatedSynchronousErrorHandling&&Kr&&(Kr.errorThrown=!0,Kr.error=n)}(n):ht(n)}function th(n,e){const{onStoppedNotification:t}=Wi;t&&Mt.setTimeout(()=>t(n,e))}const z_={closed:!0,next:Nn,error:function Px(n){throw n},complete:Nn},up="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ga(n){return n}function H_(n){return 0===n.length?Ga:1===n.length?n[0]:function(t){return n.reduce((i,r)=>r(i),t)}}let Ci=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,r){const o=function Ox(n){return n&&n instanceof Uo||function Nx(n){return n&&Mn(n.next)&&Mn(n.error)&&Mn(n.complete)}(n)&&rr(n)}(t)?t:new zo(t,i,r);return yr(()=>{const{operator:l,source:c}=this;o.add(l?l.call(o,c):c?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=dp(i))((r,o)=>{const l=new zo({next:c=>{try{t(c)}catch(h){o(h),l.unsubscribe()}},error:o,complete:r});this.subscribe(l)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[up](){return this}pipe(...t){return H_(t)(this)}toPromise(t){return new(t=dp(t))((i,r)=>{let o;this.subscribe(l=>o=l,l=>r(l),()=>i(o))})}}return n.create=e=>new n(e),n})();function dp(n){var e;return null!==(e=null!=n?n:Wi.Promise)&&void 0!==e?e:Promise}const kx=Vn(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ri=(()=>{class n extends Ci{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new G_(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new kx}next(t){yr(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){yr(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){yr(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:r,observers:o}=this;return i||r?Or:(this.currentObservers=null,o.push(t),new Ei(()=>{this.currentObservers=null,Yr(o,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:r,isStopped:o}=this;i?t.error(r):o&&t.complete()}asObservable(){const t=new Ci;return t.source=this,t}}return n.create=(e,t)=>new G_(e,t),n})();class G_ extends ri{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:Or}}function W_(n){return Mn(null==n?void 0:n.lift)}function Zi(n){return e=>{if(W_(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ji(n,e,t,i,r){return new hp(n,e,t,i,r)}class hp extends Uo{constructor(e,t,i,r,o,l){super(e),this.onFinalize=o,this.shouldUnsubscribe=l,this._next=t?function(c){try{t(c)}catch(h){e.error(h)}}:super._next,this._error=r?function(c){try{r(c)}catch(h){e.error(h)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function an(n,e){return Zi((t,i)=>{let r=0;t.subscribe(ji(i,o=>{i.next(n.call(e,o,r++))}))})}function _a(n){return this instanceof _a?(this.v=n,this):new _a(n)}function ou(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=t.apply(n,e||[]),o=[];return r={},l("next"),l("throw"),l("return"),r[Symbol.asyncIterator]=function(){return this},r;function l(x){i[x]&&(r[x]=function(M){return new Promise(function(S,C){o.push([x,M,S,C])>1||c(x,M)})})}function c(x,M){try{!function h(x){x.value instanceof _a?Promise.resolve(x.value.v).then(p,g):y(o[0][2],x)}(i[x](M))}catch(S){y(o[0][3],S)}}function p(x){c("next",x)}function g(x){c("throw",x)}function y(x,M){x(M),o.shift(),o.length&&c(o[0][0],o[0][1])}}function nh(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function $_(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(o){t[o]=n[o]&&function(l){return new Promise(function(c,h){!function r(o,l,c,h){Promise.resolve(h).then(function(p){o({value:p,done:c})},l)}(c,h,(l=n[o](l)).done,l.value)})}}}const fr=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function vp(n){return Mn(null==n?void 0:n.then)}function Vx(n){return Mn(n[up])}function oc(n){return Symbol.asyncIterator&&Mn(null==n?void 0:n[Symbol.asyncIterator])}function Ux(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const J_=function au(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function K_(n){return Mn(null==n?void 0:n[J_])}function lu(n){return ou(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:r}=yield _a(t.read());if(r)return yield _a(void 0);yield yield _a(i)}}finally{t.releaseLock()}})}function Q_(n){return Mn(null==n?void 0:n.getReader)}function Br(n){if(n instanceof Ci)return n;if(null!=n){if(Vx(n))return function Wa(n){return new Ci(e=>{const t=n[up]();if(Mn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(fr(n))return function rh(n){return new Ci(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(vp(n))return function zx(n){return new Ci(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,ht)})}(n);if(oc(n))return ey(n);if(K_(n))return function Hx(n){return new Ci(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Q_(n))return function cu(n){return ey(lu(n))}(n)}throw Ux(n)}function ey(n){return new Ci(e=>{(function Gx(n,e){var t,i,r,o;return function Bx(n,e,t,i){return new(t||(t=Promise))(function(o,l){function c(g){try{p(i.next(g))}catch(y){l(y)}}function h(g){try{p(i.throw(g))}catch(y){l(y)}}function p(g){g.done?o(g.value):function r(o){return o instanceof t?o:new t(function(l){l(o)})}(g.value).then(c,h)}p((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=nh(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=t.return)&&(yield o.call(t))}finally{if(r)throw r.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function ss(n,e,t,i=0,r=!1){const o=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function Dr(n,e,t=1/0){return Mn(e)?Dr((i,r)=>an((o,l)=>e(i,o,r,l))(Br(n(i,r))),t):("number"==typeof e&&(t=e),Zi((i,r)=>function Xs(n,e,t,i,r,o,l,c){const h=[];let p=0,g=0,y=!1;const x=()=>{y&&!h.length&&!p&&e.complete()},M=C=>p<i?S(C):h.push(C),S=C=>{o&&e.next(C),p++;let T=!1;Br(t(C,g++)).subscribe(ji(e,P=>{null==r||r(P),o?M(P):e.next(P)},()=>{T=!0},void 0,()=>{if(T)try{for(p--;h.length&&p<i;){const P=h.shift();l?ss(e,l,()=>S(P)):S(P)}x()}catch(P){e.error(P)}}))};return n.subscribe(ji(e,M,()=>{y=!0,x()})),()=>{null==c||c()}}(i,r,n,t)))}function ac(n=1/0){return Dr(Ga,n)}const ya=new Ci(n=>n.complete());function ty(n){return n&&Mn(n.schedule)}function xp(n){return n[n.length-1]}function ny(n){return Mn(xp(n))?n.pop():void 0}function hu(n){return ty(xp(n))?n.pop():void 0}function iy(n,e=0){return Zi((t,i)=>{t.subscribe(ji(i,r=>ss(i,n,()=>i.next(r),e),()=>ss(i,n,()=>i.complete(),e),r=>ss(i,n,()=>i.error(r),e)))})}function bp(n,e=0){return Zi((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function wp(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ci(t=>{ss(t,e,()=>{const i=n[Symbol.asyncIterator]();ss(t,e,()=>{i.next().then(r=>{r.done?t.complete():t.next(r.value)})},0,!0)})})}function sr(n,e){return e?function cy(n,e){if(null!=n){if(Vx(n))return function ry(n,e){return Br(n).pipe(bp(e),iy(e))}(n,e);if(fr(n))return function oy(n,e){return new Ci(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(vp(n))return function sy(n,e){return Br(n).pipe(bp(e),iy(e))}(n,e);if(oc(n))return wp(n,e);if(K_(n))return function ay(n,e){return new Ci(t=>{let i;return ss(t,e,()=>{i=n[J_](),ss(t,e,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(l){return void t.error(l)}o?t.complete():t.next(r)},0,!0)}),()=>Mn(null==i?void 0:i.return)&&i.return()})}(n,e);if(Q_(n))return function ly(n,e){return wp(lu(n),e)}(n,e)}throw Ux(n)}(n,e):Br(n)}function Mp(...n){const e=hu(n),t=function Wx(n,e){return"number"==typeof xp(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?Br(i[0]):ac(t)(sr(i,e)):ya}function Sp(n={}){const{connector:e=(()=>new ri),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=n;return o=>{let l,c,h,p=0,g=!1,y=!1;const x=()=>{null==c||c.unsubscribe(),c=void 0},M=()=>{x(),l=h=void 0,g=y=!1},S=()=>{const C=l;M(),null==C||C.unsubscribe()};return Zi((C,T)=>{p++,!y&&!g&&x();const P=h=null!=h?h:e();T.add(()=>{p--,0===p&&!y&&!g&&(c=Ep(S,r))}),P.subscribe(T),!l&&p>0&&(l=new zo({next:O=>P.next(O),error:O=>{y=!0,x(),c=Ep(M,t,O),P.error(O)},complete:()=>{g=!0,x(),c=Ep(M,i),P.complete()}}),Br(C).subscribe(l))})(o)}}function Ep(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new zo({next:()=>{i.unsubscribe(),n()}});return e(...t).subscribe(i)}function Ti(n){for(let e in n)if(n[e]===Ti)return e;throw Error("Could not find renamed property on target object.")}function Cp(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Ai(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Ai).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Tp(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const jx=Ti({__forward_ref__:Ti});function ci(n){return n.__forward_ref__=ci,n.toString=function(){return Ai(this())},n}function sn(n){return Ap(n)?n():n}function Ap(n){return"function"==typeof n&&n.hasOwnProperty(jx)&&n.__forward_ref__===ci}class ke extends Error{constructor(e,t){super(function sh(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}(e,t)),this.code=e}}function mn(n){return"string"==typeof n?n:null==n?"":String(n)}function oh(n,e){throw new ke(-201,!1)}function Ls(n,e){null==n&&function ti(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function yt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function Rn(n){return{providers:n.providers||[],imports:n.imports||[]}}function ah(n){return dy(n,yl)||dy(n,lh)}function dy(n,e){return n.hasOwnProperty(e)?n[e]:null}function os(n){return n&&(n.hasOwnProperty(pu)||n.hasOwnProperty(Jx))?n[pu]:null}const yl=Ti({\u0275prov:Ti}),pu=Ti({\u0275inj:Ti}),lh=Ti({ngInjectableDef:Ti}),Jx=Ti({ngInjectorDef:Ti});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let ch;function Zs(n){const e=ch;return ch=n,e}function fy(n,e,t){const i=ah(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Yt.Optional?null:void 0!==e?e:void oh(Ai(n))}function ja(n){return{toString:n}.toString()}var Ho=(()=>((Ho=Ho||{})[Ho.OnPush=0]="OnPush",Ho[Ho.Default=1]="Default",Ho))(),Go=(()=>{return(n=Go||(Go={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",Go;var n})();const Di=(()=>"undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof global&&global||"undefined"!=typeof window&&window||"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self)(),gu={},mi=[],Ip=Ti({\u0275cmp:Ti}),my=Ti({\u0275dir:Ti}),gy=Ti({\u0275pipe:Ti}),Kx=Ti({\u0275mod:Ti}),qa=Ti({\u0275fac:Ti}),uh=Ti({__NG_ELEMENT_ID__:Ti});let Qx=0;function si(n){return ja(()=>{const t=!0===n.standalone,i={},r={type:n.type,providersResolver:null,decls:n.decls,vars:n.vars,factory:null,template:n.template||null,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:n.exportAs||null,onPush:n.changeDetection===Ho.OnPush,directiveDefs:null,pipeDefs:null,standalone:t,dependencies:t&&n.dependencies||null,getStandaloneInjector:null,selectors:n.selectors||mi,viewQuery:n.viewQuery||null,features:n.features||null,data:n.data||{},encapsulation:n.encapsulation||Go.Emulated,id:"c"+Qx++,styles:n.styles||mi,_:null,setInput:null,schemas:n.schemas||null,tView:null},o=n.dependencies,l=n.features;return r.inputs=nb(n.inputs,i),r.outputs=nb(n.outputs),l&&l.forEach(c=>c(r)),r.directiveDefs=o?()=>("function"==typeof o?o():o).map(eb).filter(tb):null,r.pipeDefs=o?()=>("function"==typeof o?o():o).map(_i).filter(tb):null,r})}function eb(n){return gi(n)||Yi(n)}function tb(n){return null!==n}const KC={};function Xn(n){return ja(()=>{const e={type:n.type,bootstrap:n.bootstrap||mi,declarations:n.declarations||mi,imports:n.imports||mi,exports:n.exports||mi,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null};return null!=n.id&&(KC[n.id]=n.type),e})}function nb(n,e){if(null==n)return gu;const t={};for(const i in n)if(n.hasOwnProperty(i)){let r=n[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),t[r]=i,e&&(e[r]=o)}return t}const st=si;function gi(n){return n[Ip]||null}function Yi(n){return n[my]||null}function _i(n){return n[gy]||null}function as(n,e){const t=n[Kx]||null;if(!t&&!0===e)throw new Error(`Type ${Ai(n)} does not have '\u0275mod' property.`);return t}function or(n){return Array.isArray(n)&&"object"==typeof n[1]}function Ks(n){return Array.isArray(n)&&!0===n[1]}function _u(n){return 0!=(8&n.flags)}function qo(n){return 2==(2&n.flags)}function yu(n){return 1==(1&n.flags)}function ks(n){return null!==n.template}function _y(n){return 0!=(256&n[2])}function Sl(n,e){return n.hasOwnProperty(qa)?n[qa]:null}class rb{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Qr(){return vy}function vy(n){return n.type.prototype.ngOnChanges&&(n.setInput=xy),en}function en(){const n=ob(this),e=null==n?void 0:n.current;if(e){const t=n.previous;if(t===gu)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function xy(n,e,t,i){const r=ob(n)||function $o(n,e){return n[sb]=e}(n,{previous:gu,current:null}),o=r.current||(r.current={}),l=r.previous,c=this.declaredInputs[t],h=l[c];o[c]=new rb(h&&h.currentValue,e,l===gu),n[i]=e}Qr.ngInherit=!0;const sb="__ngSimpleChanges__";function ob(n){return n[sb]||null}function ar(n){for(;Array.isArray(n);)n=n[0];return n}function Lp(n,e){return ar(e[n])}function Wn(n,e){return ar(e[n.index])}function eo(n,e){return n.data[e]}function bs(n,e){const t=e[n];return or(t)?t:t[0]}function Pp(n){return 4==(4&n[2])}function fh(n){return 64==(64&n[2])}function cs(n,e){return null==e?null:n[e]}function Fi(n){n[18]=0}function wu(n,e){n[5]+=e;let t=n,i=n[3];for(;null!==i&&(1===e&&1===t[5]||-1===e&&0===t[5]);)i[5]+=e,t=i,i=i[3]}const Ke={lFrame:db(null),bindingsEnabled:!0};function Su(){return Ke.bindingsEnabled}function pe(){return Ke.lFrame.lView}function On(){return Ke.lFrame.tView}function _h(n){return Ke.lFrame.contextLView=n,n[8]}function Np(n){return Ke.lFrame.contextLView=null,n}function Qi(){let n=ub();for(;null!==n&&64===n.type;)n=n.parent;return n}function ub(){return Ke.lFrame.currentTNode}function So(n,e){const t=Ke.lFrame;t.currentTNode=n,t.isParent=e}function Cl(){return Ke.lFrame.isParent}function ws(){Ke.lFrame.isParent=!1}function to(){return Ke.lFrame.bindingIndex++}function My(n,e){const t=Ke.lFrame;t.bindingIndex=t.bindingRootIndex=n,Eu(e)}function Eu(n){Ke.lFrame.currentDirectiveIndex=n}function Cu(n){const e=Ke.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}function vh(){return Ke.lFrame.currentQueryIndex}function Tu(n){Ke.lFrame.currentQueryIndex=n}function Vp(n){const e=n[1];return 2===e.type?e.declTNode:1===e.type?n[6]:null}function Up(n,e,t){if(t&Yt.SkipSelf){let r=e,o=n;for(;!(r=r.parent,null!==r||t&Yt.Host||(r=Vp(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;e=r,n=o}const i=Ke.lFrame=Ni();return i.currentTNode=e,i.lView=n,!0}function Au(n){const e=Ni(),t=n[1];Ke.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function Ni(){const n=Ke.lFrame,e=null===n?null:n.child;return null===e?db(n):e}function db(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function xh(){const n=Ke.lFrame;return Ke.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Tl=xh;function Al(){const n=xh();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Ms(){return Ke.lFrame.selectedIndex}function Dl(n){Ke.lFrame.selectedIndex=n}function Yn(){const n=Ke.lFrame;return eo(n.tView,n.selectedIndex)}function pc(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const o=n.data[t].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:c,ngAfterViewInit:h,ngAfterViewChecked:p,ngOnDestroy:g}=o;l&&(n.contentHooks||(n.contentHooks=[])).push(-t,l),c&&((n.contentHooks||(n.contentHooks=[])).push(t,c),(n.contentCheckHooks||(n.contentCheckHooks=[])).push(t,c)),h&&(n.viewHooks||(n.viewHooks=[])).push(-t,h),p&&((n.viewHooks||(n.viewHooks=[])).push(t,p),(n.viewCheckHooks||(n.viewCheckHooks=[])).push(t,p)),null!=g&&(n.destroyHooks||(n.destroyHooks=[])).push(t,g)}}function Qa(n,e,t){Pu(n,e,3,t)}function el(n,e,t,i){(3&n[2])===t&&Pu(n,e,t,i)}function Lu(n,e){let t=n[2];(3&t)===e&&(t&=2047,t+=1,n[2]=t)}function Pu(n,e,t,i){const o=null!=i?i:-1,l=e.length-1;let c=0;for(let h=void 0!==i?65535&n[18]:0;h<l;h++)if("number"==typeof e[h+1]){if(c=e[h],null!=i&&c>=i)break}else e[h]<0&&(n[18]+=65536),(c<o||-1==o)&&(fb(n,t,e,h),n[18]=(4294901760&n[18])+h+2),h++}function fb(n,e,t,i){const r=t[i]<0,o=t[i+1],c=n[r?-t[i]:t[i]];if(r){if(n[2]>>11<n[18]>>16&&(3&n[2])===e){n[2]+=2048;try{o.call(c)}finally{}}}else try{o.call(c)}finally{}}class tl{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Hp(n,e,t){let i=0;for(;i<t.length;){const r=t[i];if("number"==typeof r){if(0!==r)break;i++;const o=t[i++],l=t[i++],c=t[i++];n.setAttribute(e,l,c,o)}else{const o=r,l=t[++i];mb(o)?n.setProperty(e,o,l):n.setAttribute(e,o,l),i++}}return i}function pb(n){return 3===n||4===n||6===n}function mb(n){return 64===n.charCodeAt(0)}function Gp(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const r=e[i];"number"==typeof r?t=r:0===t||gb(n,t,r,null,-1===t||2===t?e[++i]:null)}}return n}function gb(n,e,t,i,r){let o=0,l=n.length;if(-1===e)l=-1;else for(;o<n.length;){const c=n[o++];if("number"==typeof c){if(c===e){l=-1;break}if(c>e){l=o-1;break}}}for(;o<n.length;){const c=n[o];if("number"==typeof c)break;if(c===t){if(null===i)return void(null!==r&&(n[o+1]=r));if(i===n[o+1])return void(n[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==l&&(n.splice(l,0,e),o=l+1),n.splice(o++,0,t),null!==i&&n.splice(o++,0,i),null!==r&&n.splice(o++,0,r)}function _b(n){return-1!==n}function Fu(n){return 32767&n}function Nu(n,e){let t=function cT(n){return n>>16}(n),i=e;for(;t>0;)i=i[15],t--;return i}let Ey=!0;function Wp(n){const e=Ey;return Ey=n,e}let uT=0;const Ma={};function wh(n,e){const t=Ty(n,e);if(-1!==t)return t;const i=e[1];i.firstCreatePass&&(n.injectorIndex=e.length,Cy(i.data,n),Cy(e,null),Cy(i.blueprint,null));const r=jp(n,e),o=n.injectorIndex;if(_b(r)){const l=Fu(r),c=Nu(r,e),h=c[1].data;for(let p=0;p<8;p++)e[o+p]=c[l+p]|h[l+p]}return e[o+8]=r,o}function Cy(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ty(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function jp(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,r=e;for(;null!==r;){if(i=Cb(r),null===i)return-1;if(t++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return-1}function qp(n,e,t){!function dT(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(uh)&&(i=t[uh]),null==i&&(i=t[uh]=uT++);const r=255&i;e.data[n+(r>>5)]|=1<<r}(n,e,t)}function xb(n,e,t){if(t&Yt.Optional)return n;oh()}function bb(n,e,t,i){if(t&Yt.Optional&&void 0===i&&(i=null),0==(t&(Yt.Self|Yt.Host))){const r=n[9],o=Zs(void 0);try{return r?r.get(e,i,t&Yt.Optional):fy(e,i,t&Yt.Optional)}finally{Zs(o)}}return xb(i,0,t)}function wb(n,e,t,i=Yt.Default,r){if(null!==n){if(1024&e[2]){const l=function gT(n,e,t,i,r){let o=n,l=e;for(;null!==o&&null!==l&&1024&l[2]&&!(256&l[2]);){const c=Mb(o,l,t,i|Yt.Self,Ma);if(c!==Ma)return c;let h=o.parent;if(!h){const p=l[21];if(p){const g=p.get(t,Ma,i);if(g!==Ma)return g}h=Cb(l),l=l[15]}o=h}return r}(n,e,t,i,Ma);if(l!==Ma)return l}const o=Mb(n,e,t,i,Ma);if(o!==Ma)return o}return bb(e,t,i,r)}function Mb(n,e,t,i,r){const o=function pT(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(uh)?n[uh]:void 0;return"number"==typeof e?e>=0?255&e:mT:e}(t);if("function"==typeof o){if(!Up(e,n,i))return i&Yt.Host?xb(r,0,i):bb(e,t,i,r);try{const l=o(i);if(null!=l||i&Yt.Optional)return l;oh()}finally{Tl()}}else if("number"==typeof o){let l=null,c=Ty(n,e),h=-1,p=i&Yt.Host?e[16][6]:null;for((-1===c||i&Yt.SkipSelf)&&(h=-1===c?jp(n,e):e[c+8],-1!==h&&Eb(i,!1)?(l=e[1],c=Fu(h),e=Nu(h,e)):c=-1);-1!==c;){const g=e[1];if(Sb(o,c,g.data)){const y=fT(c,e,t,l,i,p);if(y!==Ma)return y}h=e[c+8],-1!==h&&Eb(i,e[1].data[c+8]===p)&&Sb(o,c,e)?(l=g,c=Fu(h),e=Nu(h,e)):c=-1}}return r}function fT(n,e,t,i,r,o){const l=e[1],c=l.data[n+8],g=$p(c,l,t,null==i?qo(c)&&Ey:i!=l&&0!=(3&c.type),r&Yt.Host&&o===c);return null!==g?Mh(e,l,g,c):Ma}function $p(n,e,t,i,r){const o=n.providerIndexes,l=e.data,c=1048575&o,h=n.directiveStart,g=o>>20,x=r?c+g:n.directiveEnd;for(let M=i?c:c+g;M<x;M++){const S=l[M];if(M<h&&t===S||M>=h&&S.type===t)return M}if(r){const M=l[h];if(M&&ks(M)&&M.type===t)return h}return null}function Mh(n,e,t,i){let r=n[t];const o=e.data;if(function sT(n){return n instanceof tl}(r)){const l=r;l.resolving&&function qx(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new ke(-200,`Circular dependency in DI detected for ${n}${t}`)}(function ui(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():mn(n)}(o[t]));const c=Wp(l.canSeeViewProviders);l.resolving=!0;const h=l.injectImpl?Zs(l.injectImpl):null;Up(n,i,Yt.Default);try{r=n[t]=l.factory(void 0,o,n,i),e.firstCreatePass&&t>=i.directiveStart&&function Iu(n,e,t){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=e.type.prototype;if(i){const l=vy(e);(t.preOrderHooks||(t.preOrderHooks=[])).push(n,l),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,l)}r&&(t.preOrderHooks||(t.preOrderHooks=[])).push(0-n,r),o&&((t.preOrderHooks||(t.preOrderHooks=[])).push(n,o),(t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(n,o))}(t,o[t],e)}finally{null!==h&&Zs(h),Wp(c),l.resolving=!1,Tl()}}return r}function Sb(n,e,t){return!!(t[e+(n>>5)]&1<<n)}function Eb(n,e){return!(n&Yt.Self||n&Yt.Host&&e)}class Ou{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return wb(this._tNode,this._lView,e,i,t)}}function mT(){return new Ou(Qi(),pe())}function ni(n){return ja(()=>{const e=n.prototype.constructor,t=e[qa]||Ay(e),i=Object.prototype;let r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){const o=r[qa]||Ay(r);if(o&&o!==t)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function Ay(n){return Ap(n)?()=>{const e=Ay(sn(n));return e&&e()}:Sl(n)}function Cb(n){const e=n[1],t=e.type;return 2===t?e.declTNode:1===t?n[6]:null}function Ll(n){return function hT(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let r=0;for(;r<i;){const o=t[r];if(pb(o))break;if(0===o)r+=2;else if("number"==typeof o)for(r++;r<i&&"string"==typeof t[r];)r++;else{if(o===e)return t[r+1];r+=2}}}return null}(Qi(),n)}const Bu="__parameters__";function Uu(n,e,t){return ja(()=>{const i=function Dy(n){return function(...t){if(n){const i=n(...t);for(const r in i)this[r]=i[r]}}}(e);function r(...o){if(this instanceof r)return i.apply(this,o),this;const l=new r(...o);return c.annotation=l,c;function c(h,p,g){const y=h.hasOwnProperty(Bu)?h[Bu]:Object.defineProperty(h,Bu,{value:[]})[Bu];for(;y.length<=g;)y.push(null);return(y[g]=y[g]||[]).push(l),h}}return t&&(r.prototype=Object.create(t.prototype)),r.prototype.ngMetadataName=n,r.annotationCls=r,r})}class at{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=yt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const yT=new at("AnalyzeForEntryComponents");function no(n,e){void 0===e&&(e=n);for(let t=0;t<n.length;t++){let i=n[t];Array.isArray(i)?(e===n&&(e=n.slice(0,t)),no(i,e)):e!==n&&e.push(i)}return e}function nl(n,e){n.forEach(t=>Array.isArray(t)?nl(t,e):e(t))}function Ab(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Xp(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function Ch(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function io(n,e,t){let i=zu(n,e);return i>=0?n[1|i]=t:(i=~i,function bT(n,e,t,i){let r=n.length;if(r==e)n.push(t,i);else if(1===r)n.push(i,n[0]),n[0]=t;else{for(r--,n.push(n[r-1],n[r]);r>e;)n[r]=n[r-2],r--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Iy(n,e){const t=zu(n,e);if(t>=0)return n[1|t]}function zu(n,e){return function Ib(n,e,t){let i=0,r=n.length>>t;for(;r!==i;){const o=i+(r-i>>1),l=n[o<<t];if(e===l)return o<<t;l>e?r=o:i=o+1}return~(r<<t)}(n,e,1)}const Th={},Py="__NG_DI_FLAG__",Yp="ngTempTokenPath",DT=/\n/gm,Lb="__source";let Ah;function Hu(n){const e=Ah;return Ah=n,e}function IT(n,e=Yt.Default){if(void 0===Ah)throw new ke(-203,!1);return null===Ah?fy(n,void 0,e):Ah.get(n,e&Yt.Optional?null:void 0,e)}function Be(n,e=Yt.Default){return(function hy(){return ch}()||IT)(sn(n),e)}function Eo(n,e=Yt.Default){return"number"!=typeof e&&(e=0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)),Be(n,e)}function Fy(n){const e=[];for(let t=0;t<n.length;t++){const i=sn(n[t]);if(Array.isArray(i)){if(0===i.length)throw new ke(900,!1);let r,o=Yt.Default;for(let l=0;l<i.length;l++){const c=i[l],h=LT(c);"number"==typeof h?-1===h?r=c.token:o|=h:r=c}e.push(Be(r,o))}else e.push(Be(i))}return e}function Dh(n,e){return n[Py]=e,n.prototype[Py]=e,n}function LT(n){return n[Py]}const Sa=Dh(Uu("Optional"),8),Gu=Dh(Uu("SkipSelf"),4);let Oy,ju;function mc(n){var e;return(null===(e=function Lh(){if(void 0===ju&&(ju=null,Di.trustedTypes))try{ju=Di.trustedTypes.createPolicy("angular",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch(n){}return ju}())||void 0===e?void 0:e.createHTML(n))||n}class Co{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class To extends Co{getTypeName(){return"HTML"}}class ro extends Co{getTypeName(){return"Style"}}class zb extends Co{getTypeName(){return"Script"}}class $T extends Co{getTypeName(){return"URL"}}class XT extends Co{getTypeName(){return"ResourceURL"}}function so(n){return n instanceof Co?n.changingThisBreaksApplicationSecurity:n}function Ea(n,e){const t=function ZT(n){return n instanceof Co&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see https://g.co/ng/security#xss)`)}return t===e}class t1{constructor(e){this.inertDocumentHelper=e}getInertBodyElement(e){e="<body><remove></remove>"+e;try{const t=(new window.DOMParser).parseFromString(mc(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(t){return null}}}class n1{constructor(e){if(this.defaultDoc=e,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const t=this.inertDocument.createElement("html");this.inertDocument.appendChild(t);const i=this.inertDocument.createElement("body");t.appendChild(i)}}getInertBodyElement(e){const t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=mc(e),t;const i=this.inertDocument.createElement("body");return i.innerHTML=mc(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(e){const t=e.attributes;for(let r=t.length-1;0<r;r--){const l=t.item(r).name;("xmlns:ns1"===l||0===l.indexOf("ns1:"))&&e.removeAttribute(l)}let i=e.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const s1=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,o1=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Fh(n){return(n=String(n)).match(s1)||n.match(o1)?n:"unsafe:"+n}function Ca(n){const e={};for(const t of n.split(","))e[t]=!0;return e}function Nh(...n){const e={};for(const t of n)for(const i in t)t.hasOwnProperty(i)&&(e[i]=!0);return e}const Wb=Ca("area,br,col,hr,img,wbr"),jb=Ca("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),qb=Ca("rp,rt"),Uy=Nh(Wb,Nh(jb,Ca("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Nh(qb,Ca("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Nh(qb,jb)),zy=Ca("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Hy=Ca("srcset"),Gy=Nh(zy,Hy,Ca("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ca("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),$b=Ca("script,style,template");class Wy{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(e){let t=e.firstChild,i=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?i=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,i&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let r=this.checkClobberedElement(t,t.nextSibling);if(r){t=r;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(e){const t=e.nodeName.toLowerCase();if(!Uy.hasOwnProperty(t))return this.sanitizedSomething=!0,!$b.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const i=e.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),l=o.name,c=l.toLowerCase();if(!Gy.hasOwnProperty(c)){this.sanitizedSomething=!0;continue}let h=o.value;zy[c]&&(h=Fh(h)),Hy[c]&&(n=h,h=(n=String(n)).split(",").map(e=>Fh(e.trim())).join(", ")),this.buf.push(" ",l,'="',il(h),'"')}var n;return this.buf.push(">"),!0}endElement(e){const t=e.nodeName.toLowerCase();Uy.hasOwnProperty(t)&&!Wb.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(e){this.buf.push(il(e))}checkClobberedElement(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${e.outerHTML}`);return t}}const Xb=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,a1=/([^\#-~ |!])/g;function il(n){return n.replace(/&/g,"&amp;").replace(Xb,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(a1,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Oh;function Zb(n,e){let t=null;try{Oh=Oh||function Hb(n){const e=new n1(n);return function r1(){try{return!!(new window.DOMParser).parseFromString(mc(""),"text/html")}catch(n){return!1}}()?new t1(e):e}(n);let i=e?String(e):"";t=Oh.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=t.innerHTML,t=Oh.getInertBodyElement(i)}while(i!==o);return mc((new Wy).sanitizeChildren(jy(t)||t))}finally{if(t){const i=jy(t)||t;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function jy(n){return"content"in n&&function Yb(n){return n.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===n.nodeName}(n)?n.content:null}var di=(()=>((di=di||{})[di.NONE=0]="NONE",di[di.HTML=1]="HTML",di[di.STYLE=2]="STYLE",di[di.SCRIPT=3]="SCRIPT",di[di.URL=4]="URL",di[di.RESOURCE_URL=5]="RESOURCE_URL",di))();const $y=new at("ENVIRONMENT_INITIALIZER"),tw=new at("INJECTOR",-1),Xy=new at("INJECTOR_DEF_TYPES");class nw{get(e,t=Th){if(t===Th){const i=new Error(`NullInjectorError: No provider for ${Ai(e)}!`);throw i.name="NullInjectorError",i}return t}}function iw(...n){return{\u0275providers:Zy(0,n)}}function Zy(n,...e){const t=[],i=new Set;let r;return nl(e,o=>{const l=o;Yy(l,t,[],i)&&(r||(r=[]),r.push(l))}),void 0!==r&&rw(r,t),t}function rw(n,e){for(let t=0;t<n.length;t++){const{providers:r}=n[t];nl(r,o=>{e.push(o)})}}function Yy(n,e,t,i){if(!(n=sn(n)))return!1;let r=null,o=os(n);const l=!o&&gi(n);if(o||l){if(l&&!l.standalone)return!1;r=n}else{const h=n.ngModule;if(o=os(h),!o)return!1;r=h}const c=i.has(r);if(l){if(c)return!1;if(i.add(r),l.dependencies){const h="function"==typeof l.dependencies?l.dependencies():l.dependencies;for(const p of h)Yy(p,e,t,i)}}else{if(!o)return!1;{if(null!=o.imports&&!c){let p;i.add(r);try{nl(o.imports,g=>{Yy(g,e,t,i)&&(p||(p=[]),p.push(g))})}finally{}void 0!==p&&rw(p,e)}if(!c){const p=Sl(r)||(()=>new r);e.push({provide:r,useFactory:p,deps:mi},{provide:Xy,useValue:r,multi:!0},{provide:$y,useValue:()=>Be(r),multi:!0})}const h=o.providers;null==h||c||nl(h,g=>{e.push(g)})}}return r!==n&&void 0!==n.providers}const d1=Ti({provide:String,useValue:Ti});function Jy(n){return null!==n&&"object"==typeof n&&d1 in n}function gc(n){return"function"==typeof n}const em=new at("Set Injector scope."),tm={},f1={};let Ky;function nm(){return void 0===Ky&&(Ky=new nw),Ky}class Pl{}class aw extends Pl{constructor(e,t,i,r){super(),this.parent=t,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,sm(e,l=>this.processProvider(l)),this.records.set(tw,qu(void 0,this)),r.has("environment")&&this.records.set(Pl,qu(void 0,this));const o=this.records.get(em);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Xy.multi,mi,Yt.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=Hu(this),i=Zs(void 0);try{return e()}finally{Hu(t),Zs(i)}}get(e,t=Th,i=Yt.Default){this.assertNotDestroyed();const r=Hu(this),o=Zs(void 0);try{if(!(i&Yt.SkipSelf)){let c=this.records.get(e);if(void 0===c){const h=function g1(n){return"function"==typeof n||"object"==typeof n&&n instanceof at}(e)&&ah(e);c=h&&this.injectableDefInScope(h)?qu(im(e),tm):null,this.records.set(e,c)}if(null!=c)return this.hydrate(e,c)}return(i&Yt.Self?nm():this.parent).get(e,t=i&Yt.Optional&&t===Th?null:t)}catch(l){if("NullInjectorError"===l.name){if((l[Yp]=l[Yp]||[]).unshift(Ai(e)),r)throw l;return function PT(n,e,t,i){const r=n[Yp];throw e[Lb]&&r.unshift(e[Lb]),n.message=function FT(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let r=Ai(e);if(Array.isArray(e))r=e.map(Ai).join(" -> ");else if("object"==typeof e){let o=[];for(let l in e)if(e.hasOwnProperty(l)){let c=e[l];o.push(l+":"+("string"==typeof c?JSON.stringify(c):Ai(c)))}r=`{${o.join(", ")}}`}return`${t}${i?"("+i+")":""}[${r}]: ${n.replace(DT,"\n  ")}`}("\n"+n.message,r,t,i),n.ngTokenPath=r,n[Yp]=null,n}(l,e,"R3InjectorError",this.source)}throw l}finally{Zs(o),Hu(r)}}resolveInjectorInitializers(){const e=Hu(this),t=Zs(void 0);try{const i=this.get($y.multi,mi,Yt.Self);for(const r of i)r()}finally{Hu(e),Zs(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Ai(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ke(205,!1)}processProvider(e){let t=gc(e=sn(e))?e:sn(e&&e.provide);const i=function rm(n){return Jy(n)?qu(void 0,n.useValue):qu(Uh(n),tm)}(e);if(gc(e)||!0!==e.multi)this.records.get(t);else{let r=this.records.get(t);r||(r=qu(void 0,tm,!0),r.factory=()=>Fy(r.multi),this.records.set(t,r)),t=e,r.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===tm&&(t.value=f1,t.value=t.factory()),"object"==typeof t.value&&t.value&&function lw(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=sn(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function im(n){const e=ah(n),t=null!==e?e.factory:Sl(n);if(null!==t)return t;if(n instanceof at)throw new ke(204,!1);if(n instanceof Function)return function p1(n){const e=n.length;if(e>0)throw Ch(e,"?"),new ke(204,!1);const t=function YC(n){const e=n&&(n[yl]||n[lh]);if(e){const t=function JC(n){if(n.hasOwnProperty("name"))return n.name;const e=(""+n).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(n);return console.warn(`DEPRECATED: DI is instantiating a token "${t}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${t}" class.`),e}return null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new ke(204,!1)}function Uh(n,e,t){let i;if(gc(n)){const r=sn(n);return Sl(r)||im(r)}if(Jy(n))i=()=>sn(n.useValue);else if(function ow(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Fy(n.deps||[]));else if(function sw(n){return!(!n||!n.useExisting)}(n))i=()=>Be(sn(n.useExisting));else{const r=sn(n&&(n.useClass||n.provide));if(!function m1(n){return!!n.deps}(n))return Sl(r)||im(r);i=()=>new r(...Fy(n.deps))}return i}function qu(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function _1(n){return!!n.\u0275providers}function sm(n,e){for(const t of n)Array.isArray(t)?sm(t,e):_1(t)?sm(t.\u0275providers,e):e(t)}class Fl{}class y1{resolveComponentFactory(e){throw function zh(n){const e=Error(`No component factory found for ${Ai(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let hi=(()=>{class n{}return n.NULL=new y1,n})();function cw(){return Ta(Qi(),pe())}function Ta(n,e){return new In(Wn(n,e))}let In=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=cw,n})();function am(n){return n instanceof In?n.nativeElement:n}class Jo{}let hs=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function lm(){const n=pe(),t=bs(Qi().index,n);return(or(t)?t:n)[11]}(),n})(),$u=(()=>{class n{}return n.\u0275prov=yt({token:n,providedIn:"root",factory:()=>null}),n})();class Ko{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Xu=new Ko("14.1.0"),Nl={};function _c(n){return n.ngOriginalError}class ao{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&_c(e);for(;t&&_c(t);)t=_c(t);return t||null}}const Mr=new Map;let mw=0;const qh="__ngContext__";function lr(n,e){or(e)?(n[qh]=e[20],function _w(n){Mr.set(n[20],n)}(e)):n[qh]=e}function Ju(n){const e=n[qh];return"number"==typeof e?function pm(n){return Mr.get(n)||null}(e):e||null}function $h(n){const e=Ju(n);return e?or(e)?e:e.lView:null}const Ku=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Di))();function Xh(n){return n.ownerDocument.defaultView}function Ao(n){return n instanceof Function?n():n}var Ur=(()=>((Ur=Ur||{})[Ur.Important=1]="Important",Ur[Ur.DashCase=2]="DashCase",Ur))();function pv(n,e){return undefined(n,e)}function Zh(n){const e=n[3];return Ks(e)?e[3]:e}function mv(n){return Mw(n[13])}function gv(n){return Mw(n[4])}function Mw(n){for(;null!==n&&!Ks(n);)n=n[4];return n}function Qu(n,e,t,i,r){if(null!=i){let o,l=!1;Ks(i)?o=i:or(i)&&(l=!0,i=i[0]);const c=ar(i);0===n&&null!==t?null==r?Tw(e,t,c):Ss(e,t,c,r||null,!0):1===n&&null!==t?Ss(e,t,c,r||null,!0):2===n?function Cm(n,e,t){const i=Bl(n,e);i&&function Em(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,c,l):3===n&&e.destroyNode(c),null!=o&&function Vl(n,e,t,i,r){const o=t[7];o!==ar(t)&&Qu(e,n,i,o,r);for(let c=10;c<t.length;c++){const h=t[c];Sc(h[1],h,n,e,i,o)}}(e,n,o,t,r)}}function ed(n,e,t){return n.createElement(e,t)}function _v(n,e){const t=n[9],i=t.indexOf(e),r=e[3];512&e[2]&&(e[2]&=-513,wu(r,-1)),t.splice(i,1)}function Sm(n,e){if(n.length<=10)return;const t=10+e,i=n[t];if(i){const r=i[17];null!==r&&r!==n&&_v(r,i),e>0&&(n[t-1][4]=i[4]);const o=Xp(n,10+e);!function Cw(n,e){Sc(n,e,e[11],2,null,null),e[0]=null,e[6]=null}(i[1],i);const l=o[19];null!==l&&l.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-65}return i}function td(n,e){if(!(128&e[2])){const t=e[11];t.destroyNode&&Sc(n,e,t,3,null,null),function E1(n){let e=n[13];if(!e)return Jh(n[1],n);for(;e;){let t=null;if(or(e))t=e[13];else{const i=e[10];i&&(t=i)}if(!t){for(;e&&!e[4]&&e!==n;)or(e)&&Jh(e[1],e),e=e[3];null===e&&(e=n),or(e)&&Jh(e[1],e),t=e&&e[4]}e=t}}(e)}}function Jh(n,e){if(!(128&e[2])){e[2]&=-65,e[2]|=128,function sl(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const r=e[t[i]];if(!(r instanceof tl)){const o=t[i+1];if(Array.isArray(o))for(let l=0;l<o.length;l+=2){const c=r[o[l]],h=o[l+1];try{h.call(c)}finally{}}else try{o.call(r)}finally{}}}}(n,e),function T1(n,e){const t=n.cleanup,i=e[7];let r=-1;if(null!==t)for(let o=0;o<t.length-1;o+=2)if("string"==typeof t[o]){const l=t[o+1],c="function"==typeof l?l(e):ar(e[l]),h=i[r=t[o+2]],p=t[o+3];"boolean"==typeof p?c.removeEventListener(t[o],h,p):p>=0?i[r=p]():i[r=-p].unsubscribe(),o+=2}else{const l=i[r=t[o+1]];t[o].call(l)}if(null!==i){for(let o=r+1;o<i.length;o++)(0,i[o])();e[7]=null}}(n,e),1===e[1].type&&e[11].destroy();const t=e[17];if(null!==t&&Ks(e[3])){t!==e[3]&&_v(t,e);const i=e[19];null!==i&&i.detachView(n)}!function mm(n){Mr.delete(n[20])}(e)}}function yv(n,e,t){return function vv(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[0];if(2&i.flags){const r=n.data[i.directiveStart].encapsulation;if(r===Go.None||r===Go.Emulated)return null}return Wn(i,t)}(n,e.parent,t)}function Ss(n,e,t,i,r){n.insertBefore(e,t,i,r)}function Tw(n,e,t){n.appendChild(e,t)}function Aw(n,e,t,i,r){null!==i?Ss(n,e,t,i,r):Tw(n,e,t)}function Bl(n,e){return n.parentNode(e)}function Kh(n,e,t){return Dw(n,e,t)}let Dw=function nd(n,e,t){return 40&n.type?Wn(n,t):null};function wc(n,e,t,i){const r=yv(n,i,e),o=e[11],c=Kh(i.parent||e[6],i,e);if(null!=r)if(Array.isArray(t))for(let h=0;h<t.length;h++)Aw(o,r,t[h],c,!1);else Aw(o,r,t,c,!1)}function Mc(n,e){if(null!==e){const t=e.type;if(3&t)return Wn(e,n);if(4&t)return id(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return Mc(n,i);{const r=n[e.index];return Ks(r)?id(-1,r):ar(r)}}if(32&t)return pv(e,n)()||ar(n[e.index]);{const i=ef(n,e);return null!==i?Array.isArray(i)?i[0]:Mc(Zh(n[16]),i):Mc(n,e.next)}}return null}function ef(n,e){return null!==e?n[16][6].projection[e.projection]:null}function id(n,e){const t=10+n+1;if(t<e.length){const i=e[t],r=i[1].firstChild;if(null!==r)return Mc(i,r)}return e[7]}function es(n,e,t,i,r,o,l){for(;null!=t;){const c=i[t.index],h=t.type;if(l&&0===e&&(c&&lr(ar(c),i),t.flags|=4),64!=(64&t.flags))if(8&h)es(n,e,t.child,i,r,o,!1),Qu(e,n,r,c,o);else if(32&h){const p=pv(t,i);let g;for(;g=p();)Qu(e,n,r,g,o);Qu(e,n,r,c,o)}else 16&h?ea(n,e,i,t,r,o):Qu(e,n,r,c,o);t=l?t.projectionNext:t.next}}function Sc(n,e,t,i,r,o){es(t,i,n.firstChild,e,r,o,!1)}function ea(n,e,t,i,r,o){const l=t[16],h=l[6].projection[i.projection];if(Array.isArray(h))for(let p=0;p<h.length;p++)Qu(e,n,r,h[p],o);else es(n,e,h,l[3],r,o,!0)}function Am(n,e,t){n.setAttribute(e,"style",t)}function tf(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Dm(n,e,t){let i=n.length;for(;;){const r=n.indexOf(e,t);if(-1===r)return r;if(0===r||n.charCodeAt(r-1)<=32){const o=e.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}t=r+1}}const Rm="ng-template";function A1(n,e,t){let i=0;for(;i<n.length;){let r=n[i++];if(t&&"class"===r){if(r=n[i],-1!==Dm(r.toLowerCase(),e,0))return!0}else if(1===r){for(;i<n.length&&"string"==typeof(r=n[i++]);)if(r.toLowerCase()===e)return!0;return!1}}return!1}function Hi(n){return 4===n.type&&n.value!==Rm}function lo(n,e,t){return e===(4!==n.type||t?n.value:Rm)}function Im(n,e,t){let i=4;const r=n.attrs||[],o=function bv(n){for(let e=0;e<n.length;e++)if(pb(n[e]))return e;return n.length}(r);let l=!1;for(let c=0;c<e.length;c++){const h=e[c];if("number"!=typeof h){if(!l)if(4&i){if(i=2|1&i,""!==h&&!lo(n,h,t)||""===h&&1===e.length){if(Es(i))return!1;l=!0}}else{const p=8&i?h:e[++c];if(8&i&&null!==n.attrs){if(!A1(n.attrs,p,t)){if(Es(i))return!1;l=!0}continue}const y=Lm(8&i?"class":h,r,Hi(n),t);if(-1===y){if(Es(i))return!1;l=!0;continue}if(""!==p){let x;x=y>o?"":r[y+1].toLowerCase();const M=8&i?x:null;if(M&&-1!==Dm(M,p,0)||2&i&&p!==x){if(Es(i))return!1;l=!0}}}}else{if(!l&&!Es(i)&&!Es(h))return!1;if(l&&Es(h))continue;l=!1,i=h|1&i}}return Es(i)||l}function Es(n){return 0==(1&n)}function Lm(n,e,t,i){if(null===e)return-1;let r=0;if(i||!t){let o=!1;for(;r<e.length;){const l=e[r];if(l===n)return r;if(3===l||6===l)o=!0;else{if(1===l||2===l){let c=e[++r];for(;"string"==typeof c;)c=e[++r];continue}if(4===l)break;if(0===l){r+=4;continue}}r+=o?1:2}return-1}return function nf(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Do(n,e,t=!1){for(let i=0;i<e.length;i++)if(Im(n,e[i],t))return!0;return!1}function Pm(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let r=0;r<n.length;r++)if(n[r]!==i[r])continue e;return!0}}return!1}function Cc(n,e){return n?":not("+e.trim()+")":e}function Tc(n){let e=n[0],t=1,i=2,r="",o=!1;for(;t<n.length;){let l=n[t];if("string"==typeof l)if(2&i){const c=n[++t];r+="["+l+(c.length>0?'="'+c+'"':"")+"]"}else 8&i?r+="."+l:4&i&&(r+=" "+l);else""!==r&&!Es(l)&&(e+=Cc(o,r),r=""),i=l,o=o||!Es(i);t++}return""!==r&&(e+=Cc(o,r)),e}const yn={};function jn(n){Ul(On(),pe(),Ms()+n,!1)}function Ul(n,e,t,i){if(!i)if(3==(3&e[2])){const o=n.preOrderCheckHooks;null!==o&&Qa(e,o,t)}else{const o=n.preOrderHooks;null!==o&&el(e,o,0,t)}Dl(t)}function af(n,e=null,t=null,i){const r=lf(n,e,t,i);return r.resolveInjectorInitializers(),r}function lf(n,e=null,t=null,i,r=new Set){const o=[t||mi,iw(n)];return i=i||("object"==typeof n?void 0:Ai(n)),new aw(o,e||nm(),i||null,r)}let Ii=(()=>{class n{static create(t,i){var r;if(Array.isArray(t))return af({name:""},i,t,"");{const o=null!==(r=t.name)&&void 0!==r?r:"";return af({name:o},t.parent,t.providers,o)}}}return n.THROW_IF_NOT_FOUND=Th,n.NULL=new nw,n.\u0275prov=yt({token:n,providedIn:"any",factory:()=>Be(tw)}),n.__NG_ELEMENT_ID__=-1,n})();function oe(n,e=Yt.Default){const t=pe();return null===t?Be(n,e):wb(Qi(),t,sn(n),e)}function Hm(){throw new Error("invalid")}function od(n,e){return n<<17|e<<2}function Lo(n){return n>>17&32767}function Ac(n){return 2|n}function na(n){return(131068&n)>>2}function Wm(n,e){return-131069&n|e<<2}function Dc(n){return 1|n}function eg(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const r=t[i],o=t[i+1];if(-1!==o){const l=n.data[o];Tu(r),l.contentQueries(2,e[o],o)}}}function tg(n,e,t,i,r,o,l,c,h,p,g){const y=e.blueprint.slice();return y[0]=r,y[2]=76|i,(null!==g||n&&1024&n[2])&&(y[2]|=1024),Fi(y),y[3]=y[15]=n,y[8]=t,y[10]=l||n&&n[10],y[11]=c||n&&n[11],y[12]=h||n&&n[12]||null,y[9]=p||n&&n[9]||null,y[6]=o,y[20]=function gw(){return mw++}(),y[21]=g,y[16]=2==e.type?n[16]:y,y}function cd(n,e,t,i,r){let o=n.data[e];if(null===o)o=function Fv(n,e,t,i,r){const o=ub(),l=Cl(),h=n.data[e]=function zv(n,e,t,i,r,o){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,l?o:o&&o.parent,t,e,i,r);return null===n.firstChild&&(n.firstChild=h),null!==o&&(l?null==o.child&&null!==h.parent&&(o.child=h):null===o.next&&(o.next=h)),h}(n,e,t,i,r),function wy(){return Ke.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=t,o.value=i,o.attrs=r;const l=function Vs(){const n=Ke.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();o.injectorIndex=null===l?-1:l.injectorIndex}return So(o,!0),o}function ud(n,e,t,i){if(0===t)return-1;const r=e.length;for(let o=0;o<t;o++)e.push(i),n.blueprint.push(i),n.data.push(null);return r}function ng(n,e,t){Au(e);try{const i=n.viewQuery;null!==i&&Xv(1,i,t);const r=n.template;null!==r&&Nv(n,e,r,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&eg(n,e),n.staticViewQueries&&Xv(2,n.viewQuery,t);const o=n.components;null!==o&&function Pv(n,e){for(let t=0;t<e.length;t++)rM(n,e[t])}(e,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[2]&=-5,Al()}}function yf(n,e,t,i){const r=e[2];if(128!=(128&r)){Au(e);try{Fi(e),function Ka(n){return Ke.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Nv(n,e,t,2,i);const l=3==(3&r);if(l){const p=n.preOrderCheckHooks;null!==p&&Qa(e,p,null)}else{const p=n.preOrderHooks;null!==p&&el(e,p,0,null),Lu(e,0)}if(function J1(n){for(let e=mv(n);null!==e;e=gv(e)){if(!e[2])continue;const t=e[9];for(let i=0;i<t.length;i++){const r=t[i],o=r[3];0==(512&r[2])&&wu(o,1),r[2]|=512}}}(e),function ur(n){for(let e=mv(n);null!==e;e=gv(e))for(let t=10;t<e.length;t++){const i=e[t],r=i[1];fh(i)&&yf(r,i,r.template,i[8])}}(e),null!==n.contentQueries&&eg(n,e),l){const p=n.contentCheckHooks;null!==p&&Qa(e,p)}else{const p=n.contentHooks;null!==p&&el(e,p,1),Lu(e,1)}!function qw(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const r=t[i];if(r<0)Dl(~r);else{const o=r,l=t[++i],c=t[++i];My(l,o),c(2,e[o])}}}finally{Dl(-1)}}(n,e);const c=n.components;null!==c&&function $1(n,e){for(let t=0;t<e.length;t++)pr(n,e[t])}(e,c);const h=n.viewQuery;if(null!==h&&Xv(2,h,i),l){const p=n.viewCheckHooks;null!==p&&Qa(e,p)}else{const p=n.viewHooks;null!==p&&el(e,p,2),Lu(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[2]&=-41,512&e[2]&&(e[2]&=-513,wu(e[3],-1))}finally{Al()}}}function X1(n,e,t,i){const r=e[10],l=Pp(e);try{!l&&r.begin&&r.begin(),l&&ng(n,e,i),yf(n,e,t,i)}finally{!l&&r.end&&r.end()}}function Nv(n,e,t,i,r){const o=Ms(),l=2&i;try{Dl(-1),l&&e.length>22&&Ul(n,e,22,!1),t(i,r)}finally{Dl(o)}}function ig(n,e,t){!Su()||(function og(n,e,t,i){const r=t.directiveStart,o=t.directiveEnd;n.firstCreatePass||wh(t,e),lr(i,e);const l=t.initialInputs;for(let c=r;c<o;c++){const h=n.data[c],p=ks(h);p&&nM(e,t,h);const g=Mh(e,n,c,t);lr(g,e),null!==l&&lg(0,c-r,g,h,0,l),p&&(bs(t.index,e)[8]=g)}}(n,e,t,Wn(t,e)),128==(128&t.flags)&&function Gv(n,e,t){const i=t.directiveStart,r=t.directiveEnd,o=t.index,l=function Bp(){return Ke.lFrame.currentDirectiveIndex}();try{Dl(o);for(let c=i;c<r;c++){const h=n.data[c],p=e[c];Eu(c),(null!==h.hostBindings||0!==h.hostVars||null!==h.hostAttrs)&&Wv(h,p)}}finally{Dl(-1),Eu(l)}}(n,e,t))}function Ov(n,e,t=Wn){const i=e.localNames;if(null!==i){let r=e.index+1;for(let o=0;o<i.length;o+=2){const l=i[o+1],c=-1===l?t(e,n):n[l];n[r++]=c}}}function kv(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=dd(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function dd(n,e,t,i,r,o,l,c,h,p){const g=22+i,y=g+r,x=function Bv(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:yn);return t}(g,y),M="function"==typeof p?p():p;return x[1]={type:n,blueprint:x,template:t,queries:null,viewQuery:c,declTNode:e,data:x.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof l?l():l,firstChild:null,schemas:h,consts:M,incompleteFirstPass:!1}}function Uv(n,e,t,i){const r=ia(e);null===t?r.push(i):(r.push(t),n.firstCreatePass&&Zv(n).push(i,r.length-1))}function Xw(n,e,t){for(let i in n)if(n.hasOwnProperty(i)){const r=n[i];(t=null===t?{}:t).hasOwnProperty(i)?t[i].push(e,r):t[i]=[e,r]}return t}function Zw(n,e){const i=e.directiveEnd,r=n.data,o=e.attrs,l=[];let c=null,h=null;for(let p=e.directiveStart;p<i;p++){const g=r[p],y=g.inputs,x=null===o||Hi(e)?null:iM(y,o);l.push(x),c=Xw(y,p,c),h=Xw(g.outputs,p,h)}null!==c&&(c.hasOwnProperty("class")&&(e.flags|=16),c.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=l,e.inputs=c,e.outputs=h}function zr(n,e,t,i,r,o,l,c){const h=Wn(e,t);let g,p=e.inputs;!c&&null!=p&&(g=p[i])?(Po(n,t,g,i,r),qo(e)&&Hv(t,e.index)):3&e.type&&(i=function Yw(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),r=null!=l?l(r,e.value||"",i):r,o.setProperty(h,i,r))}function Hv(n,e){const t=bs(e,n);16&t[2]||(t[2]|=32)}function sg(n,e,t,i){let r=!1;if(Su()){const o=function Kw(n,e,t){const i=n.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const l=i[o];Do(t,l.selectors,!1)&&(r||(r=[]),qp(wh(t,e),n,l.type),ks(l)?(Qw(n,t),r.unshift(l)):r.push(l))}return r}(n,e,t),l=null===i?null:{"":-1};if(null!==o){r=!0,jv(t,n.data.length,o.length);for(let g=0;g<o.length;g++){const y=o[g];y.providersResolver&&y.providersResolver(y)}let c=!1,h=!1,p=ud(n,e,o.length,null);for(let g=0;g<o.length;g++){const y=o[g];t.mergedAttrs=Gp(t.mergedAttrs,y.hostAttrs),tM(n,t,e,p,y),eM(p,y,l),null!==y.contentQueries&&(t.flags|=8),(null!==y.hostBindings||null!==y.hostAttrs||0!==y.hostVars)&&(t.flags|=128);const x=y.type.prototype;!c&&(x.ngOnChanges||x.ngOnInit||x.ngDoCheck)&&((n.preOrderHooks||(n.preOrderHooks=[])).push(t.index),c=!0),!h&&(x.ngOnChanges||x.ngDoCheck)&&((n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(t.index),h=!0),p++}Zw(n,t)}l&&function Y1(n,e,t){if(e){const i=n.localNames=[];for(let r=0;r<e.length;r+=2){const o=t[e[r+1]];if(null==o)throw new ke(-301,!1);i.push(e[r],o)}}}(t,i,l)}return t.mergedAttrs=Gp(t.mergedAttrs,t.attrs),r}function Jw(n,e,t,i,r,o){const l=o.hostBindings;if(l){let c=n.hostBindingOpCodes;null===c&&(c=n.hostBindingOpCodes=[]);const h=~e.index;(function Wl(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(c)!=h&&c.push(h),c.push(i,r,l)}}function Wv(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Qw(n,e){e.flags|=2,(n.components||(n.components=[])).push(e.index)}function eM(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;ks(e)&&(t[""]=n)}}function jv(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function tM(n,e,t,i,r){n.data[i]=r;const o=r.factory||(r.factory=Sl(r.type)),l=new tl(o,ks(r),oe);n.blueprint[i]=l,t[i]=l,Jw(n,e,0,i,ud(n,t,r.hostVars,yn),r)}function nM(n,e,t){const i=Wn(e,n),r=kv(t),o=n[10],l=cg(n,tg(n,r,null,t.onPush?32:16,i,e,o,o.createRenderer(i,t),null,null,null));n[e.index]=l}function Da(n,e,t,i,r,o){const l=Wn(n,e);!function ag(n,e,t,i,r,o,l){if(null==o)n.removeAttribute(e,r,t);else{const c=null==l?mn(o):l(o,i||"",r);n.setAttribute(e,r,c,t)}}(e[11],l,o,n.value,t,i,r)}function lg(n,e,t,i,r,o){const l=o[e];if(null!==l){const c=i.setInput;for(let h=0;h<l.length;){const p=l[h++],g=l[h++],y=l[h++];null!==c?i.setInput(t,y,p,g):t[g]=y}}}function iM(n,e){let t=null,i=0;for(;i<e.length;){const r=e[i];if(0!==r)if(5!==r){if("number"==typeof r)break;n.hasOwnProperty(r)&&(null===t&&(t=[]),t.push(r,n[r],e[i+1])),i+=2}else i+=2;else i+=4}return t}function xf(n,e,t,i){return new Array(n,!0,!1,e,null,0,i,t,null,null)}function pr(n,e){const t=bs(e,n);if(fh(t)){const i=t[1];48&t[2]?yf(i,t,i.template,t[8]):t[5]>0&&hd(t)}}function hd(n){for(let i=mv(n);null!==i;i=gv(i))for(let r=10;r<i.length;r++){const o=i[r];if(512&o[2]){const l=o[1];yf(l,o,l.template,o[8])}else o[5]>0&&hd(o)}const t=n[1].components;if(null!==t)for(let i=0;i<t.length;i++){const r=bs(t[i],n);fh(r)&&r[5]>0&&hd(r)}}function rM(n,e){const t=bs(e,n),i=t[1];(function K1(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),ng(i,t,t[8])}function cg(n,e){return n[13]?n[14][4]=e:n[13]=e,n[14]=e,e}function ug(n){for(;n;){n[2]|=32;const e=Zh(n);if(_y(n)&&!e)return n;n=e}return null}function $v(n){!function hg(n){for(let e=0;e<n.components.length;e++){const t=n.components[e],i=$h(t);if(null!==i){const r=i[1];X1(r,i,r.template,t)}}}(n[8])}function Xv(n,e,t){Tu(0),e(n,t)}const jl=(()=>Promise.resolve(null))();function ia(n){return n[7]||(n[7]=[])}function Zv(n){return n.cleanup||(n.cleanup=[])}function Yv(n,e,t){return(null===n||ks(n))&&(t=function by(n){for(;Array.isArray(n);){if("object"==typeof n[1])return n;n=n[0]}return null}(t[e.index])),t[11]}function Ic(n,e){const t=n[9],i=t?t.get(ao,null):null;i&&i.handleError(e)}function Po(n,e,t,i,r){for(let o=0;o<t.length;){const l=t[o++],c=t[o++],h=e[l],p=n.data[l];null!==p.setInput?p.setInput(h,r,i,c):h[c]=r}}function fg(n,e,t){let i=t?n.styles:null,r=t?n.classes:null,o=0;if(null!==e)for(let l=0;l<e.length;l++){const c=e[l];"number"==typeof c?o=c:1==o?r=Tp(r,c):2==o&&(i=Tp(i,c+": "+e[++l]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=r:n.classesWithoutHost=r}function fd(n,e,t,i,r=!1){for(;null!==t;){const o=e[t.index];if(null!==o&&i.push(ar(o)),Ks(o))for(let c=10;c<o.length;c++){const h=o[c],p=h[1].firstChild;null!==p&&fd(h[1],h,p,i)}const l=t.type;if(8&l)fd(n,e,t.child,i);else if(32&l){const c=pv(t,e);let h;for(;h=c();)i.push(h)}else if(16&l){const c=ef(e,t);if(Array.isArray(c))i.push(...c);else{const h=Zh(e[16]);fd(h[1],h,c,i,!0)}}t=r?t.projectionNext:t.next}return i}class al{constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,t=e[1];return fd(t,e,t.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(Ks(e)){const t=e[8],i=t?t.indexOf(this):-1;i>-1&&(Sm(e,i),Xp(t,i))}this._attachedToViewContainer=!1}td(this._lView[1],this._lView)}onDestroy(e){Uv(this._lView[1],this._lView,null,e)}markForCheck(){ug(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){!function qv(n,e,t){const i=e[10];i.begin&&i.begin();try{yf(n,e,n.template,t)}catch(r){throw Ic(e,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ke(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Mm(n,e){Sc(n,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new ke(902,!1);this._appRef=e}}class sM extends al{constructor(e){super(e),this._view=e}detectChanges(){$v(this._view)}checkNoChanges(){}get context(){return null}}class pd extends hi{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=gi(e);return new Ra(t,this.ngModule)}}function Jv(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Lc{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){const r=this.injector.get(e,Nl,i);return r!==Nl||t===Nl?r:this.parentInjector.get(e,t,i)}}class Ra extends Fl{constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function rf(n){return n.map(Tc).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}get inputs(){return Jv(this.componentDef.inputs)}get outputs(){return Jv(this.componentDef.outputs)}create(e,t,i,r){let o=(r=r||this.ngModule)instanceof Pl?r:null==r?void 0:r.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const l=o?new Lc(e,o):e,c=l.get(Jo,null);if(null===c)throw new ke(407,!1);const h=l.get($u,null),p=c.createRenderer(null,this.componentDef),g=this.componentDef.selectors[0][0]||"div",y=i?function Vv(n,e,t){return n.selectRootElement(e,t===Go.ShadowDom)}(p,i,this.componentDef.encapsulation):ed(c.createRenderer(null,this.componentDef),g,function Kv(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(g)),x=this.componentDef.onPush?288:272,M=function pg(n,e){return{components:[],scheduler:n||Ku,clean:jl,playerHandler:e||null,flags:0}}(),S=dd(0,null,null,1,0,null,null,null,null,null),C=tg(null,S,M,x,null,null,c,p,h,l,null);let T,P;Au(C);try{const O=function nA(n,e,t,i,r,o){const l=t[1];t[22]=n;const h=cd(l,22,2,"#host",null),p=h.mergedAttrs=e.hostAttrs;null!==p&&(fg(h,p,!0),null!==n&&(Hp(r,n,p),null!==h.classes&&tf(r,n,h.classes),null!==h.styles&&Am(r,n,h.styles)));const g=i.createRenderer(n,e),y=tg(t,kv(e),null,e.onPush?32:16,t[22],h,i,g,o||null,null,null);return l.firstCreatePass&&(qp(wh(h,t),l,e.type),Qw(l,h),jv(h,t.length,1)),cg(t,y),t[22]=y}(y,this.componentDef,C,c,p);if(y)if(i)Hp(p,y,["ng-version",Xu.full]);else{const{attrs:k,classes:B}=function sf(n){const e=[],t=[];let i=1,r=2;for(;i<n.length;){let o=n[i];if("string"==typeof o)2===r?""!==o&&e.push(o,n[++i]):8===r&&t.push(o);else{if(!Es(r))break;r=o}i++}return{attrs:e,classes:t}}(this.componentDef.selectors[0]);k&&Hp(p,y,k),B&&B.length>0&&tf(p,y,B.join(" "))}if(P=eo(S,22),void 0!==t){const k=P.projection=[];for(let B=0;B<this.ngContentSelectors.length;B++){const z=t[B];k.push(null!=z?Array.from(z):null)}}T=function aM(n,e,t,i,r){const o=t[1],l=function vf(n,e,t){const i=Qi();n.firstCreatePass&&(t.providersResolver&&t.providersResolver(t),tM(n,i,e,ud(n,e,1,null),t),Zw(n,i));const r=Mh(e,n,i.directiveStart,i);lr(r,e);const o=Wn(i,e);return o&&lr(o,e),r}(o,t,e);if(i.components.push(l),n[8]=l,null!==r)for(const h of r)h(l,e);if(e.contentQueries){const h=Qi();e.contentQueries(1,l,h.directiveStart)}const c=Qi();return!o.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(Dl(c.index),Jw(t[1],c,0,c.directiveStart,c.directiveEnd,e),Wv(e,l)),l}(O,this.componentDef,C,M,[iA]),ng(S,C,null)}finally{Al()}return new tA(this.componentType,T,Ta(P,C),C,P)}}class tA extends class om{}{constructor(e,t,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=t,this.hostView=this.changeDetectorRef=new sM(r),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[e])){const o=this._rootLView;Po(o[1],o,r,e,t),Hv(o,this._tNode.index)}}get injector(){return new Ou(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function iA(){const n=Qi();pc(pe()[1],n)}function Dt(n){let e=function Qv(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let r;if(ks(n))r=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new ke(903,!1);r=e.\u0275dir}if(r){if(t){i.push(r);const l=n;l.inputs=t0(n.inputs),l.declaredInputs=t0(n.declaredInputs),l.outputs=t0(n.outputs);const c=r.hostBindings;c&&aA(n,c);const h=r.viewQuery,p=r.contentQueries;if(h&&sA(n,h),p&&oA(n,p),Cp(n.inputs,r.inputs),Cp(n.declaredInputs,r.declaredInputs),Cp(n.outputs,r.outputs),ks(r)&&r.data.animation){const g=n.data;g.animation=(g.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let l=0;l<o.length;l++){const c=o[l];c&&c.ngInherit&&c(n),c===Dt&&(t=!1)}}e=Object.getPrototypeOf(e)}!function e0(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const r=n[i];r.hostVars=e+=r.hostVars,r.hostAttrs=Gp(r.hostAttrs,t=Gp(t,r.hostAttrs))}}(i)}function t0(n){return n===gu?{}:n===mi?[]:n}function sA(n,e){const t=n.viewQuery;n.viewQuery=t?(i,r)=>{e(i,r),t(i,r)}:e}function oA(n,e){const t=n.contentQueries;n.contentQueries=t?(i,r,o)=>{e(i,r,o),t(i,r,o)}:e}function aA(n,e){const t=n.hostBindings;n.hostBindings=t?(i,r)=>{e(i,r),t(i,r)}:e}let mg=null;function Pc(){if(!mg){const n=Di.Symbol;if(n&&n.iterator)mg=n.iterator;else{const e=Object.getOwnPropertyNames(Map.prototype);for(let t=0;t<e.length;++t){const i=e[t];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(mg=i)}}}return mg}function n0(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function ms(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function gs(n,e,t,i){const r=pe();return ms(r,to(),e)&&(On(),Da(Yn(),r,n,e,t,i)),gs}function b(n,e,t,i,r,o,l,c){const h=pe(),p=On(),g=n+22,y=p.firstCreatePass?function v(n,e,t,i,r,o,l,c,h){const p=e.consts,g=cd(e,n,4,l||null,cs(p,c));sg(e,t,g,cs(p,h)),pc(e,g);const y=g.tViews=dd(2,g,i,r,o,e.directiveRegistry,e.pipeRegistry,null,e.schemas,p);return null!==e.queries&&(e.queries.template(e,g),y.queries=e.queries.embeddedTView(g)),g}(g,p,h,e,t,i,r,o,l):p.data[g];So(y,!1);const x=h[11].createComment("");wc(p,h,x,y),lr(x,h),cg(h,h[g]=xf(x,h,x,y)),yu(y)&&ig(p,h,y),null!=l&&Ov(h,y,c)}function E(n,e,t){const i=pe();return ms(i,to(),e)&&zr(On(),Yn(),i,n,e,i[11],t,!1),E}function D(n,e,t,i,r){const l=r?"class":"style";Po(n,t,e.inputs[l],l,i)}function I(n,e,t,i){const r=pe(),o=On(),l=22+n,c=r[11],h=r[l]=ed(c,e,function zp(){return Ke.lFrame.currentNamespace}()),p=o.firstCreatePass?function R(n,e,t,i,r,o,l){const c=e.consts,p=cd(e,n,2,r,cs(c,o));return sg(e,t,p,cs(c,l)),null!==p.attrs&&fg(p,p.attrs,!1),null!==p.mergedAttrs&&fg(p,p.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,p),p}(l,o,r,0,e,t,i):o.data[l];So(p,!0);const g=p.mergedAttrs;null!==g&&Hp(c,h,g);const y=p.classes;null!==y&&tf(c,h,y);const x=p.styles;return null!==x&&Am(c,h,x),64!=(64&p.flags)&&wc(o,r,h,p),0===function ph(){return Ke.lFrame.elementDepthCount}()&&lr(h,r),function mh(){Ke.lFrame.elementDepthCount++}(),yu(p)&&(ig(o,r,p),function ts(n,e,t){if(_u(e)){const r=e.directiveEnd;for(let o=e.directiveStart;o<r;o++){const l=n.data[o];l.contentQueries&&l.contentQueries(1,t[o],o)}}}(o,p,r)),null!==i&&Ov(r,p),I}function F(){let n=Qi();Cl()?ws():(n=n.parent,So(n,!1));const e=n;!function hc(){Ke.lFrame.elementDepthCount--}();const t=On();return t.firstCreatePass&&(pc(t,n),_u(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function aT(n){return 0!=(16&n.flags)}(e)&&D(t,e,pe(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function lT(n){return 0!=(32&n.flags)}(e)&&D(t,e,pe(),e.stylesWithoutHost,!1),F}function V(n,e,t,i){return I(n,e,t,i),F(),V}function K(){return pe()}function H(n){return!!n&&"function"==typeof n.then}const he=function re(n){return!!n&&"function"==typeof n.subscribe};function se(n,e,t,i){const r=pe(),o=On(),l=Qi();return Ce(o,r,r[11],l,n,e,0,i),se}function fe(n,e){const t=Qi(),i=pe(),r=On();return Ce(r,i,Yv(Cu(r.data),t,i),t,n,e),fe}function Ce(n,e,t,i,r,o,l,c){const h=yu(i),g=n.firstCreatePass&&Zv(n),y=e[8],x=ia(e);let M=!0;if(3&i.type||c){const T=Wn(i,e),P=c?c(T):T,O=x.length,k=c?z=>c(ar(z[i.index])):i.index;let B=null;if(!c&&h&&(B=function we(n,e,t,i){const r=n.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const l=r[o];if(l===t&&r[o+1]===i){const c=e[7],h=r[o+2];return c.length>h?c[h]:null}"string"==typeof l&&(o+=2)}return null}(n,e,r,i.index)),null!==B)(B.__ngLastListenerFn__||B).__ngNextListenerFn__=o,B.__ngLastListenerFn__=o,M=!1;else{o=de(i,e,y,o,!1);const z=t.listen(P,r,o);x.push(o,z),g&&g.push(r,k,O,O+1)}}else o=de(i,e,y,o,!1);const S=i.outputs;let C;if(M&&null!==S&&(C=S[r])){const T=C.length;if(T)for(let P=0;P<T;P+=2){const q=e[C[P]][C[P+1]].subscribe(o),ne=x.length;x.push(o,q),g&&g.push(r,i.index,ne,-(ne+1))}}}function be(n,e,t,i){try{return!1!==t(i)}catch(r){return Ic(n,r),!1}}function de(n,e,t,i,r){return function o(l){if(l===Function)return i;ug(2&n.flags?bs(n.index,e):e);let h=be(e,0,i,l),p=o.__ngNextListenerFn__;for(;p;)h=be(e,0,p,l)&&h,p=p.__ngNextListenerFn__;return r&&!1===h&&(l.preventDefault(),l.returnValue=!1),h}}function ve(n=1){return function ds(n){return(Ke.lFrame.contextLView=function hb(n,e){for(;n>0;)e=e[15],n--;return e}(n,Ke.lFrame.contextLView))[8]}(n)}function Ae(n,e){let t=null;const i=function Ec(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(0==(1&t))return e[t+1]}return null}(n);for(let r=0;r<e.length;r++){const o=e[r];if("*"!==o){if(null===i?Do(n,o,!0):Pm(i,o))return r}else t=r}return t}function He(n){const e=pe()[16][6];if(!e.projection){const i=e.projection=Ch(n?n.length:1,null),r=i.slice();let o=e.child;for(;null!==o;){const l=n?Ae(o,n):0;null!==l&&(r[l]?r[l].projectionNext=o:i[l]=o,r[l]=o),o=o.next}}}function Ze(n,e=0,t){const i=pe(),r=On(),o=cd(r,22+n,16,null,t||null);null===o.projection&&(o.projection=e),ws(),64!=(64&o.flags)&&function rd(n,e,t){ea(e[11],0,e,t,yv(n,t,e),Kh(t.parent||e[6],t,e))}(r,i,o)}function Qe(n,e,t,i,r){const o=n[t+1],l=null===e;let c=i?Lo(o):na(o),h=!1;for(;0!==c&&(!1===h||l);){const g=n[c+1];lt(n[c],e)&&(h=!0,n[c+1]=i?Dc(g):Ac(g)),c=i?Lo(g):na(g)}h&&(n[t+1]=i?Ac(o):Dc(o))}function lt(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&zu(n,e)>=0}function Bt(n,e,t){return sa(n,e,t,!1),Bt}function wt(n,e){return sa(n,e,null,!0),wt}function sa(n,e,t,i){const r=pe(),o=On(),l=function us(n){const e=Ke.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}(2);o.firstUpdatePass&&function _g(n,e,t,i){const r=n.data;if(null===r[t+1]){const o=r[Ms()],l=function fM(n,e){return e>=n.expandoStartIndex}(n,t);(function gt(n,e){return 0!=(n.flags&(e?16:32))})(o,i)&&null===e&&!l&&(e=!1),e=function pA(n,e,t,i){const r=Cu(n);let o=i?e.residualClasses:e.residualStyles;if(null===r)0===(i?e.classBindings:e.styleBindings)&&(t=co(t=yg(null,n,e,t,i),e.attrs,i),o=null);else{const l=e.directiveStylingLast;if(-1===l||n[l]!==r)if(t=yg(r,n,e,t,i),null===o){let h=function Sf(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==na(i))return n[Lo(i)]}(n,e,i);void 0!==h&&Array.isArray(h)&&(h=yg(null,n,e,h[1],i),h=co(h,e.attrs,i),function pM(n,e,t,i){n[Lo(t?e.classBindings:e.styleBindings)]=i}(n,e,i,h))}else o=function mM(n,e,t){let i;const r=e.directiveEnd;for(let o=1+e.directiveStylingLast;o<r;o++)i=co(i,n[o].hostAttrs,t);return co(i,e.attrs,t)}(n,e,i)}return void 0!==o&&(i?e.residualClasses=o:e.residualStyles=o),t}(r,o,e,i),function pn(n,e,t,i,r,o){let l=o?e.classBindings:e.styleBindings,c=Lo(l),h=na(l);n[i]=t;let g,p=!1;if(Array.isArray(t)){const y=t;g=y[1],(null===g||zu(y,g)>0)&&(p=!0)}else g=t;if(r)if(0!==h){const x=Lo(n[c+1]);n[i+1]=od(x,c),0!==x&&(n[x+1]=Wm(n[x+1],i)),n[c+1]=function Uw(n,e){return 131071&n|e<<17}(n[c+1],i)}else n[i+1]=od(c,0),0!==c&&(n[c+1]=Wm(n[c+1],i)),c=i;else n[i+1]=od(h,0),0===c?c=i:n[h+1]=Wm(n[h+1],i),h=i;p&&(n[i+1]=Ac(n[i+1])),Qe(n,g,i,!0),Qe(n,g,i,!1),function vi(n,e,t,i,r){const o=r?n.residualClasses:n.residualStyles;null!=o&&"string"==typeof e&&zu(o,e)>=0&&(t[i+1]=Dc(t[i+1]))}(e,g,n,i,o),l=od(c,h),o?e.classBindings=l:e.styleBindings=l}(r,o,e,t,l,i)}}(o,n,l,i),e!==yn&&ms(r,l,e)&&function Y(n,e,t,i,r,o,l,c){if(!(3&e.type))return;const h=n.data,p=h[c+1];Ee(function jm(n){return 1==(1&n)}(p)?De(h,e,t,r,na(p),l):void 0)||(Ee(o)||function Gm(n){return 2==(2&n)}(p)&&(o=De(h,null,t,r,c,l)),function Tm(n,e,t,i,r){if(e)r?n.addClass(t,i):n.removeClass(t,i);else{let o=-1===i.indexOf("-")?void 0:Ur.DashCase;null==r?n.removeStyle(t,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Ur.Important),n.setStyle(t,i,r,o))}}(i,l,Lp(Ms(),t),r,o))}(o,o.data[Ms()],r,r[11],n,r[l+1]=function Fe(n,e){return null==n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Ai(so(n)))),n}(e,t),i,l)}function yg(n,e,t,i,r){let o=null;const l=t.directiveEnd;let c=t.directiveStylingLast;for(-1===c?c=t.directiveStart:c++;c<l&&(o=e[c],i=co(i,o.hostAttrs,r),o!==n);)c++;return null!==n&&(t.directiveStylingLast=c),i}function co(n,e,t){const i=t?1:2;let r=-1;if(null!==e)for(let o=0;o<e.length;o++){const l=e[o];"number"==typeof l?r=l:r===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),io(n,l,!!t||e[++o]))}return void 0===n?null:n}function De(n,e,t,i,r,o){const l=null===e;let c;for(;r>0;){const h=n[r],p=Array.isArray(h),g=p?h[1]:h,y=null===g;let x=t[r+1];x===yn&&(x=y?mi:void 0);let M=y?Iy(x,i):g===i?x:void 0;if(p&&!Ee(M)&&(M=Iy(h,i)),Ee(M)&&(c=M,l))return c;const S=n[r+1];r=l?Lo(S):na(S)}if(null!==e){let h=o?e.residualClasses:e.residualStyles;null!=h&&(c=Iy(h,i))}return c}function Ee(n){return void 0!==n}function Pt(n,e=""){const t=pe(),i=On(),r=n+22,o=i.firstCreatePass?cd(i,r,1,e,null):i.data[r],l=t[r]=function kl(n,e){return n.createText(e)}(t[11],e);wc(i,t,l,o),So(o,!1)}function Ut(n){return ln("",n,""),Ut}function ln(n,e,t){const i=pe(),r=function gd(n,e,t,i){return ms(n,to(),t)?e+mn(t)+i:yn}(i,n,e,t);return r!==yn&&function Cs(n,e,t){const i=Lp(e,n);!function Ew(n,e,t){n.setValue(e,t)}(n[11],i,t)}(i,Ms(),r),ln}function gA(n,e,t){const i=pe();return ms(i,to(),e)&&zr(On(),Yn(),i,n,e,i[11],t,!0),gA}function _A(n,e,t){const i=pe();if(ms(i,to(),e)){const o=On(),l=Yn();zr(o,l,i,n,e,Yv(Cu(o.data),l,i),t,!0)}return _A}const xg="en-US";let YP=xg;function xA(n,e,t,i,r){if(n=sn(n),Array.isArray(n))for(let o=0;o<n.length;o++)xA(n[o],e,t,i,r);else{const o=On(),l=pe();let c=gc(n)?n:sn(n.provide),h=Uh(n);const p=Qi(),g=1048575&p.providerIndexes,y=p.directiveStart,x=p.providerIndexes>>20;if(gc(n)||!n.multi){const M=new tl(h,r,oe),S=wA(c,e,r?g:g+x,y);-1===S?(qp(wh(p,l),o,c),bA(o,n,e.length),e.push(c),p.directiveStart++,p.directiveEnd++,r&&(p.providerIndexes+=1048576),t.push(M),l.push(M)):(t[S]=M,l[S]=M)}else{const M=wA(c,e,g+x,y),S=wA(c,e,g,g+x),C=M>=0&&t[M],T=S>=0&&t[S];if(r&&!T||!r&&!C){qp(wh(p,l),o,c);const P=function M4(n,e,t,i,r){const o=new tl(n,t,oe);return o.multi=[],o.index=e,o.componentProviders=0,bF(o,r,i&&!t),o}(r?w4:b4,t.length,r,i,h);!r&&T&&(t[S].providerFactory=P),bA(o,n,e.length,0),e.push(c),p.directiveStart++,p.directiveEnd++,r&&(p.providerIndexes+=1048576),t.push(P),l.push(P)}else bA(o,n,M>-1?M:S,bF(t[r?S:M],h,!r&&i));!r&&i&&T&&t[S].componentProviders++}}}function bA(n,e,t,i){const r=gc(e),o=function h1(n){return!!n.useClass}(e);if(r||o){const h=(o?sn(e.useClass):e).prototype.ngOnDestroy;if(h){const p=n.destroyHooks||(n.destroyHooks=[]);if(!r&&e.multi){const g=p.indexOf(t);-1===g?p.push(t,[i,h]):p[g+1].push(i,h)}else p.push(t,h)}}}function bF(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function wA(n,e,t,i){for(let r=t;r<i;r++)if(e[r]===n)return r;return-1}function b4(n,e,t,i){return MA(this.multi,[])}function w4(n,e,t,i){const r=this.multi;let o;if(this.providerFactory){const l=this.providerFactory.componentProviders,c=Mh(t,t[1],this.providerFactory.index,i);o=c.slice(0,l),MA(r,o);for(let h=l;h<c.length;h++)o.push(c[h])}else o=[],MA(r,o);return o}function MA(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function gn(n,e=[]){return t=>{t.providersResolver=(i,r)=>function x4(n,e,t){const i=On();if(i.firstCreatePass){const r=ks(n);xA(t,i.data,i.blueprint,r,!0),xA(e,i.data,i.blueprint,r,!1)}}(i,r?r(n):n,e)}}class Af{}class wF{}class MF extends Af{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new pd(this);const i=as(e);this._bootstrapComponents=Ao(i.bootstrap),this._r3Injector=lf(e,t,[{provide:Af,useValue:this},{provide:hi,useValue:this.componentFactoryResolver}],Ai(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class SA extends wF{constructor(e){super(),this.moduleType=e}create(e){return new MF(this.moduleType,e)}}class E4 extends Af{constructor(e,t,i){super(),this.componentFactoryResolver=new pd(this),this.instance=null;const r=new aw([...e,{provide:Af,useValue:this},{provide:hi,useValue:this.componentFactoryResolver}],t||nm(),i,new Set(["environment"]));this.injector=r,r.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function wM(n,e,t=null){return new E4(n,e,t).injector}function CA(n){return e=>{setTimeout(n,void 0,e)}}const Mi=class Q4 extends ri{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){var r,o,l;let c=e,h=t||(()=>null),p=i;if(e&&"object"==typeof e){const y=e;c=null===(r=y.next)||void 0===r?void 0:r.bind(y),h=null===(o=y.error)||void 0===o?void 0:o.bind(y),p=null===(l=y.complete)||void 0===l?void 0:l.bind(y)}this.__isAsync&&(h=CA(h),c&&(c=CA(c)),p&&(p=CA(p)));const g=super.subscribe({next:c,error:h,complete:p});return e instanceof Ei&&e.add(g),g}};function eG(){return this._results[Pc()]()}class wg{constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Pc(),i=wg.prototype;i[t]||(i[t]=eG)}get changes(){return this._changes||(this._changes=new Mi)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const r=no(e);(this._changesDetected=!function vT(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=e[i];if(t&&(r=t(r),o=t(o)),o!==r)return!1}return!0}(i._results,r,t))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ts=(()=>{class n{}return n.__NG_ELEMENT_ID__=iG,n})();const tG=Ts,nG=class extends tG{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tViews,r=tg(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);r[17]=this._declarationLView[this._declarationTContainer.index];const l=this._declarationLView[19];return null!==l&&(r[19]=l.createEmbeddedView(i)),ng(i,r,e),new al(r)}};function iG(){return MM(Qi(),pe())}function MM(n,e){return 4&n.type?new nG(e,n,Ta(n,e)):null}let Gs=(()=>{class n{}return n.__NG_ELEMENT_ID__=rG,n})();function rG(){return kF(Qi(),pe())}const sG=Gs,NF=class extends sG{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return Ta(this._hostTNode,this._hostLView)}get injector(){return new Ou(this._hostTNode,this._hostLView)}get parentInjector(){const e=jp(this._hostTNode,this._hostLView);if(_b(e)){const t=Nu(e,this._hostLView),i=Fu(e);return new Ou(t[1].data[i+8],t)}return new Ou(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=OF(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,t,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const l=e.createEmbeddedView(t||{},o);return this.insert(l,r),l}createComponent(e,t,i,r,o){const l=e&&!function Eh(n){return"function"==typeof n}(e);let c;if(l)c=t;else{const y=t||{};c=y.index,i=y.injector,r=y.projectableNodes,o=y.environmentInjector||y.ngModuleRef}const h=l?e:new Ra(gi(e)),p=i||this.parentInjector;if(!o&&null==h.ngModule){const x=(l?p:this.parentInjector).get(Pl,null);x&&(o=x)}const g=h.create(p,r,void 0,o);return this.insert(g.hostView,c),g}insert(e,t){const i=e._lView,r=i[1];if(function At(n){return Ks(n[3])}(i)){const g=this.indexOf(e);if(-1!==g)this.detach(g);else{const y=i[3],x=new NF(y,y[6],y[3]);x.detach(x.indexOf(e))}}const o=this._adjustIndex(t),l=this._lContainer;!function Yh(n,e,t,i){const r=10+i,o=t.length;i>0&&(t[r-1][4]=e),i<o-10?(e[4]=t[r],Ab(t,10+i,e)):(t.push(e),e[4]=null),e[3]=t;const l=e[17];null!==l&&t!==l&&function C1(n,e){const t=n[9];e[16]!==e[3][3][16]&&(n[2]=!0),null===t?n[9]=[e]:t.push(e)}(l,e);const c=e[19];null!==c&&c.insertView(n),e[2]|=64}(r,i,l,o);const c=id(o,l),h=i[11],p=Bl(h,l[7]);return null!==p&&function wm(n,e,t,i,r,o){i[0]=r,i[6]=e,Sc(n,i,t,1,r,o)}(r,l[6],h,i,p,c),e.attachToViewContainerRef(),Ab(TA(l),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=OF(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=Sm(this._lContainer,t);i&&(Xp(TA(this._lContainer),t),td(i[1],i))}detach(e){const t=this._adjustIndex(e,-1),i=Sm(this._lContainer,t);return i&&null!=Xp(TA(this._lContainer),t)?new al(i):null}_adjustIndex(e,t=0){return null==e?this.length+t:e}};function OF(n){return n[8]}function TA(n){return n[8]||(n[8]=[])}function kF(n,e){let t;const i=e[n.index];if(Ks(i))t=i;else{let r;if(8&n.type)r=ar(i);else{const o=e[11];r=o.createComment("");const l=Wn(n,e);Ss(o,Bl(o,l),r,function xc(n,e){return n.nextSibling(e)}(o,l),!1)}e[n.index]=t=xf(i,e,r,n),cg(e,t)}return new NF(t,n,e)}class AA{constructor(e){this.queryList=e,this.matches=null}clone(){return new AA(this.queryList)}setDirty(){this.queryList.setDirty()}}class DA{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,r=[];for(let o=0;o<i;o++){const l=t.getByIndex(o);r.push(this.queries[l.indexInDeclarationView].clone())}return new DA(r)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==HF(e,t).matches&&this.queries[t].setDirty()}}class BF{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class RA{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const r=null!==t?t.length:0,o=this.getByIndex(i).embeddedTView(e,r);o&&(o.indexInDeclarationView=i,null!==t?t.push(o):t=[o])}return null!==t?new RA(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class IA{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new IA(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(e,t,lG(t,o)),this.matchTNodeWithReadOption(e,t,$p(t,e,o,!1,!1))}else i===Ts?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,$p(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===In||r===Gs||r===Ts&&4&t.type)this.addMatch(t.index,-2);else{const o=$p(t,e,r,!1,!1);null!==o&&this.addMatch(t.index,o)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function lG(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function uG(n,e,t,i){return-1===t?function cG(n,e){return 11&n.type?Ta(n,e):4&n.type?MM(n,e):null}(e,n):-2===t?function dG(n,e,t){return t===In?Ta(e,n):t===Ts?MM(e,n):t===Gs?kF(e,n):void 0}(n,e,i):Mh(n,n[1],t,e)}function VF(n,e,t,i){const r=e[19].queries[i];if(null===r.matches){const o=n.data,l=t.matches,c=[];for(let h=0;h<l.length;h+=2){const p=l[h];c.push(p<0?null:uG(e,o[p],l[h+1],t.metadata.read))}r.matches=c}return r.matches}function LA(n,e,t,i){const r=n.queries.getByIndex(t),o=r.matches;if(null!==o){const l=VF(n,e,r,t);for(let c=0;c<o.length;c+=2){const h=o[c];if(h>0)i.push(l[c/2]);else{const p=o[c+1],g=e[-h];for(let y=10;y<g.length;y++){const x=g[y];x[17]===x[3]&&LA(x[1],x,p,i)}if(null!==g[9]){const y=g[9];for(let x=0;x<y.length;x++){const M=y[x];LA(M[1],M,p,i)}}}}}return i}function ai(n){const e=pe(),t=On(),i=vh();Tu(i+1);const r=HF(t,i);if(n.dirty&&Pp(e)===(2==(2&r.metadata.flags))){if(null===r.matches)n.reset([]);else{const o=r.crossesNgTemplate?LA(t,e,i,[]):VF(t,e,r,i);n.reset(o,am),n.notifyOnChanges()}return!0}return!1}function oa(n,e,t){const i=On();i.firstCreatePass&&(zF(i,new BF(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),UF(i,pe(),e)}function mr(n,e,t,i){const r=On();if(r.firstCreatePass){const o=Qi();zF(r,new BF(e,t,i),o.index),function fG(n,e){const t=n.contentQueries||(n.contentQueries=[]);e!==(t.length?t[t.length-1]:-1)&&t.push(n.queries.length-1,e)}(r,n),2==(2&t)&&(r.staticContentQueries=!0)}UF(r,pe(),t)}function li(){return function hG(n,e){return n[19].queries[e].queryList}(pe(),vh())}function UF(n,e,t){const i=new wg(4==(4&t));Uv(n,e,i,i.destroy),null===e[19]&&(e[19]=new DA),e[19].queries.push(new AA(i))}function zF(n,e,t){null===n.queries&&(n.queries=new RA),n.queries.track(new IA(e,t))}function HF(n,e){return n.queries.getByIndex(e)}function EM(...n){}const CM=new at("Application Initializer");let TM=(()=>{class n{constructor(t){this.appInits=t,this.resolve=EM,this.reject=EM,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(H(o))t.push(o);else if(he(o)){const l=new Promise((c,h)=>{o.subscribe({complete:c,error:h})});t.push(l)}}Promise.all(t).then(()=>{i()}).catch(r=>{this.reject(r)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(Be(CM,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const h0=new at("AppId",{providedIn:"root",factory:function l2(){return`${kA()}${kA()}${kA()}`}});function kA(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const c2=new at("Platform Initializer"),AM=new at("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),u2=new at("appBootstrapListener"),Cg=new at("AnimationModuleType");let FG=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const ql=new at("LocaleId",{providedIn:"root",factory:()=>Eo(ql,Yt.Optional|Yt.SkipSelf)||function NG(){return"undefined"!=typeof $localize&&$localize.locale||xg}()});class kG{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let BA=(()=>{class n{compileModuleSync(t){return new SA(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),o=Ao(as(t).declarations).reduce((l,c)=>{const h=gi(c);return h&&l.push(new Ra(h)),l},[]);return new kG(i,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const UG=(()=>Promise.resolve(0))();function VA(n){"undefined"==typeof Zone?UG.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class zn{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Mi(!1),this.onMicrotaskEmpty=new Mi(!1),this.onStable=new Mi(!1),this.onError=new Mi(!1),"undefined"==typeof Zone)throw new ke(908,!1);Zone.assertZonePatched();const r=this;if(r._nesting=0,r._outer=r._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const o=Zone.AsyncStackTaggingZoneSpec;r._inner=r._inner.fork(new o("Angular"))}Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&t,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function zG(){let n=Di.requestAnimationFrame,e=Di.cancelAnimationFrame;if("undefined"!=typeof Zone&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function WG(n){const e=()=>{!function GG(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(Di,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,zA(n),n.isCheckStableRunning=!0,UA(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),zA(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,r,o,l,c)=>{try{return f2(n),t.invokeTask(r,o,l,c)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||n.shouldCoalesceRunChangeDetection)&&e(),p2(n)}},onInvoke:(t,i,r,o,l,c,h)=>{try{return f2(n),t.invoke(r,o,l,c,h)}finally{n.shouldCoalesceRunChangeDetection&&e(),p2(n)}},onHasTask:(t,i,r,o)=>{t.hasTask(r,o),i===r&&("microTask"==o.change?(n._hasPendingMicrotasks=o.microTask,zA(n),UA(n)):"macroTask"==o.change&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(t,i,r,o)=>(t.handleError(r,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!zn.isInAngularZone())throw new ke(909,!1)}static assertNotInAngularZone(){if(zn.isInAngularZone())throw new ke(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,r){const o=this._inner,l=o.scheduleEventTask("NgZoneEvent: "+r,e,HG,EM,EM);try{return o.runTask(l,t,i)}finally{o.cancelTask(l)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const HG={};function UA(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function zA(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function f2(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function p2(n){n._nesting--,UA(n)}class jG{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Mi,this.onMicrotaskEmpty=new Mi,this.onStable=new Mi,this.onError=new Mi}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,r){return e.apply(t,i)}}const m2=new at(""),DM=new at("");let f0,HA=(()=>{class n{constructor(t,i,r){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,f0||(function qG(n){f0=n}(r),r.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{zn.assertNotInAngularZone(),VA(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())VA(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(l=>l.timeoutId!==o),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:o,updateCb:r})}whenStable(t,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,r){return[]}}return n.\u0275fac=function(t){return new(t||n)(Be(zn),Be(GA),Be(DM))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),GA=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){var r;return null!==(r=null==f0?void 0:f0.findTestabilityInTree(this,t,i))&&void 0!==r?r:null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),$l=null;const g2=new at("AllowMultipleToken"),WA=new at("PlatformDestroyListeners");class _2{constructor(e,t){this.name=e,this.token=t}}function v2(n,e,t=[]){const i=`Platform: ${e}`,r=new at(i);return(o=[])=>{let l=jA();if(!l||l.injector.get(g2,!1)){const c=[...t,...o,{provide:r,useValue:!0}];n?n(c):function ZG(n){if($l&&!$l.get(g2,!1))throw new ke(400,!1);$l=n;const e=n.get(b2);(function y2(n){const e=n.get(c2,null);e&&e.forEach(t=>t())})(n)}(function x2(n=[],e){return Ii.create({name:e,providers:[{provide:em,useValue:"platform"},{provide:WA,useValue:new Set([()=>$l=null])},...n]})}(c,i))}return function JG(n){const e=jA();if(!e)throw new ke(401,!1);return e}()}}function jA(){var n;return null!==(n=null==$l?void 0:$l.get(b2))&&void 0!==n?n:null}let b2=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const r=function KG(n,e){let t;return t="noop"===n?new jG:("zone.js"===n?void 0:n)||new zn(e),t}(null==i?void 0:i.ngZone,function w2(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),o=[{provide:zn,useValue:r}];return r.run(()=>{const l=Ii.create({providers:o,parent:this.injector,name:t.moduleType.name}),c=t.create(l),h=c.injector.get(ao,null);if(!h)throw new ke(402,!1);return r.runOutsideAngular(()=>{const p=r.onError.subscribe({next:g=>{h.handleError(g)}});c.onDestroy(()=>{RM(this._modules,c),p.unsubscribe()})}),function M2(n,e,t){try{const i=t();return H(i)?i.catch(r=>{throw e.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(h,r,()=>{const p=c.injector.get(TM);return p.runInitializers(),p.donePromise.then(()=>(function JP(n){Ls(n,"Expected localeId to be defined"),"string"==typeof n&&(YP=n.toLowerCase().replace(/_/g,"-"))}(c.injector.get(ql,xg)||xg),this._moduleDoBootstrap(c),c))})})}bootstrapModule(t,i=[]){const r=S2({},i);return function $G(n,e,t){const i=new SA(t);return Promise.resolve(i)}(0,0,t).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(t){const i=t.injector.get(p0);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!t.instance.ngDoBootstrap)throw new ke(403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ke(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(WA,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(Be(Ii))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function S2(n,e){return Array.isArray(e)?e.reduce(S2,n):Object.assign(Object.assign({},n),e)}let p0=(()=>{class n{constructor(t,i,r){this._zone=t,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new Ci(c=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{c.next(this._stable),c.complete()})}),l=new Ci(c=>{let h;this._zone.runOutsideAngular(()=>{h=this._zone.onStable.subscribe(()=>{zn.assertNotInAngularZone(),VA(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,c.next(!0))})})});const p=this._zone.onUnstable.subscribe(()=>{zn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{c.next(!1)}))});return()=>{h.unsubscribe(),p.unsubscribe()}});this.isStable=Mp(o,l.pipe(Sp()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,i){const r=t instanceof Fl;if(!this._injector.get(TM).done)throw!r&&function Sg(n){const e=gi(n)||Yi(n)||_i(n);return null!==e&&e.standalone}(t),new ke(405,false);let l;l=r?t:this._injector.get(hi).resolveComponentFactory(t),this.componentTypes.push(l.componentType);const c=function XG(n){return n.isBoundToModule}(l)?void 0:this._injector.get(Af),p=l.create(Ii.NULL,[],i||l.selector,c),g=p.location.nativeElement,y=p.injector.get(m2,null);return null==y||y.registerApplication(g),p.onDestroy(()=>{this.detachView(p.hostView),RM(this.components,p),null==y||y.unregisterApplication(g)}),this._loadComponent(p),p}tick(){if(this._runningTick)throw new ke(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;RM(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t),this._injector.get(u2,[]).concat(this._bootstrapListeners).forEach(r=>r(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>RM(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new ke(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(Be(zn),Be(Pl),Be(ao))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function RM(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let C2=!0,aa=(()=>{class n{}return n.__NG_ELEMENT_ID__=t5,n})();function t5(n){return function n5(n,e,t){if(qo(n)&&!t){const i=bs(n.index,e);return new al(i,i)}return 47&n.type?new al(e[16],e):null}(Qi(),pe(),16==(16&n))}class F2{constructor(){}supports(e){return e instanceof Map||n0(e)}create(){return new d5}}class d5{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||n0(e)))throw new ke(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(i,r)=>{if(t&&t.key===r)this._maybeAddToChanges(t,i),this._appendAfter=t,t=t._next;else{const o=this._getOrCreateRecordForKey(r,i);t=this._insertBeforeOrAppend(t,o)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let i=t;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const i=e._prev;return t._next=e,t._prev=i,e._prev=t,i&&(i._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const r=this._records.get(e);this._maybeAddToChanges(r,t);const o=r._prev,l=r._next;return o&&(o._next=l),l&&(l._prev=o),r._next=null,r._prev=null,r}const i=new h5(e);return this._records.set(e,i),i.currentValue=t,this._addToAdditions(i),i}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(i=>t(e[i],i))}}class h5{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function O2(){return new m0([new F2])}let m0=(()=>{class n{constructor(t){this.factories=t}static create(t,i){if(i){const r=i.factories.slice();t=t.concat(r)}return new n(t)}static extend(t){return{provide:n,useFactory:i=>n.create(t,i||O2()),deps:[[n,new Gu,new Sa]]}}find(t){const i=this.factories.find(r=>r.supports(t));if(i)return i;throw new ke(901,!1)}}return n.\u0275prov=yt({token:n,providedIn:"root",factory:O2}),n})();const m5=v2(null,"core",[]);let g5=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(Be(p0))},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})();let PM=null;function Xl(){return PM}const pi=new at("DocumentToken");let FM=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:function(){return function x5(){return Be(k2)}()},providedIn:"platform"}),n})();const b5=new at("Location Initialized");let k2=(()=>{class n extends FM{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Xl().getBaseHref(this._doc)}onPopState(t){const i=Xl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=Xl().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,i,r){B2()?this._history.pushState(t,i,r):this.location.hash=r}replaceState(t,i,r){B2()?this._history.replaceState(t,i,r):this.location.hash=r}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(Be(pi))},n.\u0275prov=yt({token:n,factory:function(){return function w5(){return new k2(Be(pi))}()},providedIn:"platform"}),n})();function B2(){return!!window.history.pushState}function YA(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function V2(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Bc(n){return n&&"?"!==n[0]?"?"+n:n}let Rf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:function(){return function M5(){const n=Be(pi).location;return new z2(Be(FM),n&&n.origin||"")}()},providedIn:"root"}),n})();const U2=new at("appBaseHref");let z2=(()=>{class n extends Rf{constructor(t,i){if(super(),this._platformLocation=t,this._removeListenerFns=[],null==i&&(i=this._platformLocation.getBaseHrefFromDOM()),null==i)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=i}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return YA(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+Bc(this._platformLocation.search),r=this._platformLocation.hash;return r&&t?`${i}${r}`:i}pushState(t,i,r,o){const l=this.prepareExternalUrl(r+Bc(o));this._platformLocation.pushState(t,i,l)}replaceState(t,i,r,o){const l=this.prepareExternalUrl(r+Bc(o));this._platformLocation.replaceState(t,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Be(FM),Be(U2,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),S5=(()=>{class n extends Rf{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=YA(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,r,o){let l=this.prepareExternalUrl(r+Bc(o));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,i,l)}replaceState(t,i,r,o){let l=this.prepareExternalUrl(r+Bc(o));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){var i,r;null===(r=(i=this._platformLocation).historyGo)||void 0===r||r.call(i,t)}}return n.\u0275fac=function(t){return new(t||n)(Be(FM),Be(U2,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),JA=(()=>{class n{constructor(t){this._subject=new Mi,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._baseHref=V2(H2(i)),this._locationStrategy.onPopState(r=>{this._subject.emit({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){var t;null===(t=this._urlChangeSubscription)||void 0===t||t.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+Bc(i))}normalize(t){return n.stripTrailingSlash(function C5(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,H2(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",r=null){this._locationStrategy.pushState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Bc(i)),r)}replaceState(t,i="",r=null){this._locationStrategy.replaceState(r,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Bc(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){var i,r;null===(r=(i=this._locationStrategy).historyGo)||void 0===r||r.call(i,t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{var i;const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(null===(i=this._urlChangeSubscription)||void 0===i||i.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(r=>r(t,i))}subscribe(t,i,r){return this._subject.subscribe({next:t,error:i,complete:r})}}return n.normalizeQueryParams=Bc,n.joinWithSlash=YA,n.stripTrailingSlash=V2,n.\u0275fac=function(t){return new(t||n)(Be(Rf))},n.\u0275prov=yt({token:n,factory:function(){return function E5(){return new JA(Be(Rf))}()},providedIn:"root"}),n})();function H2(n){return n.replace(/\/index.html$/,"")}function J2(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[r,o]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(r.trim()===e)return decodeURIComponent(o)}return null}let WM=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new pW,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){tN("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){tN("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)(oe(Gs),oe(Ts))},n.\u0275dir=st({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class pW{constructor(){this.$implicit=null,this.ngIf=null}}function tN(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Ai(e)}'.`)}let iN=(()=>{class n{constructor(t,i,r){this._ngEl=t,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,i){const[r,o]=t.split("."),l=-1===r.indexOf("-")?void 0:Ur.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,l):this._renderer.removeStyle(this._ngEl.nativeElement,r,l)}_applyChanges(t){t.forEachRemovedItem(i=>this._setStyle(i.key,null)),t.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),t.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(m0),oe(hs))},n.\u0275dir=st({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),n})(),y0=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})();const sN="browser";let WW=(()=>{class n{}return n.\u0275prov=yt({token:n,providedIn:"root",factory:()=>new jW(Be(pi),window)}),n})();class jW{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function qW(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let r=i.currentNode;for(;r;){const o=r.shadowRoot;if(o){const l=o.getElementById(e)||o.querySelector(`[name="${e}"]`);if(l)return l}r=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,r=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(i-o[0],r-o[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=oN(this.window.history)||oN(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function oN(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class aN{}class dD extends class $W extends class v5{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function y5(n){PM||(PM=n)}(new dD)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function XW(){return v0=v0||document.querySelector("base"),v0?v0.getAttribute("href"):null}();return null==t?null:function ZW(n){jM=jM||document.createElement("a"),jM.setAttribute("href",n);const e=jM.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){v0=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return J2(document.cookie,e)}}let jM,v0=null;const lN=new at("TRANSITION_ID"),JW=[{provide:CM,useFactory:function YW(n,e,t){return()=>{t.get(TM).donePromise.then(()=>{const i=Xl(),r=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[lN,pi,Ii],multi:!0}];let QW=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const qM=new at("EventManagerPlugins");let $M=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(r=>r.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,i,r){return this._findPluginFor(i).addEventListener(t,i,r)}addGlobalEventListener(t,i,r){return this._findPluginFor(i).addGlobalEventListener(t,i,r)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const l=r[o];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(Be(qM),Be(zn))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();class cN{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const r=Xl().getGlobalEventTarget(this._doc,e);if(!r)throw new Error(`Unsupported event target ${r} for event ${t}`);return this.addEventListener(r,t,i)}}let uN=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const i=new Set;t.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),x0=(()=>{class n extends uN{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,i,r){t.forEach(o=>{const l=this._doc.createElement("style");l.textContent=o,r.push(i.appendChild(l))})}addHost(t){const i=[];this._addStylesToHost(this._stylesSet,t,i),this._hostNodes.set(t,i)}removeHost(t){const i=this._hostNodes.get(t);i&&i.forEach(dN),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(t,r,i)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(dN))}}return n.\u0275fac=function(t){return new(t||n)(Be(pi))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();function dN(n){Xl().remove(n)}const hD={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},fD=/%COMP%/g;function XM(n,e,t){for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?XM(n,r,t):(r=r.replace(fD,n),t.push(r))}return t}function pN(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let ZM=(()=>{class n{constructor(t,i,r){this.eventManager=t,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new pD(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;switch(i.encapsulation){case Go.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new s8(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(t),r}case 1:case Go.ShadowDom:return new o8(this.eventManager,this.sharedStylesHost,t,i);default:if(!this.rendererByCompId.has(i.id)){const r=XM(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(Be($M),Be(x0),Be(h0))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();class pD{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(hD[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(gN(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(gN(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,r){if(r){t=r+":"+t;const o=hD[r];o?e.setAttributeNS(o,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const r=hD[i];r?e.removeAttributeNS(r,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,r){r&(Ur.DashCase|Ur.Important)?e.style.setProperty(t,i,r&Ur.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Ur.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,pN(i)):this.eventManager.addEventListener(e,t,pN(i))}}function gN(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class s8 extends pD{constructor(e,t,i,r){super(e),this.component=i;const o=XM(r+"-"+i.id,i.styles,[]);t.addStyles(o),this.contentAttr=function n8(n){return"_ngcontent-%COMP%".replace(fD,n)}(r+"-"+i.id),this.hostAttr=function i8(n){return"_nghost-%COMP%".replace(fD,n)}(r+"-"+i.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}class o8 extends pD{constructor(e,t,i,r){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=XM(r.id,r.styles,[]);for(let l=0;l<o.length;l++){const c=document.createElement("style");c.textContent=o[l],this.shadowRoot.appendChild(c)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let a8=(()=>{class n extends cN{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,r){return t.addEventListener(i,r,!1),()=>this.removeEventListener(t,i,r)}removeEventListener(t,i,r){return t.removeEventListener(i,r)}}return n.\u0275fac=function(t){return new(t||n)(Be(pi))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const _N=["alt","control","meta","shift"],c8={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yN={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},u8={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let d8=(()=>{class n extends cN{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,r){const o=n.parseEventName(i),l=n.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xl().onAndCancel(t,o.domEventName,l))}static parseEventName(t){const i=t.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=n._normalizeKey(i.pop());let l="";if(_N.forEach(h=>{const p=i.indexOf(h);p>-1&&(i.splice(p,1),l+=h+".")}),l+=o,0!=i.length||0===o.length)return null;const c={};return c.domEventName=r,c.fullKey=l,c}static getEventFullKey(t){let i="",r=function h8(n){let e=n.key;if(null==e){if(e=n.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===n.location&&yN.hasOwnProperty(e)&&(e=yN[e]))}return c8[e]||e}(t);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),_N.forEach(o=>{o!=r&&(0,u8[o])(t)&&(i+=o+".")}),i+=r,i}static eventCallback(t,i,r){return o=>{n.getEventFullKey(o)===t&&r.runGuarded(()=>i(o))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(Be(pi))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const g8=v2(m5,"browser",[{provide:AM,useValue:sN},{provide:c2,useValue:function f8(){dD.makeCurrent()},multi:!0},{provide:pi,useFactory:function m8(){return function GT(n){Oy=n}(document),document},deps:[]}]),xN=new at(""),bN=[{provide:DM,useClass:class KW{addToWindow(e){Di.getAngularTestability=(i,r=!0)=>{const o=e.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},Di.getAllAngularTestabilities=()=>e.getAllTestabilities(),Di.getAllAngularRootElements=()=>e.getAllRootElements(),Di.frameworkStabilizers||(Di.frameworkStabilizers=[]),Di.frameworkStabilizers.push(i=>{const r=Di.getAllAngularTestabilities();let o=r.length,l=!1;const c=function(h){l=l||h,o--,0==o&&i(l)};r.forEach(function(h){h.whenStable(c)})})}findTestabilityInTree(e,t,i){if(null==t)return null;const r=e.getTestability(t);return null!=r?r:i?Xl().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}},deps:[]},{provide:m2,useClass:HA,deps:[zn,GA,DM]},{provide:HA,useClass:HA,deps:[zn,GA,DM]}],wN=[{provide:em,useValue:"root"},{provide:ao,useFactory:function p8(){return new ao},deps:[]},{provide:qM,useClass:a8,multi:!0,deps:[pi,zn,AM]},{provide:qM,useClass:d8,multi:!0,deps:[pi]},{provide:ZM,useClass:ZM,deps:[$M,x0,h0]},{provide:Jo,useExisting:ZM},{provide:uN,useExisting:x0},{provide:x0,useClass:x0,deps:[pi]},{provide:$M,useClass:$M,deps:[qM,zn]},{provide:aN,useClass:QW,deps:[]},[]];let MN=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:h0,useValue:t.appId},{provide:lN,useExisting:h0},JW]}}}return n.\u0275fac=function(t){return new(t||n)(Be(xN,12))},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({providers:[...wN,...bN],imports:[y0,g5]}),n})(),SN=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(Be(pi))},n.\u0275prov=yt({token:n,factory:function(t){let i=null;return i=t?new t:function y8(){return new SN(Be(pi))}(),i},providedIn:"root"}),n})();"undefined"!=typeof window&&window;let _D=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:function(t){let i=null;return i=t?new(t||n):Be(TN),i},providedIn:"root"}),n})(),TN=(()=>{class n extends _D{constructor(t){super(),this._doc=t}sanitize(t,i){if(null==i)return null;switch(t){case di.NONE:return i;case di.HTML:return Ea(i,"HTML")?so(i):Zb(this._doc,String(i)).toString();case di.STYLE:return Ea(i,"Style")?so(i):i;case di.SCRIPT:if(Ea(i,"Script"))return so(i);throw new Error("unsafe value used in a script context");case di.URL:return Ea(i,"URL")?so(i):Fh(String(i));case di.RESOURCE_URL:if(Ea(i,"ResourceURL"))return so(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${t} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(t){return function YT(n){return new To(n)}(t)}bypassSecurityTrustStyle(t){return function JT(n){return new ro(n)}(t)}bypassSecurityTrustScript(t){return function KT(n){return new zb(n)}(t)}bypassSecurityTrustUrl(t){return function QT(n){return new $T(n)}(t)}bypassSecurityTrustResourceUrl(t){return function e1(n){return new XT(n)}(t)}}return n.\u0275fac=function(t){return new(t||n)(Be(pi))},n.\u0275prov=yt({token:n,factory:function(t){let i=null;return i=t?new t:function C8(n){return new TN(n.get(pi))}(Be(Ii)),i},providedIn:"root"}),n})();function Gt(...n){return sr(n,hu(n))}class la extends ri{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const{isArray:T8}=Array,{getPrototypeOf:A8,prototype:D8,keys:R8}=Object;function AN(n){if(1===n.length){const e=n[0];if(T8(e))return{args:e,keys:null};if(function I8(n){return n&&"object"==typeof n&&A8(n)===D8}(e)){const t=R8(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:L8}=Array;function yD(n){return an(e=>function P8(n,e){return L8(e)?n(...e):n(e)}(n,e))}function DN(n,e){return n.reduce((t,i,r)=>(t[i]=e[r],t),{})}function vD(...n){const e=hu(n),t=ny(n),{args:i,keys:r}=AN(n);if(0===i.length)return sr([],e);const o=new Ci(function F8(n,e,t=Ga){return i=>{RN(e,()=>{const{length:r}=n,o=new Array(r);let l=r,c=r;for(let h=0;h<r;h++)RN(e,()=>{const p=sr(n[h],e);let g=!1;p.subscribe(ji(i,y=>{o[h]=y,g||(g=!0,c--),c||i.next(t(o.slice()))},()=>{--l||i.complete()}))},i)},i)}}(i,e,r?l=>DN(r,l):Ga));return t?o.pipe(yD(t)):o}function RN(n,e,t){n?ss(t,n,e):e()}function YM(...n){return function N8(){return ac(1)}()(sr(n,hu(n)))}function IN(n){return new Ci(e=>{Br(n()).subscribe(e)})}function Tg(n,e){const t=Mn(n)?n:()=>n,i=r=>r.error(t());return new Ci(e?r=>e.schedule(i,0,r):i)}const Ag=Vn(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function xD(){return Zi((n,e)=>{let t=null;n._refCount++;const i=ji(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const r=n._connection,o=t;t=null,r&&(!o||r===o)&&r.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class LN extends Ci{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,W_(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ei;const t=this.getSubject();e.add(this.source.subscribe(ji(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ei.EMPTY)}return e}refCount(){return xD()(this)}}function Zl(n,e){return Zi((t,i)=>{let r=null,o=0,l=!1;const c=()=>l&&!r&&i.complete();t.subscribe(ji(i,h=>{null==r||r.unsubscribe();let p=0;const g=o++;Br(n(h,g)).subscribe(r=ji(i,y=>i.next(e?e(h,y,g,p++):y),()=>{r=null,c()}))},()=>{l=!0,c()}))})}function Na(n){return n<=0?()=>ya:Zi((e,t)=>{let i=0;e.subscribe(ji(t,r=>{++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function Dg(...n){const e=hu(n);return Zi((t,i)=>{(e?YM(n,t,e):YM(n,t)).subscribe(i)})}function _s(n,e){return Zi((t,i)=>{let r=0;t.subscribe(ji(i,o=>n.call(e,o,r++)&&i.next(o)))})}function JM(n){return Zi((e,t)=>{let i=!1;e.subscribe(ji(t,r=>{i=!0,t.next(r)},()=>{i||t.next(n),t.complete()}))})}function PN(n=O8){return Zi((e,t)=>{let i=!1;e.subscribe(ji(t,r=>{i=!0,t.next(r)},()=>i?t.complete():t.error(n())))})}function O8(){return new Ag}function Cd(n,e){const t=arguments.length>=2;return i=>i.pipe(n?_s((r,o)=>n(r,o,i)):Ga,Na(1),t?JM(e):PN(()=>new Ag))}function Td(n,e){return Mn(e)?Dr(n,e,1):Dr(n,1)}function jr(n,e,t){const i=Mn(n)||e||t?{next:n,error:e,complete:t}:n;return i?Zi((r,o)=>{var l;null===(l=i.subscribe)||void 0===l||l.call(i);let c=!0;r.subscribe(ji(o,h=>{var p;null===(p=i.next)||void 0===p||p.call(i,h),o.next(h)},()=>{var h;c=!1,null===(h=i.complete)||void 0===h||h.call(i),o.complete()},h=>{var p;c=!1,null===(p=i.error)||void 0===p||p.call(i,h),o.error(h)},()=>{var h,p;c&&(null===(h=i.unsubscribe)||void 0===h||h.call(i)),null===(p=i.finalize)||void 0===p||p.call(i)}))}):Ga}function Uc(n){return Zi((e,t)=>{let o,i=null,r=!1;i=e.subscribe(ji(t,void 0,void 0,l=>{o=Br(n(l,Uc(n)(e))),i?(i.unsubscribe(),i=null,o.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(t))})}function k8(n,e,t,i,r){return(o,l)=>{let c=t,h=e,p=0;o.subscribe(ji(l,g=>{const y=p++;h=c?n(h,g,y):(c=!0,g),i&&l.next(h)},r&&(()=>{c&&l.next(h),l.complete()})))}}function FN(n,e){return Zi(k8(n,e,arguments.length>=2,!0))}function bD(n){return n<=0?()=>ya:Zi((e,t)=>{let i=[];e.subscribe(ji(t,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(const r of i)t.next(r);t.complete()},void 0,()=>{i=null}))})}function NN(n,e){const t=arguments.length>=2;return i=>i.pipe(n?_s((r,o)=>n(r,o,i)):Ga,bD(1),t?JM(e):PN(()=>new Ag))}function wD(n){return an(()=>n)}function KM(n){return Zi((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Hn="primary";class V8{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Rg(n){return new V8(n)}function U8(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const r={};for(let o=0;o<i.length;o++){const l=i[o],c=n[o];if(l.startsWith(":"))r[l.substring(1)]=c;else if(l!==c.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function Yl(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let r;for(let o=0;o<t.length;o++)if(r=t[o],!ON(n[r],e[r]))return!1;return!0}function ON(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((r,o)=>i[o]===r)}return n===e}function kN(n){return Array.prototype.concat.apply([],n)}function BN(n){return n.length>0?n[n.length-1]:null}function As(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function zc(n){return he(n)?n:H(n)?sr(Promise.resolve(n)):Gt(n)}const G8={exact:function zN(n,e,t){if(!Lf(n.segments,e.segments)||!QM(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!zN(n.children[i],e.children[i],t))return!1;return!0},subset:HN},VN={exact:function W8(n,e){return Yl(n,e)},subset:function j8(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>ON(n[t],e[t]))},ignored:()=>!0};function UN(n,e,t){return G8[t.paths](n.root,e.root,t.matrixParams)&&VN[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function HN(n,e,t){return GN(n,e,e.segments,t)}function GN(n,e,t,i){if(n.segments.length>t.length){const r=n.segments.slice(0,t.length);return!(!Lf(r,t)||e.hasChildren()||!QM(r,t,i))}if(n.segments.length===t.length){if(!Lf(n.segments,t)||!QM(n.segments,t,i))return!1;for(const r in e.children)if(!n.children[r]||!HN(n.children[r],e.children[r],i))return!1;return!0}{const r=t.slice(0,n.segments.length),o=t.slice(n.segments.length);return!!(Lf(n.segments,r)&&QM(n.segments,r,i)&&n.children[Hn])&&GN(n.children[Hn],e,o,i)}}function QM(n,e,t){return e.every((i,r)=>VN[t](n[r].parameters,i.parameters))}class If{constructor(e,t,i){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Rg(this.queryParams)),this._queryParamMap}toString(){return X8.serialize(this)}}class qn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,As(t,(i,r)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return eS(this)}}class b0{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Rg(this.parameters)),this._parameterMap}toString(){return XN(this)}}function Lf(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}class WN{}class jN{parse(e){const t=new i6(e);return new If(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${w0(e.root,!0)}`,i=function J8(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(r=>`${tS(t)}=${tS(r)}`).join("&"):`${tS(t)}=${tS(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function Z8(n){return encodeURI(n)}(e.fragment)}`:""}`}}const X8=new jN;function eS(n){return n.segments.map(e=>XN(e)).join("/")}function w0(n,e){if(!n.hasChildren())return eS(n);if(e){const t=n.children[Hn]?w0(n.children[Hn],!1):"",i=[];return As(n.children,(r,o)=>{o!==Hn&&i.push(`${o}:${w0(r,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function $8(n,e){let t=[];return As(n.children,(i,r)=>{r===Hn&&(t=t.concat(e(i,r)))}),As(n.children,(i,r)=>{r!==Hn&&(t=t.concat(e(i,r)))}),t}(n,(i,r)=>r===Hn?[w0(n.children[Hn],!1)]:[`${r}:${w0(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Hn]?`${eS(n)}/${t[0]}`:`${eS(n)}/(${t.join("//")})`}}function qN(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function tS(n){return qN(n).replace(/%3B/gi,";")}function SD(n){return qN(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function nS(n){return decodeURIComponent(n)}function $N(n){return nS(n.replace(/\+/g,"%20"))}function XN(n){return`${SD(n.path)}${function Y8(n){return Object.keys(n).map(e=>`;${SD(e)}=${SD(n[e])}`).join("")}(n.parameters)}`}const K8=/^[^\/()?;=#]+/;function iS(n){const e=n.match(K8);return e?e[0]:""}const Q8=/^[^=?&#]+/,t6=/^[^&#]+/;class i6{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new qn([],{}):new qn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Hn]=new qn(e,t)),i}parseSegment(){const e=iS(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new ke(4009,!1);return this.capture(e),new b0(nS(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=iS(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const r=iS(this.remaining);r&&(i=r,this.capture(i))}e[nS(t)]=nS(i)}parseQueryParam(e){const t=function e6(n){const e=n.match(Q8);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const l=function n6(n){const e=n.match(t6);return e?e[0]:""}(this.remaining);l&&(i=l,this.capture(i))}const r=$N(t),o=$N(i);if(e.hasOwnProperty(r)){let l=e[r];Array.isArray(l)||(l=[l],e[r]=l),l.push(o)}else e[r]=o}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=iS(this.remaining),r=this.remaining[i.length];if("/"!==r&&")"!==r&&";"!==r)throw new ke(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=Hn);const l=this.parseChildren();t[o]=1===Object.keys(l).length?l[Hn]:new qn([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new ke(4011,!1)}}function ED(n){return n.segments.length>0?new qn([],{[Hn]:n}):n}function rS(n){const e={};for(const i of Object.keys(n.children)){const o=rS(n.children[i]);(o.segments.length>0||o.hasChildren())&&(e[i]=o)}return function r6(n){if(1===n.numberOfChildren&&n.children[Hn]){const e=n.children[Hn];return new qn(n.segments.concat(e.segments),e.children)}return n}(new qn(n.segments,e))}function Pf(n){return n instanceof If}function a6(n,e,t,i,r){var o;if(0===t.length)return Ig(e.root,e.root,e.root,i,r);const c=function JN(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new YN(!0,0,n);let e=0,t=!1;const i=n.reduce((r,o,l)=>{if("object"==typeof o&&null!=o){if(o.outlets){const c={};return As(o.outlets,(h,p)=>{c[p]="string"==typeof h?h.split("/"):h}),[...r,{outlets:c}]}if(o.segmentPath)return[...r,o.segmentPath]}return"string"!=typeof o?[...r,o]:0===l?(o.split("/").forEach((c,h)=>{0==h&&"."===c||(0==h&&""===c?t=!0:".."===c?e++:""!=c&&r.push(c))}),r):[...r,o]},[]);return new YN(t,e,i)}(t);return c.toRoot()?Ig(e.root,e.root,new qn([],{}),i,r):function h(g){var y;const x=function c6(n,e,t,i){if(n.isAbsolute)return new Lg(e.root,!0,0);if(-1===i)return new Lg(t,t===e.root,0);return function KN(n,e,t){let i=n,r=e,o=t;for(;o>r;){if(o-=r,i=i.parent,!i)throw new ke(4005,!1);r=i.segments.length}return new Lg(i,!1,r-o)}(t,i+(M0(n.commands[0])?0:1),n.numberOfDoubleDots)}(c,e,null===(y=n.snapshot)||void 0===y?void 0:y._urlSegment,g),M=x.processChildren?E0(x.segmentGroup,x.index,c.commands):TD(x.segmentGroup,x.index,c.commands);return Ig(e.root,x.segmentGroup,M,i,r)}(null===(o=n.snapshot)||void 0===o?void 0:o._lastPathIndex)}function M0(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function S0(n){return"object"==typeof n&&null!=n&&n.outlets}function Ig(n,e,t,i,r){let l,o={};i&&As(i,(h,p)=>{o[p]=Array.isArray(h)?h.map(g=>`${g}`):`${h}`}),l=n===e?t:ZN(n,e,t);const c=ED(rS(l));return new If(c,o,r)}function ZN(n,e,t){const i={};return As(n.children,(r,o)=>{i[o]=r===e?t:ZN(r,e,t)}),new qn(n.segments,i)}class YN{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&M0(i[0]))throw new ke(4003,!1);const r=i.find(S0);if(r&&r!==BN(i))throw new ke(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Lg{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function TD(n,e,t){if(n||(n=new qn([],{})),0===n.segments.length&&n.hasChildren())return E0(n,e,t);const i=function d6(n,e,t){let i=0,r=e;const o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=t.length)return o;const l=n.segments[r],c=t[i];if(S0(c))break;const h=`${c}`,p=i<t.length-1?t[i+1]:null;if(r>0&&void 0===h)break;if(h&&p&&"object"==typeof p&&void 0===p.outlets){if(!eO(h,p,l))return o;i+=2}else{if(!eO(h,{},l))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}(n,e,t),r=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const o=new qn(n.segments.slice(0,i.pathIndex),{});return o.children[Hn]=new qn(n.segments.slice(i.pathIndex),n.children),E0(o,0,r)}return i.match&&0===r.length?new qn(n.segments,{}):i.match&&!n.hasChildren()?AD(n,e,t):i.match?E0(n,0,r):AD(n,e,t)}function E0(n,e,t){if(0===t.length)return new qn(n.segments,{});{const i=function u6(n){return S0(n[0])?n[0].outlets:{[Hn]:n}}(t),r={};return As(i,(o,l)=>{"string"==typeof o&&(o=[o]),null!==o&&(r[l]=TD(n.children[l],e,o))}),As(n.children,(o,l)=>{void 0===i[l]&&(r[l]=o)}),new qn(n.segments,r)}}function AD(n,e,t){const i=n.segments.slice(0,e);let r=0;for(;r<t.length;){const o=t[r];if(S0(o)){const h=h6(o.outlets);return new qn(i,h)}if(0===r&&M0(t[0])){i.push(new b0(n.segments[e].path,QN(t[0]))),r++;continue}const l=S0(o)?o.outlets[Hn]:`${o}`,c=r<t.length-1?t[r+1]:null;l&&c&&M0(c)?(i.push(new b0(l,QN(c))),r+=2):(i.push(new b0(l,{})),r++)}return new qn(i,{})}function h6(n){const e={};return As(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=AD(new qn([],{}),0,t))}),e}function QN(n){const e={};return As(n,(t,i)=>e[i]=`${t}`),e}function eO(n,e,t){return n==t.path&&Yl(e,t.parameters)}class Hc{constructor(e,t){this.id=e,this.url=t}}class DD extends Hc{constructor(e,t,i="imperative",r=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Ff extends Hc{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class sS extends Hc{constructor(e,t,i,r){super(e,t),this.reason=i,this.code=r,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class tO extends Hc{constructor(e,t,i,r){super(e,t),this.error=i,this.target=r,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class f6 extends Hc{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class p6 extends Hc{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class m6 extends Hc{constructor(e,t,i,r,o){super(e,t),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class g6 extends Hc{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class _6 extends Hc{constructor(e,t,i,r){super(e,t),this.urlAfterRedirects=i,this.state=r,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class y6{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class v6{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class x6{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class b6{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class w6{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class M6{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class nO{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class iO{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=RD(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=RD(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=ID(e,this._root);return t.length<2?[]:t[t.length-2].children.map(r=>r.value).filter(r=>r!==e)}pathFromRoot(e){return ID(e,this._root).map(t=>t.value)}}function RD(n,e){if(n===e.value)return e;for(const t of e.children){const i=RD(n,t);if(i)return i}return null}function ID(n,e){if(n===e.value)return[e];for(const t of e.children){const i=ID(n,t);if(i.length)return i.unshift(e),i}return[]}class Gc{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Pg(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class rO extends iO{constructor(e,t){super(e),this.snapshot=t,LD(this,e)}toString(){return this.snapshot.toString()}}function sO(n,e){const t=function E6(n,e){const l=new oS([],{},{},"",{},Hn,e,null,n.root,-1,{});return new aO("",new Gc(l,[]))}(n,e),i=new la([new b0("",{})]),r=new la({}),o=new la({}),l=new la({}),c=new la(""),h=new Fg(i,r,l,c,o,Hn,e,t.root);return h.snapshot=t.root,new rO(new Gc(h,[]),t)}class Fg{constructor(e,t,i,r,o,l,c,h){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=l,this.component=c,this._futureSnapshot=h}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(an(e=>Rg(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(an(e=>Rg(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function oO(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const r=t[i],o=t[i-1];if(r.routeConfig&&""===r.routeConfig.path)i--;else{if(o.component)break;i--}}return function C6(n){return n.reduce((e,t)=>{var i;return{params:Object.assign(Object.assign({},e.params),t.params),data:Object.assign(Object.assign({},e.data),t.data),resolve:Object.assign(Object.assign(Object.assign(Object.assign({},t.data),e.resolve),null===(i=t.routeConfig)||void 0===i?void 0:i.data),t._resolvedData)}},{params:{},data:{},resolve:{}})}(t.slice(i))}class oS{constructor(e,t,i,r,o,l,c,h,p,g,y,x){this.url=e,this.params=t,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=l,this.component=c,this.routeConfig=h,this._urlSegment=p,this._lastPathIndex=g,this._correctedLastPathIndex=null!=x?x:g,this._resolve=y}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Rg(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Rg(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class aO extends iO{constructor(e,t){super(t),this.url=e,LD(this,t)}toString(){return lO(this._root)}}function LD(n,e){e.value._routerState=n,e.children.forEach(t=>LD(n,t))}function lO(n){const e=n.children.length>0?` { ${n.children.map(lO).join(", ")} } `:"";return`${n.value}${e}`}function PD(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Yl(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),Yl(e.params,t.params)||n.params.next(t.params),function z8(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Yl(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),Yl(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function FD(n,e){const t=Yl(n.params,e.params)&&function q8(n,e){return Lf(n,e)&&n.every((t,i)=>Yl(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||FD(n.parent,e.parent))}function C0(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const r=function A6(n,e,t){return e.children.map(i=>{for(const r of t.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return C0(n,i,r);return C0(n,i)})}(n,e,t);return new Gc(i,r)}{if(n.shouldAttach(e.value)){const o=n.retrieve(e.value);if(null!==o){const l=o.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(c=>C0(n,c)),l}}const i=function D6(n){return new Fg(new la(n.url),new la(n.params),new la(n.queryParams),new la(n.fragment),new la(n.data),n.outlet,n.component,n)}(e.value),r=e.children.map(o=>C0(n,o));return new Gc(i,r)}}const ND="ngNavigationCancelingError";function cO(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Pf(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,r=uO(!1,0,e);return r.url=t,r.navigationBehaviorOptions=i,r}function uO(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[ND]=!0,i.cancellationCode=e,t&&(i.url=t),i}function dO(n){return hO(n)&&Pf(n.url)}function hO(n){return n&&n[ND]}class R6{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new T0,this.attachRef=null}}class T0{constructor(){this.contexts=new Map}onChildOutletCreated(e,t){const i=this.getOrCreateContext(e);i.outlet=t,this.contexts.set(e,i)}onChildOutletDestroyed(e){const t=this.getContext(e);t&&(t.outlet=null,t.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let t=this.getContext(e);return t||(t=new R6,this.contexts.set(e,t)),t}getContext(e){return this.contexts.get(e)||null}}const aS=!1;let fO=(()=>{class n{constructor(t,i,r,o,l){this.parentContexts=t,this.location=i,this.changeDetector=o,this.environmentInjector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new Mi,this.deactivateEvents=new Mi,this.attachEvents=new Mi,this.detachEvents=new Mi,this.name=r||Hn,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){var t;(null===(t=this.parentContexts.getContext(this.name))||void 0===t?void 0:t.outlet)===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ke(4012,aS);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ke(4012,aS);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ke(4012,aS);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new ke(4013,aS);this._activatedRoute=t;const r=this.location,l=t._futureSnapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,h=new I6(t,c,r.injector);if(i&&function L6(n){return!!n.resolveComponentFactory}(i)){const p=i.resolveComponentFactory(l);this.activated=r.createComponent(p,r.length,h)}else this.activated=r.createComponent(l,{index:r.length,injector:h,environmentInjector:null!=i?i:this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(oe(T0),oe(Gs),Ll("name"),oe(aa),oe(Pl))},n.\u0275dir=st({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),n})();class I6{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===Fg?this.route:e===T0?this.childContexts:this.parent.get(e,t)}}let pO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=si({type:n,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,i){1&t&&V(0,"router-outlet")},dependencies:[fO],encapsulation:2}),n})();function mO(n,e){var t;return n.providers&&!n._injector&&(n._injector=wM(n.providers,e,`Route: ${n.path}`)),null!==(t=n._injector)&&void 0!==t?t:e}function kD(n){const e=n.children&&n.children.map(kD),t=e?Object.assign(Object.assign({},n),{children:e}):Object.assign({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Hn&&(t.component=pO),t}function Oa(n){return n.outlet||Hn}function gO(n,e){const t=n.filter(i=>Oa(i)===e);return t.push(...n.filter(i=>Oa(i)!==e)),t}function _O(n){var e;if(!n)return null;if(null!==(e=n.routeConfig)&&void 0!==e&&e._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){const i=t.routeConfig;if(null!=i&&i._loadedInjector)return i._loadedInjector;if(null!=i&&i._injector)return i._injector}return null}class k6{constructor(e,t,i,r){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=r}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),PD(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const r=Pg(t);e.children.forEach(o=>{const l=o.value.outlet;this.deactivateRoutes(o,r[l],i),delete r[l]}),As(r,(o,l)=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(e,t,i){const r=e.value,o=t?t.value:null;if(r===o)if(r.component){const l=i.getContext(r.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,i);else o&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Pg(e);for(const l of Object.keys(o))this.deactivateRouteAndItsChildren(o[l],r);if(i&&i.outlet){const l=i.outlet.detach(),c=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),r=i&&e.value.component?i.children:t,o=Pg(e);for(const l of Object.keys(o))this.deactivateRouteAndItsChildren(o[l],r);i&&i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated(),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const r=Pg(t);e.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new M6(o.value.snapshot))}),e.children.length&&this.forwardEvent(new b6(e.value.snapshot))}activateRoutes(e,t,i){var r;const o=e.value,l=t?t.value:null;if(PD(o),o===l)if(o.component){const c=i.getOrCreateContext(o.outlet);this.activateChildRoutes(e,t,c.children)}else this.activateChildRoutes(e,t,i);else if(o.component){const c=i.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const h=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),c.children.onOutletReAttached(h.contexts),c.attachRef=h.componentRef,c.route=h.route.value,c.outlet&&c.outlet.attach(h.componentRef,h.route.value),PD(h.route.value),this.activateChildRoutes(e,null,c.children)}else{const h=_O(o.snapshot),p=null!==(r=null==h?void 0:h.get(hi))&&void 0!==r?r:null;c.attachRef=null,c.route=o,c.resolver=p,c.injector=h,c.outlet&&c.outlet.activateWith(o,c.injector),this.activateChildRoutes(e,null,c.children)}}else this.activateChildRoutes(e,null,i)}}class yO{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class lS{constructor(e,t){this.component=e,this.route=t}}function B6(n,e,t){const i=n._root;return A0(i,e?e._root:null,t,[i.value])}function cS(n,e,t){const i=_O(e);return(null!=i?i:t).get(n)}function A0(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=Pg(e);return n.children.forEach(l=>{(function U6(n,e,t,i,r={canDeactivateChecks:[],canActivateChecks:[]}){const o=n.value,l=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(l&&o.routeConfig===l.routeConfig){const h=function z6(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Lf(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Lf(n.url,e.url)||!Yl(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!FD(n,e)||!Yl(n.queryParams,e.queryParams);default:return!FD(n,e)}}(l,o,o.routeConfig.runGuardsAndResolvers);h?r.canActivateChecks.push(new yO(i)):(o.data=l.data,o._resolvedData=l._resolvedData),A0(n,e,o.component?c?c.children:null:t,i,r),h&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new lS(c.outlet.component,l))}else l&&D0(e,c,r),r.canActivateChecks.push(new yO(i)),A0(n,null,o.component?c?c.children:null:t,i,r)})(l,o[l.value.outlet],t,i.concat([l.value]),r),delete o[l.value.outlet]}),As(o,(l,c)=>D0(l,t.getContext(c),r)),r}function D0(n,e,t){const i=Pg(n),r=n.value;As(i,(o,l)=>{D0(o,r.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new lS(r.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,r))}function R0(n){return"function"==typeof n}const uS=Symbol("INITIAL_VALUE");function Ng(){return Zl(n=>vD(n.map(e=>e.pipe(Na(1),Dg(uS)))).pipe(an(e=>{for(const t of e)if(!0!==t){if(t===uS)return uS;if(!1===t||t instanceof If)return t}return!0}),_s(e=>e!==uS),Na(1)))}function vO(n){return function Fx(...n){return H_(n)}(jr(e=>{if(Pf(e))throw cO(0,e)}),an(e=>!0===e))}const BD={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function xO(n,e,t,i,r){const o=VD(n,e,t);return o.matched?function rj(n,e,t,i){const r=e.canMatch;return r&&0!==r.length?Gt(r.map(l=>{const c=n.get(l),h=function $6(n){return n&&R0(n.canMatch)}(c)?c.canMatch(e,t):c(e,t);return zc(h)})).pipe(Ng(),vO()):Gt(!0)}(i=mO(e,i),e,t).pipe(an(l=>!0===l?o:Object.assign({},BD))):Gt(o)}function VD(n,e,t){var i;if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?Object.assign({},BD):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const o=(e.matcher||U8)(t,n,e);if(!o)return Object.assign({},BD);const l={};As(o.posParams,(h,p)=>{l[p]=h.path});const c=o.consumed.length>0?Object.assign(Object.assign({},l),o.consumed[o.consumed.length-1].parameters):l;return{matched:!0,consumedSegments:o.consumed,remainingSegments:t.slice(o.consumed.length),parameters:c,positionalParamSegments:null!==(i=o.posParams)&&void 0!==i?i:{}}}function dS(n,e,t,i,r="corrected"){if(t.length>0&&function aj(n,e,t){return t.some(i=>hS(n,e,i)&&Oa(i)!==Hn)}(n,t,i)){const l=new qn(e,function oj(n,e,t,i){const r={};r[Hn]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const o of t)if(""===o.path&&Oa(o)!==Hn){const l=new qn([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,r[Oa(o)]=l}return r}(n,e,i,new qn(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function lj(n,e,t){return t.some(i=>hS(n,e,i))}(n,t,i)){const l=new qn(n.segments,function sj(n,e,t,i,r,o){const l={};for(const c of i)if(hS(n,t,c)&&!r[Oa(c)]){const h=new qn([],{});h._sourceSegment=n,h._segmentIndexShift="legacy"===o?n.segments.length:e.length,l[Oa(c)]=h}return Object.assign(Object.assign({},r),l)}(n,e,t,i,n.children,r));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const o=new qn(n.segments,n.children);return o._sourceSegment=n,o._segmentIndexShift=e.length,{segmentGroup:o,slicedSegments:t}}function hS(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function bO(n,e,t,i){return!!(Oa(n)===i||i!==Hn&&hS(e,t,n))&&("**"===n.path||VD(e,n,t).matched)}function wO(n,e,t){return 0===e.length&&!n.children[t]}const fS=!1;class pS{constructor(e){this.segmentGroup=e||null}}class MO{constructor(e){this.urlTree=e}}function I0(n){return Tg(new pS(n))}function SO(n){return Tg(new MO(n))}class hj{constructor(e,t,i,r,o){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=r,this.config=o,this.allowRedirects=!0}apply(){const e=dS(this.urlTree.root,[],[],this.config).segmentGroup,t=new qn(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Hn).pipe(an(o=>this.createUrlTree(rS(o),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Uc(o=>{if(o instanceof MO)return this.allowRedirects=!1,this.match(o.urlTree);throw o instanceof pS?this.noMatchError(o):o}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Hn).pipe(an(r=>this.createUrlTree(rS(r),e.queryParams,e.fragment))).pipe(Uc(r=>{throw r instanceof pS?this.noMatchError(r):r}))}noMatchError(e){return new ke(4002,fS)}createUrlTree(e,t,i){const r=ED(e);return new If(r,t,i)}expandSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(an(o=>new qn([],o))):this.expandSegment(e,i,t,i.segments,r,!0)}expandChildren(e,t,i){const r=[];for(const o of Object.keys(i.children))"primary"===o?r.unshift(o):r.push(o);return sr(r).pipe(Td(o=>{const l=i.children[o],c=gO(t,o);return this.expandSegmentGroup(e,c,l,o).pipe(an(h=>({segment:h,outlet:o})))}),FN((o,l)=>(o[l.outlet]=l.segment,o),{}),NN())}expandSegment(e,t,i,r,o,l){return sr(i).pipe(Td(c=>this.expandSegmentAgainstRoute(e,t,i,c,r,o,l).pipe(Uc(p=>{if(p instanceof pS)return Gt(null);throw p}))),Cd(c=>!!c),Uc((c,h)=>{if(c instanceof Ag||"EmptyError"===c.name)return wO(t,r,o)?Gt(new qn([],{})):I0(t);throw c}))}expandSegmentAgainstRoute(e,t,i,r,o,l,c){return bO(r,t,o,l)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,t,r,o,l):c&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,l):I0(t):I0(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,r,o,l){return"**"===r.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,o,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,r){const o=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?SO(o):this.lineralizeSegments(i,o).pipe(Dr(l=>{const c=new qn(l,{});return this.expandSegment(e,c,t,l,r,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,r,o,l){const{matched:c,consumedSegments:h,remainingSegments:p,positionalParamSegments:g}=VD(t,r,o);if(!c)return I0(t);const y=this.applyRedirectCommands(h,r.redirectTo,g);return r.redirectTo.startsWith("/")?SO(y):this.lineralizeSegments(r,y).pipe(Dr(x=>this.expandSegment(e,t,i,x.concat(p),l,!1)))}matchSegmentAgainstRoute(e,t,i,r,o){return"**"===i.path?(e=mO(i,e),i.loadChildren?(i._loadedRoutes?Gt({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(an(c=>(i._loadedRoutes=c.routes,i._loadedInjector=c.injector,new qn(r,{})))):Gt(new qn(r,{}))):xO(t,i,r,e).pipe(Zl(({matched:l,consumedSegments:c,remainingSegments:h})=>{var p;return l?(e=null!==(p=i._injector)&&void 0!==p?p:e,this.getChildConfig(e,i,r).pipe(Dr(y=>{var x;const M=null!==(x=y.injector)&&void 0!==x?x:e,S=y.routes,{segmentGroup:C,slicedSegments:T}=dS(t,c,h,S),P=new qn(C.segments,C.children);if(0===T.length&&P.hasChildren())return this.expandChildren(M,S,P).pipe(an(z=>new qn(c,z)));if(0===S.length&&0===T.length)return Gt(new qn(c,{}));const O=Oa(i)===o;return this.expandSegment(M,P,S,T,O?Hn:o,!0).pipe(an(B=>new qn(c.concat(B.segments),B.children)))}))):I0(t)}))}getChildConfig(e,t,i){return t.children?Gt({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Gt({routes:t._loadedRoutes,injector:t._loadedInjector}):function ij(n,e,t,i){const r=e.canLoad;return void 0===r||0===r.length?Gt(!0):Gt(r.map(l=>{const c=n.get(l),h=function G6(n){return n&&R0(n.canLoad)}(c)?c.canLoad(e,t):c(e,t);return zc(h)})).pipe(Ng(),vO())}(e,t,i).pipe(Dr(r=>r?this.configLoader.loadChildren(e,t).pipe(jr(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):function uj(n){return Tg(uO(fS,3))}())):Gt({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],r=t.root;for(;;){if(i=i.concat(r.segments),0===r.numberOfChildren)return Gt(i);if(r.numberOfChildren>1||!r.children[Hn])return Tg(new ke(4e3,fS));r=r.children[Hn]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,r){const o=this.createSegmentGroup(e,t.root,i,r);return new If(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return As(e,(r,o)=>{if("string"==typeof r&&r.startsWith(":")){const c=r.substring(1);i[o]=t[c]}else i[o]=r}),i}createSegmentGroup(e,t,i,r){const o=this.createSegments(e,t.segments,i,r);let l={};return As(t.children,(c,h)=>{l[h]=this.createSegmentGroup(e,c,i,r)}),new qn(o,l)}createSegments(e,t,i,r){return t.map(o=>o.path.startsWith(":")?this.findPosParam(e,o,r):this.findOrReturn(o,i))}findPosParam(e,t,i){const r=i[t.path.substring(1)];if(!r)throw new ke(4001,fS);return r}findOrReturn(e,t){let i=0;for(const r of t){if(r.path===e.path)return t.splice(i),r;i++}return e}}class pj{}class _j{constructor(e,t,i,r,o,l,c,h){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=r,this.url=o,this.paramsInheritanceStrategy=l,this.relativeLinkResolution=c,this.urlSerializer=h}recognize(){const e=dS(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Hn).pipe(an(t=>{if(null===t)return null;const i=new oS([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Hn,this.rootComponentType,null,this.urlTree.root,-1,{}),r=new Gc(i,t),o=new aO(this.url,r);return this.inheritParamsAndData(o._root),o}))}inheritParamsAndData(e){const t=e.value,i=oO(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(r=>this.inheritParamsAndData(r))}processSegmentGroup(e,t,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,r)}processChildren(e,t,i){return sr(Object.keys(i.children)).pipe(Td(r=>{const o=i.children[r],l=gO(t,r);return this.processSegmentGroup(e,l,o,r)}),FN((r,o)=>r&&o?(r.push(...o),r):null),function B8(n,e=!1){return Zi((t,i)=>{let r=0;t.subscribe(ji(i,o=>{const l=n(o,r++);(l||e)&&i.next(o),!l&&i.complete()}))})}(r=>null!==r),JM(null),NN(),an(r=>{if(null===r)return null;const o=EO(r);return function yj(n){n.sort((e,t)=>e.value.outlet===Hn?-1:t.value.outlet===Hn?1:e.value.outlet.localeCompare(t.value.outlet))}(o),o}))}processSegment(e,t,i,r,o){return sr(t).pipe(Td(l=>{var c;return this.processSegmentAgainstRoute(null!==(c=l._injector)&&void 0!==c?c:e,l,i,r,o)}),Cd(l=>!!l),Uc(l=>{if(l instanceof Ag)return wO(i,r,o)?Gt([]):Gt(null);throw l}))}processSegmentAgainstRoute(e,t,i,r,o){var l,c;if(t.redirectTo||!bO(t,i,r,o))return Gt(null);let h;if("**"===t.path){const p=r.length>0?BN(r).parameters:{},g=TO(i)+r.length;h=Gt({snapshot:new oS(r,p,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DO(t),Oa(t),null!==(c=null!==(l=t.component)&&void 0!==l?l:t._loadedComponent)&&void 0!==c?c:null,t,CO(i),g,RO(t),g),consumedSegments:[],remainingSegments:[]})}else h=xO(i,t,r,e).pipe(an(({matched:p,consumedSegments:g,remainingSegments:y,parameters:x})=>{var M,S;if(!p)return null;const C=TO(i)+g.length;return{snapshot:new oS(g,x,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,DO(t),Oa(t),null!==(S=null!==(M=t.component)&&void 0!==M?M:t._loadedComponent)&&void 0!==S?S:null,t,CO(i),C,RO(t),C),consumedSegments:g,remainingSegments:y}}));return h.pipe(Zl(p=>{var g,y;if(null===p)return Gt(null);const{snapshot:x,consumedSegments:M,remainingSegments:S}=p;e=null!==(g=t._injector)&&void 0!==g?g:e;const C=null!==(y=t._loadedInjector)&&void 0!==y?y:e,T=function vj(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:P,slicedSegments:O}=dS(i,M,S,T.filter(B=>void 0===B.redirectTo),this.relativeLinkResolution);if(0===O.length&&P.hasChildren())return this.processChildren(C,T,P).pipe(an(B=>null===B?null:[new Gc(x,B)]));if(0===T.length&&0===O.length)return Gt([new Gc(x,[])]);const k=Oa(t)===o;return this.processSegment(C,T,P,O,k?Hn:o).pipe(an(B=>null===B?null:[new Gc(x,B)]))}))}}function xj(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function EO(n){const e=[],t=new Set;for(const i of n){if(!xj(i)){e.push(i);continue}const r=e.find(o=>i.value.routeConfig===o.value.routeConfig);void 0!==r?(r.children.push(...i.children),t.add(r)):e.push(i)}for(const i of t){const r=EO(i.children);e.push(new Gc(i.value,r))}return e.filter(i=>!t.has(i))}function CO(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function TO(n){var e,t;let i=n,r=null!==(e=i._segmentIndexShift)&&void 0!==e?e:0;for(;i._sourceSegment;)i=i._sourceSegment,r+=null!==(t=i._segmentIndexShift)&&void 0!==t?t:0;return r-1}function DO(n){return n.data||{}}function RO(n){return n.resolve||{}}const UD=Symbol("RouteTitle");function IO(n){return"string"==typeof n.title||null===n.title}function zD(n){return Zl(e=>{const t=n(e);return t?sr(t).pipe(an(()=>e)):Gt(e)})}class Rj extends class Dj{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const HD=new at("ROUTES");let GD=(()=>{class n{constructor(t,i){this.injector=t,this.compiler=i,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Gt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=zc(t.loadComponent()).pipe(jr(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),KM(()=>{this.componentLoaders.delete(t)})),r=new LN(i,()=>new ri).pipe(xD());return this.componentLoaders.set(t,r),r}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Gt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const o=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(an(c=>{this.onLoadEndListener&&this.onLoadEndListener(i);let h,p,g=!1;Array.isArray(c)?p=c:(h=c.create(t).injector,p=kN(h.get(HD,[],Yt.Self|Yt.Optional)));return{routes:p.map(kD),injector:h}}),KM(()=>{this.childrenLoaders.delete(i)})),l=new LN(o,()=>new ri).pipe(xD());return this.childrenLoaders.set(i,l),l}loadModuleFactoryOrRoutes(t){return zc(t()).pipe(Dr(i=>i instanceof wF||Array.isArray(i)?Gt(i):sr(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)(Be(Ii),Be(BA))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();class Lj{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function Pj(n){throw n}function Fj(n,e,t){return e.parse("/")}const Nj={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Oj={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ws=(()=>{class n{constructor(t,i,r,o,l,c,h){this.rootComponentType=t,this.urlSerializer=i,this.rootContexts=r,this.location=o,this.config=h,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new ri,this.errorHandler=Pj,this.malformedUriErrorHandler=Fj,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>Gt(void 0),this.urlHandlingStrategy=new Lj,this.routeReuseStrategy=new Rj,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=l.get(GD),this.configLoader.onLoadEndListener=x=>this.triggerEvent(new v6(x)),this.configLoader.onLoadStartListener=x=>this.triggerEvent(new y6(x)),this.ngModule=l.get(Af),this.console=l.get(FG);const y=l.get(zn);this.isNgZoneEnabled=y instanceof zn&&zn.isInAngularZone(),this.resetConfig(h),this.currentUrlTree=function H8(){return new If(new qn([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=sO(this.currentUrlTree,this.rootComponentType),this.transitions=new la({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var t;return null===(t=this.location.getState())||void 0===t?void 0:t.\u0275routerPageId}setupNavigations(t){const i=this.events;return t.pipe(_s(r=>0!==r.id),an(r=>Object.assign(Object.assign({},r),{extractedUrl:this.urlHandlingStrategy.extract(r.rawUrl)})),Zl(r=>{let o=!1,l=!1;return Gt(r).pipe(jr(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Zl(c=>{const h=this.browserUrlTree.toString(),p=!this.navigated||c.extractedUrl.toString()!==h||h!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||p)&&this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return PO(c.source)&&(this.browserUrlTree=c.extractedUrl),Gt(c).pipe(Zl(y=>{const x=this.transitions.getValue();return i.next(new DD(y.id,this.serializeUrl(y.extractedUrl),y.source,y.restoredState)),x!==this.transitions.getValue()?ya:Promise.resolve(y)}),function fj(n,e,t,i){return Zl(r=>function dj(n,e,t,i,r){return new hj(n,e,t,i,r).apply()}(n,e,t,r.extractedUrl,i).pipe(an(o=>Object.assign(Object.assign({},r),{urlAfterRedirects:o}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),jr(y=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:y.urlAfterRedirects}),r.urlAfterRedirects=y.urlAfterRedirects}),function wj(n,e,t,i,r,o){return Dr(l=>function gj(n,e,t,i,r,o,l="emptyOnly",c="legacy"){return new _j(n,e,t,i,r,l,c,o).recognize().pipe(Zl(h=>null===h?function mj(n){return new Ci(e=>e.error(n))}(new pj):Gt(h)))}(n,e,t,l.urlAfterRedirects,i.serialize(l.urlAfterRedirects),i,r,o).pipe(an(c=>Object.assign(Object.assign({},l),{targetSnapshot:c}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),jr(y=>{if(r.targetSnapshot=y.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!y.extras.skipLocationChange){const M=this.urlHandlingStrategy.merge(y.urlAfterRedirects,y.rawUrl);this.setBrowserUrl(M,y)}this.browserUrlTree=y.urlAfterRedirects}const x=new f6(y.id,this.serializeUrl(y.extractedUrl),this.serializeUrl(y.urlAfterRedirects),y.targetSnapshot);i.next(x)}));if(p&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:x,extractedUrl:M,source:S,restoredState:C,extras:T}=c,P=new DD(x,this.serializeUrl(M),S,C);i.next(P);const O=sO(M,this.rootComponentType).snapshot;return Gt(r=Object.assign(Object.assign({},c),{targetSnapshot:O,urlAfterRedirects:M,extras:Object.assign(Object.assign({},T),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=c.rawUrl,c.resolve(null),ya}),jr(c=>{const h=new p6(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot);this.triggerEvent(h)}),an(c=>r=Object.assign(Object.assign({},c),{guards:B6(c.targetSnapshot,c.currentSnapshot,this.rootContexts)})),function Z6(n,e){return Dr(t=>{const{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:l}}=t;return 0===l.length&&0===o.length?Gt(Object.assign(Object.assign({},t),{guardsResult:!0})):function Y6(n,e,t,i){return sr(n).pipe(Dr(r=>function nj(n,e,t,i,r){const o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return o&&0!==o.length?Gt(o.map(c=>{const h=cS(c,e,r);return zc(function q6(n){return n&&R0(n.canDeactivate)}(h)?h.canDeactivate(n,e,t,i):h(n,e,t,i)).pipe(Cd())})).pipe(Ng()):Gt(!0)}(r.component,r.route,t,e,i)),Cd(r=>!0!==r,!0))}(l,i,r,n).pipe(Dr(c=>c&&function H6(n){return"boolean"==typeof n}(c)?function J6(n,e,t,i){return sr(e).pipe(Td(r=>YM(function Q6(n,e){return null!==n&&e&&e(new x6(n)),Gt(!0)}(r.route.parent,i),function K6(n,e){return null!==n&&e&&e(new w6(n)),Gt(!0)}(r.route,i),function tj(n,e,t){const i=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(l=>function V6(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>IN(()=>Gt(l.guards.map(h=>{const p=cS(h,l.node,t);return zc(function j6(n){return n&&R0(n.canActivateChild)}(p)?p.canActivateChild(i,n):p(i,n)).pipe(Cd())})).pipe(Ng())));return Gt(o).pipe(Ng())}(n,r.path,t),function ej(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Gt(!0);const r=i.map(o=>IN(()=>{const l=cS(o,e,t);return zc(function W6(n){return n&&R0(n.canActivate)}(l)?l.canActivate(e,n):l(e,n)).pipe(Cd())}));return Gt(r).pipe(Ng())}(n,r.route,t))),Cd(r=>!0!==r,!0))}(i,o,n,e):Gt(c)),an(c=>Object.assign(Object.assign({},t),{guardsResult:c})))})}(this.ngModule.injector,c=>this.triggerEvent(c)),jr(c=>{if(r.guardsResult=c.guardsResult,Pf(c.guardsResult))throw cO(0,c.guardsResult);const h=new m6(c.id,this.serializeUrl(c.extractedUrl),this.serializeUrl(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.triggerEvent(h)}),_s(c=>!!c.guardsResult||(this.restoreHistory(c),this.cancelNavigationTransition(c,"",3),!1)),zD(c=>{if(c.guards.canActivateChecks.length)return Gt(c).pipe(jr(h=>{const p=new g6(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);this.triggerEvent(p)}),Zl(h=>{let p=!1;return Gt(h).pipe(function Mj(n,e){return Dr(t=>{const{targetSnapshot:i,guards:{canActivateChecks:r}}=t;if(!r.length)return Gt(t);let o=0;return sr(r).pipe(Td(l=>function Sj(n,e,t,i){const r=n.routeConfig,o=n._resolve;return void 0!==(null==r?void 0:r.title)&&!IO(r)&&(o[UD]=r.title),function Ej(n,e,t,i){const r=function Cj(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===r.length)return Gt({});const o={};return sr(r).pipe(Dr(l=>function Tj(n,e,t,i){const r=cS(n,e,i);return zc(r.resolve?r.resolve(e,t):r(e,t))}(n[l],e,t,i).pipe(Cd(),jr(c=>{o[l]=c}))),bD(1),wD(o),Uc(l=>l instanceof Ag?ya:Tg(l)))}(o,n,e,i).pipe(an(l=>(n._resolvedData=l,n.data=oO(n,t).resolve,r&&IO(r)&&(n.data[UD]=r.title),null)))}(l.route,i,n,e)),jr(()=>o++),bD(1),Dr(l=>o===r.length?Gt(t):ya))})}(this.paramsInheritanceStrategy,this.ngModule.injector),jr({next:()=>p=!0,complete:()=>{p||(this.restoreHistory(h),this.cancelNavigationTransition(h,"",2))}}))}),jr(h=>{const p=new _6(h.id,this.serializeUrl(h.extractedUrl),this.serializeUrl(h.urlAfterRedirects),h.targetSnapshot);this.triggerEvent(p)}))}),zD(c=>{const h=p=>{var g;const y=[];(null===(g=p.routeConfig)||void 0===g?void 0:g.loadComponent)&&!p.routeConfig._loadedComponent&&y.push(this.configLoader.loadComponent(p.routeConfig).pipe(jr(x=>{p.component=x}),an(()=>{})));for(const x of p.children)y.push(...h(x));return y};return vD(h(c.targetSnapshot.root)).pipe(JM(),Na(1))}),zD(()=>this.afterPreactivation()),an(c=>{const h=function T6(n,e,t){const i=C0(n,e._root,t?t._root:void 0);return new rO(i,e)}(this.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return r=Object.assign(Object.assign({},c),{targetRouterState:h})}),jr(c=>{this.currentUrlTree=c.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(c.urlAfterRedirects,c.rawUrl),this.routerState=c.targetRouterState,"deferred"===this.urlUpdateStrategy&&(c.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,c),this.browserUrlTree=c.urlAfterRedirects)}),((n,e,t)=>an(i=>(new k6(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,this.routeReuseStrategy,c=>this.triggerEvent(c)),jr({next(){o=!0},complete(){o=!0}}),KM(()=>{var c;o||l||this.cancelNavigationTransition(r,"",1),(null===(c=this.currentNavigation)||void 0===c?void 0:c.id)===r.id&&(this.currentNavigation=null)}),Uc(c=>{var h;if(l=!0,hO(c)){dO(c)||(this.navigated=!0,this.restoreHistory(r,!0));const p=new sS(r.id,this.serializeUrl(r.extractedUrl),c.message,c.cancellationCode);if(i.next(p),dO(c)){const g=this.urlHandlingStrategy.merge(c.url,this.rawUrlTree),y={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||PO(r.source)};this.scheduleNavigation(g,"imperative",null,y,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{this.restoreHistory(r,!0);const p=new tO(r.id,this.serializeUrl(r.extractedUrl),c,null!==(h=r.targetSnapshot)&&void 0!==h?h:void 0);i.next(p);try{r.resolve(this.errorHandler(c))}catch(g){r.reject(g)}}return ya}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),t))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{var r;const o={replaceUrl:!0},l=null!==(r=t.state)&&void 0!==r&&r.navigationId?t.state:null;if(l){const h=Object.assign({},l);delete h.navigationId,delete h.\u0275routerPageId,0!==Object.keys(h).length&&(o.state=h)}const c=this.parseUrl(t.url);this.scheduleNavigation(c,i,l,o)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(kD),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:r,queryParams:o,fragment:l,queryParamsHandling:c,preserveFragment:h}=i,p=r||this.routerState.root,g=h?this.currentUrlTree.fragment:l;let y=null;switch(c){case"merge":y=Object.assign(Object.assign({},this.currentUrlTree.queryParams),o);break;case"preserve":y=this.currentUrlTree.queryParams;break;default:y=o||null}return null!==y&&(y=this.removeEmptyProps(y)),a6(p,this.currentUrlTree,t,y,null!=g?g:null)}navigateByUrl(t,i={skipLocationChange:!1}){const r=Pf(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,"imperative",null,i)}navigate(t,i={skipLocationChange:!1}){return function kj(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new ke(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(r){i=this.malformedUriErrorHandler(r,this.urlSerializer,t)}return i}isActive(t,i){let r;if(r=!0===i?Object.assign({},Nj):!1===i?Object.assign({},Oj):i,Pf(t))return UN(this.currentUrlTree,t,r);const o=this.parseUrl(t);return UN(this.currentUrlTree,o,r)}removeEmptyProps(t){return Object.keys(t).reduce((i,r)=>{const o=t[r];return null!=o&&(i[r]=o),i},{})}processNavigations(){this.navigations.subscribe(t=>{var i;this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new Ff(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,null===(i=this.titleStrategy)||void 0===i||i.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,i,r,o,l){var c,h;if(this.disposed)return Promise.resolve(!1);let p,g,y;l?(p=l.resolve,g=l.reject,y=l.promise):y=new Promise((S,C)=>{p=S,g=C});const x=++this.navigationId;let M;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(r=this.location.getState()),M=r&&r.\u0275routerPageId?r.\u0275routerPageId:o.replaceUrl||o.skipLocationChange?null!==(c=this.browserPageId)&&void 0!==c?c:0:(null!==(h=this.browserPageId)&&void 0!==h?h:0)+1):M=0,this.setTransition({id:x,targetPageId:M,source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:o,resolve:p,reject:g,promise:y,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),y.catch(S=>Promise.reject(S))}setBrowserUrl(t,i){const r=this.urlSerializer.serialize(t),o=Object.assign(Object.assign({},i.extras.state),this.generateNgRouterState(i.id,i.targetPageId));this.location.isCurrentPathEqualTo(r)||i.extras.replaceUrl?this.location.replaceState(r,"",o):this.location.go(r,"",o)}restoreHistory(t,i=!1){var r,o;if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(r=this.currentNavigation)||void 0===r?void 0:r.finalUrl)||0===l?this.currentUrlTree===(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)&&0===l&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(l)}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,i,r){const o=new sS(t.id,this.serializeUrl(t.extractedUrl),i,r);this.triggerEvent(o),t.resolve(!1)}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){Hm()},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();function PO(n){return"imperative"!==n}let FO=(()=>{class n{buildTitle(t){var i;let r,o=t.root;for(;void 0!==o;)r=null!==(i=this.getResolvedTitleForRoute(o))&&void 0!==i?i:r,o=o.children.find(l=>l.outlet===Hn);return r}getResolvedTitleForRoute(t){return t.data[UD]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:function(){return Eo(Uj)},providedIn:"root"}),n})(),Uj=(()=>{class n extends FO{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(Be(SN))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class NO{}let OO=(()=>{class n{constructor(t,i,r,o,l){this.router=t,this.injector=r,this.preloadingStrategy=o,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(_s(t=>t instanceof Ff),Td(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){var r,o,l;const c=[];for(const h of i){h.providers&&!h._injector&&(h._injector=wM(h.providers,t,`Route: ${h.path}`));const p=null!==(r=h._injector)&&void 0!==r?r:t,g=null!==(o=h._loadedInjector)&&void 0!==o?o:p;h.loadChildren&&!h._loadedRoutes||h.loadComponent&&!h._loadedComponent?c.push(this.preloadConfig(p,h)):(h.children||h._loadedRoutes)&&c.push(this.processRoutes(g,null!==(l=h.children)&&void 0!==l?l:h._loadedRoutes))}return sr(c).pipe(ac())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let r;r=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Gt(null);const o=r.pipe(Dr(l=>{var c;return null===l?Gt(void 0):(i._loadedRoutes=l.routes,i._loadedInjector=l.injector,this.processRoutes(null!==(c=l.injector)&&void 0!==c?c:t,l.routes))}));return i.loadComponent&&!i._loadedComponent?sr([o,this.loader.loadComponent(i)]).pipe(ac()):o})}}return n.\u0275fac=function(t){return new(t||n)(Be(Ws),Be(BA),Be(Pl),Be(NO),Be(GD))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const kO=new at("");let zj=(()=>{class n{constructor(t,i,r={}){this.router=t,this.viewportScroller=i,this.options=r,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},r.scrollPositionRestoration=r.scrollPositionRestoration||"disabled",r.anchorScrolling=r.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof DD?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Ff&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof nO&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.router.triggerEvent(new nO(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){Hm()},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const qD=new at("ROUTER_CONFIGURATION",{providedIn:"root",factory:()=>({})}),BO=new at("ROUTER_FORROOT_GUARD"),VO=new at(""),Hj=[JA,{provide:WN,useClass:jN},{provide:Ws,useFactory:function Xj(n,e,t,i,r,o,l,c={},h,p){const g=new Ws(null,n,e,t,i,r,kN(o));return h&&(g.urlHandlingStrategy=h),p&&(g.routeReuseStrategy=p),g.titleStrategy=l,function Zj(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(c,g),g},deps:[WN,T0,JA,Ii,BA,HD,FO,qD,[class Ij{},new Sa],[class Aj{},new Sa]]},T0,{provide:Fg,useFactory:function Yj(n){return n.routerState.root},deps:[Ws]},GD];function Gj(){return new _2("Router",Ws)}let UO=(()=>{class n{constructor(t,i){}static forRoot(t,i){return{ngModule:n,providers:[Hj,[],zO(t),{provide:BO,useFactory:$j,deps:[[Ws,new Sa,new Gu]]},{provide:qD,useValue:i||{}},null!=i&&i.useHash?{provide:Rf,useClass:S5}:{provide:Rf,useClass:z2},{provide:kO,useFactory:()=>{const n=Eo(Ws),e=Eo(WW),t=Eo(qD);return t.scrollOffset&&e.setOffset(t.scrollOffset),new zj(n,e,t)}},null!=i&&i.preloadingStrategy?i9(i.preloadingStrategy):[],{provide:_2,multi:!0,useFactory:Gj},null!=i&&i.initialNavigation?Kj(i):[],[{provide:HO,useFactory:Jj},{provide:u2,multi:!0,useExisting:HO}]]}}static forChild(t){return{ngModule:n,providers:[zO(t)]}}}return n.\u0275fac=function(t){return new(t||n)(Be(BO,8),Be(Ws,8))},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})();function $j(n){return"guarded"}function zO(n){return[{provide:yT,multi:!0,useValue:n},{provide:HD,multi:!0,useValue:n}]}function Jj(){const n=Eo(Ii);return e=>{var t,i;const r=n.get(p0);if(e!==r.components[0])return;const o=n.get(Ws),l=n.get(GO);null===n.get($D,null,Yt.Optional)&&o.initialNavigation(),null===(t=n.get(VO,null,Yt.Optional))||void 0===t||t.setUpPreloading(),null===(i=n.get(kO,null,Yt.Optional))||void 0===i||i.init(),o.resetRootComponentType(r.componentTypes[0]),l.next(),l.complete()}}const HO=new at("");function Kj(n){return["disabled"===n.initialNavigation?[{provide:CM,multi:!0,useFactory:()=>{const n=Eo(Ws);return()=>{n.setUpLocationChangeListener()}}},{provide:$D,useValue:"disabled"}]:[],"enabledBlocking"===n.initialNavigation?[{provide:$D,useValue:"enabledBlocking"},{provide:CM,multi:!0,deps:[Ii],useFactory:n=>{const e=n.get(b5,Promise.resolve(null));let t=!1;return()=>e.then(()=>new Promise(r=>{const o=n.get(Ws),l=n.get(GO);(function i(r){n.get(Ws).events.pipe(_s(l=>l instanceof Ff||l instanceof sS||l instanceof tO),an(l=>l instanceof Ff||l instanceof sS&&(0===l.code||1===l.code)&&null),_s(l=>null!==l),Na(1)).subscribe(()=>{r()})})(()=>{r(!0),t=!0}),o.afterPreactivation=()=>(r(!0),t||l.closed?Gt(void 0):l),o.initialNavigation()}))}}]:[]]}const GO=new at("",{factory:()=>new ri}),$D=new at("");function i9(n){return[OO,{provide:VO,useExisting:OO},{provide:NO,useExisting:n}]}const r9=[];let s9=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[UO.forRoot(r9),UO]}),n})();var o9=xs(861);const Bo=1001,is=1003,qr=1006,kf=1009,Bf=1014,Dd=1015,F0=1016,zg=1020,dl=1023,Vf=1026,Hg=1027,Uf=3e3,Er=3001,qc="srgb",zf="srgb-linear";class qg{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;const r=this._listeners[e];if(void 0!==r){const o=r.indexOf(t);-1!==o&&r.splice(o,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const i=this._listeners[e.type];if(void 0!==i){e.target=this;const r=i.slice(0);for(let o=0,l=r.length;o<l;o++)r[o].call(this,e);e.target=null}}}const js=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Hf=Math.PI/180,N0=180/Math.PI;function ca(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(js[255&n]+js[n>>8&255]+js[n>>16&255]+js[n>>24&255]+"-"+js[255&e]+js[e>>8&255]+"-"+js[e>>16&15|64]+js[e>>24&255]+"-"+js[63&t|128]+js[t>>8&255]+"-"+js[t>>16&255]+js[t>>24&255]+js[255&i]+js[i>>8&255]+js[i>>16&255]+js[i>>24&255]).toLowerCase()}function Pr(n,e,t){return Math.max(e,Math.min(t,n))}function O0(n,e,t){return(1-t)*n+t*e}function cR(n){return 0==(n&n-1)&&0!==n}function ES(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}class Xe{constructor(e=0,t=0){Xe.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),o=this.x-e.x,l=this.y-e.y;return this.x=o*i-l*r+e.x,this.y=o*r+l*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ua{constructor(){ua.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,o,l,c,h,p){const g=this.elements;return g[0]=e,g[1]=r,g[2]=c,g[3]=t,g[4]=o,g[5]=h,g[6]=i,g[7]=l,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,l=i[0],c=i[3],h=i[6],p=i[1],g=i[4],y=i[7],x=i[2],M=i[5],S=i[8],C=r[0],T=r[3],P=r[6],O=r[1],k=r[4],B=r[7],z=r[2],q=r[5],ne=r[8];return o[0]=l*C+c*O+h*z,o[3]=l*T+c*k+h*q,o[6]=l*P+c*B+h*ne,o[1]=p*C+g*O+y*z,o[4]=p*T+g*k+y*q,o[7]=p*P+g*B+y*ne,o[2]=x*C+M*O+S*z,o[5]=x*T+M*k+S*q,o[8]=x*P+M*B+S*ne,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],c=e[5],h=e[6],p=e[7],g=e[8];return t*l*g-t*c*p-i*o*g+i*c*h+r*o*p-r*l*h}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],c=e[5],h=e[6],p=e[7],g=e[8],y=g*l-c*p,x=c*h-g*o,M=p*o-l*h,S=t*y+i*x+r*M;if(0===S)return this.set(0,0,0,0,0,0,0,0,0);const C=1/S;return e[0]=y*C,e[1]=(r*p-g*i)*C,e[2]=(c*i-r*l)*C,e[3]=x*C,e[4]=(g*t-r*h)*C,e[5]=(r*o-c*t)*C,e[6]=M*C,e[7]=(i*h-p*t)*C,e[8]=(l*t-i*o)*C,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,o,l,c){const h=Math.cos(o),p=Math.sin(o);return this.set(i*h,i*p,-i*(h*l+p*c)+l+e,-r*p,r*h,-r*(-p*l+h*c)+c+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,o=r[0],l=r[3],c=r[6],h=r[1],p=r[4],g=r[7];return r[0]=t*o+i*h,r[3]=t*l+i*p,r[6]=t*c+i*g,r[1]=-i*o+t*h,r[4]=-i*l+t*p,r[7]=-i*c+t*g,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}function T3(n){for(let e=n.length-1;e>=0;--e)if(n[e]>65535)return!0;return!1}function k0(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Gf(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function CS(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const uR={[qc]:{[zf]:Gf},[zf]:{[qc]:CS}},hl={legacyMode:!0,get workingColorSpace(){return zf},set workingColorSpace(n){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(n,e,t){if(this.legacyMode||e===t||!e||!t)return n;if(uR[e]&&void 0!==uR[e][t]){const i=uR[e][t];return n.r=i(n.r),n.g=i(n.g),n.b=i(n.b),n}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(n,e){return this.convert(n,this.workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this.workingColorSpace)}},A3={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},rs={r:0,g:0,b:0},fl={h:0,s:0,l:0},TS={h:0,s:0,l:0};function dR(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function AS(n,e){return e.r=n.r,e.g=n.g,e.b=n.b,e}let Xg,Ft=(()=>{class n{constructor(t,i,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,void 0===i&&void 0===r?this.set(t):this.setRGB(t,i,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=qc){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,hl.toWorkingColorSpace(this,i),this}setRGB(t,i,r,o=zf){return this.r=t,this.g=i,this.b=r,hl.toWorkingColorSpace(this,o),this}setHSL(t,i,r,o=zf){if(t=function lR(n,e){return(n%e+e)%e}(t,1),i=Pr(i,0,1),r=Pr(r,0,1),0===i)this.r=this.g=this.b=r;else{const l=r<=.5?r*(1+i):r+i-r*i,c=2*r-l;this.r=dR(c,l,t+1/3),this.g=dR(c,l,t),this.b=dR(c,l,t-1/3)}return hl.toWorkingColorSpace(this,o),this}setStyle(t,i=qc){function r(l){void 0!==l&&parseFloat(l)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let l;const h=o[2];switch(o[1]){case"rgb":case"rgba":if(l=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(l[1],10))/255,this.g=Math.min(255,parseInt(l[2],10))/255,this.b=Math.min(255,parseInt(l[3],10))/255,hl.toWorkingColorSpace(this,i),r(l[4]),this;if(l=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(l[1],10))/100,this.g=Math.min(100,parseInt(l[2],10))/100,this.b=Math.min(100,parseInt(l[3],10))/100,hl.toWorkingColorSpace(this,i),r(l[4]),this;break;case"hsl":case"hsla":if(l=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){const p=parseFloat(l[1])/360,g=parseInt(l[2],10)/100,y=parseInt(l[3],10)/100;return r(l[4]),this.setHSL(p,g,y,i)}}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(t)){const l=o[1],c=l.length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,hl.toWorkingColorSpace(this,i),this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,hl.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=qc){const r=A3[t.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Gf(t.r),this.g=Gf(t.g),this.b=Gf(t.b),this}copyLinearToSRGB(t){return this.r=CS(t.r),this.g=CS(t.g),this.b=CS(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=qc){return hl.fromWorkingColorSpace(AS(this,rs),t),Pr(255*rs.r,0,255)<<16^Pr(255*rs.g,0,255)<<8^Pr(255*rs.b,0,255)<<0}getHexString(t=qc){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=zf){hl.fromWorkingColorSpace(AS(this,rs),i);const r=rs.r,o=rs.g,l=rs.b,c=Math.max(r,o,l),h=Math.min(r,o,l);let p,g;const y=(h+c)/2;if(h===c)p=0,g=0;else{const x=c-h;switch(g=y<=.5?x/(c+h):x/(2-c-h),c){case r:p=(o-l)/x+(o<l?6:0);break;case o:p=(l-r)/x+2;break;case l:p=(r-o)/x+4}p/=6}return t.h=p,t.s=g,t.l=y,t}getRGB(t,i=zf){return hl.fromWorkingColorSpace(AS(this,rs),i),t.r=rs.r,t.g=rs.g,t.b=rs.b,t}getStyle(t=qc){return hl.fromWorkingColorSpace(AS(this,rs),t),t!==qc?`color(${t} ${rs.r} ${rs.g} ${rs.b})`:`rgb(${255*rs.r|0},${255*rs.g|0},${255*rs.b|0})`}offsetHSL(t,i,r){return this.getHSL(fl),fl.h+=t,fl.s+=i,fl.l+=r,this.setHSL(fl.h,fl.s,fl.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,r){return this.r=t.r+(i.r-t.r)*r,this.g=t.g+(i.g-t.g)*r,this.b=t.b+(i.b-t.b)*r,this}lerpHSL(t,i){this.getHSL(fl),t.getHSL(TS);const r=O0(fl.h,TS.h,i),o=O0(fl.s,TS.s,i),l=O0(fl.l,TS.l,i);return this.setHSL(r,o,l),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}return n.NAMES=A3,n})();class D3{static getDataURL(e){if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Xg&&(Xg=k0("canvas")),Xg.width=e.width,Xg.height=e.height;const i=Xg.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Xg}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){const t=k0("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),o=r.data;for(let l=0;l<o.length;l++)o[l]=255*Gf(o[l]/255);return i.putImageData(r,0,0),t}if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t[i]=t instanceof Uint8Array||t instanceof Uint8ClampedArray?Math.floor(255*Gf(t[i]/255)):Gf(t[i]);return{data:t,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class Zg{constructor(e=null){this.isSource=!0,this.uuid=ca(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){const t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let o;if(Array.isArray(r)){o=[];for(let l=0,c=r.length;l<c;l++)o.push(hR(r[l].isDataTexture?r[l].image:r[l]))}else o=hR(r);i.url=o}return t||(e.images[this.uuid]=i),i}}function hR(n){return"undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap?D3.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let b7=0,Rd=(()=>{class n extends qg{constructor(t=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=Bo,o=Bo,l=qr,c=1008,h=dl,p=kf,g=1,y=Uf){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:b7++}),this.uuid=ca(),this.name="",this.source=new Zg(t),this.mipmaps=[],this.mapping=i,this.wrapS=r,this.wrapT=o,this.magFilter=l,this.minFilter=c,this.anisotropy=g,this.format=h,this.internalFormat=null,this.type=p,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ua,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=y,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=void 0===t||"string"==typeof t;if(!i&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const r={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),i||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(300!==this.mapping)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case 1e3:t.x=t.x-Math.floor(t.x);break;case Bo:t.x=t.x<0?0:1;break;case 1002:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case 1e3:t.y=t.y-Math.floor(t.y);break;case Bo:t.y=t.y<0?0:1;break;case 1002:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){!0===t&&(this.version++,this.source.needsUpdate=!0)}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=300,n})();class Bi{constructor(e=0,t=0,i=0,r=1){Bi.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=this.w,l=e.elements;return this.x=l[0]*t+l[4]*i+l[8]*r+l[12]*o,this.y=l[1]*t+l[5]*i+l[9]*r+l[13]*o,this.z=l[2]*t+l[6]*i+l[10]*r+l[14]*o,this.w=l[3]*t+l[7]*i+l[11]*r+l[15]*o,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,o;const h=e.elements,p=h[0],g=h[4],y=h[8],x=h[1],M=h[5],S=h[9],C=h[2],T=h[6],P=h[10];if(Math.abs(g-x)<.01&&Math.abs(y-C)<.01&&Math.abs(S-T)<.01){if(Math.abs(g+x)<.1&&Math.abs(y+C)<.1&&Math.abs(S+T)<.1&&Math.abs(p+M+P-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(p+1)/2,B=(M+1)/2,z=(P+1)/2,q=(g+x)/4,ne=(y+C)/4,U=(S+T)/4;return k>B&&k>z?k<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(k),r=q/i,o=ne/i):B>z?B<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(B),i=q/r,o=U/r):z<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(z),i=ne/o,r=U/o),this.set(i,r,o,t),this}let O=Math.sqrt((T-S)*(T-S)+(y-C)*(y-C)+(x-g)*(x-g));return Math.abs(O)<.001&&(O=1),this.x=(T-S)/O,this.y=(y-C)/O,this.z=(x-g)/O,this.w=Math.acos((p+M+P-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Wf extends qg{constructor(e,t,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Bi(0,0,e,t),this.scissorTest=!1,this.viewport=new Bi(0,0,e,t),this.texture=new Rd({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:qr,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return(new this.constructor).copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Zg(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class fR extends Rd{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=is,this.minFilter=is,this.wrapR=Bo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class R3 extends Rd{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=is,this.minFilter=is,this.wrapR=Bo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class da{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,o,l,c){let h=i[r+0],p=i[r+1],g=i[r+2],y=i[r+3];const x=o[l+0],M=o[l+1],S=o[l+2],C=o[l+3];if(0===c)return e[t+0]=h,e[t+1]=p,e[t+2]=g,void(e[t+3]=y);if(1===c)return e[t+0]=x,e[t+1]=M,e[t+2]=S,void(e[t+3]=C);if(y!==C||h!==x||p!==M||g!==S){let T=1-c;const P=h*x+p*M+g*S+y*C,O=P>=0?1:-1,k=1-P*P;if(k>Number.EPSILON){const z=Math.sqrt(k),q=Math.atan2(z,P*O);T=Math.sin(T*q)/z,c=Math.sin(c*q)/z}const B=c*O;if(h=h*T+x*B,p=p*T+M*B,g=g*T+S*B,y=y*T+C*B,T===1-c){const z=1/Math.sqrt(h*h+p*p+g*g+y*y);h*=z,p*=z,g*=z,y*=z}}e[t]=h,e[t+1]=p,e[t+2]=g,e[t+3]=y}static multiplyQuaternionsFlat(e,t,i,r,o,l){const c=i[r],h=i[r+1],p=i[r+2],g=i[r+3],y=o[l],x=o[l+1],M=o[l+2],S=o[l+3];return e[t]=c*S+g*y+h*M-p*x,e[t+1]=h*S+g*x+p*y-c*M,e[t+2]=p*S+g*M+c*x-h*y,e[t+3]=g*S-c*y-h*x-p*M,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,o=e._z,l=e._order,c=Math.cos,h=Math.sin,p=c(i/2),g=c(r/2),y=c(o/2),x=h(i/2),M=h(r/2),S=h(o/2);switch(l){case"XYZ":this._x=x*g*y+p*M*S,this._y=p*M*y-x*g*S,this._z=p*g*S+x*M*y,this._w=p*g*y-x*M*S;break;case"YXZ":this._x=x*g*y+p*M*S,this._y=p*M*y-x*g*S,this._z=p*g*S-x*M*y,this._w=p*g*y+x*M*S;break;case"ZXY":this._x=x*g*y-p*M*S,this._y=p*M*y+x*g*S,this._z=p*g*S+x*M*y,this._w=p*g*y-x*M*S;break;case"ZYX":this._x=x*g*y-p*M*S,this._y=p*M*y+x*g*S,this._z=p*g*S-x*M*y,this._w=p*g*y+x*M*S;break;case"YZX":this._x=x*g*y+p*M*S,this._y=p*M*y+x*g*S,this._z=p*g*S-x*M*y,this._w=p*g*y-x*M*S;break;case"XZY":this._x=x*g*y-p*M*S,this._y=p*M*y-x*g*S,this._z=p*g*S+x*M*y,this._w=p*g*y+x*M*S;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],o=t[8],l=t[1],c=t[5],h=t[9],p=t[2],g=t[6],y=t[10],x=i+c+y;if(x>0){const M=.5/Math.sqrt(x+1);this._w=.25/M,this._x=(g-h)*M,this._y=(o-p)*M,this._z=(l-r)*M}else if(i>c&&i>y){const M=2*Math.sqrt(1+i-c-y);this._w=(g-h)/M,this._x=.25*M,this._y=(r+l)/M,this._z=(o+p)/M}else if(c>y){const M=2*Math.sqrt(1+c-i-y);this._w=(o-p)/M,this._x=(r+l)/M,this._y=.25*M,this._z=(h+g)/M}else{const M=2*Math.sqrt(1+y-i-c);this._w=(l-r)/M,this._x=(o+p)/M,this._y=(h+g)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Pr(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(0===i)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,o=e._z,l=e._w,c=t._x,h=t._y,p=t._z,g=t._w;return this._x=i*g+l*c+r*p-o*h,this._y=r*g+l*h+o*c-i*p,this._z=o*g+l*p+i*h-r*c,this._w=l*g-i*c-r*h-o*p,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);const i=this._x,r=this._y,o=this._z,l=this._w;let c=l*e._w+i*e._x+r*e._y+o*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=l,this._x=i,this._y=r,this._z=o,this;const h=1-c*c;if(h<=Number.EPSILON){const M=1-t;return this._w=M*l+t*this._w,this._x=M*i+t*this._x,this._y=M*r+t*this._y,this._z=M*o+t*this._z,this.normalize(),this._onChangeCallback(),this}const p=Math.sqrt(h),g=Math.atan2(p,c),y=Math.sin((1-t)*g)/p,x=Math.sin(t*g)/p;return this._w=l*y+this._w*x,this._x=i*y+this._x*x,this._y=r*y+this._y*x,this._z=o*y+this._z*x,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),o=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(o),i*Math.cos(o),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Z{constructor(e=0,t=0,i=0){Z.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(I3.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(I3.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*i+o[6]*r,this.y=o[1]*t+o[4]*i+o[7]*r,this.z=o[2]*t+o[5]*i+o[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,o=e.elements,l=1/(o[3]*t+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*i+o[8]*r+o[12])*l,this.y=(o[1]*t+o[5]*i+o[9]*r+o[13])*l,this.z=(o[2]*t+o[6]*i+o[10]*r+o[14])*l,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,o=e.x,l=e.y,c=e.z,h=e.w,p=h*t+l*r-c*i,g=h*i+c*t-o*r,y=h*r+o*i-l*t,x=-o*t-l*i-c*r;return this.x=p*h+x*-o+g*-c-y*-l,this.y=g*h+x*-l+y*-o-p*-c,this.z=y*h+x*-c+p*-l-g*-o,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r,this.y=o[1]*t+o[5]*i+o[9]*r,this.z=o[2]*t+o[6]*i+o[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,o=e.z,l=t.x,c=t.y,h=t.z;return this.x=r*h-o*c,this.y=o*l-i*h,this.z=i*c-r*l,this}projectOnVector(e){const t=e.lengthSq();if(0===t)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return pR.copy(this).projectOnVector(e),this.sub(pR)}reflect(e){return this.sub(pR.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Pr(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,i=Math.sqrt(1-uH(e,2));return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const pR=new Z,I3=new da;class Yg{constructor(e=new Z(1/0,1/0,1/0),t=new Z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,o=-1/0,l=-1/0,c=-1/0;for(let h=0,p=e.length;h<p;h+=3){const g=e[h],y=e[h+1],x=e[h+2];g<t&&(t=g),y<i&&(i=y),x<r&&(r=x),g>o&&(o=g),y>l&&(l=y),x>c&&(c=x)}return this.min.set(t,i,r),this.max.set(o,l,c),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,o=-1/0,l=-1/0,c=-1/0;for(let h=0,p=e.count;h<p;h++){const g=e.getX(h),y=e.getY(h),x=e.getZ(h);g<t&&(t=g),y<i&&(i=y),x<r&&(r=x),g>o&&(o=g),y>l&&(l=y),x>c&&(c=x)}return this.min.set(t,i,r),this.max.set(o,l,c),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=jf.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(void 0!==i)if(t&&null!=i.attributes&&void 0!==i.attributes.position){const o=i.attributes.position;for(let l=0,c=o.count;l<c;l++)jf.fromBufferAttribute(o,l).applyMatrix4(e.matrixWorld),this.expandByPoint(jf)}else null===i.boundingBox&&i.computeBoundingBox(),mR.copy(i.boundingBox),mR.applyMatrix4(e.matrixWorld),this.union(mR);const r=e.children;for(let o=0,l=r.length;o<l;o++)this.expandByObject(r[o],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,jf),jf.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(B0),DS.subVectors(this.max,B0),Jg.subVectors(e.a,B0),Kg.subVectors(e.b,B0),Qg.subVectors(e.c,B0),Id.subVectors(Kg,Jg),Ld.subVectors(Qg,Kg),qf.subVectors(Jg,Qg);let t=[0,-Id.z,Id.y,0,-Ld.z,Ld.y,0,-qf.z,qf.y,Id.z,0,-Id.x,Ld.z,0,-Ld.x,qf.z,0,-qf.x,-Id.y,Id.x,0,-Ld.y,Ld.x,0,-qf.y,qf.x,0];return!(!gR(t,Jg,Kg,Qg,DS)||(t=[1,0,0,0,1,0,0,0,1],!gR(t,Jg,Kg,Qg,DS)))&&(RS.crossVectors(Id,Ld),t=[RS.x,RS.y,RS.z],gR(t,Jg,Kg,Qg,DS))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return jf.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(jf).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||($c[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),$c[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),$c[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),$c[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),$c[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),$c[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),$c[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),$c[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints($c)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $c=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z],jf=new Z,mR=new Yg,Jg=new Z,Kg=new Z,Qg=new Z,Id=new Z,Ld=new Z,qf=new Z,B0=new Z,DS=new Z,RS=new Z,$f=new Z;function gR(n,e,t,i,r){for(let o=0,l=n.length-3;o<=l;o+=3){$f.fromArray(n,o);const c=r.x*Math.abs($f.x)+r.y*Math.abs($f.y)+r.z*Math.abs($f.z),h=e.dot($f),p=t.dot($f),g=i.dot($f);if(Math.max(-Math.max(h,p,g),Math.min(h,p,g))>c)return!1}return!0}const w7=new Yg,L3=new Z,IS=new Z,_R=new Z;class e_{constructor(e=new Z,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;void 0!==t?i.copy(t):w7.setFromPoints(e).getCenter(i);let r=0;for(let o=0,l=e.length;o<l;o++)r=Math.max(r,i.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){_R.subVectors(e,this.center);const t=_R.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(_R.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return!0===this.center.equals(e.center)?IS.set(0,0,1).multiplyScalar(e.radius):IS.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(L3.copy(e.center).add(IS)),this.expandByPoint(L3.copy(e.center).sub(IS)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Xc=new Z,yR=new Z,LS=new Z,Pd=new Z,vR=new Z,PS=new Z,xR=new Z;class FS{constructor(e=new Z,t=new Z(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Xc)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Xc.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Xc.copy(this.direction).multiplyScalar(t).add(this.origin),Xc.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){yR.copy(e).add(t).multiplyScalar(.5),LS.copy(t).sub(e).normalize(),Pd.copy(this.origin).sub(yR);const o=.5*e.distanceTo(t),l=-this.direction.dot(LS),c=Pd.dot(this.direction),h=-Pd.dot(LS),p=Pd.lengthSq(),g=Math.abs(1-l*l);let y,x,M,S;if(g>0)if(y=l*h-c,x=l*c-h,S=o*g,y>=0)if(x>=-S)if(x<=S){const C=1/g;y*=C,x*=C,M=y*(y+l*x+2*c)+x*(l*y+x+2*h)+p}else x=o,y=Math.max(0,-(l*x+c)),M=-y*y+x*(x+2*h)+p;else x=-o,y=Math.max(0,-(l*x+c)),M=-y*y+x*(x+2*h)+p;else x<=-S?(y=Math.max(0,-(-l*o+c)),x=y>0?-o:Math.min(Math.max(-o,-h),o),M=-y*y+x*(x+2*h)+p):x<=S?(y=0,x=Math.min(Math.max(-o,-h),o),M=x*(x+2*h)+p):(y=Math.max(0,-(l*o+c)),x=y>0?o:Math.min(Math.max(-o,-h),o),M=-y*y+x*(x+2*h)+p);else x=l>0?-o:o,y=Math.max(0,-(l*x+c)),M=-y*y+x*(x+2*h)+p;return i&&i.copy(this.direction).multiplyScalar(y).add(this.origin),r&&r.copy(LS).multiplyScalar(x).add(yR),M}intersectSphere(e,t){Xc.subVectors(e.center,this.origin);const i=Xc.dot(this.direction),r=Xc.dot(Xc)-i*i,o=e.radius*e.radius;if(r>o)return null;const l=Math.sqrt(o-r),c=i-l,h=i+l;return c<0&&h<0?null:this.at(c<0?h:c,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,o,l,c,h;const p=1/this.direction.x,g=1/this.direction.y,y=1/this.direction.z,x=this.origin;return p>=0?(i=(e.min.x-x.x)*p,r=(e.max.x-x.x)*p):(i=(e.max.x-x.x)*p,r=(e.min.x-x.x)*p),g>=0?(o=(e.min.y-x.y)*g,l=(e.max.y-x.y)*g):(o=(e.max.y-x.y)*g,l=(e.min.y-x.y)*g),i>l||o>r||((o>i||i!=i)&&(i=o),(l<r||r!=r)&&(r=l),y>=0?(c=(e.min.z-x.z)*y,h=(e.max.z-x.z)*y):(c=(e.max.z-x.z)*y,h=(e.min.z-x.z)*y),i>h||c>r)||((c>i||i!=i)&&(i=c),(h<r||r!=r)&&(r=h),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,Xc)}intersectTriangle(e,t,i,r,o){vR.subVectors(t,e),PS.subVectors(i,e),xR.crossVectors(vR,PS);let c,l=this.direction.dot(xR);if(l>0){if(r)return null;c=1}else{if(!(l<0))return null;c=-1,l=-l}Pd.subVectors(this.origin,e);const h=c*this.direction.dot(PS.crossVectors(Pd,PS));if(h<0)return null;const p=c*this.direction.dot(vR.cross(Pd));if(p<0||h+p>l)return null;const g=-c*Pd.dot(xR);return g<0?null:this.at(g/l,o)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Bn{constructor(){Bn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,o,l,c,h,p,g,y,x,M,S,C,T){const P=this.elements;return P[0]=e,P[4]=t,P[8]=i,P[12]=r,P[1]=o,P[5]=l,P[9]=c,P[13]=h,P[2]=p,P[6]=g,P[10]=y,P[14]=x,P[3]=M,P[7]=S,P[11]=C,P[15]=T,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Bn).fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/t_.setFromMatrixColumn(e,0).length(),o=1/t_.setFromMatrixColumn(e,1).length(),l=1/t_.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=0,t[8]=i[8]*l,t[9]=i[9]*l,t[10]=i[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,o=e.z,l=Math.cos(i),c=Math.sin(i),h=Math.cos(r),p=Math.sin(r),g=Math.cos(o),y=Math.sin(o);if("XYZ"===e.order){const x=l*g,M=l*y,S=c*g,C=c*y;t[0]=h*g,t[4]=-h*y,t[8]=p,t[1]=M+S*p,t[5]=x-C*p,t[9]=-c*h,t[2]=C-x*p,t[6]=S+M*p,t[10]=l*h}else if("YXZ"===e.order){const x=h*g,M=h*y,S=p*g,C=p*y;t[0]=x+C*c,t[4]=S*c-M,t[8]=l*p,t[1]=l*y,t[5]=l*g,t[9]=-c,t[2]=M*c-S,t[6]=C+x*c,t[10]=l*h}else if("ZXY"===e.order){const x=h*g,M=h*y,S=p*g,C=p*y;t[0]=x-C*c,t[4]=-l*y,t[8]=S+M*c,t[1]=M+S*c,t[5]=l*g,t[9]=C-x*c,t[2]=-l*p,t[6]=c,t[10]=l*h}else if("ZYX"===e.order){const x=l*g,M=l*y,S=c*g,C=c*y;t[0]=h*g,t[4]=S*p-M,t[8]=x*p+C,t[1]=h*y,t[5]=C*p+x,t[9]=M*p-S,t[2]=-p,t[6]=c*h,t[10]=l*h}else if("YZX"===e.order){const x=l*h,M=l*p,S=c*h,C=c*p;t[0]=h*g,t[4]=C-x*y,t[8]=S*y+M,t[1]=y,t[5]=l*g,t[9]=-c*g,t[2]=-p*g,t[6]=M*y+S,t[10]=x-C*y}else if("XZY"===e.order){const x=l*h,M=l*p,S=c*h,C=c*p;t[0]=h*g,t[4]=-y,t[8]=p*g,t[1]=x*y+C,t[5]=l*g,t[9]=M*y-S,t[2]=S*y-M,t[6]=c*g,t[10]=C*y+x}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(M7,e,S7)}lookAt(e,t,i){const r=this.elements;return ha.subVectors(e,t),0===ha.lengthSq()&&(ha.z=1),ha.normalize(),Fd.crossVectors(i,ha),0===Fd.lengthSq()&&(1===Math.abs(i.z)?ha.x+=1e-4:ha.z+=1e-4,ha.normalize(),Fd.crossVectors(i,ha)),Fd.normalize(),NS.crossVectors(ha,Fd),r[0]=Fd.x,r[4]=NS.x,r[8]=ha.x,r[1]=Fd.y,r[5]=NS.y,r[9]=ha.y,r[2]=Fd.z,r[6]=NS.z,r[10]=ha.z,this}multiply(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,o=this.elements,l=i[0],c=i[4],h=i[8],p=i[12],g=i[1],y=i[5],x=i[9],M=i[13],S=i[2],C=i[6],T=i[10],P=i[14],O=i[3],k=i[7],B=i[11],z=i[15],q=r[0],ne=r[4],U=r[8],ee=r[12],le=r[1],me=r[5],Oe=r[9],tt=r[13],ge=r[2],Pe=r[6],ae=r[10],ye=r[14],xe=r[3],_e=r[7],Se=r[11],Je=r[15];return o[0]=l*q+c*le+h*ge+p*xe,o[4]=l*ne+c*me+h*Pe+p*_e,o[8]=l*U+c*Oe+h*ae+p*Se,o[12]=l*ee+c*tt+h*ye+p*Je,o[1]=g*q+y*le+x*ge+M*xe,o[5]=g*ne+y*me+x*Pe+M*_e,o[9]=g*U+y*Oe+x*ae+M*Se,o[13]=g*ee+y*tt+x*ye+M*Je,o[2]=S*q+C*le+T*ge+P*xe,o[6]=S*ne+C*me+T*Pe+P*_e,o[10]=S*U+C*Oe+T*ae+P*Se,o[14]=S*ee+C*tt+T*ye+P*Je,o[3]=O*q+k*le+B*ge+z*xe,o[7]=O*ne+k*me+B*Pe+z*_e,o[11]=O*U+k*Oe+B*ae+z*Se,o[15]=O*ee+k*tt+B*ye+z*Je,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],o=e[12],l=e[1],c=e[5],h=e[9],p=e[13],g=e[2],y=e[6],x=e[10],M=e[14];return e[3]*(+o*h*y-r*p*y-o*c*x+i*p*x+r*c*M-i*h*M)+e[7]*(+t*h*M-t*p*x+o*l*x-r*l*M+r*p*g-o*h*g)+e[11]*(+t*p*y-t*c*M-o*l*y+i*l*M+o*c*g-i*p*g)+e[15]*(-r*c*g-t*h*y+t*c*x+r*l*y-i*l*x+i*h*g)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],o=e[3],l=e[4],c=e[5],h=e[6],p=e[7],g=e[8],y=e[9],x=e[10],M=e[11],S=e[12],C=e[13],T=e[14],P=e[15],O=y*T*p-C*x*p+C*h*M-c*T*M-y*h*P+c*x*P,k=S*x*p-g*T*p-S*h*M+l*T*M+g*h*P-l*x*P,B=g*C*p-S*y*p+S*c*M-l*C*M-g*c*P+l*y*P,z=S*y*h-g*C*h-S*c*x+l*C*x+g*c*T-l*y*T,q=t*O+i*k+r*B+o*z;if(0===q)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ne=1/q;return e[0]=O*ne,e[1]=(C*x*o-y*T*o-C*r*M+i*T*M+y*r*P-i*x*P)*ne,e[2]=(c*T*o-C*h*o+C*r*p-i*T*p-c*r*P+i*h*P)*ne,e[3]=(y*h*o-c*x*o-y*r*p+i*x*p+c*r*M-i*h*M)*ne,e[4]=k*ne,e[5]=(g*T*o-S*x*o+S*r*M-t*T*M-g*r*P+t*x*P)*ne,e[6]=(S*h*o-l*T*o-S*r*p+t*T*p+l*r*P-t*h*P)*ne,e[7]=(l*x*o-g*h*o+g*r*p-t*x*p-l*r*M+t*h*M)*ne,e[8]=B*ne,e[9]=(S*y*o-g*C*o-S*i*M+t*C*M+g*i*P-t*y*P)*ne,e[10]=(l*C*o-S*c*o+S*i*p-t*C*p-l*i*P+t*c*P)*ne,e[11]=(g*c*o-l*y*o-g*i*p+t*y*p+l*i*M-t*c*M)*ne,e[12]=z*ne,e[13]=(g*C*r-S*y*r+S*i*x-t*C*x-g*i*T+t*y*T)*ne,e[14]=(S*c*r-l*C*r-S*i*h+t*C*h+l*i*T-t*c*T)*ne,e[15]=(l*y*r-g*c*r+g*i*h-t*y*h-l*i*x+t*c*x)*ne,this}scale(e){const t=this.elements,i=e.x,r=e.y,o=e.z;return t[0]*=i,t[4]*=r,t[8]*=o,t[1]*=i,t[5]*=r,t[9]*=o,t[2]*=i,t[6]*=r,t[10]*=o,t[3]*=i,t[7]*=r,t[11]*=o,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),o=1-i,l=e.x,c=e.y,h=e.z,p=o*l,g=o*c;return this.set(p*l+i,p*c-r*h,p*h+r*c,0,p*c+r*h,g*c+i,g*h-r*l,0,p*h-r*c,g*h+r*l,o*h*h+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,o,l){return this.set(1,i,o,0,e,1,l,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,o=t._x,l=t._y,c=t._z,h=t._w,p=o+o,g=l+l,y=c+c,x=o*p,M=o*g,S=o*y,C=l*g,T=l*y,P=c*y,O=h*p,k=h*g,B=h*y,z=i.x,q=i.y,ne=i.z;return r[0]=(1-(C+P))*z,r[1]=(M+B)*z,r[2]=(S-k)*z,r[3]=0,r[4]=(M-B)*q,r[5]=(1-(x+P))*q,r[6]=(T+O)*q,r[7]=0,r[8]=(S+k)*ne,r[9]=(T-O)*ne,r[10]=(1-(x+C))*ne,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let o=t_.set(r[0],r[1],r[2]).length();const l=t_.set(r[4],r[5],r[6]).length(),c=t_.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],pl.copy(this);const p=1/o,g=1/l,y=1/c;return pl.elements[0]*=p,pl.elements[1]*=p,pl.elements[2]*=p,pl.elements[4]*=g,pl.elements[5]*=g,pl.elements[6]*=g,pl.elements[8]*=y,pl.elements[9]*=y,pl.elements[10]*=y,t.setFromRotationMatrix(pl),i.x=o,i.y=l,i.z=c,this}makePerspective(e,t,i,r,o,l){void 0===l&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const c=this.elements,p=2*o/(i-r),g=(t+e)/(t-e),y=(i+r)/(i-r),x=-(l+o)/(l-o),M=-2*l*o/(l-o);return c[0]=2*o/(t-e),c[4]=0,c[8]=g,c[12]=0,c[1]=0,c[5]=p,c[9]=y,c[13]=0,c[2]=0,c[6]=0,c[10]=x,c[14]=M,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,o,l){const c=this.elements,h=1/(t-e),p=1/(i-r),g=1/(l-o),y=(t+e)*h,x=(i+r)*p,M=(l+o)*g;return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-y,c[1]=0,c[5]=2*p,c[9]=0,c[13]=-x,c[2]=0,c[6]=0,c[10]=-2*g,c[14]=-M,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const t_=new Z,pl=new Bn,M7=new Z(0,0,0),S7=new Z(1,1,1),Fd=new Z,NS=new Z,ha=new Z,P3=new Bn,F3=new da;let E7=(()=>{class n{constructor(t=0,i=0,r=0,o=n.DefaultOrder){this.isEuler=!0,this._x=t,this._y=i,this._z=r,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,r,o=this._order){return this._x=t,this._y=i,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,r=!0){const o=t.elements,l=o[0],c=o[4],h=o[8],p=o[1],g=o[5],y=o[9],x=o[2],M=o[6],S=o[10];switch(i){case"XYZ":this._y=Math.asin(Pr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-y,S),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(M,g),this._z=0);break;case"YXZ":this._x=Math.asin(-Pr(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(h,S),this._z=Math.atan2(p,g)):(this._y=Math.atan2(-x,l),this._z=0);break;case"ZXY":this._x=Math.asin(Pr(M,-1,1)),Math.abs(M)<.9999999?(this._y=Math.atan2(-x,S),this._z=Math.atan2(-c,g)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-Pr(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(M,S),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-c,g));break;case"YZX":this._z=Math.asin(Pr(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-y,g),this._y=Math.atan2(-x,l)):(this._x=0,this._y=Math.atan2(h,S));break;case"XZY":this._z=Math.asin(-Pr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(M,g),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-y,S),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(t,i,r){return P3.makeRotationFromQuaternion(t),this.setFromRotationMatrix(P3,i,r)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return F3.setFromEuler(this),this.setFromQuaternion(F3,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}return n.DefaultOrder="XYZ",n.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],n})();class bR{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return 0!=(this.mask&e.mask)}isEnabled(e){return 0!=(this.mask&(1<<e|0))}}let C7=0;const N3=new Z,n_=new da,Zc=new Bn,OS=new Z,V0=new Z,T7=new Z,A7=new da,O3=new Z(1,0,0),k3=new Z(0,1,0),B3=new Z(0,0,1),D7={type:"added"},V3={type:"removed"};let fo=(()=>{class n extends qg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:C7++}),this.uuid=ca(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DefaultUp.clone();const t=new Z,i=new E7,r=new da,o=new Z(1,1,1);i._onChange(function l(){r.setFromEuler(i,!1)}),r._onChange(function c(){i.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Bn},normalMatrix:{value:new ua}}),this.matrix=new Bn,this.matrixWorld=new Bn,this.matrixAutoUpdate=n.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new bR,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return n_.setFromAxisAngle(t,i),this.quaternion.multiply(n_),this}rotateOnWorldAxis(t,i){return n_.setFromAxisAngle(t,i),this.quaternion.premultiply(n_),this}rotateX(t){return this.rotateOnAxis(O3,t)}rotateY(t){return this.rotateOnAxis(k3,t)}rotateZ(t){return this.rotateOnAxis(B3,t)}translateOnAxis(t,i){return N3.copy(t).applyQuaternion(this.quaternion),this.position.add(N3.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(O3,t)}translateY(t){return this.translateOnAxis(k3,t)}translateZ(t){return this.translateOnAxis(B3,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Zc.copy(this.matrixWorld).invert())}lookAt(t,i,r){t.isVector3?OS.copy(t):OS.set(t,i,r);const o=this.parent;this.updateWorldMatrix(!0,!1),V0.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Zc.lookAt(V0,OS,this.up):Zc.lookAt(OS,V0,this.up),this.quaternion.setFromRotationMatrix(Zc),o&&(Zc.extractRotation(o.matrixWorld),n_.setFromRotationMatrix(Zc),this.quaternion.premultiply(n_.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(D7)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const i=this.children.indexOf(t);return-1!==i&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(V3)),this}removeFromParent(){const t=this.parent;return null!==t&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const i=this.children[t];i.parent=null,i.dispatchEvent(V3)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Zc.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Zc.multiply(t.parent.matrixWorld)),t.applyMatrix4(Zc),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let r=0,o=this.children.length;r<o;r++){const c=this.children[r].getObjectByProperty(t,i);if(void 0!==c)return c}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(V0,t,T7),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(V0,A7,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverse(t)}traverseVisible(t){if(!1===this.visible)return;t(this);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverseVisible(t)}traverseAncestors(t){const i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].updateMatrixWorld(t)}updateWorldMatrix(t,i){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i){const o=this.children;for(let l=0,c=o.length;l<c;l++)o[l].updateWorldMatrix(!1,!0)}}toJSON(t){const i=void 0===t||"string"==typeof t,r={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};function l(h,p){return void 0===h[p.uuid]&&(h[p.uuid]=p.toJSON(t)),p.uuid}if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(o.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=l(t.geometries,this.geometry);const h=this.geometry.parameters;if(void 0!==h&&void 0!==h.shapes){const p=h.shapes;if(Array.isArray(p))for(let g=0,y=p.length;g<y;g++)l(t.shapes,p[g]);else l(t.shapes,p)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(l(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const h=[];for(let p=0,g=this.material.length;p<g;p++)h.push(l(t.materials,this.material[p]));o.material=h}else o.material=l(t.materials,this.material);if(this.children.length>0){o.children=[];for(let h=0;h<this.children.length;h++)o.children.push(this.children[h].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let h=0;h<this.animations.length;h++)o.animations.push(l(t.animations,this.animations[h]))}if(i){const h=c(t.geometries),p=c(t.materials),g=c(t.textures),y=c(t.images),x=c(t.shapes),M=c(t.skeletons),S=c(t.animations),C=c(t.nodes);h.length>0&&(r.geometries=h),p.length>0&&(r.materials=p),g.length>0&&(r.textures=g),y.length>0&&(r.images=y),x.length>0&&(r.shapes=x),M.length>0&&(r.skeletons=M),S.length>0&&(r.animations=S),C.length>0&&(r.nodes=C)}return r.object=o,r;function c(h){const p=[];for(const g in h){const y=h[g];delete y.metadata,p.push(y)}return p}}clone(t){return(new this.constructor).copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(let r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}return n.DefaultUp=new Z(0,1,0),n.DefaultMatrixAutoUpdate=!0,n})();const ml=new Z,Yc=new Z,wR=new Z,Jc=new Z,i_=new Z,r_=new Z,U3=new Z,MR=new Z,SR=new Z,ER=new Z;class gl{constructor(e=new Z,t=new Z,i=new Z){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ml.subVectors(e,t),r.cross(ml);const o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(e,t,i,r,o){ml.subVectors(r,t),Yc.subVectors(i,t),wR.subVectors(e,t);const l=ml.dot(ml),c=ml.dot(Yc),h=ml.dot(wR),p=Yc.dot(Yc),g=Yc.dot(wR),y=l*p-c*c;if(0===y)return o.set(-2,-1,-1);const x=1/y,M=(p*h-c*g)*x,S=(l*g-c*h)*x;return o.set(1-M-S,S,M)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Jc),Jc.x>=0&&Jc.y>=0&&Jc.x+Jc.y<=1}static getUV(e,t,i,r,o,l,c,h){return this.getBarycoord(e,t,i,r,Jc),h.set(0,0),h.addScaledVector(o,Jc.x),h.addScaledVector(l,Jc.y),h.addScaledVector(c,Jc.z),h}static isFrontFacing(e,t,i,r){return ml.subVectors(i,t),Yc.subVectors(e,t),ml.cross(Yc).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ml.subVectors(this.c,this.b),Yc.subVectors(this.a,this.b),.5*ml.cross(Yc).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return gl.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return gl.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,o){return gl.getUV(e,this.a,this.b,this.c,t,i,r,o)}containsPoint(e){return gl.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return gl.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,o=this.c;let l,c;i_.subVectors(r,i),r_.subVectors(o,i),MR.subVectors(e,i);const h=i_.dot(MR),p=r_.dot(MR);if(h<=0&&p<=0)return t.copy(i);SR.subVectors(e,r);const g=i_.dot(SR),y=r_.dot(SR);if(g>=0&&y<=g)return t.copy(r);const x=h*y-g*p;if(x<=0&&h>=0&&g<=0)return l=h/(h-g),t.copy(i).addScaledVector(i_,l);ER.subVectors(e,o);const M=i_.dot(ER),S=r_.dot(ER);if(S>=0&&M<=S)return t.copy(o);const C=M*p-h*S;if(C<=0&&p>=0&&S<=0)return c=p/(p-S),t.copy(i).addScaledVector(r_,c);const T=g*S-M*y;if(T<=0&&y-g>=0&&M-S>=0)return U3.subVectors(o,r),c=(y-g)/(y-g+(M-S)),t.copy(r).addScaledVector(U3,c);const P=1/(T+C+x);return l=C*P,c=x*P,t.copy(i).addScaledVector(i_,l).addScaledVector(r_,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let R7=0;class s_ extends qg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:R7++}),this.uuid=ca(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const t in e){const i=e[t];if(void 0===i){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if("shading"===t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===i;continue}const r=this[t];void 0!==r?r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}}toJSON(e){const t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(o){const l=[];for(const c in o){const h=o[c];delete h.metadata,l.push(h)}return l}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(i.blending=this.blending),0!==this.side&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),t){const o=r(e.textures),l=r(e.images);o.length>0&&(i.textures=o),l.length>0&&(i.images=l)}return i}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(null!==t){const r=t.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=t[o].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}class Kc extends s_{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ft(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const $r=new Z,kS=new Xe;class ys{constructor(e,t,i){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===i,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),l=new Ft),t[i++]=l.r,t[i++]=l.g,t[i++]=l.b}return this}copyVector2sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),l=new Xe),t[i++]=l.x,t[i++]=l.y}return this}copyVector3sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),l=new Z),t[i++]=l.x,t[i++]=l.y,t[i++]=l.z}return this}copyVector4sArray(e){const t=this.array;let i=0;for(let r=0,o=e.length;r<o;r++){let l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),l=new Bi),t[i++]=l.x,t[i++]=l.y,t[i++]=l.z,t[i++]=l.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)kS.fromBufferAttribute(this,t),kS.applyMatrix3(e),this.setXY(t,kS.x,kS.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)$r.fromBufferAttribute(this,t),$r.applyMatrix3(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)$r.fromBufferAttribute(this,t),$r.applyMatrix4(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)$r.fromBufferAttribute(this,t),$r.applyNormalMatrix(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)$r.fromBufferAttribute(this,t),$r.transformDirection(e),this.setXYZ(t,$r.x,$r.y,$r.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){return this.array[e*this.itemSize]}setX(e,t){return this.array[e*this.itemSize]=t,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,t){return this.array[e*this.itemSize+1]=t,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,t){return this.array[e*this.itemSize+2]=t,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,t){return this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,o){return this.array[0+(e*=this.itemSize)]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=o,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class z3 extends ys{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class H3 extends ys{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class Wt extends ys{constructor(e,t,i){super(new Float32Array(e),t,i)}}let I7=0;const Ba=new Bn,CR=new fo,o_=new Z,fa=new Yg,U0=new Yg,vs=new Z;class Kn extends qg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:I7++}),this.uuid=ca(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(T3(e)?H3:z3)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(void 0!==i){const o=(new ua).getNormalMatrix(e);i.applyNormalMatrix(o),i.needsUpdate=!0}const r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return Ba.makeRotationFromQuaternion(e),this.applyMatrix4(Ba),this}rotateX(e){return Ba.makeRotationX(e),this.applyMatrix4(Ba),this}rotateY(e){return Ba.makeRotationY(e),this.applyMatrix4(Ba),this}rotateZ(e){return Ba.makeRotationZ(e),this.applyMatrix4(Ba),this}translate(e,t,i){return Ba.makeTranslation(e,t,i),this.applyMatrix4(Ba),this}scale(e,t,i){return Ba.makeScale(e,t,i),this.applyMatrix4(Ba),this}lookAt(e){return CR.lookAt(e),CR.updateMatrix(),this.applyMatrix4(CR.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(o_).negate(),this.translate(o_.x,o_.y,o_.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const o=e[i];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new Wt(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Yg);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Z(-1/0,-1/0,-1/0),new Z(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++)fa.setFromBufferAttribute(t[i]),this.morphTargetsRelative?(vs.addVectors(this.boundingBox.min,fa.min),this.boundingBox.expandByPoint(vs),vs.addVectors(this.boundingBox.max,fa.max),this.boundingBox.expandByPoint(vs)):(this.boundingBox.expandByPoint(fa.min),this.boundingBox.expandByPoint(fa.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new e_);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Z,1/0);if(e){const i=this.boundingSphere.center;if(fa.setFromBufferAttribute(e),t)for(let o=0,l=t.length;o<l;o++)U0.setFromBufferAttribute(t[o]),this.morphTargetsRelative?(vs.addVectors(fa.min,U0.min),fa.expandByPoint(vs),vs.addVectors(fa.max,U0.max),fa.expandByPoint(vs)):(fa.expandByPoint(U0.min),fa.expandByPoint(U0.max));fa.getCenter(i);let r=0;for(let o=0,l=e.count;o<l;o++)vs.fromBufferAttribute(e,o),r=Math.max(r,i.distanceToSquared(vs));if(t)for(let o=0,l=t.length;o<l;o++){const c=t[o],h=this.morphTargetsRelative;for(let p=0,g=c.count;p<g;p++)vs.fromBufferAttribute(c,p),h&&(o_.fromBufferAttribute(e,p),vs.add(o_)),r=Math.max(r,i.distanceToSquared(vs))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const i=e.array,r=t.position.array,o=t.normal.array,l=t.uv.array,c=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ys(new Float32Array(4*c),4));const h=this.getAttribute("tangent").array,p=[],g=[];for(let le=0;le<c;le++)p[le]=new Z,g[le]=new Z;const y=new Z,x=new Z,M=new Z,S=new Xe,C=new Xe,T=new Xe,P=new Z,O=new Z;function k(le,me,Oe){y.fromArray(r,3*le),x.fromArray(r,3*me),M.fromArray(r,3*Oe),S.fromArray(l,2*le),C.fromArray(l,2*me),T.fromArray(l,2*Oe),x.sub(y),M.sub(y),C.sub(S),T.sub(S);const tt=1/(C.x*T.y-T.x*C.y);!isFinite(tt)||(P.copy(x).multiplyScalar(T.y).addScaledVector(M,-C.y).multiplyScalar(tt),O.copy(M).multiplyScalar(C.x).addScaledVector(x,-T.x).multiplyScalar(tt),p[le].add(P),p[me].add(P),p[Oe].add(P),g[le].add(O),g[me].add(O),g[Oe].add(O))}let B=this.groups;0===B.length&&(B=[{start:0,count:i.length}]);for(let le=0,me=B.length;le<me;++le){const Oe=B[le],tt=Oe.start;for(let Pe=tt,ae=tt+Oe.count;Pe<ae;Pe+=3)k(i[Pe+0],i[Pe+1],i[Pe+2])}const z=new Z,q=new Z,ne=new Z,U=new Z;function ee(le){ne.fromArray(o,3*le),U.copy(ne);const me=p[le];z.copy(me),z.sub(ne.multiplyScalar(ne.dot(me))).normalize(),q.crossVectors(U,me);const tt=q.dot(g[le])<0?-1:1;h[4*le]=z.x,h[4*le+1]=z.y,h[4*le+2]=z.z,h[4*le+3]=tt}for(let le=0,me=B.length;le<me;++le){const Oe=B[le],tt=Oe.start;for(let Pe=tt,ae=tt+Oe.count;Pe<ae;Pe+=3)ee(i[Pe+0]),ee(i[Pe+1]),ee(i[Pe+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new ys(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let x=0,M=i.count;x<M;x++)i.setXYZ(x,0,0,0);const r=new Z,o=new Z,l=new Z,c=new Z,h=new Z,p=new Z,g=new Z,y=new Z;if(e)for(let x=0,M=e.count;x<M;x+=3){const S=e.getX(x+0),C=e.getX(x+1),T=e.getX(x+2);r.fromBufferAttribute(t,S),o.fromBufferAttribute(t,C),l.fromBufferAttribute(t,T),g.subVectors(l,o),y.subVectors(r,o),g.cross(y),c.fromBufferAttribute(i,S),h.fromBufferAttribute(i,C),p.fromBufferAttribute(i,T),c.add(g),h.add(g),p.add(g),i.setXYZ(S,c.x,c.y,c.z),i.setXYZ(C,h.x,h.y,h.z),i.setXYZ(T,p.x,p.y,p.z)}else for(let x=0,M=t.count;x<M;x+=3)r.fromBufferAttribute(t,x+0),o.fromBufferAttribute(t,x+1),l.fromBufferAttribute(t,x+2),g.subVectors(l,o),y.subVectors(r,o),g.cross(y),i.setXYZ(x+0,g.x,g.y,g.z),i.setXYZ(x+1,g.x,g.y,g.z),i.setXYZ(x+2,g.x,g.y,g.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(e,t){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const r in i){if(void 0===e.attributes[r])continue;const l=i[r].array,c=e.attributes[r],h=c.array,p=c.itemSize*t,g=Math.min(h.length,l.length-p);for(let y=0,x=p;y<g;y++,x++)l[x]=h[y]}return this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)vs.fromBufferAttribute(e,t),vs.normalize(),e.setXYZ(t,vs.x,vs.y,vs.z)}toNonIndexed(){function e(c,h){const p=c.array,g=c.itemSize,y=c.normalized,x=new p.constructor(h.length*g);let M=0,S=0;for(let C=0,T=h.length;C<T;C++){M=c.isInterleavedBufferAttribute?h[C]*c.data.stride+c.offset:h[C]*g;for(let P=0;P<g;P++)x[S++]=p[M++]}return new ys(x,g,y)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Kn,i=this.index.array,r=this.attributes;for(const c in r){const p=e(r[c],i);t.setAttribute(c,p)}const o=this.morphAttributes;for(const c in o){const h=[],p=o[c];for(let g=0,y=p.length;g<y;g++){const M=e(p[g],i);h.push(M)}t.morphAttributes[c]=h}t.morphTargetsRelative=this.morphTargetsRelative;const l=this.groups;for(let c=0,h=l.length;c<h;c++){const p=l[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const h=this.parameters;for(const p in h)void 0!==h[p]&&(e[p]=h[p]);return e}e.data={attributes:{}};const t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const h in i)e.data.attributes[h]=i[h].toJSON(e.data);const r={};let o=!1;for(const h in this.morphAttributes){const p=this.morphAttributes[h],g=[];for(let y=0,x=p.length;y<x;y++)g.push(p[y].toJSON(e.data));g.length>0&&(r[h]=g,o=!0)}o&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const l=this.groups;l.length>0&&(e.data.groups=JSON.parse(JSON.stringify(l)));const c=this.boundingSphere;return null!==c&&(e.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),e}clone(){return(new this.constructor).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;null!==i&&this.setIndex(i.clone(t));const r=e.attributes;for(const p in r)this.setAttribute(p,r[p].clone(t));const o=e.morphAttributes;for(const p in o){const g=[],y=o[p];for(let x=0,M=y.length;x<M;x++)g.push(y[x].clone(t));this.morphAttributes[p]=g}this.morphTargetsRelative=e.morphTargetsRelative;const l=e.groups;for(let p=0,g=l.length;p<g;p++){const y=l[p];this.addGroup(y.start,y.count,y.materialIndex)}const c=e.boundingBox;null!==c&&(this.boundingBox=c.clone());const h=e.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,void 0!==e.parameters&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const G3=new Bn,a_=new FS,TR=new e_,Nd=new Z,Od=new Z,kd=new Z,AR=new Z,DR=new Z,RR=new Z,BS=new Z,VS=new Z,US=new Z,zS=new Xe,HS=new Xe,GS=new Xe,IR=new Z,WS=new Z;class po extends fo{constructor(e=new Kn,t=new Kc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}raycast(e,t){const i=this.geometry,r=this.material,o=this.matrixWorld;if(void 0===r||(null===i.boundingSphere&&i.computeBoundingSphere(),TR.copy(i.boundingSphere),TR.applyMatrix4(o),!1===e.ray.intersectsSphere(TR))||(G3.copy(o).invert(),a_.copy(e.ray).applyMatrix4(G3),null!==i.boundingBox&&!1===a_.intersectsBox(i.boundingBox)))return;let l;const c=i.index,h=i.attributes.position,p=i.morphAttributes.position,g=i.morphTargetsRelative,y=i.attributes.uv,x=i.attributes.uv2,M=i.groups,S=i.drawRange;if(null!==c)if(Array.isArray(r))for(let C=0,T=M.length;C<T;C++){const P=M[C],O=r[P.materialIndex];for(let z=Math.max(P.start,S.start),q=Math.min(c.count,Math.min(P.start+P.count,S.start+S.count));z<q;z+=3){const ne=c.getX(z),U=c.getX(z+1),ee=c.getX(z+2);l=jS(this,O,e,a_,h,p,g,y,x,ne,U,ee),l&&(l.faceIndex=Math.floor(z/3),l.face.materialIndex=P.materialIndex,t.push(l))}}else for(let P=Math.max(0,S.start),O=Math.min(c.count,S.start+S.count);P<O;P+=3){const k=c.getX(P),B=c.getX(P+1),z=c.getX(P+2);l=jS(this,r,e,a_,h,p,g,y,x,k,B,z),l&&(l.faceIndex=Math.floor(P/3),t.push(l))}else if(void 0!==h)if(Array.isArray(r))for(let C=0,T=M.length;C<T;C++){const P=M[C],O=r[P.materialIndex];for(let z=Math.max(P.start,S.start),q=Math.min(h.count,Math.min(P.start+P.count,S.start+S.count));z<q;z+=3)l=jS(this,O,e,a_,h,p,g,y,x,z,z+1,z+2),l&&(l.faceIndex=Math.floor(z/3),l.face.materialIndex=P.materialIndex,t.push(l))}else for(let P=Math.max(0,S.start),O=Math.min(h.count,S.start+S.count);P<O;P+=3)l=jS(this,r,e,a_,h,p,g,y,x,P,P+1,P+2),l&&(l.faceIndex=Math.floor(P/3),t.push(l))}}function jS(n,e,t,i,r,o,l,c,h,p,g,y){Nd.fromBufferAttribute(r,p),Od.fromBufferAttribute(r,g),kd.fromBufferAttribute(r,y);const x=n.morphTargetInfluences;if(o&&x){BS.set(0,0,0),VS.set(0,0,0),US.set(0,0,0);for(let S=0,C=o.length;S<C;S++){const T=x[S],P=o[S];0!==T&&(AR.fromBufferAttribute(P,p),DR.fromBufferAttribute(P,g),RR.fromBufferAttribute(P,y),l?(BS.addScaledVector(AR,T),VS.addScaledVector(DR,T),US.addScaledVector(RR,T)):(BS.addScaledVector(AR.sub(Nd),T),VS.addScaledVector(DR.sub(Od),T),US.addScaledVector(RR.sub(kd),T)))}Nd.add(BS),Od.add(VS),kd.add(US)}n.isSkinnedMesh&&(n.boneTransform(p,Nd),n.boneTransform(g,Od),n.boneTransform(y,kd));const M=function L7(n,e,t,i,r,o,l,c){let h;if(h=1===e.side?i.intersectTriangle(l,o,r,!0,c):i.intersectTriangle(r,o,l,2!==e.side,c),null===h)return null;WS.copy(c),WS.applyMatrix4(n.matrixWorld);const p=t.ray.origin.distanceTo(WS);return p<t.near||p>t.far?null:{distance:p,point:WS.clone(),object:n}}(n,e,t,i,Nd,Od,kd,IR);if(M){c&&(zS.fromBufferAttribute(c,p),HS.fromBufferAttribute(c,g),GS.fromBufferAttribute(c,y),M.uv=gl.getUV(IR,Nd,Od,kd,zS,HS,GS,new Xe)),h&&(zS.fromBufferAttribute(h,p),HS.fromBufferAttribute(h,g),GS.fromBufferAttribute(h,y),M.uv2=gl.getUV(IR,Nd,Od,kd,zS,HS,GS,new Xe));const S={a:p,b:g,c:y,normal:new Z,materialIndex:0};gl.getNormal(Nd,Od,kd,S.normal),M.face=S}return M}class Bd extends Kn{constructor(e=1,t=1,i=1,r=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:o,depthSegments:l};const c=this;r=Math.floor(r),o=Math.floor(o),l=Math.floor(l);const h=[],p=[],g=[],y=[];let x=0,M=0;function S(C,T,P,O,k,B,z,q,ne,U,ee){const le=B/ne,me=z/U,Oe=B/2,tt=z/2,ge=q/2,Pe=ne+1,ae=U+1;let ye=0,xe=0;const _e=new Z;for(let Se=0;Se<ae;Se++){const Je=Se*me-tt;for(let Ve=0;Ve<Pe;Ve++)_e[C]=(Ve*le-Oe)*O,_e[T]=Je*k,_e[P]=ge,p.push(_e.x,_e.y,_e.z),_e[C]=0,_e[T]=0,_e[P]=q>0?1:-1,g.push(_e.x,_e.y,_e.z),y.push(Ve/ne),y.push(1-Se/U),ye+=1}for(let Se=0;Se<U;Se++)for(let Je=0;Je<ne;Je++){const ot=x+Je+Pe*(Se+1),ct=x+(Je+1)+Pe*(Se+1),$t=x+(Je+1)+Pe*Se;h.push(x+Je+Pe*Se,ot,$t),h.push(ot,ct,$t),xe+=6}c.addGroup(M,xe,ee),M+=xe,x+=ye}S("z","y","x",-1,-1,i,t,e,l,o,0),S("z","y","x",1,-1,i,t,-e,l,o,1),S("x","z","y",1,1,e,i,t,r,l,2),S("x","z","y",1,-1,e,i,-t,r,l,3),S("x","y","z",1,-1,e,t,i,r,o,4),S("x","y","z",-1,-1,e,t,-i,r,o,5),this.setIndex(h),this.setAttribute("position",new Wt(p,3)),this.setAttribute("normal",new Wt(g,3)),this.setAttribute("uv",new Wt(y,2))}static fromJSON(e){return new Bd(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function l_(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];e[t][i]=r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.clone():Array.isArray(r)?r.slice():r}}return e}function qs(n){const e={};for(let t=0;t<n.length;t++){const i=l_(n[t]);for(const r in i)e[r]=i[r]}return e}const P7={clone:l_,merge:qs};class Vd extends s_{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=l_(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const l=this.uniforms[r].value;t.uniforms[r]=l&&l.isTexture?{type:"t",value:l.toJSON(e).uuid}:l&&l.isColor?{type:"c",value:l.getHex()}:l&&l.isVector2?{type:"v2",value:l.toArray()}:l&&l.isVector3?{type:"v3",value:l.toArray()}:l&&l.isVector4?{type:"v4",value:l.toArray()}:l&&l.isMatrix3?{type:"m3",value:l.toArray()}:l&&l.isMatrix4?{type:"m4",value:l.toArray()}:{value:l}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const r in this.extensions)!0===this.extensions[r]&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class LR extends fo{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Bn,this.projectionMatrix=new Bn,this.projectionMatrixInverse=new Bn}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}class Ds extends LR{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=2*N0*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*Hf*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*N0*Math.atan(Math.tan(.5*Hf*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,o,l){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(.5*Hf*this.fov)/this.zoom,i=2*t,r=this.aspect*i,o=-.5*r;const l=this.view;if(null!==this.view&&this.view.enabled){const h=l.fullWidth,p=l.fullHeight;o+=l.offsetX*r/h,t-=l.offsetY*i/p,r*=l.width/h,i*=l.height/p}const c=this.filmOffset;0!==c&&(o+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class O7 extends fo{constructor(e,t,i){if(super(),this.type="CubeCamera",!0!==i.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new Ds(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new Z(1,0,0)),this.add(r);const o=new Ds(90,1,e,t);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new Z(-1,0,0)),this.add(o);const l=new Ds(90,1,e,t);l.layers=this.layers,l.up.set(0,0,1),l.lookAt(new Z(0,1,0)),this.add(l);const c=new Ds(90,1,e,t);c.layers=this.layers,c.up.set(0,0,-1),c.lookAt(new Z(0,-1,0)),this.add(c);const h=new Ds(90,1,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Z(0,0,1)),this.add(h);const p=new Ds(90,1,e,t);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new Z(0,0,-1)),this.add(p)}update(e,t){null===this.parent&&this.updateMatrixWorld();const i=this.renderTarget,[r,o,l,c,h,p]=this.children,g=e.getRenderTarget(),y=e.toneMapping,x=e.xr.enabled;e.toneMapping=0,e.xr.enabled=!1;const M=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,o),e.setRenderTarget(i,2),e.render(t,l),e.setRenderTarget(i,3),e.render(t,c),e.setRenderTarget(i,4),e.render(t,h),i.texture.generateMipmaps=M,e.setRenderTarget(i,5),e.render(t,p),e.setRenderTarget(g),e.toneMapping=y,e.xr.enabled=x,i.texture.needsPMREMUpdate=!0}}class qS extends Rd{constructor(e,t,i,r,o,l,c,h,p,g){super(e=void 0!==e?e:[],t=void 0!==t?t:301,i,r,o,l,c,h,p,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class k7 extends Wf{constructor(e,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1};this.texture=new qS([i,i,i,i,i,i],t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:qr}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i_uniforms={tEquirect:{value:null}},i_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",i_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",r=new Bd(5,5,5),o=new Vd({name:"CubemapFromEquirect",uniforms:l_(i_uniforms),vertexShader:i_vertexShader,fragmentShader:i_fragmentShader,side:1,blending:0});o.uniforms.tEquirect.value=t;const l=new po(r,o),c=t.minFilter;return 1008===t.minFilter&&(t.minFilter=qr),new O7(1,10,this).update(e,l),t.minFilter=c,l.geometry.dispose(),l.material.dispose(),this}clear(e,t,i,r){const o=e.getRenderTarget();for(let l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,i,r);e.setRenderTarget(o)}}const PR=new Z,B7=new Z,V7=new ua;class Xf{constructor(e=new Z(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=PR.subVectors(i,t).cross(B7.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(PR),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;const o=-(e.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:t.copy(i).multiplyScalar(o).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||V7.getNormalMatrix(e),r=this.coplanarPoint(PR).applyMatrix4(e),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}const d_=new e_,$S=new Z;class FR{constructor(e=new Xf,t=new Xf,i=new Xf,r=new Xf,o=new Xf,l=new Xf){this.planes=[e,t,i,r,o,l]}set(e,t,i,r,o,l){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(i),c[3].copy(r),c[4].copy(o),c[5].copy(l),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],o=i[1],l=i[2],c=i[3],h=i[4],p=i[5],g=i[6],y=i[7],x=i[8],M=i[9],S=i[10],C=i[11],T=i[12],P=i[13],O=i[14],k=i[15];return t[0].setComponents(c-r,y-h,C-x,k-T).normalize(),t[1].setComponents(c+r,y+h,C+x,k+T).normalize(),t[2].setComponents(c+o,y+p,C+M,k+P).normalize(),t[3].setComponents(c-o,y-p,C-M,k-P).normalize(),t[4].setComponents(c-l,y-g,C-S,k-O).normalize(),t[5].setComponents(c+l,y+g,C+S,k+O).normalize(),this}intersectsObject(e){const t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),d_.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(d_)}intersectsSprite(e){return d_.center.set(0,0,0),d_.radius=.7071067811865476,d_.applyMatrix4(e.matrixWorld),this.intersectsSphere(d_)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let o=0;o<6;o++)if(t[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if($S.x=r.normal.x>0?e.max.x:e.min.x,$S.y=r.normal.y>0?e.max.y:e.min.y,$S.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint($S)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function W3(){let n=null,e=!1,t=null,i=null;function r(o,l){t(o,l),i=n.requestAnimationFrame(r)}return{start:function(){!0!==e&&null!==t&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(o){t=o},setContext:function(o){n=o}}}function U7(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function l(p){return p.isInterleavedBufferAttribute&&(p=p.data),i.get(p)},remove:function c(p){p.isInterleavedBufferAttribute&&(p=p.data);const g=i.get(p);g&&(n.deleteBuffer(g.buffer),i.delete(p))},update:function h(p,g){if(p.isGLBufferAttribute){const x=i.get(p);return void((!x||x.version<p.version)&&i.set(p,{buffer:p.buffer,type:p.type,bytesPerElement:p.elementSize,version:p.version}))}p.isInterleavedBufferAttribute&&(p=p.data);const y=i.get(p);void 0===y?i.set(p,function r(p,g){const y=p.array,x=p.usage,M=n.createBuffer();let S;if(n.bindBuffer(g,M),n.bufferData(g,y,x),p.onUploadCallback(),y instanceof Float32Array)S=5126;else if(y instanceof Uint16Array)if(p.isFloat16BufferAttribute){if(!t)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");S=5131}else S=5123;else if(y instanceof Int16Array)S=5122;else if(y instanceof Uint32Array)S=5125;else if(y instanceof Int32Array)S=5124;else if(y instanceof Int8Array)S=5120;else if(y instanceof Uint8Array)S=5121;else{if(!(y instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+y);S=5121}return{buffer:M,type:S,bytesPerElement:y.BYTES_PER_ELEMENT,version:p.version}}(p,g)):y.version<p.version&&(function o(p,g,y){const x=g.array,M=g.updateRange;n.bindBuffer(y,p),-1===M.count?n.bufferSubData(y,0,x):(t?n.bufferSubData(y,M.offset*x.BYTES_PER_ELEMENT,x,M.offset,M.count):n.bufferSubData(y,M.offset*x.BYTES_PER_ELEMENT,x.subarray(M.offset,M.offset+M.count)),M.count=-1)}(y.buffer,p,g),y.version=p.version)}}}class z0 extends Kn{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const o=e/2,l=t/2,c=Math.floor(i),h=Math.floor(r),p=c+1,g=h+1,y=e/c,x=t/h,M=[],S=[],C=[],T=[];for(let P=0;P<g;P++){const O=P*x-l;for(let k=0;k<p;k++)S.push(k*y-o,-O,0),C.push(0,0,1),T.push(k/c),T.push(1-P/h)}for(let P=0;P<h;P++)for(let O=0;O<c;O++){const B=O+p*(P+1),z=O+1+p*(P+1),q=O+1+p*P;M.push(O+p*P,B,q),M.push(B,z,q)}this.setIndex(M),this.setAttribute("position",new Wt(S,3)),this.setAttribute("normal",new Wt(C,3)),this.setAttribute("uv",new Wt(T,2))}static fromJSON(e){return new z0(e.width,e.height,e.widthSegments,e.heightSegments)}}const Qn={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#ifdef USE_IRIDESCENCE\nvec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\n#endif\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",iridescence_fragment:"#ifdef USE_IRIDESCENCE\nconst mat3 XYZ_TO_REC709 = mat3(\n    3.2404542, -0.9692660,  0.0556434,\n   -1.5371385,  1.8760108, -0.2040259,\n   -0.4985314,  0.0415560,  1.0572252\n);\nvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n   vec3 sqrtF0 = sqrt( fresnel0 );\n   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n}\nvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n}\nfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n}\nvec3 evalSensitivity( float OPD, vec3 shift ) {\n   float phase = 2.0 * PI * OPD * 1.0e-9;\n   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );\n   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );\n   xyz /= 1.0685e-7;\n   vec3 srgb = XYZ_TO_REC709 * xyz;\n   return srgb;\n}\nvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n   vec3 I;\n   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n   float cosTheta2Sq = 1.0 - sinTheta2Sq;\n   if ( cosTheta2Sq < 0.0 ) {\n       return vec3( 1.0 );\n   }\n   float cosTheta2 = sqrt( cosTheta2Sq );\n   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n   float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n   float R21 = R12;\n   float T121 = 1.0 - R12;\n   float phi12 = 0.0;\n   if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n   float phi21 = PI - phi12;\n   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n   vec3 phi23 = vec3( 0.0 );\n   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;\n   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;\n   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;\n   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n   vec3 phi = vec3( phi21 ) + phi23;\n   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n   vec3 r123 = sqrt( R123 );\n   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n   vec3 C0 = R12 + Rs;\n   I = C0;\n   vec3 Cm = Rs - T121;\n   for ( int m = 1; m <= 2; ++m ) {\n       Cm *= r123;\n       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n       I += Cm * Sm;\n   }\n   return max( I, vec3( 0.0 ) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\nfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\nif ( material.iridescenceThickness == 0.0 ) {\n\tmaterial.iridescence = 0.0;\n} else {\n\tmaterial.iridescence = saturate( material.iridescence );\n}\nif ( material.iridescence > 0.0 ) {\n\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},vt={common:{diffuse:{value:new Ft(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ua},uv2Transform:{value:new ua},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ft(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ft(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ua}},sprite:{diffuse:{value:new Ft(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ua}}},Jl={basic:{uniforms:qs([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.fog]),vertexShader:Qn.meshbasic_vert,fragmentShader:Qn.meshbasic_frag},lambert:{uniforms:qs([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.fog,vt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:Qn.meshlambert_vert,fragmentShader:Qn.meshlambert_frag},phong:{uniforms:qs([vt.common,vt.specularmap,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,vt.lights,{emissive:{value:new Ft(0)},specular:{value:new Ft(1118481)},shininess:{value:30}}]),vertexShader:Qn.meshphong_vert,fragmentShader:Qn.meshphong_frag},standard:{uniforms:qs([vt.common,vt.envmap,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.roughnessmap,vt.metalnessmap,vt.fog,vt.lights,{emissive:{value:new Ft(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},toon:{uniforms:qs([vt.common,vt.aomap,vt.lightmap,vt.emissivemap,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.gradientmap,vt.fog,vt.lights,{emissive:{value:new Ft(0)}}]),vertexShader:Qn.meshtoon_vert,fragmentShader:Qn.meshtoon_frag},matcap:{uniforms:qs([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,vt.fog,{matcap:{value:null}}]),vertexShader:Qn.meshmatcap_vert,fragmentShader:Qn.meshmatcap_frag},points:{uniforms:qs([vt.points,vt.fog]),vertexShader:Qn.points_vert,fragmentShader:Qn.points_frag},dashed:{uniforms:qs([vt.common,vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qn.linedashed_vert,fragmentShader:Qn.linedashed_frag},depth:{uniforms:qs([vt.common,vt.displacementmap]),vertexShader:Qn.depth_vert,fragmentShader:Qn.depth_frag},normal:{uniforms:qs([vt.common,vt.bumpmap,vt.normalmap,vt.displacementmap,{opacity:{value:1}}]),vertexShader:Qn.meshnormal_vert,fragmentShader:Qn.meshnormal_frag},sprite:{uniforms:qs([vt.sprite,vt.fog]),vertexShader:Qn.sprite_vert,fragmentShader:Qn.sprite_frag},background:{uniforms:{uvTransform:{value:new ua},t2D:{value:null}},vertexShader:Qn.background_vert,fragmentShader:Qn.background_frag},cube:{uniforms:qs([vt.envmap,{opacity:{value:1}}]),vertexShader:Qn.cube_vert,fragmentShader:Qn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qn.equirect_vert,fragmentShader:Qn.equirect_frag},distanceRGBA:{uniforms:qs([vt.common,vt.displacementmap,{referencePosition:{value:new Z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qn.distanceRGBA_vert,fragmentShader:Qn.distanceRGBA_frag},shadow:{uniforms:qs([vt.lights,vt.fog,{color:{value:new Ft(0)},opacity:{value:1}}]),vertexShader:Qn.shadow_vert,fragmentShader:Qn.shadow_frag}};function B$(n,e,t,i,r,o){const l=new Ft(0);let h,p,c=!0===r?0:1,g=null,y=0,x=null;function S(C,T){t.buffers.color.setClear(C.r,C.g,C.b,T,o)}return{getClearColor:function(){return l},setClearColor:function(C,T=1){l.set(C),c=T,S(l,c)},getClearAlpha:function(){return c},setClearAlpha:function(C){c=C,S(l,c)},render:function M(C,T){let P=!1,O=!0===T.isScene?T.background:null;O&&O.isTexture&&(O=e.get(O));const k=n.xr,B=k.getSession&&k.getSession();B&&"additive"===B.environmentBlendMode&&(O=null),null===O?S(l,c):O&&O.isColor&&(S(O,1),P=!0),(n.autoClear||P)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),O&&(O.isCubeTexture||306===O.mapping)?(void 0===p&&(p=new po(new Bd(1,1,1),new Vd({name:"BackgroundCubeMaterial",uniforms:l_(Jl.cube.uniforms),vertexShader:Jl.cube.vertexShader,fragmentShader:Jl.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),p.geometry.deleteAttribute("uv"),p.onBeforeRender=function(z,q,ne){this.matrixWorld.copyPosition(ne.matrixWorld)},Object.defineProperty(p.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(p)),p.material.uniforms.envMap.value=O,p.material.uniforms.flipEnvMap.value=O.isCubeTexture&&!1===O.isRenderTargetTexture?-1:1,(g!==O||y!==O.version||x!==n.toneMapping)&&(p.material.needsUpdate=!0,g=O,y=O.version,x=n.toneMapping),p.layers.enableAll(),C.unshift(p,p.geometry,p.material,0,0,null)):O&&O.isTexture&&(void 0===h&&(h=new po(new z0(2,2),new Vd({name:"BackgroundMaterial",uniforms:l_(Jl.background.uniforms),vertexShader:Jl.background.vertexShader,fragmentShader:Jl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=O,!0===O.matrixAutoUpdate&&O.updateMatrix(),h.material.uniforms.uvTransform.value.copy(O.matrix),(g!==O||y!==O.version||x!==n.toneMapping)&&(h.material.needsUpdate=!0,g=O,y=O.version,x=n.toneMapping),h.layers.enableAll(),C.unshift(h,h.geometry,h.material,0,0,null))}}}function V$(n,e,t,i){const r=n.getParameter(34921),o=i.isWebGL2?null:e.get("OES_vertex_array_object"),l=i.isWebGL2||null!==o,c={},h=T(null);let p=h,g=!1;function M(ge){return i.isWebGL2?n.bindVertexArray(ge):o.bindVertexArrayOES(ge)}function S(ge){return i.isWebGL2?n.deleteVertexArray(ge):o.deleteVertexArrayOES(ge)}function T(ge){const Pe=[],ae=[],ye=[];for(let xe=0;xe<r;xe++)Pe[xe]=0,ae[xe]=0,ye[xe]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Pe,enabledAttributes:ae,attributeDivisors:ye,object:ge,attributes:{},index:null}}function k(){const ge=p.newAttributes;for(let Pe=0,ae=ge.length;Pe<ae;Pe++)ge[Pe]=0}function B(ge){z(ge,0)}function z(ge,Pe){const ye=p.enabledAttributes,xe=p.attributeDivisors;p.newAttributes[ge]=1,0===ye[ge]&&(n.enableVertexAttribArray(ge),ye[ge]=1),xe[ge]!==Pe&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ge,Pe),xe[ge]=Pe)}function q(){const ge=p.newAttributes,Pe=p.enabledAttributes;for(let ae=0,ye=Pe.length;ae<ye;ae++)Pe[ae]!==ge[ae]&&(n.disableVertexAttribArray(ae),Pe[ae]=0)}function ne(ge,Pe,ae,ye,xe,_e){!0!==i.isWebGL2||5124!==ae&&5125!==ae?n.vertexAttribPointer(ge,Pe,ae,ye,xe,_e):n.vertexAttribIPointer(ge,Pe,ae,xe,_e)}function Oe(){tt(),g=!0,p!==h&&(p=h,M(p.object))}function tt(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:function y(ge,Pe,ae,ye,xe){let _e=!1;if(l){const Se=function C(ge,Pe,ae){const ye=!0===ae.wireframe;let xe=c[ge.id];void 0===xe&&(xe={},c[ge.id]=xe);let _e=xe[Pe.id];void 0===_e&&(_e={},xe[Pe.id]=_e);let Se=_e[ye];return void 0===Se&&(Se=T(function x(){return i.isWebGL2?n.createVertexArray():o.createVertexArrayOES()}()),_e[ye]=Se),Se}(ye,ae,Pe);p!==Se&&(p=Se,M(p.object)),_e=function P(ge,Pe,ae,ye){const xe=p.attributes,_e=Pe.attributes;let Se=0;const Je=ae.getAttributes();for(const Ve in Je)if(Je[Ve].location>=0){const ct=xe[Ve];let $t=_e[Ve];if(void 0===$t&&("instanceMatrix"===Ve&&ge.instanceMatrix&&($t=ge.instanceMatrix),"instanceColor"===Ve&&ge.instanceColor&&($t=ge.instanceColor)),void 0===ct||ct.attribute!==$t||$t&&ct.data!==$t.data)return!0;Se++}return p.attributesNum!==Se||p.index!==ye}(ge,ye,ae,xe),_e&&function O(ge,Pe,ae,ye){const xe={},_e=Pe.attributes;let Se=0;const Je=ae.getAttributes();for(const Ve in Je)if(Je[Ve].location>=0){let ct=_e[Ve];void 0===ct&&("instanceMatrix"===Ve&&ge.instanceMatrix&&(ct=ge.instanceMatrix),"instanceColor"===Ve&&ge.instanceColor&&(ct=ge.instanceColor));const $t={};$t.attribute=ct,ct&&ct.data&&($t.data=ct.data),xe[Ve]=$t,Se++}p.attributes=xe,p.attributesNum=Se,p.index=ye}(ge,ye,ae,xe)}else{const Se=!0===Pe.wireframe;(p.geometry!==ye.id||p.program!==ae.id||p.wireframe!==Se)&&(p.geometry=ye.id,p.program=ae.id,p.wireframe=Se,_e=!0)}null!==xe&&t.update(xe,34963),(_e||g)&&(g=!1,function U(ge,Pe,ae,ye){if(!1===i.isWebGL2&&(ge.isInstancedMesh||ye.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;k();const xe=ye.attributes,_e=ae.getAttributes(),Se=Pe.defaultAttributeValues;for(const Je in _e){const Ve=_e[Je];if(Ve.location>=0){let ot=xe[Je];if(void 0===ot&&("instanceMatrix"===Je&&ge.instanceMatrix&&(ot=ge.instanceMatrix),"instanceColor"===Je&&ge.instanceColor&&(ot=ge.instanceColor)),void 0!==ot){const ct=ot.normalized,$t=ot.itemSize,Ne=t.get(ot);if(void 0===Ne)continue;const bn=Ne.buffer,dn=Ne.type,Kt=Ne.bytesPerElement;if(ot.isInterleavedBufferAttribute){const ft=ot.data,Dn=ft.stride,je=ot.offset;if(ft.isInstancedInterleavedBuffer){for(let ze=0;ze<Ve.locationSize;ze++)z(Ve.location+ze,ft.meshPerAttribute);!0!==ge.isInstancedMesh&&void 0===ye._maxInstanceCount&&(ye._maxInstanceCount=ft.meshPerAttribute*ft.count)}else for(let ze=0;ze<Ve.locationSize;ze++)B(Ve.location+ze);n.bindBuffer(34962,bn);for(let ze=0;ze<Ve.locationSize;ze++)ne(Ve.location+ze,$t/Ve.locationSize,dn,ct,Dn*Kt,(je+$t/Ve.locationSize*ze)*Kt)}else{if(ot.isInstancedBufferAttribute){for(let ft=0;ft<Ve.locationSize;ft++)z(Ve.location+ft,ot.meshPerAttribute);!0!==ge.isInstancedMesh&&void 0===ye._maxInstanceCount&&(ye._maxInstanceCount=ot.meshPerAttribute*ot.count)}else for(let ft=0;ft<Ve.locationSize;ft++)B(Ve.location+ft);n.bindBuffer(34962,bn);for(let ft=0;ft<Ve.locationSize;ft++)ne(Ve.location+ft,$t/Ve.locationSize,dn,ct,$t*Kt,$t/Ve.locationSize*ft*Kt)}}else if(void 0!==Se){const ct=Se[Je];if(void 0!==ct)switch(ct.length){case 2:n.vertexAttrib2fv(Ve.location,ct);break;case 3:n.vertexAttrib3fv(Ve.location,ct);break;case 4:n.vertexAttrib4fv(Ve.location,ct);break;default:n.vertexAttrib1fv(Ve.location,ct)}}}}q()}(ge,Pe,ae,ye),null!==xe&&n.bindBuffer(34963,t.get(xe).buffer))},reset:Oe,resetDefaultState:tt,dispose:function ee(){Oe();for(const ge in c){const Pe=c[ge];for(const ae in Pe){const ye=Pe[ae];for(const xe in ye)S(ye[xe].object),delete ye[xe];delete Pe[ae]}delete c[ge]}},releaseStatesOfGeometry:function le(ge){if(void 0===c[ge.id])return;const Pe=c[ge.id];for(const ae in Pe){const ye=Pe[ae];for(const xe in ye)S(ye[xe].object),delete ye[xe];delete Pe[ae]}delete c[ge.id]},releaseStatesOfProgram:function me(ge){for(const Pe in c){const ae=c[Pe];if(void 0===ae[ge.id])continue;const ye=ae[ge.id];for(const xe in ye)S(ye[xe].object),delete ye[xe];delete ae[ge.id]}},initAttributes:k,enableAttribute:B,disableUnusedAttributes:q}}function U$(n,e,t,i){const r=i.isWebGL2;let o;this.setMode=function l(p){o=p},this.render=function c(p,g){n.drawArrays(o,p,g),t.update(g,o,1)},this.renderInstances=function h(p,g,y){if(0===y)return;let x,M;if(r)x=n,M="drawArraysInstanced";else if(x=e.get("ANGLE_instanced_arrays"),M="drawArraysInstancedANGLE",null===x)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");x[M](o,p,g,y),t.update(g,o,y)}}function z$(n,e,t){let i;function o(ne){if("highp"===ne){if(n.getShaderPrecisionFormat(35633,36338).precision>0&&n.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";ne="mediump"}return"mediump"===ne&&n.getShaderPrecisionFormat(35633,36337).precision>0&&n.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const l="undefined"!=typeof WebGL2RenderingContext&&n instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&n instanceof WebGL2ComputeRenderingContext;let c=void 0!==t.precision?t.precision:"highp";const h=o(c);h!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",h,"instead."),c=h);const p=l||e.has("WEBGL_draw_buffers"),g=!0===t.logarithmicDepthBuffer,y=n.getParameter(34930),x=n.getParameter(35660),M=n.getParameter(3379),S=n.getParameter(34076),C=n.getParameter(34921),T=n.getParameter(36347),P=n.getParameter(36348),O=n.getParameter(36349),k=x>0,B=l||e.has("OES_texture_float");return{isWebGL2:l,drawBuffers:p,getMaxAnisotropy:function r(){if(void 0!==i)return i;if(!0===e.has("EXT_texture_filter_anisotropic")){const ne=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(ne.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i},getMaxPrecision:o,precision:c,logarithmicDepthBuffer:g,maxTextures:y,maxVertexTextures:x,maxTextureSize:M,maxCubemapSize:S,maxAttributes:C,maxVertexUniforms:T,maxVaryings:P,maxFragmentUniforms:O,vertexTextures:k,floatFragmentTextures:B,floatVertexTextures:k&&B,maxSamples:l?n.getParameter(36183):0}}function H$(n){const e=this;let t=null,i=0,r=!1,o=!1;const l=new Xf,c=new ua,h={value:null,needsUpdate:!1};function p(){h.value!==t&&(h.value=t,h.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function g(y,x,M,S){const C=null!==y?y.length:0;let T=null;if(0!==C){if(T=h.value,!0!==S||null===T){const P=M+4*C,O=x.matrixWorldInverse;c.getNormalMatrix(O),(null===T||T.length<P)&&(T=new Float32Array(P));for(let k=0,B=M;k!==C;++k,B+=4)l.copy(y[k]).applyMatrix4(O,c),l.normal.toArray(T,B),T[B+3]=l.constant}h.value=T,h.needsUpdate=!0}return e.numPlanes=C,e.numIntersection=0,T}this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(y,x,M){const S=0!==y.length||x||0!==i||r;return r=x,t=g(y,M,0),i=y.length,S},this.beginShadows=function(){o=!0,g(null)},this.endShadows=function(){o=!1,p()},this.setState=function(y,x,M){const S=y.clippingPlanes,C=y.clipIntersection,T=y.clipShadows,P=n.get(y);if(!r||null===S||0===S.length||o&&!T)o?g(null):p();else{const O=o?0:i,k=4*O;let B=P.clippingState||null;h.value=B,B=g(S,x,k,M);for(let z=0;z!==k;++z)B[z]=t[z];P.clippingState=B,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=O}}}function G$(n){let e=new WeakMap;function t(l,c){return 303===c?l.mapping=301:304===c&&(l.mapping=302),l}function r(l){const c=l.target;c.removeEventListener("dispose",r);const h=e.get(c);void 0!==h&&(e.delete(c),h.dispose())}return{get:function i(l){if(l&&l.isTexture&&!1===l.isRenderTargetTexture){const c=l.mapping;if(303===c||304===c){if(e.has(l))return t(e.get(l).texture,l.mapping);{const h=l.image;if(h&&h.height>0){const p=new k7(h.height/2);return p.fromEquirectangularTexture(n,l),e.set(l,p),l.addEventListener("dispose",r),t(p.texture,l.mapping)}return null}}}return l},dispose:function o(){e=new WeakMap}}}Jl.physical={uniforms:qs([Jl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ft(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ft(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ft(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag};class NR extends LR{constructor(e=-1,t=1,i=1,r=-1,o=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=o,this.far=l,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,o,l){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let o=i-e,l=i+e,c=r+t,h=r-t;if(null!==this.view&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,l=o+p*this.view.width,c-=g*this.view.offsetY,h=c-g*this.view.height}this.projectionMatrix.makeOrthographic(o,l,c,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}const j3=[.125,.215,.35,.446,.526,.582],OR=new NR,q3=new Ft;let kR=null;const Yf=(1+Math.sqrt(5))/2,f_=1/Yf,$3=[new Z(1,1,1),new Z(-1,1,1),new Z(1,1,-1),new Z(-1,1,-1),new Z(0,Yf,f_),new Z(0,Yf,-f_),new Z(f_,0,Yf),new Z(-f_,0,Yf),new Z(Yf,f_,0),new Z(-Yf,f_,0)];class X3{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){kR=this._renderer.getRenderTarget(),this._setSize(256);const o=this._allocateTargets();return o.depthBuffer=!0,this._sceneToCubeUV(e,i,r,o),t>0&&this._blur(o,0,0,t),this._applyPMREM(o),this._cleanup(o),o}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=J3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=Y3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(kR),e.scissorTest=!1,XS(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSize(301===e.mapping||302===e.mapping?0===e.image.length?16:e.image[0].width||e.image[0].image.width:e.image.width/4),kR=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:qr,minFilter:qr,generateMipmaps:!1,type:F0,format:dl,encoding:Uf,depthBuffer:!1},r=Z3(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Z3(e,t,i);const{_lodMax:o}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function W$(n){const e=[],t=[],i=[];let r=n;const o=n-4+1+j3.length;for(let l=0;l<o;l++){const c=Math.pow(2,r);t.push(c);let h=1/c;l>n-4?h=j3[l-n+4-1]:0===l&&(h=0),i.push(h);const p=1/(c-2),g=-p,y=1+p,x=[g,g,y,g,y,y,g,g,y,y,g,y],M=6,S=6,C=3,T=2,P=1,O=new Float32Array(C*S*M),k=new Float32Array(T*S*M),B=new Float32Array(P*S*M);for(let q=0;q<M;q++){const ne=q%3*2/3-1,U=q>2?0:-1;O.set([ne,U,0,ne+2/3,U,0,ne+2/3,U+1,0,ne,U,0,ne+2/3,U+1,0,ne,U+1,0],C*S*q),k.set(x,T*S*q),B.set([q,q,q,q,q,q],P*S*q)}const z=new Kn;z.setAttribute("position",new ys(O,C)),z.setAttribute("uv",new ys(k,T)),z.setAttribute("faceIndex",new ys(B,P)),e.push(z),r>4&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}(o)),this._blurMaterial=function j$(n,e,t){const i=new Float32Array(20),r=new Z(0,1,0);return new Vd({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(o,e,t)}return r}_compileMaterial(e){const t=new po(this._lodPlanes[0],e);this._renderer.compile(t,OR)}_sceneToCubeUV(e,t,i,r){const c=new Ds(90,1,t,i),h=[1,-1,1,1,1,1],p=[1,1,1,-1,-1,-1],g=this._renderer,y=g.autoClear,x=g.toneMapping;g.getClearColor(q3),g.toneMapping=0,g.autoClear=!1;const M=new Kc({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),S=new po(new Bd,M);let C=!1;const T=e.background;T?T.isColor&&(M.color.copy(T),e.background=null,C=!0):(M.color.copy(q3),C=!0);for(let P=0;P<6;P++){const O=P%3;0===O?(c.up.set(0,h[P],0),c.lookAt(p[P],0,0)):1===O?(c.up.set(0,0,h[P]),c.lookAt(0,p[P],0)):(c.up.set(0,h[P],0),c.lookAt(0,0,p[P]));const k=this._cubeSize;XS(r,O*k,P>2?k:0,k,k),g.setRenderTarget(r),C&&g.render(S,c),g.render(e,c)}S.geometry.dispose(),S.material.dispose(),g.toneMapping=x,g.autoClear=y,e.background=T}_textureToCubeUV(e,t){const i=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=J3()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=Y3());const o=r?this._cubemapMaterial:this._equirectMaterial,l=new po(this._lodPlanes[0],o);o.uniforms.envMap.value=e;const h=this._cubeSize;XS(t,0,0,3*h,2*h),i.setRenderTarget(t),i.render(l,OR)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const o=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]);this._blur(e,r-1,r,o,$3[(r-1)%$3.length])}t.autoClear=i}_blur(e,t,i,r,o){const l=this._pingPongRenderTarget;this._halfBlur(e,l,t,i,r,"latitudinal",o),this._halfBlur(l,e,i,i,r,"longitudinal",o)}_halfBlur(e,t,i,r,o,l,c){const h=this._renderer,p=this._blurMaterial;"latitudinal"!==l&&"longitudinal"!==l&&console.error("blur direction must be either latitudinal or longitudinal!");const y=new po(this._lodPlanes[r],p),x=p.uniforms,M=this._sizeLods[i]-1,S=isFinite(o)?Math.PI/(2*M):2*Math.PI/39,C=o/S,T=isFinite(o)?1+Math.floor(3*C):20;T>20&&console.warn(`sigmaRadians, ${o}, is too large and will clip, as it requested ${T} samples when the maximum is set to 20`);const P=[];let O=0;for(let ne=0;ne<20;++ne){const U=ne/C,ee=Math.exp(-U*U/2);P.push(ee),0===ne?O+=ee:ne<T&&(O+=2*ee)}for(let ne=0;ne<P.length;ne++)P[ne]=P[ne]/O;x.envMap.value=e.texture,x.samples.value=T,x.weights.value=P,x.latitudinal.value="latitudinal"===l,c&&(x.poleAxis.value=c);const{_lodMax:k}=this;x.dTheta.value=S,x.mipInt.value=k-i;const B=this._sizeLods[r];XS(t,3*B*(r>k-4?r-k+4:0),4*(this._cubeSize-B),3*B,2*B),h.setRenderTarget(t),h.render(y,OR)}}function Z3(n,e,t){const i=new Wf(n,e,t);return i.texture.mapping=306,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function XS(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Y3(){return new Vd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function J3(){return new Vd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function q$(n){let e=new WeakMap,t=null;function o(c){const h=c.target;h.removeEventListener("dispose",o);const p=e.get(h);void 0!==p&&(e.delete(h),p.dispose())}return{get:function i(c){if(c&&c.isTexture){const h=c.mapping,p=303===h||304===h,g=301===h||302===h;if(p||g){if(c.isRenderTargetTexture&&!0===c.needsPMREMUpdate){c.needsPMREMUpdate=!1;let y=e.get(c);return null===t&&(t=new X3(n)),y=p?t.fromEquirectangular(c,y):t.fromCubemap(c,y),e.set(c,y),y.texture}if(e.has(c))return e.get(c).texture;{const y=c.image;if(p&&y&&y.height>0||g&&y&&function r(c){let h=0;for(let g=0;g<6;g++)void 0!==c[g]&&h++;return 6===h}(y)){null===t&&(t=new X3(n));const x=p?t.fromEquirectangular(c):t.fromCubemap(c);return e.set(c,x),c.addEventListener("dispose",o),x.texture}return null}}}return c},dispose:function l(){e=new WeakMap,null!==t&&(t.dispose(),t=null)}}}function $$(n){const e={};function t(i){if(void 0!==e[i])return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return null!==t(i)},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return null===r&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function X$(n,e,t,i){const r={},o=new WeakMap;function l(y){const x=y.target;null!==x.index&&e.remove(x.index);for(const S in x.attributes)e.remove(x.attributes[S]);x.removeEventListener("dispose",l),delete r[x.id];const M=o.get(x);M&&(e.remove(M),o.delete(x)),i.releaseStatesOfGeometry(x),!0===x.isInstancedBufferGeometry&&delete x._maxInstanceCount,t.memory.geometries--}function p(y){const x=[],M=y.index,S=y.attributes.position;let C=0;if(null!==M){const O=M.array;C=M.version;for(let k=0,B=O.length;k<B;k+=3){const z=O[k+0],q=O[k+1],ne=O[k+2];x.push(z,q,q,ne,ne,z)}}else{C=S.version;for(let k=0,B=S.array.length/3-1;k<B;k+=3){const z=k+0,q=k+1,ne=k+2;x.push(z,q,q,ne,ne,z)}}const T=new(T3(x)?H3:z3)(x,1);T.version=C;const P=o.get(y);P&&e.remove(P),o.set(y,T)}return{get:function c(y,x){return!0===r[x.id]||(x.addEventListener("dispose",l),r[x.id]=!0,t.memory.geometries++),x},update:function h(y){const x=y.attributes;for(const S in x)e.update(x[S],34962);const M=y.morphAttributes;for(const S in M){const C=M[S];for(let T=0,P=C.length;T<P;T++)e.update(C[T],34962)}},getWireframeAttribute:function g(y){const x=o.get(y);if(x){const M=y.index;null!==M&&x.version<M.version&&p(y)}else p(y);return o.get(y)}}}function Z$(n,e,t,i){const r=i.isWebGL2;let o,c,h;this.setMode=function l(x){o=x},this.setIndex=function p(x){c=x.type,h=x.bytesPerElement},this.render=function g(x,M){n.drawElements(o,M,c,x*h),t.update(M,o,1)},this.renderInstances=function y(x,M,S){if(0===S)return;let C,T;if(r)C=n,T="drawElementsInstanced";else if(C=e.get("ANGLE_instanced_arrays"),T="drawElementsInstancedANGLE",null===C)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");C[T](o,M,c,x*h,S),t.update(M,o,S)}}function Y$(n){const t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function r(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function i(o,l,c){switch(t.calls++,l){case 4:t.triangles+=c*(o/3);break;case 1:t.lines+=c*(o/2);break;case 3:t.lines+=c*(o-1);break;case 2:t.lines+=c*o;break;case 0:t.points+=c*o;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",l)}}}}function J$(n,e){return n[0]-e[0]}function K$(n,e){return Math.abs(e[1])-Math.abs(n[1])}function VR(n,e){let t=1;const i=e.isInterleavedBufferAttribute?e.data.array:e.array;i instanceof Int8Array?t=127:i instanceof Uint8Array?t=255:i instanceof Uint16Array?t=65535:i instanceof Int16Array?t=32767:i instanceof Int32Array?t=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),n.divideScalar(t)}function Q$(n,e,t){const i={},r=new Float32Array(8),o=new WeakMap,l=new Bi,c=[];for(let p=0;p<8;p++)c[p]=[p,0];return{update:function h(p,g,y,x){const M=p.morphTargetInfluences;if(!0===e.isWebGL2){const S=g.morphAttributes.position||g.morphAttributes.normal||g.morphAttributes.color,C=void 0!==S?S.length:0;let T=o.get(g);if(void 0===T||T.count!==C){let Pe=function(){tt.dispose(),o.delete(g),g.removeEventListener("dispose",Pe)};void 0!==T&&T.texture.dispose();const k=void 0!==g.morphAttributes.position,B=void 0!==g.morphAttributes.normal,z=void 0!==g.morphAttributes.color,q=g.morphAttributes.position||[],ne=g.morphAttributes.normal||[],U=g.morphAttributes.color||[];let ee=0;!0===k&&(ee=1),!0===B&&(ee=2),!0===z&&(ee=3);let le=g.attributes.position.count*ee,me=1;le>e.maxTextureSize&&(me=Math.ceil(le/e.maxTextureSize),le=e.maxTextureSize);const Oe=new Float32Array(le*me*4*C),tt=new fR(Oe,le,me,C);tt.type=Dd,tt.needsUpdate=!0;const ge=4*ee;for(let ae=0;ae<C;ae++){const ye=q[ae],xe=ne[ae],_e=U[ae],Se=le*me*4*ae;for(let Je=0;Je<ye.count;Je++){const Ve=Je*ge;!0===k&&(l.fromBufferAttribute(ye,Je),!0===ye.normalized&&VR(l,ye),Oe[Se+Ve+0]=l.x,Oe[Se+Ve+1]=l.y,Oe[Se+Ve+2]=l.z,Oe[Se+Ve+3]=0),!0===B&&(l.fromBufferAttribute(xe,Je),!0===xe.normalized&&VR(l,xe),Oe[Se+Ve+4]=l.x,Oe[Se+Ve+5]=l.y,Oe[Se+Ve+6]=l.z,Oe[Se+Ve+7]=0),!0===z&&(l.fromBufferAttribute(_e,Je),!0===_e.normalized&&VR(l,_e),Oe[Se+Ve+8]=l.x,Oe[Se+Ve+9]=l.y,Oe[Se+Ve+10]=l.z,Oe[Se+Ve+11]=4===_e.itemSize?l.w:1)}}T={count:C,texture:tt,size:new Xe(le,me)},o.set(g,T),g.addEventListener("dispose",Pe)}let P=0;for(let k=0;k<M.length;k++)P+=M[k];const O=g.morphTargetsRelative?1:1-P;x.getUniforms().setValue(n,"morphTargetBaseInfluence",O),x.getUniforms().setValue(n,"morphTargetInfluences",M),x.getUniforms().setValue(n,"morphTargetsTexture",T.texture,t),x.getUniforms().setValue(n,"morphTargetsTextureSize",T.size)}else{const S=void 0===M?0:M.length;let C=i[g.id];if(void 0===C||C.length!==S){C=[];for(let B=0;B<S;B++)C[B]=[B,0];i[g.id]=C}for(let B=0;B<S;B++){const z=C[B];z[0]=B,z[1]=M[B]}C.sort(K$);for(let B=0;B<8;B++)B<S&&C[B][1]?(c[B][0]=C[B][0],c[B][1]=C[B][1]):(c[B][0]=Number.MAX_SAFE_INTEGER,c[B][1]=0);c.sort(J$);const T=g.morphAttributes.position,P=g.morphAttributes.normal;let O=0;for(let B=0;B<8;B++){const z=c[B],q=z[0],ne=z[1];q!==Number.MAX_SAFE_INTEGER&&ne?(T&&g.getAttribute("morphTarget"+B)!==T[q]&&g.setAttribute("morphTarget"+B,T[q]),P&&g.getAttribute("morphNormal"+B)!==P[q]&&g.setAttribute("morphNormal"+B,P[q]),r[B]=ne,O+=ne):(T&&!0===g.hasAttribute("morphTarget"+B)&&g.deleteAttribute("morphTarget"+B),P&&!0===g.hasAttribute("morphNormal"+B)&&g.deleteAttribute("morphNormal"+B),r[B]=0)}const k=g.morphTargetsRelative?1:1-O;x.getUniforms().setValue(n,"morphTargetBaseInfluence",k),x.getUniforms().setValue(n,"morphTargetInfluences",r)}}}}function eX(n,e,t,i){let r=new WeakMap;function c(h){const p=h.target;p.removeEventListener("dispose",c),t.remove(p.instanceMatrix),null!==p.instanceColor&&t.remove(p.instanceColor)}return{update:function o(h){const p=i.render.frame,y=e.get(h,h.geometry);return r.get(y)!==p&&(e.update(y),r.set(y,p)),h.isInstancedMesh&&(!1===h.hasEventListener("dispose",c)&&h.addEventListener("dispose",c),t.update(h.instanceMatrix,34962),null!==h.instanceColor&&t.update(h.instanceColor,34962)),y},dispose:function l(){r=new WeakMap}}}const K3=new Rd,Q3=new fR,ek=new R3,tk=new qS,nk=[],ik=[],rk=new Float32Array(16),sk=new Float32Array(9),ok=new Float32Array(4);function p_(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let o=nk[r];if(void 0===o&&(o=new Float32Array(r),nk[r]=o),0!==e){i.toArray(o,0);for(let l=1,c=0;l!==e;++l)c+=t,n[l].toArray(o,c)}return o}function mo(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function go(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function ZS(n,e){let t=ik[e];void 0===t&&(t=new Int32Array(e),ik[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function tX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function nX(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(mo(t,e))return;n.uniform2fv(this.addr,e),go(t,e)}}function iX(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(void 0!==e.r)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(mo(t,e))return;n.uniform3fv(this.addr,e),go(t,e)}}function rX(n,e){const t=this.cache;if(void 0!==e.x)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(mo(t,e))return;n.uniform4fv(this.addr,e),go(t,e)}}function sX(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(mo(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),go(t,e)}else{if(mo(t,i))return;ok.set(i),n.uniformMatrix2fv(this.addr,!1,ok),go(t,i)}}function oX(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(mo(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),go(t,e)}else{if(mo(t,i))return;sk.set(i),n.uniformMatrix3fv(this.addr,!1,sk),go(t,i)}}function aX(n,e){const t=this.cache,i=e.elements;if(void 0===i){if(mo(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),go(t,e)}else{if(mo(t,i))return;rk.set(i),n.uniformMatrix4fv(this.addr,!1,rk),go(t,i)}}function lX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function cX(n,e){const t=this.cache;mo(t,e)||(n.uniform2iv(this.addr,e),go(t,e))}function uX(n,e){const t=this.cache;mo(t,e)||(n.uniform3iv(this.addr,e),go(t,e))}function dX(n,e){const t=this.cache;mo(t,e)||(n.uniform4iv(this.addr,e),go(t,e))}function hX(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function fX(n,e){const t=this.cache;mo(t,e)||(n.uniform2uiv(this.addr,e),go(t,e))}function pX(n,e){const t=this.cache;mo(t,e)||(n.uniform3uiv(this.addr,e),go(t,e))}function mX(n,e){const t=this.cache;mo(t,e)||(n.uniform4uiv(this.addr,e),go(t,e))}function gX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2D(e||K3,r)}function _X(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||ek,r)}function yX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||tk,r)}function vX(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Q3,r)}function bX(n,e){n.uniform1fv(this.addr,e)}function wX(n,e){const t=p_(e,this.size,2);n.uniform2fv(this.addr,t)}function MX(n,e){const t=p_(e,this.size,3);n.uniform3fv(this.addr,t)}function SX(n,e){const t=p_(e,this.size,4);n.uniform4fv(this.addr,t)}function EX(n,e){const t=p_(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function CX(n,e){const t=p_(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function TX(n,e){const t=p_(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function AX(n,e){n.uniform1iv(this.addr,e)}function DX(n,e){n.uniform2iv(this.addr,e)}function RX(n,e){n.uniform3iv(this.addr,e)}function IX(n,e){n.uniform4iv(this.addr,e)}function LX(n,e){n.uniform1uiv(this.addr,e)}function PX(n,e){n.uniform2uiv(this.addr,e)}function FX(n,e){n.uniform3uiv(this.addr,e)}function NX(n,e){n.uniform4uiv(this.addr,e)}function OX(n,e,t){const i=e.length,r=ZS(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2D(e[o]||K3,r[o])}function kX(n,e,t){const i=e.length,r=ZS(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture3D(e[o]||ek,r[o])}function BX(n,e,t){const i=e.length,r=ZS(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTextureCube(e[o]||tk,r[o])}function VX(n,e,t){const i=e.length,r=ZS(t,i);n.uniform1iv(this.addr,r);for(let o=0;o!==i;++o)t.setTexture2DArray(e[o]||Q3,r[o])}class zX{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function xX(n){switch(n){case 5126:return tX;case 35664:return nX;case 35665:return iX;case 35666:return rX;case 35674:return sX;case 35675:return oX;case 35676:return aX;case 5124:case 35670:return lX;case 35667:case 35671:return cX;case 35668:case 35672:return uX;case 35669:case 35673:return dX;case 5125:return hX;case 36294:return fX;case 36295:return pX;case 36296:return mX;case 35678:case 36198:case 36298:case 36306:case 35682:return gX;case 35679:case 36299:case 36307:return _X;case 35680:case 36300:case 36308:case 36293:return yX;case 36289:case 36303:case 36311:case 36292:return vX}}(t.type)}}class HX{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function UX(n){switch(n){case 5126:return bX;case 35664:return wX;case 35665:return MX;case 35666:return SX;case 35674:return EX;case 35675:return CX;case 35676:return TX;case 5124:case 35670:return AX;case 35667:case 35671:return DX;case 35668:case 35672:return RX;case 35669:case 35673:return IX;case 5125:return LX;case 36294:return PX;case 36295:return FX;case 36296:return NX;case 35678:case 36198:case 36298:case 36306:case 35682:return OX;case 35679:case 36299:case 36307:return kX;case 35680:case 36300:case 36308:case 36293:return BX;case 36289:case 36303:case 36311:case 36292:return VX}}(t.type)}}class GX{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let o=0,l=r.length;o!==l;++o){const c=r[o];c.setValue(e,t[c.id],i)}}}const UR=/(\w+)(\])?(\[|\.)?/g;function ak(n,e){n.seq.push(e),n.map[e.id]=e}function WX(n,e,t){const i=n.name,r=i.length;for(UR.lastIndex=0;;){const o=UR.exec(i),l=UR.lastIndex;let c=o[1];const p=o[3];if("]"===o[2]&&(c|=0),void 0===p||"["===p&&l+2===r){ak(t,void 0===p?new zX(c,n,e):new HX(c,n,e));break}{let y=t.map[c];void 0===y&&(y=new GX(c),ak(t,y)),t=y}}}class YS{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let r=0;r<i;++r){const o=e.getActiveUniform(t,r);WX(o,e.getUniformLocation(t,o.name),this)}}setValue(e,t,i,r){const o=this.map[t];void 0!==o&&o.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let o=0,l=t.length;o!==l;++o){const c=t[o],h=i[c.id];!1!==h.needsUpdate&&c.setValue(e,h.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,o=e.length;r!==o;++r){const l=e[r];l.id in t&&i.push(l)}return i}}function lk(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}let jX=0;function ck(n,e,t){const i=n.getShaderParameter(e,35713),r=n.getShaderInfoLog(e).trim();if(i&&""===r)return"";const o=/ERROR: 0:(\d+)/.exec(r);if(o){const l=parseInt(o[1]);return t.toUpperCase()+"\n\n"+r+"\n\n"+function qX(n,e){const t=n.split("\n"),i=[],r=Math.max(e-6,0),o=Math.min(e+6,t.length);for(let l=r;l<o;l++){const c=l+1;i.push(`${c===e?">":" "} ${c}: ${t[l]}`)}return i.join("\n")}(n.getShaderSource(e),l)}return r}function XX(n,e){const t=function $X(n){switch(n){case Uf:return["Linear","( value )"];case Er:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}(e);return"vec4 "+n+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function ZX(n,e){let t;switch(e){case 1:t="Linear";break;case 2:t="Reinhard";break;case 3:t="OptimizedCineon";break;case 4:t="ACESFilmic";break;case 5:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function H0(n){return""!==n}function uk(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function dk(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const QX=/^[ \t]*#include +<([\w\d./]+)>/gm;function zR(n){return n.replace(QX,eZ)}function eZ(n,e){const t=Qn[e];if(void 0===t)throw new Error("Can not resolve #include <"+e+">");return zR(t)}const tZ=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,nZ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function hk(n){return n.replace(nZ,fk).replace(tZ,iZ)}function iZ(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),fk(0,e,t,i)}function fk(n,e,t,i){let r="";for(let o=parseInt(e);o<parseInt(t);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function pk(n){let e="precision "+n.precision+" float;\nprecision "+n.precision+" int;";return"highp"===n.precision?e+="\n#define HIGH_PRECISION":"mediump"===n.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===n.precision&&(e+="\n#define LOW_PRECISION"),e}function cZ(n,e,t,i){const r=n.getContext(),o=t.defines;let l=t.vertexShader,c=t.fragmentShader;const h=function rZ(n){let e="SHADOWMAP_TYPE_BASIC";return 1===n.shadowMapType?e="SHADOWMAP_TYPE_PCF":2===n.shadowMapType?e="SHADOWMAP_TYPE_PCF_SOFT":3===n.shadowMapType&&(e="SHADOWMAP_TYPE_VSM"),e}(t),p=function sZ(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case 301:case 302:e="ENVMAP_TYPE_CUBE";break;case 306:e="ENVMAP_TYPE_CUBE_UV"}return e}(t),g=function oZ(n){let e="ENVMAP_MODE_REFLECTION";return n.envMap&&302===n.envMapMode&&(e="ENVMAP_MODE_REFRACTION"),e}(t),y=function aZ(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case 0:e="ENVMAP_BLENDING_MULTIPLY";break;case 1:e="ENVMAP_BLENDING_MIX";break;case 2:e="ENVMAP_BLENDING_ADD"}return e}(t),x=function lZ(n){const e=n.envMapCubeUVHeight;if(null===e)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:i,maxMip:t}}(t),M=t.isWebGL2?"":function YX(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.tangentSpaceNormalMap||n.clearcoatNormalMap||n.flatShading||"physical"===n.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(H0).join("\n")}(t),S=function JX(n){const e=[];for(const t in n){const i=n[t];!1!==i&&e.push("#define "+t+" "+i)}return e.join("\n")}(o),C=r.createProgram();let T,P,O=t.glslVersion?"#version "+t.glslVersion+"\n":"";t.isRawShaderMaterial?(T=[S].filter(H0).join("\n"),T.length>0&&(T+="\n"),P=[M,S].filter(H0).join("\n"),P.length>0&&(P+="\n")):(T=[pk(t),"#define SHADER_NAME "+t.shaderName,S,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&!1===t.flatShading?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(H0).join("\n"),P=[M,pk(t),"#define SHADER_NAME "+t.shaderName,S,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",t.envMap?"#define "+y:"",x?"#define CUBEUV_TEXEL_WIDTH "+x.texelWidth:"",x?"#define CUBEUV_TEXEL_HEIGHT "+x.texelHeight:"",x?"#define CUBEUV_MAX_MIP "+x.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==t.toneMapping?"#define TONE_MAPPING":"",0!==t.toneMapping?Qn.tonemapping_pars_fragment:"",0!==t.toneMapping?ZX("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Qn.encodings_pars_fragment,XX("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"","\n"].filter(H0).join("\n")),l=zR(l),l=uk(l,t),l=dk(l,t),c=zR(c),c=uk(c,t),c=dk(c,t),l=hk(l),c=hk(c),t.isWebGL2&&!0!==t.isRawShaderMaterial&&(O="#version 300 es\n",T=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+T,P=["#define varying in","300 es"===t.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===t.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+P);const B=O+P+c,z=lk(r,35633,O+T+l),q=lk(r,35632,B);if(r.attachShader(C,z),r.attachShader(C,q),void 0!==t.index0AttributeName?r.bindAttribLocation(C,0,t.index0AttributeName):!0===t.morphTargets&&r.bindAttribLocation(C,0,"position"),r.linkProgram(C),n.debug.checkShaderErrors){const ee=r.getProgramInfoLog(C).trim(),le=r.getShaderInfoLog(z).trim(),me=r.getShaderInfoLog(q).trim();let Oe=!0,tt=!0;if(!1===r.getProgramParameter(C,35714)){Oe=!1;const ge=ck(r,z,"vertex"),Pe=ck(r,q,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(C,35715)+"\n\nProgram Info Log: "+ee+"\n"+ge+"\n"+Pe)}else""!==ee?console.warn("THREE.WebGLProgram: Program Info Log:",ee):(""===le||""===me)&&(tt=!1);tt&&(this.diagnostics={runnable:Oe,programLog:ee,vertexShader:{log:le,prefix:T},fragmentShader:{log:me,prefix:P}})}let ne,U;return r.deleteShader(z),r.deleteShader(q),this.getUniforms=function(){return void 0===ne&&(ne=new YS(r,C)),ne},this.getAttributes=function(){return void 0===U&&(U=function KX(n,e){const t={},i=n.getProgramParameter(e,35721);for(let r=0;r<i;r++){const o=n.getActiveAttrib(e,r),l=o.name;let c=1;35674===o.type&&(c=2),35675===o.type&&(c=3),35676===o.type&&(c=4),t[l]={type:o.type,location:n.getAttribLocation(e,l),locationSize:c}}return t}(r,C)),U},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(C),this.program=void 0},this.name=t.shaderName,this.id=jX++,this.cacheKey=e,this.usedTimes=1,this.program=C,this.vertexShader=z,this.fragmentShader=q,this}let uZ=0;class dZ{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const i=e.fragmentShader,r=this._getShaderStage(e.vertexShader),o=this._getShaderStage(i),l=this._getShaderCacheForMaterial(e);return!1===l.has(r)&&(l.add(r),r.usedTimes++),!1===l.has(o)&&(l.add(o),o.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,0===i.usedTimes&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;return!1===t.has(e)&&t.set(e,new Set),t.get(e)}_getShaderStage(e){const t=this.shaderCache;if(!1===t.has(e)){const i=new hZ(e);t.set(e,i)}return t.get(e)}}class hZ{constructor(e){this.id=uZ++,this.code=e,this.usedTimes=0}}function fZ(n,e,t,i,r,o,l){const c=new bR,h=new dZ,p=[],g=r.isWebGL2,y=r.logarithmicDepthBuffer,x=r.vertexTextures;let M=r.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function C(U,ee,le,me,Oe){const tt=me.fog,ge=Oe.geometry,ae=(U.isMeshStandardMaterial?t:e).get(U.envMap||(U.isMeshStandardMaterial?me.environment:null)),ye=ae&&306===ae.mapping?ae.image.height:null,xe=S[U.type];null!==U.precision&&(M=r.getMaxPrecision(U.precision),M!==U.precision&&console.warn("THREE.WebGLProgram.getParameters:",U.precision,"not supported, using",M,"instead."));const _e=ge.morphAttributes.position||ge.morphAttributes.normal||ge.morphAttributes.color,Se=void 0!==_e?_e.length:0;let Ve,ot,ct,$t,Je=0;if(void 0!==ge.morphAttributes.position&&(Je=1),void 0!==ge.morphAttributes.normal&&(Je=2),void 0!==ge.morphAttributes.color&&(Je=3),xe){const Dn=Jl[xe];Ve=Dn.vertexShader,ot=Dn.fragmentShader}else Ve=U.vertexShader,ot=U.fragmentShader,h.update(U),ct=h.getVertexShaderID(U),$t=h.getFragmentShaderID(U);const Ne=n.getRenderTarget(),dn=U.clearcoat>0,Kt=U.iridescence>0;return{isWebGL2:g,shaderID:xe,shaderName:U.type,vertexShader:Ve,fragmentShader:ot,defines:U.defines,customVertexShaderID:ct,customFragmentShaderID:$t,isRawShaderMaterial:!0===U.isRawShaderMaterial,glslVersion:U.glslVersion,precision:M,instancing:!0===Oe.isInstancedMesh,instancingColor:!0===Oe.isInstancedMesh&&null!==Oe.instanceColor,supportsVertexTextures:x,outputEncoding:null===Ne?n.outputEncoding:!0===Ne.isXRRenderTarget?Ne.texture.encoding:Uf,map:!!U.map,matcap:!!U.matcap,envMap:!!ae,envMapMode:ae&&ae.mapping,envMapCubeUVHeight:ye,lightMap:!!U.lightMap,aoMap:!!U.aoMap,emissiveMap:!!U.emissiveMap,bumpMap:!!U.bumpMap,normalMap:!!U.normalMap,objectSpaceNormalMap:1===U.normalMapType,tangentSpaceNormalMap:0===U.normalMapType,decodeVideoTexture:!!U.map&&!0===U.map.isVideoTexture&&U.map.encoding===Er,clearcoat:dn,clearcoatMap:dn&&!!U.clearcoatMap,clearcoatRoughnessMap:dn&&!!U.clearcoatRoughnessMap,clearcoatNormalMap:dn&&!!U.clearcoatNormalMap,iridescence:Kt,iridescenceMap:Kt&&!!U.iridescenceMap,iridescenceThicknessMap:Kt&&!!U.iridescenceThicknessMap,displacementMap:!!U.displacementMap,roughnessMap:!!U.roughnessMap,metalnessMap:!!U.metalnessMap,specularMap:!!U.specularMap,specularIntensityMap:!!U.specularIntensityMap,specularColorMap:!!U.specularColorMap,opaque:!1===U.transparent&&1===U.blending,alphaMap:!!U.alphaMap,alphaTest:U.alphaTest>0,gradientMap:!!U.gradientMap,sheen:U.sheen>0,sheenColorMap:!!U.sheenColorMap,sheenRoughnessMap:!!U.sheenRoughnessMap,transmission:U.transmission>0,transmissionMap:!!U.transmissionMap,thicknessMap:!!U.thicknessMap,combine:U.combine,vertexTangents:!!U.normalMap&&!!ge.attributes.tangent,vertexColors:U.vertexColors,vertexAlphas:!0===U.vertexColors&&!!ge.attributes.color&&4===ge.attributes.color.itemSize,vertexUvs:!!(U.map||U.bumpMap||U.normalMap||U.specularMap||U.alphaMap||U.emissiveMap||U.roughnessMap||U.metalnessMap||U.clearcoatMap||U.clearcoatRoughnessMap||U.clearcoatNormalMap||U.iridescenceMap||U.iridescenceThicknessMap||U.displacementMap||U.transmissionMap||U.thicknessMap||U.specularIntensityMap||U.specularColorMap||U.sheenColorMap||U.sheenRoughnessMap),uvsVertexOnly:!(U.map||U.bumpMap||U.normalMap||U.specularMap||U.alphaMap||U.emissiveMap||U.roughnessMap||U.metalnessMap||U.clearcoatNormalMap||U.iridescenceMap||U.iridescenceThicknessMap||U.transmission>0||U.transmissionMap||U.thicknessMap||U.specularIntensityMap||U.specularColorMap||U.sheen>0||U.sheenColorMap||U.sheenRoughnessMap||!U.displacementMap),fog:!!tt,useFog:!0===U.fog,fogExp2:tt&&tt.isFogExp2,flatShading:!!U.flatShading,sizeAttenuation:U.sizeAttenuation,logarithmicDepthBuffer:y,skinning:!0===Oe.isSkinnedMesh,morphTargets:void 0!==ge.morphAttributes.position,morphNormals:void 0!==ge.morphAttributes.normal,morphColors:void 0!==ge.morphAttributes.color,morphTargetsCount:Se,morphTextureStride:Je,numDirLights:ee.directional.length,numPointLights:ee.point.length,numSpotLights:ee.spot.length,numRectAreaLights:ee.rectArea.length,numHemiLights:ee.hemi.length,numDirLightShadows:ee.directionalShadowMap.length,numPointLightShadows:ee.pointShadowMap.length,numSpotLightShadows:ee.spotShadowMap.length,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:U.dithering,shadowMapEnabled:n.shadowMap.enabled&&le.length>0,shadowMapType:n.shadowMap.type,toneMapping:U.toneMapped?n.toneMapping:0,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:U.premultipliedAlpha,doubleSided:2===U.side,flipSided:1===U.side,useDepthPacking:!!U.depthPacking,depthPacking:U.depthPacking||0,index0AttributeName:U.index0AttributeName,extensionDerivatives:U.extensions&&U.extensions.derivatives,extensionFragDepth:U.extensions&&U.extensions.fragDepth,extensionDrawBuffers:U.extensions&&U.extensions.drawBuffers,extensionShaderTextureLOD:U.extensions&&U.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||i.has("EXT_shader_texture_lod"),customProgramCacheKey:U.customProgramCacheKey()}},getProgramCacheKey:function T(U){const ee=[];if(U.shaderID?ee.push(U.shaderID):(ee.push(U.customVertexShaderID),ee.push(U.customFragmentShaderID)),void 0!==U.defines)for(const le in U.defines)ee.push(le),ee.push(U.defines[le]);return!1===U.isRawShaderMaterial&&(function P(U,ee){U.push(ee.precision),U.push(ee.outputEncoding),U.push(ee.envMapMode),U.push(ee.envMapCubeUVHeight),U.push(ee.combine),U.push(ee.vertexUvs),U.push(ee.fogExp2),U.push(ee.sizeAttenuation),U.push(ee.morphTargetsCount),U.push(ee.morphAttributeCount),U.push(ee.numDirLights),U.push(ee.numPointLights),U.push(ee.numSpotLights),U.push(ee.numHemiLights),U.push(ee.numRectAreaLights),U.push(ee.numDirLightShadows),U.push(ee.numPointLightShadows),U.push(ee.numSpotLightShadows),U.push(ee.shadowMapType),U.push(ee.toneMapping),U.push(ee.numClippingPlanes),U.push(ee.numClipIntersection),U.push(ee.depthPacking)}(ee,U),function O(U,ee){c.disableAll(),ee.isWebGL2&&c.enable(0),ee.supportsVertexTextures&&c.enable(1),ee.instancing&&c.enable(2),ee.instancingColor&&c.enable(3),ee.map&&c.enable(4),ee.matcap&&c.enable(5),ee.envMap&&c.enable(6),ee.lightMap&&c.enable(7),ee.aoMap&&c.enable(8),ee.emissiveMap&&c.enable(9),ee.bumpMap&&c.enable(10),ee.normalMap&&c.enable(11),ee.objectSpaceNormalMap&&c.enable(12),ee.tangentSpaceNormalMap&&c.enable(13),ee.clearcoat&&c.enable(14),ee.clearcoatMap&&c.enable(15),ee.clearcoatRoughnessMap&&c.enable(16),ee.clearcoatNormalMap&&c.enable(17),ee.iridescence&&c.enable(18),ee.iridescenceMap&&c.enable(19),ee.iridescenceThicknessMap&&c.enable(20),ee.displacementMap&&c.enable(21),ee.specularMap&&c.enable(22),ee.roughnessMap&&c.enable(23),ee.metalnessMap&&c.enable(24),ee.gradientMap&&c.enable(25),ee.alphaMap&&c.enable(26),ee.alphaTest&&c.enable(27),ee.vertexColors&&c.enable(28),ee.vertexAlphas&&c.enable(29),ee.vertexUvs&&c.enable(30),ee.vertexTangents&&c.enable(31),ee.uvsVertexOnly&&c.enable(32),ee.fog&&c.enable(33),U.push(c.mask),c.disableAll(),ee.useFog&&c.enable(0),ee.flatShading&&c.enable(1),ee.logarithmicDepthBuffer&&c.enable(2),ee.skinning&&c.enable(3),ee.morphTargets&&c.enable(4),ee.morphNormals&&c.enable(5),ee.morphColors&&c.enable(6),ee.premultipliedAlpha&&c.enable(7),ee.shadowMapEnabled&&c.enable(8),ee.physicallyCorrectLights&&c.enable(9),ee.doubleSided&&c.enable(10),ee.flipSided&&c.enable(11),ee.useDepthPacking&&c.enable(12),ee.dithering&&c.enable(13),ee.specularIntensityMap&&c.enable(14),ee.specularColorMap&&c.enable(15),ee.transmission&&c.enable(16),ee.transmissionMap&&c.enable(17),ee.thicknessMap&&c.enable(18),ee.sheen&&c.enable(19),ee.sheenColorMap&&c.enable(20),ee.sheenRoughnessMap&&c.enable(21),ee.decodeVideoTexture&&c.enable(22),ee.opaque&&c.enable(23),U.push(c.mask)}(ee,U),ee.push(n.outputEncoding)),ee.push(U.customProgramCacheKey),ee.join()},getUniforms:function k(U){const ee=S[U.type];let le;return le=ee?P7.clone(Jl[ee].uniforms):U.uniforms,le},acquireProgram:function B(U,ee){let le;for(let me=0,Oe=p.length;me<Oe;me++){const tt=p[me];if(tt.cacheKey===ee){le=tt,++le.usedTimes;break}}return void 0===le&&(le=new cZ(n,ee,U,o),p.push(le)),le},releaseProgram:function z(U){if(0==--U.usedTimes){const ee=p.indexOf(U);p[ee]=p[p.length-1],p.pop(),U.destroy()}},releaseShaderCache:function q(U){h.remove(U)},programs:p,dispose:function ne(){h.dispose()}}}function pZ(){let n=new WeakMap;return{get:function e(o){let l=n.get(o);return void 0===l&&(l={},n.set(o,l)),l},remove:function t(o){n.delete(o)},update:function i(o,l,c){n.get(o)[l]=c},dispose:function r(){n=new WeakMap}}}function mZ(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function mk(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function gk(){const n=[];let e=0;const t=[],i=[],r=[];function l(y,x,M,S,C,T){let P=n[e];return void 0===P?(P={id:y.id,object:y,geometry:x,material:M,groupOrder:S,renderOrder:y.renderOrder,z:C,group:T},n[e]=P):(P.id=y.id,P.object=y,P.geometry=x,P.material=M,P.groupOrder=S,P.renderOrder=y.renderOrder,P.z=C,P.group=T),e++,P}return{opaque:t,transmissive:i,transparent:r,init:function o(){e=0,t.length=0,i.length=0,r.length=0},push:function c(y,x,M,S,C,T){const P=l(y,x,M,S,C,T);M.transmission>0?i.push(P):!0===M.transparent?r.push(P):t.push(P)},unshift:function h(y,x,M,S,C,T){const P=l(y,x,M,S,C,T);M.transmission>0?i.unshift(P):!0===M.transparent?r.unshift(P):t.unshift(P)},finish:function g(){for(let y=e,x=n.length;y<x;y++){const M=n[y];if(null===M.id)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.group=null}},sort:function p(y,x){t.length>1&&t.sort(y||mZ),i.length>1&&i.sort(x||mk),r.length>1&&r.sort(x||mk)}}}function gZ(){let n=new WeakMap;return{get:function e(i,r){let o;return!1===n.has(i)?(o=new gk,n.set(i,[o])):r>=n.get(i).length?(o=new gk,n.get(i).push(o)):o=n.get(i)[r],o},dispose:function t(){n=new WeakMap}}}function _Z(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Z,color:new Ft};break;case"SpotLight":t={position:new Z,direction:new Z,color:new Ft,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Z,color:new Ft,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Z,skyColor:new Ft,groundColor:new Ft};break;case"RectAreaLight":t={color:new Ft,position:new Z,halfWidth:new Z,halfHeight:new Z}}return n[e.id]=t,t}}}let vZ=0;function xZ(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function bZ(n,e){const t=new _Z,i=function yZ(){const n={};return{get:function(e){if(void 0!==n[e.id])return n[e.id];let t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let g=0;g<9;g++)r.probe.push(new Z);const o=new Z,l=new Bn,c=new Bn;return{setup:function h(g,y){let x=0,M=0,S=0;for(let ee=0;ee<9;ee++)r.probe[ee].set(0,0,0);let C=0,T=0,P=0,O=0,k=0,B=0,z=0,q=0;g.sort(xZ);const ne=!0!==y?Math.PI:1;for(let ee=0,le=g.length;ee<le;ee++){const me=g[ee],Oe=me.color,tt=me.intensity,ge=me.distance,Pe=me.shadow&&me.shadow.map?me.shadow.map.texture:null;if(me.isAmbientLight)x+=Oe.r*tt*ne,M+=Oe.g*tt*ne,S+=Oe.b*tt*ne;else if(me.isLightProbe)for(let ae=0;ae<9;ae++)r.probe[ae].addScaledVector(me.sh.coefficients[ae],tt);else if(me.isDirectionalLight){const ae=t.get(me);if(ae.color.copy(me.color).multiplyScalar(me.intensity*ne),me.castShadow){const ye=me.shadow,xe=i.get(me);xe.shadowBias=ye.bias,xe.shadowNormalBias=ye.normalBias,xe.shadowRadius=ye.radius,xe.shadowMapSize=ye.mapSize,r.directionalShadow[C]=xe,r.directionalShadowMap[C]=Pe,r.directionalShadowMatrix[C]=me.shadow.matrix,B++}r.directional[C]=ae,C++}else if(me.isSpotLight){const ae=t.get(me);if(ae.position.setFromMatrixPosition(me.matrixWorld),ae.color.copy(Oe).multiplyScalar(tt*ne),ae.distance=ge,ae.coneCos=Math.cos(me.angle),ae.penumbraCos=Math.cos(me.angle*(1-me.penumbra)),ae.decay=me.decay,me.castShadow){const ye=me.shadow,xe=i.get(me);xe.shadowBias=ye.bias,xe.shadowNormalBias=ye.normalBias,xe.shadowRadius=ye.radius,xe.shadowMapSize=ye.mapSize,r.spotShadow[P]=xe,r.spotShadowMap[P]=Pe,r.spotShadowMatrix[P]=me.shadow.matrix,q++}r.spot[P]=ae,P++}else if(me.isRectAreaLight){const ae=t.get(me);ae.color.copy(Oe).multiplyScalar(tt),ae.halfWidth.set(.5*me.width,0,0),ae.halfHeight.set(0,.5*me.height,0),r.rectArea[O]=ae,O++}else if(me.isPointLight){const ae=t.get(me);if(ae.color.copy(me.color).multiplyScalar(me.intensity*ne),ae.distance=me.distance,ae.decay=me.decay,me.castShadow){const ye=me.shadow,xe=i.get(me);xe.shadowBias=ye.bias,xe.shadowNormalBias=ye.normalBias,xe.shadowRadius=ye.radius,xe.shadowMapSize=ye.mapSize,xe.shadowCameraNear=ye.camera.near,xe.shadowCameraFar=ye.camera.far,r.pointShadow[T]=xe,r.pointShadowMap[T]=Pe,r.pointShadowMatrix[T]=me.shadow.matrix,z++}r.point[T]=ae,T++}else if(me.isHemisphereLight){const ae=t.get(me);ae.skyColor.copy(me.color).multiplyScalar(tt*ne),ae.groundColor.copy(me.groundColor).multiplyScalar(tt*ne),r.hemi[k]=ae,k++}}O>0&&(e.isWebGL2||!0===n.has("OES_texture_float_linear")?(r.rectAreaLTC1=vt.LTC_FLOAT_1,r.rectAreaLTC2=vt.LTC_FLOAT_2):!0===n.has("OES_texture_half_float_linear")?(r.rectAreaLTC1=vt.LTC_HALF_1,r.rectAreaLTC2=vt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=x,r.ambient[1]=M,r.ambient[2]=S;const U=r.hash;(U.directionalLength!==C||U.pointLength!==T||U.spotLength!==P||U.rectAreaLength!==O||U.hemiLength!==k||U.numDirectionalShadows!==B||U.numPointShadows!==z||U.numSpotShadows!==q)&&(r.directional.length=C,r.spot.length=P,r.rectArea.length=O,r.point.length=T,r.hemi.length=k,r.directionalShadow.length=B,r.directionalShadowMap.length=B,r.pointShadow.length=z,r.pointShadowMap.length=z,r.spotShadow.length=q,r.spotShadowMap.length=q,r.directionalShadowMatrix.length=B,r.pointShadowMatrix.length=z,r.spotShadowMatrix.length=q,U.directionalLength=C,U.pointLength=T,U.spotLength=P,U.rectAreaLength=O,U.hemiLength=k,U.numDirectionalShadows=B,U.numPointShadows=z,U.numSpotShadows=q,r.version=vZ++)},setupView:function p(g,y){let x=0,M=0,S=0,C=0,T=0;const P=y.matrixWorldInverse;for(let O=0,k=g.length;O<k;O++){const B=g[O];if(B.isDirectionalLight){const z=r.directional[x];z.direction.setFromMatrixPosition(B.matrixWorld),o.setFromMatrixPosition(B.target.matrixWorld),z.direction.sub(o),z.direction.transformDirection(P),x++}else if(B.isSpotLight){const z=r.spot[S];z.position.setFromMatrixPosition(B.matrixWorld),z.position.applyMatrix4(P),z.direction.setFromMatrixPosition(B.matrixWorld),o.setFromMatrixPosition(B.target.matrixWorld),z.direction.sub(o),z.direction.transformDirection(P),S++}else if(B.isRectAreaLight){const z=r.rectArea[C];z.position.setFromMatrixPosition(B.matrixWorld),z.position.applyMatrix4(P),c.identity(),l.copy(B.matrixWorld),l.premultiply(P),c.extractRotation(l),z.halfWidth.set(.5*B.width,0,0),z.halfHeight.set(0,.5*B.height,0),z.halfWidth.applyMatrix4(c),z.halfHeight.applyMatrix4(c),C++}else if(B.isPointLight){const z=r.point[M];z.position.setFromMatrixPosition(B.matrixWorld),z.position.applyMatrix4(P),M++}else if(B.isHemisphereLight){const z=r.hemi[T];z.direction.setFromMatrixPosition(B.matrixWorld),z.direction.transformDirection(P),T++}}},state:r}}function _k(n,e){const t=new bZ(n,e),i=[],r=[];return{init:function o(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function h(y){t.setup(i,y)},setupLightsView:function p(y){t.setupView(i,y)},pushLight:function l(y){i.push(y)},pushShadow:function c(y){r.push(y)}}}function wZ(n,e){let t=new WeakMap;return{get:function i(o,l=0){let c;return!1===t.has(o)?(c=new _k(n,e),t.set(o,[c])):l>=t.get(o).length?(c=new _k(n,e),t.get(o).push(c)):c=t.get(o)[l],c},dispose:function r(){t=new WeakMap}}}class yk extends s_{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class vk extends s_{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Z,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function EZ(n,e,t){let i=new FR;const r=new Xe,o=new Xe,l=new Bi,c=new yk({depthPacking:3201}),h=new vk,p={},g=t.maxTextureSize,y={0:1,1:0,2:2},x=new Vd({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),M=x.clone();M.defines.HORIZONTAL_PASS=1;const S=new Kn;S.setAttribute("position",new ys(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const C=new po(S,x),T=this;function P(B,z){const q=e.update(C);x.defines.VSM_SAMPLES!==B.blurSamples&&(x.defines.VSM_SAMPLES=B.blurSamples,M.defines.VSM_SAMPLES=B.blurSamples,x.needsUpdate=!0,M.needsUpdate=!0),null===B.mapPass&&(B.mapPass=new Wf(r.x,r.y)),x.uniforms.shadow_pass.value=B.map.texture,x.uniforms.resolution.value=B.mapSize,x.uniforms.radius.value=B.radius,n.setRenderTarget(B.mapPass),n.clear(),n.renderBufferDirect(z,null,q,x,C,null),M.uniforms.shadow_pass.value=B.mapPass.texture,M.uniforms.resolution.value=B.mapSize,M.uniforms.radius.value=B.radius,n.setRenderTarget(B.map),n.clear(),n.renderBufferDirect(z,null,q,M,C,null)}function O(B,z,q,ne,U,ee){let le=null;const me=!0===q.isPointLight?B.customDistanceMaterial:B.customDepthMaterial;if(le=void 0!==me?me:!0===q.isPointLight?h:c,n.localClippingEnabled&&!0===z.clipShadows&&Array.isArray(z.clippingPlanes)&&0!==z.clippingPlanes.length||z.displacementMap&&0!==z.displacementScale||z.alphaMap&&z.alphaTest>0){const Oe=le.uuid,tt=z.uuid;let ge=p[Oe];void 0===ge&&(ge={},p[Oe]=ge);let Pe=ge[tt];void 0===Pe&&(Pe=le.clone(),ge[tt]=Pe),le=Pe}return le.visible=z.visible,le.wireframe=z.wireframe,le.side=3===ee?null!==z.shadowSide?z.shadowSide:z.side:null!==z.shadowSide?z.shadowSide:y[z.side],le.alphaMap=z.alphaMap,le.alphaTest=z.alphaTest,le.clipShadows=z.clipShadows,le.clippingPlanes=z.clippingPlanes,le.clipIntersection=z.clipIntersection,le.displacementMap=z.displacementMap,le.displacementScale=z.displacementScale,le.displacementBias=z.displacementBias,le.wireframeLinewidth=z.wireframeLinewidth,le.linewidth=z.linewidth,!0===q.isPointLight&&!0===le.isMeshDistanceMaterial&&(le.referencePosition.setFromMatrixPosition(q.matrixWorld),le.nearDistance=ne,le.farDistance=U),le}function k(B,z,q,ne,U){if(!1===B.visible)return;if(B.layers.test(z.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&3===U)&&(!B.frustumCulled||i.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,B.matrixWorld);const me=e.update(B),Oe=B.material;if(Array.isArray(Oe)){const tt=me.groups;for(let ge=0,Pe=tt.length;ge<Pe;ge++){const ae=tt[ge],ye=Oe[ae.materialIndex];if(ye&&ye.visible){const xe=O(B,ye,ne,q.near,q.far,U);n.renderBufferDirect(q,null,me,xe,B,ae)}}}else if(Oe.visible){const tt=O(B,Oe,ne,q.near,q.far,U);n.renderBufferDirect(q,null,me,tt,B,null)}}const le=B.children;for(let me=0,Oe=le.length;me<Oe;me++)k(le[me],z,q,ne,U)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(B,z,q){if(!1===T.enabled||!1===T.autoUpdate&&!1===T.needsUpdate||0===B.length)return;const ne=n.getRenderTarget(),U=n.getActiveCubeFace(),ee=n.getActiveMipmapLevel(),le=n.state;le.setBlending(0),le.buffers.color.setClear(1,1,1,1),le.buffers.depth.setTest(!0),le.setScissorTest(!1);for(let me=0,Oe=B.length;me<Oe;me++){const tt=B[me],ge=tt.shadow;if(void 0===ge){console.warn("THREE.WebGLShadowMap:",tt,"has no shadow.");continue}if(!1===ge.autoUpdate&&!1===ge.needsUpdate)continue;r.copy(ge.mapSize);const Pe=ge.getFrameExtents();r.multiply(Pe),o.copy(ge.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(o.x=Math.floor(g/Pe.x),r.x=o.x*Pe.x,ge.mapSize.x=o.x),r.y>g&&(o.y=Math.floor(g/Pe.y),r.y=o.y*Pe.y,ge.mapSize.y=o.y)),null===ge.map&&(ge.map=new Wf(r.x,r.y,3!==this.type?{minFilter:is,magFilter:is}:{}),ge.map.texture.name=tt.name+".shadowMap",ge.camera.updateProjectionMatrix()),n.setRenderTarget(ge.map),n.clear();const ae=ge.getViewportCount();for(let ye=0;ye<ae;ye++){const xe=ge.getViewport(ye);l.set(o.x*xe.x,o.y*xe.y,o.x*xe.z,o.y*xe.w),le.viewport(l),ge.updateMatrices(tt,ye),i=ge.getFrustum(),k(z,q,ge.camera,tt,this.type)}!0!==ge.isPointLightShadow&&3===this.type&&P(ge,q),ge.needsUpdate=!1}T.needsUpdate=!1,n.setRenderTarget(ne,U,ee)}}function CZ(n,e,t){const i=t.isWebGL2,c=new function r(){let ce=!1;const xt=new Bi;let _t=null;const xn=new Bi(0,0,0,0);return{setMask:function(zt){_t!==zt&&!ce&&(n.colorMask(zt,zt,zt,zt),_t=zt)},setLocked:function(zt){ce=zt},setClear:function(zt,Tn,ut,An,Vi){!0===Vi&&(zt*=An,Tn*=An,ut*=An),xt.set(zt,Tn,ut,An),!1===xn.equals(xt)&&(n.clearColor(zt,Tn,ut,An),xn.copy(xt))},reset:function(){ce=!1,_t=null,xn.set(-1,0,0,0)}}},h=new function o(){let ce=!1,xt=null,_t=null,xn=null;return{setTest:function(zt){zt?$t(2929):Ne(2929)},setMask:function(zt){xt!==zt&&!ce&&(n.depthMask(zt),xt=zt)},setFunc:function(zt){if(_t!==zt){if(zt)switch(zt){case 0:n.depthFunc(512);break;case 1:n.depthFunc(519);break;case 2:n.depthFunc(513);break;case 3:default:n.depthFunc(515);break;case 4:n.depthFunc(514);break;case 5:n.depthFunc(518);break;case 6:n.depthFunc(516);break;case 7:n.depthFunc(517)}else n.depthFunc(515);_t=zt}},setLocked:function(zt){ce=zt},setClear:function(zt){xn!==zt&&(n.clearDepth(zt),xn=zt)},reset:function(){ce=!1,xt=null,_t=null,xn=null}}},p=new function l(){let ce=!1,xt=null,_t=null,xn=null,zt=null,Tn=null,ut=null,An=null,Vi=null;return{setTest:function(Ui){ce||(Ui?$t(2960):Ne(2960))},setMask:function(Ui){xt!==Ui&&!ce&&(n.stencilMask(Ui),xt=Ui)},setFunc:function(Ui,vo,tc){(_t!==Ui||xn!==vo||zt!==tc)&&(n.stencilFunc(Ui,vo,tc),_t=Ui,xn=vo,zt=tc)},setOp:function(Ui,vo,tc){(Tn!==Ui||ut!==vo||An!==tc)&&(n.stencilOp(Ui,vo,tc),Tn=Ui,ut=vo,An=tc)},setLocked:function(Ui){ce=Ui},setClear:function(Ui){Vi!==Ui&&(n.clearStencil(Ui),Vi=Ui)},reset:function(){ce=!1,xt=null,_t=null,xn=null,zt=null,Tn=null,ut=null,An=null,Vi=null}}};let g={},y={},x=new WeakMap,M=[],S=null,C=!1,T=null,P=null,O=null,k=null,B=null,z=null,q=null,ne=!1,U=null,ee=null,le=null,me=null,Oe=null;const tt=n.getParameter(35661);let ge=!1,Pe=0;const ae=n.getParameter(7938);-1!==ae.indexOf("WebGL")?(Pe=parseFloat(/^WebGL (\d)/.exec(ae)[1]),ge=Pe>=1):-1!==ae.indexOf("OpenGL ES")&&(Pe=parseFloat(/^OpenGL ES (\d)/.exec(ae)[1]),ge=Pe>=2);let ye=null,xe={};const _e=n.getParameter(3088),Se=n.getParameter(2978),Je=(new Bi).fromArray(_e),Ve=(new Bi).fromArray(Se);function ot(ce,xt,_t){const xn=new Uint8Array(4),zt=n.createTexture();n.bindTexture(ce,zt),n.texParameteri(ce,10241,9728),n.texParameteri(ce,10240,9728);for(let Tn=0;Tn<_t;Tn++)n.texImage2D(xt+Tn,0,6408,1,1,0,6408,5121,xn);return zt}const ct={};function $t(ce){!0!==g[ce]&&(n.enable(ce),g[ce]=!0)}function Ne(ce){!1!==g[ce]&&(n.disable(ce),g[ce]=!1)}ct[3553]=ot(3553,3553,1),ct[34067]=ot(34067,34069,6),c.setClear(0,0,0,1),h.setClear(1),p.setClear(0),$t(2929),h.setFunc(3),pt(!1),qt(1),$t(2884),je(0);const ft={100:32774,101:32778,102:32779};if(i)ft[103]=32775,ft[104]=32776;else{const ce=e.get("EXT_blend_minmax");null!==ce&&(ft[103]=ce.MIN_EXT,ft[104]=ce.MAX_EXT)}const Dn={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function je(ce,xt,_t,xn,zt,Tn,ut,An){if(0!==ce){if(!1===C&&($t(3042),C=!0),5===ce)zt=zt||xt,Tn=Tn||_t,ut=ut||xn,(xt!==P||zt!==B)&&(n.blendEquationSeparate(ft[xt],ft[zt]),P=xt,B=zt),(_t!==O||xn!==k||Tn!==z||ut!==q)&&(n.blendFuncSeparate(Dn[_t],Dn[xn],Dn[Tn],Dn[ut]),O=_t,k=xn,z=Tn,q=ut),T=ce,ne=null;else if(ce!==T||An!==ne){if((100!==P||100!==B)&&(n.blendEquation(32774),P=100,B=100),An)switch(ce){case 1:n.blendFuncSeparate(1,771,1,771);break;case 2:n.blendFunc(1,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce)}else switch(ce){case 1:n.blendFuncSeparate(770,771,1,771);break;case 2:n.blendFunc(770,1);break;case 3:n.blendFuncSeparate(0,769,0,1);break;case 4:n.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ce)}O=null,k=null,z=null,q=null,T=ce,ne=An}}else!0===C&&(Ne(3042),C=!1)}function pt(ce){U!==ce&&(n.frontFace(ce?2304:2305),U=ce)}function qt(ce){0!==ce?($t(2884),ce!==ee&&n.cullFace(1===ce?1029:2===ce?1028:1032)):Ne(2884),ee=ce}function Pn(ce,xt,_t){ce?($t(32823),(me!==xt||Oe!==_t)&&(n.polygonOffset(xt,_t),me=xt,Oe=_t)):Ne(32823)}function cn(ce){void 0===ce&&(ce=33984+tt-1),ye!==ce&&(n.activeTexture(ce),ye=ce)}return{buffers:{color:c,depth:h,stencil:p},enable:$t,disable:Ne,bindFramebuffer:function bn(ce,xt){return y[ce]!==xt&&(n.bindFramebuffer(ce,xt),y[ce]=xt,i&&(36009===ce&&(y[36160]=xt),36160===ce&&(y[36009]=xt)),!0)},drawBuffers:function dn(ce,xt){let _t=M,xn=!1;if(ce)if(_t=x.get(xt),void 0===_t&&(_t=[],x.set(xt,_t)),ce.isWebGLMultipleRenderTargets){const zt=ce.texture;if(_t.length!==zt.length||36064!==_t[0]){for(let Tn=0,ut=zt.length;Tn<ut;Tn++)_t[Tn]=36064+Tn;_t.length=zt.length,xn=!0}}else 36064!==_t[0]&&(_t[0]=36064,xn=!0);else 1029!==_t[0]&&(_t[0]=1029,xn=!0);xn&&(t.isWebGL2?n.drawBuffers(_t):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(_t))},useProgram:function Kt(ce){return S!==ce&&(n.useProgram(ce),S=ce,!0)},setBlending:je,setMaterial:function ze(ce,xt){2===ce.side?Ne(2884):$t(2884);let _t=1===ce.side;xt&&(_t=!_t),pt(_t),1===ce.blending&&!1===ce.transparent?je(0):je(ce.blending,ce.blendEquation,ce.blendSrc,ce.blendDst,ce.blendEquationAlpha,ce.blendSrcAlpha,ce.blendDstAlpha,ce.premultipliedAlpha),h.setFunc(ce.depthFunc),h.setTest(ce.depthTest),h.setMask(ce.depthWrite),c.setMask(ce.colorWrite);const xn=ce.stencilWrite;p.setTest(xn),xn&&(p.setMask(ce.stencilWriteMask),p.setFunc(ce.stencilFunc,ce.stencilRef,ce.stencilFuncMask),p.setOp(ce.stencilFail,ce.stencilZFail,ce.stencilZPass)),Pn(ce.polygonOffset,ce.polygonOffsetFactor,ce.polygonOffsetUnits),!0===ce.alphaToCoverage?$t(32926):Ne(32926)},setFlipSided:pt,setCullFace:qt,setLineWidth:function Ct(ce){ce!==le&&(ge&&n.lineWidth(ce),le=ce)},setPolygonOffset:Pn,setScissorTest:function _n(ce){ce?$t(3089):Ne(3089)},activeTexture:cn,bindTexture:function ir(ce,xt){null===ye&&cn();let _t=xe[ye];void 0===_t&&(_t={type:void 0,texture:void 0},xe[ye]=_t),(_t.type!==ce||_t.texture!==xt)&&(n.bindTexture(ce,xt||ct[ce]),_t.type=ce,_t.texture=xt)},unbindTexture:function $i(){const ce=xe[ye];void 0!==ce&&void 0!==ce.type&&(n.bindTexture(ce.type,null),ce.type=void 0,ce.texture=void 0)},compressedTexImage2D:function te(){try{n.compressedTexImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texImage2D:function Cn(){try{n.texImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texImage3D:function Ie(){try{n.texImage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texStorage2D:function dt(){try{n.texStorage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texStorage3D:function Tt(){try{n.texStorage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texSubImage2D:function $(){try{n.texSubImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},texSubImage3D:function Re(){try{n.texSubImage3D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},compressedTexSubImage2D:function rt(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(ce){console.error("THREE.WebGLState:",ce)}},scissor:function Qt(ce){!1===Je.equals(ce)&&(n.scissor(ce.x,ce.y,ce.z,ce.w),Je.copy(ce))},viewport:function Vt(ce){!1===Ve.equals(ce)&&(n.viewport(ce.x,ce.y,ce.z,ce.w),Ve.copy(ce))},reset:function kt(){n.disable(3042),n.disable(2884),n.disable(2929),n.disable(32823),n.disable(3089),n.disable(2960),n.disable(32926),n.blendEquation(32774),n.blendFunc(1,0),n.blendFuncSeparate(1,0,1,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(513),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(519,0,4294967295),n.stencilOp(7680,7680,7680),n.clearStencil(0),n.cullFace(1029),n.frontFace(2305),n.polygonOffset(0,0),n.activeTexture(33984),n.bindFramebuffer(36160,null),!0===i&&(n.bindFramebuffer(36009,null),n.bindFramebuffer(36008,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),g={},ye=null,xe={},y={},x=new WeakMap,M=[],S=null,C=!1,T=null,P=null,O=null,k=null,B=null,z=null,q=null,ne=!1,U=null,ee=null,le=null,me=null,Oe=null,Je.set(0,0,n.canvas.width,n.canvas.height),Ve.set(0,0,n.canvas.width,n.canvas.height),c.reset(),h.reset(),p.reset()}}}function TZ(n,e,t,i,r,o,l){const c=r.isWebGL2,h=r.maxTextures,p=r.maxCubemapSize,g=r.maxTextureSize,y=r.maxSamples,x=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,M=/OculusBrowser/g.test(navigator.userAgent),S=new WeakMap;let C;const T=new WeakMap;let P=!1;try{P="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(te){}function O(te,$){return P?new OffscreenCanvas(te,$):k0("canvas")}function k(te,$,Re,rt){let dt=1;if((te.width>rt||te.height>rt)&&(dt=rt/Math.max(te.width,te.height)),dt<1||!0===$){if("undefined"!=typeof HTMLImageElement&&te instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&te instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&te instanceof ImageBitmap){const Tt=$?ES:Math.floor,Cn=Tt(dt*te.width),Ie=Tt(dt*te.height);void 0===C&&(C=O(Cn,Ie));const Qt=Re?O(Cn,Ie):C;return Qt.width=Cn,Qt.height=Ie,Qt.getContext("2d").drawImage(te,0,0,Cn,Ie),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+te.width+"x"+te.height+") to ("+Cn+"x"+Ie+")."),Qt}return"data"in te&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+te.width+"x"+te.height+")."),te}return te}function B(te){return cR(te.width)&&cR(te.height)}function q(te,$){return te.generateMipmaps&&$&&te.minFilter!==is&&te.minFilter!==qr}function ne(te){n.generateMipmap(te)}function U(te,$,Re,rt,dt=!1){if(!1===c)return $;if(null!==te){if(void 0!==n[te])return n[te];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+te+"'")}let Tt=$;return 6403===$&&(5126===Re&&(Tt=33326),5131===Re&&(Tt=33325),5121===Re&&(Tt=33321)),33319===$&&(5126===Re&&(Tt=33328),5131===Re&&(Tt=33327),5121===Re&&(Tt=33323)),6408===$&&(5126===Re&&(Tt=34836),5131===Re&&(Tt=34842),5121===Re&&(Tt=rt===Er&&!1===dt?35907:32856),32819===Re&&(Tt=32854),32820===Re&&(Tt=32855)),(33325===Tt||33326===Tt||33327===Tt||33328===Tt||34842===Tt||34836===Tt)&&e.get("EXT_color_buffer_float"),Tt}function ee(te,$,Re){return!0===q(te,Re)||te.isFramebufferTexture&&te.minFilter!==is&&te.minFilter!==qr?Math.log2(Math.max($.width,$.height))+1:void 0!==te.mipmaps&&te.mipmaps.length>0?te.mipmaps.length:te.isCompressedTexture&&Array.isArray(te.image)?$.mipmaps.length:1}function le(te){return te===is||1004===te||1005===te?9728:9729}function me(te){const $=te.target;$.removeEventListener("dispose",me),function tt(te){const $=i.get(te);if(void 0===$.__webglInit)return;const Re=te.source,rt=T.get(Re);if(rt){const dt=rt[$.__cacheKey];dt.usedTimes--,0===dt.usedTimes&&ge(te),0===Object.keys(rt).length&&T.delete(Re)}i.remove(te)}($),$.isVideoTexture&&S.delete($)}function Oe(te){const $=te.target;$.removeEventListener("dispose",Oe),function Pe(te){const $=te.texture,Re=i.get(te),rt=i.get($);if(void 0!==rt.__webglTexture&&(n.deleteTexture(rt.__webglTexture),l.memory.textures--),te.depthTexture&&te.depthTexture.dispose(),te.isWebGLCubeRenderTarget)for(let dt=0;dt<6;dt++)n.deleteFramebuffer(Re.__webglFramebuffer[dt]),Re.__webglDepthbuffer&&n.deleteRenderbuffer(Re.__webglDepthbuffer[dt]);else{if(n.deleteFramebuffer(Re.__webglFramebuffer),Re.__webglDepthbuffer&&n.deleteRenderbuffer(Re.__webglDepthbuffer),Re.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Re.__webglMultisampledFramebuffer),Re.__webglColorRenderbuffer)for(let dt=0;dt<Re.__webglColorRenderbuffer.length;dt++)Re.__webglColorRenderbuffer[dt]&&n.deleteRenderbuffer(Re.__webglColorRenderbuffer[dt]);Re.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Re.__webglDepthRenderbuffer)}if(te.isWebGLMultipleRenderTargets)for(let dt=0,Tt=$.length;dt<Tt;dt++){const Cn=i.get($[dt]);Cn.__webglTexture&&(n.deleteTexture(Cn.__webglTexture),l.memory.textures--),i.remove($[dt])}i.remove($),i.remove(te)}($)}function ge(te){const $=i.get(te);n.deleteTexture($.__webglTexture),delete T.get(te.source)[$.__cacheKey],l.memory.textures--}let ae=0;function Se(te,$){const Re=i.get(te);if(te.isVideoTexture&&function ir(te){const $=l.render.frame;S.get(te)!==$&&(S.set(te,$),te.update())}(te),!1===te.isRenderTargetTexture&&te.version>0&&Re.__version!==te.version){const rt=te.image;if(null===rt)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==rt.complete)return void dn(Re,te,$);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(33984+$),t.bindTexture(3553,Re.__webglTexture)}const ct={1e3:10497,[Bo]:33071,1002:33648},$t={[is]:9728,1004:9984,1005:9986,[qr]:9729,1007:9985,1008:9987};function Ne(te,$,Re){if(Re?(n.texParameteri(te,10242,ct[$.wrapS]),n.texParameteri(te,10243,ct[$.wrapT]),(32879===te||35866===te)&&n.texParameteri(te,32882,ct[$.wrapR]),n.texParameteri(te,10240,$t[$.magFilter]),n.texParameteri(te,10241,$t[$.minFilter])):(n.texParameteri(te,10242,33071),n.texParameteri(te,10243,33071),(32879===te||35866===te)&&n.texParameteri(te,32882,33071),($.wrapS!==Bo||$.wrapT!==Bo)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(te,10240,le($.magFilter)),n.texParameteri(te,10241,le($.minFilter)),$.minFilter!==is&&$.minFilter!==qr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const rt=e.get("EXT_texture_filter_anisotropic");if($.type===Dd&&!1===e.has("OES_texture_float_linear")||!1===c&&$.type===F0&&!1===e.has("OES_texture_half_float_linear"))return;($.anisotropy>1||i.get($).__currentAnisotropy)&&(n.texParameterf(te,rt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min($.anisotropy,r.getMaxAnisotropy())),i.get($).__currentAnisotropy=$.anisotropy)}}function bn(te,$){let Re=!1;void 0===te.__webglInit&&(te.__webglInit=!0,$.addEventListener("dispose",me));const rt=$.source;let dt=T.get(rt);void 0===dt&&(dt={},T.set(rt,dt));const Tt=function _e(te){const $=[];return $.push(te.wrapS),$.push(te.wrapT),$.push(te.magFilter),$.push(te.minFilter),$.push(te.anisotropy),$.push(te.internalFormat),$.push(te.format),$.push(te.type),$.push(te.generateMipmaps),$.push(te.premultiplyAlpha),$.push(te.flipY),$.push(te.unpackAlignment),$.push(te.encoding),$.join()}($);if(Tt!==te.__cacheKey){void 0===dt[Tt]&&(dt[Tt]={texture:n.createTexture(),usedTimes:0},l.memory.textures++,Re=!0),dt[Tt].usedTimes++;const Cn=dt[te.__cacheKey];void 0!==Cn&&(dt[te.__cacheKey].usedTimes--,0===Cn.usedTimes&&ge($)),te.__cacheKey=Tt,te.__webglTexture=dt[Tt].texture}return Re}function dn(te,$,Re){let rt=3553;$.isDataArrayTexture&&(rt=35866),$.isData3DTexture&&(rt=32879);const dt=bn(te,$),Tt=$.source;if(t.activeTexture(33984+Re),t.bindTexture(rt,te.__webglTexture),Tt.version!==Tt.__currentVersion||!0===dt){n.pixelStorei(37440,$.flipY),n.pixelStorei(37441,$.premultiplyAlpha),n.pixelStorei(3317,$.unpackAlignment),n.pixelStorei(37443,0);const Cn=function z(te){return!c&&(te.wrapS!==Bo||te.wrapT!==Bo||te.minFilter!==is&&te.minFilter!==qr)}($)&&!1===B($.image);let Ie=k($.image,Cn,!1,g);Ie=$i($,Ie);const Qt=B(Ie)||c,Vt=o.convert($.format,$.encoding);let xt,kt=o.convert($.type),ce=U($.internalFormat,Vt,kt,$.encoding,$.isVideoTexture);Ne(rt,$,Qt);const _t=$.mipmaps,xn=c&&!0!==$.isVideoTexture,zt=void 0===Tt.__currentVersion||!0===dt,Tn=ee($,Ie,Qt);if($.isDepthTexture)ce=6402,c?ce=$.type===Dd?36012:$.type===Bf?33190:$.type===zg?35056:33189:$.type===Dd&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),$.format===Vf&&6402===ce&&1012!==$.type&&$.type!==Bf&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),$.type=Bf,kt=o.convert($.type)),$.format===Hg&&6402===ce&&(ce=34041,$.type!==zg&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),$.type=zg,kt=o.convert($.type))),zt&&(xn?t.texStorage2D(3553,1,ce,Ie.width,Ie.height):t.texImage2D(3553,0,ce,Ie.width,Ie.height,0,Vt,kt,null));else if($.isDataTexture)if(_t.length>0&&Qt){xn&&zt&&t.texStorage2D(3553,Tn,ce,_t[0].width,_t[0].height);for(let ut=0,An=_t.length;ut<An;ut++)xt=_t[ut],xn?t.texSubImage2D(3553,ut,0,0,xt.width,xt.height,Vt,kt,xt.data):t.texImage2D(3553,ut,ce,xt.width,xt.height,0,Vt,kt,xt.data);$.generateMipmaps=!1}else xn?(zt&&t.texStorage2D(3553,Tn,ce,Ie.width,Ie.height),t.texSubImage2D(3553,0,0,0,Ie.width,Ie.height,Vt,kt,Ie.data)):t.texImage2D(3553,0,ce,Ie.width,Ie.height,0,Vt,kt,Ie.data);else if($.isCompressedTexture){xn&&zt&&t.texStorage2D(3553,Tn,ce,_t[0].width,_t[0].height);for(let ut=0,An=_t.length;ut<An;ut++)xt=_t[ut],$.format!==dl?null!==Vt?xn?t.compressedTexSubImage2D(3553,ut,0,0,xt.width,xt.height,Vt,xt.data):t.compressedTexImage2D(3553,ut,ce,xt.width,xt.height,0,xt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xn?t.texSubImage2D(3553,ut,0,0,xt.width,xt.height,Vt,kt,xt.data):t.texImage2D(3553,ut,ce,xt.width,xt.height,0,Vt,kt,xt.data)}else if($.isDataArrayTexture)xn?(zt&&t.texStorage3D(35866,Tn,ce,Ie.width,Ie.height,Ie.depth),t.texSubImage3D(35866,0,0,0,0,Ie.width,Ie.height,Ie.depth,Vt,kt,Ie.data)):t.texImage3D(35866,0,ce,Ie.width,Ie.height,Ie.depth,0,Vt,kt,Ie.data);else if($.isData3DTexture)xn?(zt&&t.texStorage3D(32879,Tn,ce,Ie.width,Ie.height,Ie.depth),t.texSubImage3D(32879,0,0,0,0,Ie.width,Ie.height,Ie.depth,Vt,kt,Ie.data)):t.texImage3D(32879,0,ce,Ie.width,Ie.height,Ie.depth,0,Vt,kt,Ie.data);else if($.isFramebufferTexture){if(zt)if(xn)t.texStorage2D(3553,Tn,ce,Ie.width,Ie.height);else{let ut=Ie.width,An=Ie.height;for(let Vi=0;Vi<Tn;Vi++)t.texImage2D(3553,Vi,ce,ut,An,0,Vt,kt,null),ut>>=1,An>>=1}}else if(_t.length>0&&Qt){xn&&zt&&t.texStorage2D(3553,Tn,ce,_t[0].width,_t[0].height);for(let ut=0,An=_t.length;ut<An;ut++)xt=_t[ut],xn?t.texSubImage2D(3553,ut,0,0,Vt,kt,xt):t.texImage2D(3553,ut,ce,Vt,kt,xt);$.generateMipmaps=!1}else xn?(zt&&t.texStorage2D(3553,Tn,ce,Ie.width,Ie.height),t.texSubImage2D(3553,0,0,0,Vt,kt,Ie)):t.texImage2D(3553,0,ce,Vt,kt,Ie);q($,Qt)&&ne(rt),Tt.__currentVersion=Tt.version,$.onUpdate&&$.onUpdate($)}te.__version=$.version}function ft(te,$,Re,rt,dt){const Tt=o.convert(Re.format,Re.encoding),Cn=o.convert(Re.type),Ie=U(Re.internalFormat,Tt,Cn,Re.encoding);i.get($).__hasExternalTextures||(32879===dt||35866===dt?t.texImage3D(dt,0,Ie,$.width,$.height,$.depth,0,Tt,Cn,null):t.texImage2D(dt,0,Ie,$.width,$.height,0,Tt,Cn,null)),t.bindFramebuffer(36160,te),cn($)?x.framebufferTexture2DMultisampleEXT(36160,rt,dt,i.get(Re).__webglTexture,0,_n($)):n.framebufferTexture2D(36160,rt,dt,i.get(Re).__webglTexture,0),t.bindFramebuffer(36160,null)}function Dn(te,$,Re){if(n.bindRenderbuffer(36161,te),$.depthBuffer&&!$.stencilBuffer){let rt=33189;if(Re||cn($)){const dt=$.depthTexture;dt&&dt.isDepthTexture&&(dt.type===Dd?rt=36012:dt.type===Bf&&(rt=33190));const Tt=_n($);cn($)?x.renderbufferStorageMultisampleEXT(36161,Tt,rt,$.width,$.height):n.renderbufferStorageMultisample(36161,Tt,rt,$.width,$.height)}else n.renderbufferStorage(36161,rt,$.width,$.height);n.framebufferRenderbuffer(36160,36096,36161,te)}else if($.depthBuffer&&$.stencilBuffer){const rt=_n($);Re&&!1===cn($)?n.renderbufferStorageMultisample(36161,rt,35056,$.width,$.height):cn($)?x.renderbufferStorageMultisampleEXT(36161,rt,35056,$.width,$.height):n.renderbufferStorage(36161,34041,$.width,$.height),n.framebufferRenderbuffer(36160,33306,36161,te)}else{const rt=!0===$.isWebGLMultipleRenderTargets?$.texture:[$.texture];for(let dt=0;dt<rt.length;dt++){const Tt=rt[dt],Cn=o.convert(Tt.format,Tt.encoding),Ie=o.convert(Tt.type),Qt=U(Tt.internalFormat,Cn,Ie,Tt.encoding),Vt=_n($);Re&&!1===cn($)?n.renderbufferStorageMultisample(36161,Vt,Qt,$.width,$.height):cn($)?x.renderbufferStorageMultisampleEXT(36161,Vt,Qt,$.width,$.height):n.renderbufferStorage(36161,Qt,$.width,$.height)}}n.bindRenderbuffer(36161,null)}function ze(te){const $=i.get(te),Re=!0===te.isWebGLCubeRenderTarget;if(te.depthTexture&&!$.__autoAllocateDepthBuffer){if(Re)throw new Error("target.depthTexture not supported in Cube render targets");!function je(te,$){if($&&$.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,te),!$.depthTexture||!$.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get($.depthTexture).__webglTexture||$.depthTexture.image.width!==$.width||$.depthTexture.image.height!==$.height)&&($.depthTexture.image.width=$.width,$.depthTexture.image.height=$.height,$.depthTexture.needsUpdate=!0),Se($.depthTexture,0);const rt=i.get($.depthTexture).__webglTexture,dt=_n($);if($.depthTexture.format===Vf)cn($)?x.framebufferTexture2DMultisampleEXT(36160,36096,3553,rt,0,dt):n.framebufferTexture2D(36160,36096,3553,rt,0);else{if($.depthTexture.format!==Hg)throw new Error("Unknown depthTexture format");cn($)?x.framebufferTexture2DMultisampleEXT(36160,33306,3553,rt,0,dt):n.framebufferTexture2D(36160,33306,3553,rt,0)}}($.__webglFramebuffer,te)}else if(Re){$.__webglDepthbuffer=[];for(let rt=0;rt<6;rt++)t.bindFramebuffer(36160,$.__webglFramebuffer[rt]),$.__webglDepthbuffer[rt]=n.createRenderbuffer(),Dn($.__webglDepthbuffer[rt],te,!1)}else t.bindFramebuffer(36160,$.__webglFramebuffer),$.__webglDepthbuffer=n.createRenderbuffer(),Dn($.__webglDepthbuffer,te,!1);t.bindFramebuffer(36160,null)}function _n(te){return Math.min(y,te.samples)}function cn(te){const $=i.get(te);return c&&te.samples>0&&!0===e.has("WEBGL_multisampled_render_to_texture")&&!1!==$.__useRenderToTexture}function $i(te,$){const Re=te.encoding,rt=te.format,dt=te.type;return!0===te.isCompressedTexture||!0===te.isVideoTexture||1035===te.format||Re!==Uf&&(Re===Er?!1===c?!0===e.has("EXT_sRGB")&&rt===dl?(te.format=1035,te.minFilter=qr,te.generateMipmaps=!1):$=D3.sRGBToLinear($):(rt!==dl||dt!==kf)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Re)),$}this.allocateTextureUnit=function xe(){const te=ae;return te>=h&&console.warn("THREE.WebGLTextures: Trying to use "+te+" texture units while this GPU supports only "+h),ae+=1,te},this.resetTextureUnits=function ye(){ae=0},this.setTexture2D=Se,this.setTexture2DArray=function Je(te,$){const Re=i.get(te);te.version>0&&Re.__version!==te.version?dn(Re,te,$):(t.activeTexture(33984+$),t.bindTexture(35866,Re.__webglTexture))},this.setTexture3D=function Ve(te,$){const Re=i.get(te);te.version>0&&Re.__version!==te.version?dn(Re,te,$):(t.activeTexture(33984+$),t.bindTexture(32879,Re.__webglTexture))},this.setTextureCube=function ot(te,$){const Re=i.get(te);te.version>0&&Re.__version!==te.version?function Kt(te,$,Re){if(6!==$.image.length)return;const rt=bn(te,$),dt=$.source;if(t.activeTexture(33984+Re),t.bindTexture(34067,te.__webglTexture),dt.version!==dt.__currentVersion||!0===rt){n.pixelStorei(37440,$.flipY),n.pixelStorei(37441,$.premultiplyAlpha),n.pixelStorei(3317,$.unpackAlignment),n.pixelStorei(37443,0);const Tt=$.isCompressedTexture||$.image[0].isCompressedTexture,Cn=$.image[0]&&$.image[0].isDataTexture,Ie=[];for(let ut=0;ut<6;ut++)Ie[ut]=Tt||Cn?Cn?$.image[ut].image:$.image[ut]:k($.image[ut],!1,!0,p),Ie[ut]=$i($,Ie[ut]);const Qt=Ie[0],Vt=B(Qt)||c,kt=o.convert($.format,$.encoding),ce=o.convert($.type),xt=U($.internalFormat,kt,ce,$.encoding),_t=c&&!0!==$.isVideoTexture,xn=void 0===dt.__currentVersion||!0===rt;let Tn,zt=ee($,Qt,Vt);if(Ne(34067,$,Vt),Tt){_t&&xn&&t.texStorage2D(34067,zt,xt,Qt.width,Qt.height);for(let ut=0;ut<6;ut++){Tn=Ie[ut].mipmaps;for(let An=0;An<Tn.length;An++){const Vi=Tn[An];$.format!==dl?null!==kt?_t?t.compressedTexSubImage2D(34069+ut,An,0,0,Vi.width,Vi.height,kt,Vi.data):t.compressedTexImage2D(34069+ut,An,xt,Vi.width,Vi.height,0,Vi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_t?t.texSubImage2D(34069+ut,An,0,0,Vi.width,Vi.height,kt,ce,Vi.data):t.texImage2D(34069+ut,An,xt,Vi.width,Vi.height,0,kt,ce,Vi.data)}}}else{Tn=$.mipmaps,_t&&xn&&(Tn.length>0&&zt++,t.texStorage2D(34067,zt,xt,Ie[0].width,Ie[0].height));for(let ut=0;ut<6;ut++)if(Cn){_t?t.texSubImage2D(34069+ut,0,0,0,Ie[ut].width,Ie[ut].height,kt,ce,Ie[ut].data):t.texImage2D(34069+ut,0,xt,Ie[ut].width,Ie[ut].height,0,kt,ce,Ie[ut].data);for(let An=0;An<Tn.length;An++){const Ui=Tn[An].image[ut].image;_t?t.texSubImage2D(34069+ut,An+1,0,0,Ui.width,Ui.height,kt,ce,Ui.data):t.texImage2D(34069+ut,An+1,xt,Ui.width,Ui.height,0,kt,ce,Ui.data)}}else{_t?t.texSubImage2D(34069+ut,0,0,0,kt,ce,Ie[ut]):t.texImage2D(34069+ut,0,xt,kt,ce,Ie[ut]);for(let An=0;An<Tn.length;An++){const Vi=Tn[An];_t?t.texSubImage2D(34069+ut,An+1,0,0,kt,ce,Vi.image[ut]):t.texImage2D(34069+ut,An+1,xt,kt,ce,Vi.image[ut])}}}q($,Vt)&&ne(34067),dt.__currentVersion=dt.version,$.onUpdate&&$.onUpdate($)}te.__version=$.version}(Re,te,$):(t.activeTexture(33984+$),t.bindTexture(34067,Re.__webglTexture))},this.rebindTextures=function pt(te,$,Re){const rt=i.get(te);void 0!==$&&ft(rt.__webglFramebuffer,te,te.texture,36064,3553),void 0!==Re&&ze(te)},this.setupRenderTarget=function qt(te){const $=te.texture,Re=i.get(te),rt=i.get($);te.addEventListener("dispose",Oe),!0!==te.isWebGLMultipleRenderTargets&&(void 0===rt.__webglTexture&&(rt.__webglTexture=n.createTexture()),rt.__version=$.version,l.memory.textures++);const dt=!0===te.isWebGLCubeRenderTarget,Tt=!0===te.isWebGLMultipleRenderTargets,Cn=B(te)||c;if(dt){Re.__webglFramebuffer=[];for(let Ie=0;Ie<6;Ie++)Re.__webglFramebuffer[Ie]=n.createFramebuffer()}else{if(Re.__webglFramebuffer=n.createFramebuffer(),Tt)if(r.drawBuffers){const Ie=te.texture;for(let Qt=0,Vt=Ie.length;Qt<Vt;Qt++){const kt=i.get(Ie[Qt]);void 0===kt.__webglTexture&&(kt.__webglTexture=n.createTexture(),l.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(c&&te.samples>0&&!1===cn(te)){const Ie=Tt?$:[$];Re.__webglMultisampledFramebuffer=n.createFramebuffer(),Re.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,Re.__webglMultisampledFramebuffer);for(let Qt=0;Qt<Ie.length;Qt++){const Vt=Ie[Qt];Re.__webglColorRenderbuffer[Qt]=n.createRenderbuffer(),n.bindRenderbuffer(36161,Re.__webglColorRenderbuffer[Qt]);const kt=o.convert(Vt.format,Vt.encoding),ce=o.convert(Vt.type),xt=U(Vt.internalFormat,kt,ce,Vt.encoding),_t=_n(te);n.renderbufferStorageMultisample(36161,_t,xt,te.width,te.height),n.framebufferRenderbuffer(36160,36064+Qt,36161,Re.__webglColorRenderbuffer[Qt])}n.bindRenderbuffer(36161,null),te.depthBuffer&&(Re.__webglDepthRenderbuffer=n.createRenderbuffer(),Dn(Re.__webglDepthRenderbuffer,te,!0)),t.bindFramebuffer(36160,null)}}if(dt){t.bindTexture(34067,rt.__webglTexture),Ne(34067,$,Cn);for(let Ie=0;Ie<6;Ie++)ft(Re.__webglFramebuffer[Ie],te,$,36064,34069+Ie);q($,Cn)&&ne(34067),t.unbindTexture()}else if(Tt){const Ie=te.texture;for(let Qt=0,Vt=Ie.length;Qt<Vt;Qt++){const kt=Ie[Qt],ce=i.get(kt);t.bindTexture(3553,ce.__webglTexture),Ne(3553,kt,Cn),ft(Re.__webglFramebuffer,te,kt,36064+Qt,3553),q(kt,Cn)&&ne(3553)}t.unbindTexture()}else{let Ie=3553;(te.isWebGL3DRenderTarget||te.isWebGLArrayRenderTarget)&&(c?Ie=te.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Ie,rt.__webglTexture),Ne(Ie,$,Cn),ft(Re.__webglFramebuffer,te,$,36064,Ie),q($,Cn)&&ne(Ie),t.unbindTexture()}te.depthBuffer&&ze(te)},this.updateRenderTargetMipmap=function Ct(te){const $=B(te)||c,Re=!0===te.isWebGLMultipleRenderTargets?te.texture:[te.texture];for(let rt=0,dt=Re.length;rt<dt;rt++){const Tt=Re[rt];if(q(Tt,$)){const Cn=te.isWebGLCubeRenderTarget?34067:3553,Ie=i.get(Tt).__webglTexture;t.bindTexture(Cn,Ie),ne(Cn),t.unbindTexture()}}},this.updateMultisampleRenderTarget=function Pn(te){if(c&&te.samples>0&&!1===cn(te)){const $=te.isWebGLMultipleRenderTargets?te.texture:[te.texture],Re=te.width,rt=te.height;let dt=16384;const Tt=[],Cn=te.stencilBuffer?33306:36096,Ie=i.get(te),Qt=!0===te.isWebGLMultipleRenderTargets;if(Qt)for(let Vt=0;Vt<$.length;Vt++)t.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Vt,36161,null),t.bindFramebuffer(36160,Ie.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Vt,3553,null,0);t.bindFramebuffer(36008,Ie.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,Ie.__webglFramebuffer);for(let Vt=0;Vt<$.length;Vt++){Tt.push(36064+Vt),te.depthBuffer&&Tt.push(Cn);const kt=void 0!==Ie.__ignoreDepthValues&&Ie.__ignoreDepthValues;if(!1===kt&&(te.depthBuffer&&(dt|=256),te.stencilBuffer&&(dt|=1024)),Qt&&n.framebufferRenderbuffer(36008,36064,36161,Ie.__webglColorRenderbuffer[Vt]),!0===kt&&(n.invalidateFramebuffer(36008,[Cn]),n.invalidateFramebuffer(36009,[Cn])),Qt){const ce=i.get($[Vt]).__webglTexture;n.framebufferTexture2D(36009,36064,3553,ce,0)}n.blitFramebuffer(0,0,Re,rt,0,0,Re,rt,dt,9728),M&&n.invalidateFramebuffer(36008,Tt)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),Qt)for(let Vt=0;Vt<$.length;Vt++){t.bindFramebuffer(36160,Ie.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(36160,36064+Vt,36161,Ie.__webglColorRenderbuffer[Vt]);const kt=i.get($[Vt]).__webglTexture;t.bindFramebuffer(36160,Ie.__webglFramebuffer),n.framebufferTexture2D(36009,36064+Vt,3553,kt,0)}t.bindFramebuffer(36009,Ie.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=ze,this.setupFrameBufferTexture=ft,this.useMultisampledRTT=cn}function AZ(n,e,t){const i=t.isWebGL2;return{convert:function r(o,l=null){let c;if(o===kf)return 5121;if(1017===o)return 32819;if(1018===o)return 32820;if(1010===o)return 5120;if(1011===o)return 5122;if(1012===o)return 5123;if(1013===o)return 5124;if(o===Bf)return 5125;if(o===Dd)return 5126;if(o===F0)return i?5131:(c=e.get("OES_texture_half_float"),null!==c?c.HALF_FLOAT_OES:null);if(1021===o)return 6406;if(o===dl)return 6408;if(1024===o)return 6409;if(1025===o)return 6410;if(o===Vf)return 6402;if(o===Hg)return 34041;if(1028===o)return 6403;if(1022===o)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===o)return c=e.get("EXT_sRGB"),null!==c?c.SRGB_ALPHA_EXT:null;if(1029===o)return 36244;if(1030===o)return 33319;if(1031===o)return 33320;if(1033===o)return 36249;if(33776===o||33777===o||33778===o||33779===o)if(l===Er){if(c=e.get("WEBGL_compressed_texture_s3tc_srgb"),null===c)return null;if(33776===o)return c.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===o)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===o)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===o)return c.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(c=e.get("WEBGL_compressed_texture_s3tc"),null===c)return null;if(33776===o)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===o)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===o)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===o)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===o||35841===o||35842===o||35843===o){if(c=e.get("WEBGL_compressed_texture_pvrtc"),null===c)return null;if(35840===o)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===o)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===o)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===o)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===o)return c=e.get("WEBGL_compressed_texture_etc1"),null!==c?c.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===o||37496===o){if(c=e.get("WEBGL_compressed_texture_etc"),null===c)return null;if(37492===o)return l===Er?c.COMPRESSED_SRGB8_ETC2:c.COMPRESSED_RGB8_ETC2;if(37496===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:c.COMPRESSED_RGBA8_ETC2_EAC}if(37808===o||37809===o||37810===o||37811===o||37812===o||37813===o||37814===o||37815===o||37816===o||37817===o||37818===o||37819===o||37820===o||37821===o){if(c=e.get("WEBGL_compressed_texture_astc"),null===c)return null;if(37808===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:c.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:c.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:c.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:c.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:c.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:c.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:c.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:c.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:c.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:c.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:c.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:c.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:c.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===o)return l===Er?c.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:c.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===o){if(c=e.get("EXT_texture_compression_bptc"),null===c)return null;if(36492===o)return l===Er?c.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:c.COMPRESSED_RGBA_BPTC_UNORM_EXT}return o===zg?i?34042:(c=e.get("WEBGL_depth_texture"),null!==c?c.UNSIGNED_INT_24_8_WEBGL:null):void 0!==n[o]?n[o]:null}}}class DZ extends Ds{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class m_ extends fo{constructor(){super(),this.isGroup=!0,this.type="Group"}}const RZ={type:"move"};class HR{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new m_,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new m_,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Z),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new m_,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Z),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,o=null,l=null;const c=this._targetRay,h=this._grip,p=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(p&&e.hand){l=!0;for(const C of e.hand.values()){const T=t.getJointPose(C,i);if(void 0===p.joints[C.jointName]){const O=new m_;O.matrixAutoUpdate=!1,O.visible=!1,p.joints[C.jointName]=O,p.add(O)}const P=p.joints[C.jointName];null!==T&&(P.matrix.fromArray(T.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),P.jointRadius=T.radius),P.visible=null!==T}const x=p.joints["index-finger-tip"].position.distanceTo(p.joints["thumb-tip"].position),M=.02,S=.005;p.inputState.pinching&&x>M+S?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&x<=M-S&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==h&&e.gripSpace&&(o=t.getPose(e.gripSpace,i),null!==o&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),o.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(o.linearVelocity)):h.hasLinearVelocity=!1,o.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(o.angularVelocity)):h.hasAngularVelocity=!1));null!==c&&(r=t.getPose(e.targetRaySpace,i),null===r&&null!==o&&(r=o),null!==r&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(RZ)))}return null!==c&&(c.visible=null!==r),null!==h&&(h.visible=null!==o),null!==p&&(p.visible=null!==l),this}}class IZ extends Rd{constructor(e,t,i,r,o,l,c,h,p,g){if((g=void 0!==g?g:Vf)!==Vf&&g!==Hg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&g===Vf&&(i=Bf),void 0===i&&g===Hg&&(i=zg),super(null,r,o,l,c,h,g,i,p),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==c?c:is,this.minFilter=void 0!==h?h:is,this.flipY=!1,this.generateMipmaps=!1}}class LZ extends qg{constructor(e,t){super();const i=this;let r=null,o=1,l=null,c="local-floor",h=null,p=null,g=null,y=null,x=null,M=null;const S=t.getContextAttributes();let C=null,T=null;const P=[],O=[],k=new Ds;k.layers.enable(1),k.viewport=new Bi;const B=new Ds;B.layers.enable(2),B.viewport=new Bi;const z=[k,B],q=new DZ;q.layers.enable(1),q.layers.enable(2);let ne=null,U=null;function ee(_e){const Se=O.indexOf(_e.inputSource);if(-1===Se)return;const Je=P[Se];void 0!==Je&&Je.dispatchEvent({type:_e.type,data:_e.inputSource})}function le(){r.removeEventListener("select",ee),r.removeEventListener("selectstart",ee),r.removeEventListener("selectend",ee),r.removeEventListener("squeeze",ee),r.removeEventListener("squeezestart",ee),r.removeEventListener("squeezeend",ee),r.removeEventListener("end",le),r.removeEventListener("inputsourceschange",me);for(let _e=0;_e<P.length;_e++){const Se=O[_e];null!==Se&&(O[_e]=null,P[_e].disconnect(Se))}ne=null,U=null,e.setRenderTarget(C),x=null,y=null,g=null,r=null,T=null,xe.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function me(_e){for(let Se=0;Se<_e.removed.length;Se++){const Je=_e.removed[Se],Ve=O.indexOf(Je);Ve>=0&&(O[Ve]=null,P[Ve].dispatchEvent({type:"disconnected",data:Je}))}for(let Se=0;Se<_e.added.length;Se++){const Je=_e.added[Se];let Ve=O.indexOf(Je);if(-1===Ve){for(let ct=0;ct<P.length;ct++){if(ct>=O.length){O.push(Je),Ve=ct;break}if(null===O[ct]){O[ct]=Je,Ve=ct;break}}if(-1===Ve)break}const ot=P[Ve];ot&&ot.dispatchEvent({type:"connected",data:Je})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(_e){let Se=P[_e];return void 0===Se&&(Se=new HR,P[_e]=Se),Se.getTargetRaySpace()},this.getControllerGrip=function(_e){let Se=P[_e];return void 0===Se&&(Se=new HR,P[_e]=Se),Se.getGripSpace()},this.getHand=function(_e){let Se=P[_e];return void 0===Se&&(Se=new HR,P[_e]=Se),Se.getHandSpace()},this.setFramebufferScaleFactor=function(_e){o=_e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(_e){c=_e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||l},this.setReferenceSpace=function(_e){h=_e},this.getBaseLayer=function(){return null!==y?y:x},this.getBinding=function(){return g},this.getFrame=function(){return M},this.getSession=function(){return r},this.setSession=function(){var _e=(0,o9.Z)(function*(Se){if(r=Se,null!==r){if(C=e.getRenderTarget(),r.addEventListener("select",ee),r.addEventListener("selectstart",ee),r.addEventListener("selectend",ee),r.addEventListener("squeeze",ee),r.addEventListener("squeezestart",ee),r.addEventListener("squeezeend",ee),r.addEventListener("end",le),r.addEventListener("inputsourceschange",me),!0!==S.xrCompatible&&(yield t.makeXRCompatible()),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2)x=new XRWebGLLayer(r,t,{antialias:void 0!==r.renderState.layers||S.antialias,alpha:S.alpha,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:o}),r.updateRenderState({baseLayer:x}),T=new Wf(x.framebufferWidth,x.framebufferHeight,{format:dl,type:kf,encoding:e.outputEncoding});else{let Je=null,Ve=null,ot=null;S.depth&&(ot=S.stencil?35056:33190,Je=S.stencil?Hg:Vf,Ve=S.stencil?zg:Bf);const ct={colorFormat:32856,depthFormat:ot,scaleFactor:o};g=new XRWebGLBinding(r,t),y=g.createProjectionLayer(ct),r.updateRenderState({layers:[y]}),T=new Wf(y.textureWidth,y.textureHeight,{format:dl,type:kf,depthTexture:new IZ(y.textureWidth,y.textureHeight,Ve,void 0,void 0,void 0,void 0,void 0,void 0,Je),stencilBuffer:S.stencil,encoding:e.outputEncoding,samples:S.antialias?4:0}),e.properties.get(T).__ignoreDepthValues=y.ignoreDepthValues}T.isXRRenderTarget=!0,this.setFoveation(1),h=null,l=yield r.requestReferenceSpace(c),xe.setContext(r),xe.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}});return function(Se){return _e.apply(this,arguments)}}();const Oe=new Z,tt=new Z;function Pe(_e,Se){null===Se?_e.matrixWorld.copy(_e.matrix):_e.matrixWorld.multiplyMatrices(Se.matrixWorld,_e.matrix),_e.matrixWorldInverse.copy(_e.matrixWorld).invert()}this.updateCamera=function(_e){if(null===r)return;q.near=B.near=k.near=_e.near,q.far=B.far=k.far=_e.far,(ne!==q.near||U!==q.far)&&(r.updateRenderState({depthNear:q.near,depthFar:q.far}),ne=q.near,U=q.far);const Se=_e.parent,Je=q.cameras;Pe(q,Se);for(let ot=0;ot<Je.length;ot++)Pe(Je[ot],Se);q.matrixWorld.decompose(q.position,q.quaternion,q.scale),_e.position.copy(q.position),_e.quaternion.copy(q.quaternion),_e.scale.copy(q.scale),_e.matrix.copy(q.matrix),_e.matrixWorld.copy(q.matrixWorld);const Ve=_e.children;for(let ot=0,ct=Ve.length;ot<ct;ot++)Ve[ot].updateMatrixWorld(!0);2===Je.length?function ge(_e,Se,Je){Oe.setFromMatrixPosition(Se.matrixWorld),tt.setFromMatrixPosition(Je.matrixWorld);const Ve=Oe.distanceTo(tt),ot=Se.projectionMatrix.elements,ct=Je.projectionMatrix.elements,$t=ot[14]/(ot[10]-1),Ne=ot[14]/(ot[10]+1),bn=(ot[9]+1)/ot[5],dn=(ot[9]-1)/ot[5],Kt=(ot[8]-1)/ot[0],ft=(ct[8]+1)/ct[0],Dn=$t*Kt,je=$t*ft,ze=Ve/(-Kt+ft),pt=ze*-Kt;Se.matrixWorld.decompose(_e.position,_e.quaternion,_e.scale),_e.translateX(pt),_e.translateZ(ze),_e.matrixWorld.compose(_e.position,_e.quaternion,_e.scale),_e.matrixWorldInverse.copy(_e.matrixWorld).invert();const qt=$t+ze,Ct=Ne+ze;_e.projectionMatrix.makePerspective(Dn-pt,je+(Ve-pt),bn*Ne/Ct*qt,dn*Ne/Ct*qt,qt,Ct)}(q,k,B):q.projectionMatrix.copy(k.projectionMatrix)},this.getCamera=function(){return q},this.getFoveation=function(){return null!==y?y.fixedFoveation:null!==x?x.fixedFoveation:void 0},this.setFoveation=function(_e){null!==y&&(y.fixedFoveation=_e),null!==x&&void 0!==x.fixedFoveation&&(x.fixedFoveation=_e)};let ae=null;const xe=new W3;xe.setAnimationLoop(function ye(_e,Se){if(p=Se.getViewerPose(h||l),M=Se,null!==p){const Je=p.views;null!==x&&(e.setRenderTargetFramebuffer(T,x.framebuffer),e.setRenderTarget(T));let Ve=!1;Je.length!==q.cameras.length&&(q.cameras.length=0,Ve=!0);for(let ot=0;ot<Je.length;ot++){const ct=Je[ot];let $t=null;if(null!==x)$t=x.getViewport(ct);else{const bn=g.getViewSubImage(y,ct);$t=bn.viewport,0===ot&&(e.setRenderTargetTextures(T,bn.colorTexture,y.ignoreDepthValues?void 0:bn.depthStencilTexture),e.setRenderTarget(T))}let Ne=z[ot];void 0===Ne&&(Ne=new Ds,Ne.layers.enable(ot),Ne.viewport=new Bi,z[ot]=Ne),Ne.matrix.fromArray(ct.transform.matrix),Ne.projectionMatrix.fromArray(ct.projectionMatrix),Ne.viewport.set($t.x,$t.y,$t.width,$t.height),0===ot&&q.matrix.copy(Ne.matrix),!0===Ve&&q.cameras.push(Ne)}}for(let Je=0;Je<P.length;Je++){const Ve=O[Je],ot=P[Je];null!==Ve&&void 0!==ot&&ot.update(Ve,Se,h||l)}ae&&ae(_e,Se),M=null}),this.setAnimationLoop=function(_e){ae=_e},this.dispose=function(){}}}function PZ(n,e){function r(C,T){C.opacity.value=T.opacity,T.color&&C.diffuse.value.copy(T.color),T.emissive&&C.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(C.map.value=T.map),T.alphaMap&&(C.alphaMap.value=T.alphaMap),T.bumpMap&&(C.bumpMap.value=T.bumpMap,C.bumpScale.value=T.bumpScale,1===T.side&&(C.bumpScale.value*=-1)),T.displacementMap&&(C.displacementMap.value=T.displacementMap,C.displacementScale.value=T.displacementScale,C.displacementBias.value=T.displacementBias),T.emissiveMap&&(C.emissiveMap.value=T.emissiveMap),T.normalMap&&(C.normalMap.value=T.normalMap,C.normalScale.value.copy(T.normalScale),1===T.side&&C.normalScale.value.negate()),T.specularMap&&(C.specularMap.value=T.specularMap),T.alphaTest>0&&(C.alphaTest.value=T.alphaTest);const P=e.get(T).envMap;if(P&&(C.envMap.value=P,C.flipEnvMap.value=P.isCubeTexture&&!1===P.isRenderTargetTexture?-1:1,C.reflectivity.value=T.reflectivity,C.ior.value=T.ior,C.refractionRatio.value=T.refractionRatio),T.lightMap){C.lightMap.value=T.lightMap;const B=!0!==n.physicallyCorrectLights?Math.PI:1;C.lightMapIntensity.value=T.lightMapIntensity*B}let O,k;T.aoMap&&(C.aoMap.value=T.aoMap,C.aoMapIntensity.value=T.aoMapIntensity),T.map?O=T.map:T.specularMap?O=T.specularMap:T.displacementMap?O=T.displacementMap:T.normalMap?O=T.normalMap:T.bumpMap?O=T.bumpMap:T.roughnessMap?O=T.roughnessMap:T.metalnessMap?O=T.metalnessMap:T.alphaMap?O=T.alphaMap:T.emissiveMap?O=T.emissiveMap:T.clearcoatMap?O=T.clearcoatMap:T.clearcoatNormalMap?O=T.clearcoatNormalMap:T.clearcoatRoughnessMap?O=T.clearcoatRoughnessMap:T.iridescenceMap?O=T.iridescenceMap:T.iridescenceThicknessMap?O=T.iridescenceThicknessMap:T.specularIntensityMap?O=T.specularIntensityMap:T.specularColorMap?O=T.specularColorMap:T.transmissionMap?O=T.transmissionMap:T.thicknessMap?O=T.thicknessMap:T.sheenColorMap?O=T.sheenColorMap:T.sheenRoughnessMap&&(O=T.sheenRoughnessMap),void 0!==O&&(O.isWebGLRenderTarget&&(O=O.texture),!0===O.matrixAutoUpdate&&O.updateMatrix(),C.uvTransform.value.copy(O.matrix)),T.aoMap?k=T.aoMap:T.lightMap&&(k=T.lightMap),void 0!==k&&(k.isWebGLRenderTarget&&(k=k.texture),!0===k.matrixAutoUpdate&&k.updateMatrix(),C.uv2Transform.value.copy(k.matrix))}return{refreshFogUniforms:function t(C,T){C.fogColor.value.copy(T.color),T.isFog?(C.fogNear.value=T.near,C.fogFar.value=T.far):T.isFogExp2&&(C.fogDensity.value=T.density)},refreshMaterialUniforms:function i(C,T,P,O,k){T.isMeshBasicMaterial||T.isMeshLambertMaterial?r(C,T):T.isMeshToonMaterial?(r(C,T),function g(C,T){T.gradientMap&&(C.gradientMap.value=T.gradientMap)}(C,T)):T.isMeshPhongMaterial?(r(C,T),function p(C,T){C.specular.value.copy(T.specular),C.shininess.value=Math.max(T.shininess,1e-4)}(C,T)):T.isMeshStandardMaterial?(r(C,T),function y(C,T){C.roughness.value=T.roughness,C.metalness.value=T.metalness,T.roughnessMap&&(C.roughnessMap.value=T.roughnessMap),T.metalnessMap&&(C.metalnessMap.value=T.metalnessMap),e.get(T).envMap&&(C.envMapIntensity.value=T.envMapIntensity)}(C,T),T.isMeshPhysicalMaterial&&function x(C,T,P){C.ior.value=T.ior,T.sheen>0&&(C.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),C.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(C.sheenColorMap.value=T.sheenColorMap),T.sheenRoughnessMap&&(C.sheenRoughnessMap.value=T.sheenRoughnessMap)),T.clearcoat>0&&(C.clearcoat.value=T.clearcoat,C.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(C.clearcoatMap.value=T.clearcoatMap),T.clearcoatRoughnessMap&&(C.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap),T.clearcoatNormalMap&&(C.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),C.clearcoatNormalMap.value=T.clearcoatNormalMap,1===T.side&&C.clearcoatNormalScale.value.negate())),T.iridescence>0&&(C.iridescence.value=T.iridescence,C.iridescenceIOR.value=T.iridescenceIOR,C.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],C.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(C.iridescenceMap.value=T.iridescenceMap),T.iridescenceThicknessMap&&(C.iridescenceThicknessMap.value=T.iridescenceThicknessMap)),T.transmission>0&&(C.transmission.value=T.transmission,C.transmissionSamplerMap.value=P.texture,C.transmissionSamplerSize.value.set(P.width,P.height),T.transmissionMap&&(C.transmissionMap.value=T.transmissionMap),C.thickness.value=T.thickness,T.thicknessMap&&(C.thicknessMap.value=T.thicknessMap),C.attenuationDistance.value=T.attenuationDistance,C.attenuationColor.value.copy(T.attenuationColor)),C.specularIntensity.value=T.specularIntensity,C.specularColor.value.copy(T.specularColor),T.specularIntensityMap&&(C.specularIntensityMap.value=T.specularIntensityMap),T.specularColorMap&&(C.specularColorMap.value=T.specularColorMap)}(C,T,k)):T.isMeshMatcapMaterial?(r(C,T),function M(C,T){T.matcap&&(C.matcap.value=T.matcap)}(C,T)):T.isMeshDepthMaterial?r(C,T):T.isMeshDistanceMaterial?(r(C,T),function S(C,T){C.referencePosition.value.copy(T.referencePosition),C.nearDistance.value=T.nearDistance,C.farDistance.value=T.farDistance}(C,T)):T.isMeshNormalMaterial?r(C,T):T.isLineBasicMaterial?(function o(C,T){C.diffuse.value.copy(T.color),C.opacity.value=T.opacity}(C,T),T.isLineDashedMaterial&&function l(C,T){C.dashSize.value=T.dashSize,C.totalSize.value=T.dashSize+T.gapSize,C.scale.value=T.scale}(C,T)):T.isPointsMaterial?function c(C,T,P,O){let k;C.diffuse.value.copy(T.color),C.opacity.value=T.opacity,C.size.value=T.size*P,C.scale.value=.5*O,T.map&&(C.map.value=T.map),T.alphaMap&&(C.alphaMap.value=T.alphaMap),T.alphaTest>0&&(C.alphaTest.value=T.alphaTest),T.map?k=T.map:T.alphaMap&&(k=T.alphaMap),void 0!==k&&(!0===k.matrixAutoUpdate&&k.updateMatrix(),C.uvTransform.value.copy(k.matrix))}(C,T,P,O):T.isSpriteMaterial?function h(C,T){let P;C.diffuse.value.copy(T.color),C.opacity.value=T.opacity,C.rotation.value=T.rotation,T.map&&(C.map.value=T.map),T.alphaMap&&(C.alphaMap.value=T.alphaMap),T.alphaTest>0&&(C.alphaTest.value=T.alphaTest),T.map?P=T.map:T.alphaMap&&(P=T.alphaMap),void 0!==P&&(!0===P.matrixAutoUpdate&&P.updateMatrix(),C.uvTransform.value.copy(P.matrix))}(C,T):T.isShadowMaterial?(C.color.value.copy(T.color),C.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}}}function xk(n={}){this.isWebGLRenderer=!0;const e=void 0!==n.canvas?n.canvas:function FZ(){const n=k0("canvas");return n.style.display="block",n}(),t=void 0!==n.context?n.context:null,i=void 0===n.depth||n.depth,r=void 0===n.stencil||n.stencil,o=void 0!==n.antialias&&n.antialias,l=void 0===n.premultipliedAlpha||n.premultipliedAlpha,c=void 0!==n.preserveDrawingBuffer&&n.preserveDrawingBuffer,h=void 0!==n.powerPreference?n.powerPreference:"default",p=void 0!==n.failIfMajorPerformanceCaveat&&n.failIfMajorPerformanceCaveat;let g;g=null!==t?t.getContextAttributes().alpha:void 0!==n.alpha&&n.alpha;let y=null,x=null;const M=[],S=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Uf,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const C=this;let T=!1,P=0,O=0,k=null,B=-1,z=null;const q=new Bi,ne=new Bi;let U=null,ee=e.width,le=e.height,me=1,Oe=null,tt=null;const ge=new Bi(0,0,ee,le),Pe=new Bi(0,0,ee,le);let ae=!1;const ye=new FR;let xe=!1,_e=!1,Se=null;const Je=new Bn,Ve=new Xe,ot=new Z,ct={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function $t(){return null===k?me:1}let dn,Kt,ft,Dn,je,ze,pt,qt,Ct,Pn,_n,cn,ir,$i,te,$,Re,rt,dt,Tt,Cn,Ie,Qt,Ne=t;function bn(J,Me){for(let Le=0;Le<J.length;Le++){const Ge=e.getContext(J[Le],Me);if(null!==Ge)return Ge}return null}try{const J={alpha:!0,depth:i,stencil:r,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:h,failIfMajorPerformanceCaveat:p};if("setAttribute"in e&&e.setAttribute("data-engine","three.js r142"),e.addEventListener("webglcontextlost",ce,!1),e.addEventListener("webglcontextrestored",xt,!1),e.addEventListener("webglcontextcreationerror",_t,!1),null===Ne){const Me=["webgl2","webgl","experimental-webgl"];if(!0===C.isWebGL1Renderer&&Me.shift(),Ne=bn(Me,J),null===Ne)throw bn(Me)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ne.getShaderPrecisionFormat&&(Ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(J){throw console.error("THREE.WebGLRenderer: "+J.message),J}function Vt(){dn=new $$(Ne),Kt=new z$(Ne,dn,n),dn.init(Kt),Ie=new AZ(Ne,dn,Kt),ft=new CZ(Ne,dn,Kt),Dn=new Y$,je=new pZ,ze=new TZ(Ne,dn,ft,je,Kt,Ie,Dn),pt=new G$(C),qt=new q$(C),Ct=new U7(Ne,Kt),Qt=new V$(Ne,dn,Ct,Kt),Pn=new X$(Ne,Ct,Dn,Qt),_n=new eX(Ne,Pn,Ct,Dn),dt=new Q$(Ne,Kt,ze),$=new H$(je),cn=new fZ(C,pt,qt,dn,Kt,Qt,$),ir=new PZ(C,je),$i=new gZ,te=new wZ(dn,Kt),rt=new B$(C,pt,ft,_n,g,l),Re=new EZ(C,_n,Kt),Tt=new U$(Ne,dn,Dn,Kt),Cn=new Z$(Ne,dn,Dn,Kt),Dn.programs=cn.programs,C.capabilities=Kt,C.extensions=dn,C.properties=je,C.renderLists=$i,C.shadowMap=Re,C.state=ft,C.info=Dn}Vt();const kt=new LZ(C,Ne);function ce(J){J.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function xt(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const J=Dn.autoReset,Me=Re.enabled,Le=Re.autoUpdate,Te=Re.needsUpdate,Ge=Re.type;Vt(),Dn.autoReset=J,Re.enabled=Me,Re.autoUpdate=Le,Re.needsUpdate=Te,Re.type=Ge}function _t(J){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",J.statusMessage)}function xn(J){const Me=J.target;Me.removeEventListener("dispose",xn),function zt(J){(function Tn(J){const Me=je.get(J).programs;void 0!==Me&&(Me.forEach(function(Le){cn.releaseProgram(Le)}),J.isShaderMaterial&&cn.releaseShaderCache(J))})(J),je.remove(J)}(Me)}this.xr=kt,this.getContext=function(){return Ne},this.getContextAttributes=function(){return Ne.getContextAttributes()},this.forceContextLoss=function(){const J=dn.get("WEBGL_lose_context");J&&J.loseContext()},this.forceContextRestore=function(){const J=dn.get("WEBGL_lose_context");J&&J.restoreContext()},this.getPixelRatio=function(){return me},this.setPixelRatio=function(J){void 0!==J&&(me=J,this.setSize(ee,le,!1))},this.getSize=function(J){return J.set(ee,le)},this.setSize=function(J,Me,Le){kt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ee=J,le=Me,e.width=Math.floor(J*me),e.height=Math.floor(Me*me),!1!==Le&&(e.style.width=J+"px",e.style.height=Me+"px"),this.setViewport(0,0,J,Me))},this.getDrawingBufferSize=function(J){return J.set(ee*me,le*me).floor()},this.setDrawingBufferSize=function(J,Me,Le){ee=J,le=Me,me=Le,e.width=Math.floor(J*Le),e.height=Math.floor(Me*Le),this.setViewport(0,0,J,Me)},this.getCurrentViewport=function(J){return J.copy(q)},this.getViewport=function(J){return J.copy(ge)},this.setViewport=function(J,Me,Le,Te){J.isVector4?ge.set(J.x,J.y,J.z,J.w):ge.set(J,Me,Le,Te),ft.viewport(q.copy(ge).multiplyScalar(me).floor())},this.getScissor=function(J){return J.copy(Pe)},this.setScissor=function(J,Me,Le,Te){J.isVector4?Pe.set(J.x,J.y,J.z,J.w):Pe.set(J,Me,Le,Te),ft.scissor(ne.copy(Pe).multiplyScalar(me).floor())},this.getScissorTest=function(){return ae},this.setScissorTest=function(J){ft.setScissorTest(ae=J)},this.setOpaqueSort=function(J){Oe=J},this.setTransparentSort=function(J){tt=J},this.getClearColor=function(J){return J.copy(rt.getClearColor())},this.setClearColor=function(){rt.setClearColor.apply(rt,arguments)},this.getClearAlpha=function(){return rt.getClearAlpha()},this.setClearAlpha=function(){rt.setClearAlpha.apply(rt,arguments)},this.clear=function(J=!0,Me=!0,Le=!0){let Te=0;J&&(Te|=16384),Me&&(Te|=256),Le&&(Te|=1024),Ne.clear(Te)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ce,!1),e.removeEventListener("webglcontextrestored",xt,!1),e.removeEventListener("webglcontextcreationerror",_t,!1),$i.dispose(),te.dispose(),je.dispose(),pt.dispose(),qt.dispose(),_n.dispose(),Qt.dispose(),cn.dispose(),kt.dispose(),kt.removeEventListener("sessionstart",Vi),kt.removeEventListener("sessionend",Ui),Se&&(Se.dispose(),Se=null),vo.stop()},this.renderBufferDirect=function(J,Me,Le,Te,Ge,wn){null===Me&&(Me=ct);const Fn=Ge.isMesh&&Ge.matrixWorld.determinant()<0,$n=function xre(J,Me,Le,Te,Ge){!0!==Me.isScene&&(Me=ct),ze.resetTextureUnits();const wn=Me.fog,$n=null===k?C.outputEncoding:!0===k.isXRRenderTarget?k.texture.encoding:Uf,Gn=(Te.isMeshStandardMaterial?qt:pt).get(Te.envMap||(Te.isMeshStandardMaterial?Me.environment:null)),zi=!0===Te.vertexColors&&!!Le.attributes.color&&4===Le.attributes.color.itemSize,bi=!!Te.normalMap&&!!Le.attributes.tangent,Si=!!Le.morphAttributes.position,Ar=!!Le.morphAttributes.normal,cp=!!Le.morphAttributes.color,k_=Te.toneMapped?C.toneMapping:0,B_=Le.morphAttributes.position||Le.morphAttributes.normal||Le.morphAttributes.color,nc=void 0!==B_?B_.length:0,Pi=je.get(Te),V_=x.state.lights;!0!==xe||!0!==_e&&J===z||$.setState(Te,J,J===z&&Te.id===B);let Zr=!1;Te.version===Pi.__version?(Pi.needsLights&&Pi.lightsStateVersion!==V_.state.version||Pi.outputEncoding!==$n||Ge.isInstancedMesh&&!1===Pi.instancing||!Ge.isInstancedMesh&&!0===Pi.instancing||Ge.isSkinnedMesh&&!1===Pi.skinning||!Ge.isSkinnedMesh&&!0===Pi.skinning||Pi.envMap!==Gn||!0===Te.fog&&Pi.fog!==wn||void 0!==Pi.numClippingPlanes&&(Pi.numClippingPlanes!==$.numPlanes||Pi.numIntersection!==$.numIntersection)||Pi.vertexAlphas!==zi||Pi.vertexTangents!==bi||Pi.morphTargets!==Si||Pi.morphNormals!==Ar||Pi.morphColors!==cp||Pi.toneMapping!==k_||!0===Kt.isWebGL2&&Pi.morphTargetsCount!==nc)&&(Zr=!0):(Zr=!0,Pi.__version=Te.version);let ic=Pi.currentProgram;!0===Zr&&(ic=WL(Te,Me,Ge));let Kd=!1,Rx=!1,jL=!1;const xo=ic.getUniforms(),Ix=Pi.uniforms;if(ft.useProgram(ic.program)&&(Kd=!0,Rx=!0,jL=!0),Te.id!==B&&(B=Te.id,Rx=!0),Kd||z!==J){if(xo.setValue(Ne,"projectionMatrix",J.projectionMatrix),Kt.logarithmicDepthBuffer&&xo.setValue(Ne,"logDepthBufFC",2/(Math.log(J.far+1)/Math.LN2)),z!==J&&(z=J,Rx=!0,jL=!0),Te.isShaderMaterial||Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshStandardMaterial||Te.envMap){const rc=xo.map.cameraPosition;void 0!==rc&&rc.setValue(Ne,ot.setFromMatrixPosition(J.matrixWorld))}(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial)&&xo.setValue(Ne,"isOrthographic",!0===J.isOrthographicCamera),(Te.isMeshPhongMaterial||Te.isMeshToonMaterial||Te.isMeshLambertMaterial||Te.isMeshBasicMaterial||Te.isMeshStandardMaterial||Te.isShaderMaterial||Te.isShadowMaterial||Ge.isSkinnedMesh)&&xo.setValue(Ne,"viewMatrix",J.matrixWorldInverse)}if(Ge.isSkinnedMesh){xo.setOptional(Ne,Ge,"bindMatrix"),xo.setOptional(Ne,Ge,"bindMatrixInverse");const rc=Ge.skeleton;rc&&(Kt.floatVertexTextures?(null===rc.boneTexture&&rc.computeBoneTexture(),xo.setValue(Ne,"boneTexture",rc.boneTexture,ze),xo.setValue(Ne,"boneTextureSize",rc.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const qL=Le.morphAttributes;return(void 0!==qL.position||void 0!==qL.normal||void 0!==qL.color&&!0===Kt.isWebGL2)&&dt.update(Ge,Le,Te,ic),(Rx||Pi.receiveShadow!==Ge.receiveShadow)&&(Pi.receiveShadow=Ge.receiveShadow,xo.setValue(Ne,"receiveShadow",Ge.receiveShadow)),Rx&&(xo.setValue(Ne,"toneMappingExposure",C.toneMappingExposure),Pi.needsLights&&function bre(J,Me){J.ambientLightColor.needsUpdate=Me,J.lightProbe.needsUpdate=Me,J.directionalLights.needsUpdate=Me,J.directionalLightShadows.needsUpdate=Me,J.pointLights.needsUpdate=Me,J.pointLightShadows.needsUpdate=Me,J.spotLights.needsUpdate=Me,J.spotLightShadows.needsUpdate=Me,J.rectAreaLights.needsUpdate=Me,J.hemisphereLights.needsUpdate=Me}(Ix,jL),wn&&!0===Te.fog&&ir.refreshFogUniforms(Ix,wn),ir.refreshMaterialUniforms(Ix,Te,me,le,Se),YS.upload(Ne,Pi.uniformsList,Ix,ze)),Te.isShaderMaterial&&!0===Te.uniformsNeedUpdate&&(YS.upload(Ne,Pi.uniformsList,Ix,ze),Te.uniformsNeedUpdate=!1),Te.isSpriteMaterial&&xo.setValue(Ne,"center",Ge.center),xo.setValue(Ne,"modelViewMatrix",Ge.modelViewMatrix),xo.setValue(Ne,"normalMatrix",Ge.normalMatrix),xo.setValue(Ne,"modelMatrix",Ge.matrixWorld),ic}(J,Me,Le,Te,Ge);ft.setMaterial(Te,Fn);let Gn=Le.index;const zi=Le.attributes.position;if(null===Gn){if(void 0===zi||0===zi.count)return}else if(0===Gn.count)return;let bi=1;!0===Te.wireframe&&(Gn=Pn.getWireframeAttribute(Le),bi=2),Qt.setup(Ge,Te,$n,Le,Gn);let Si,Ar=Tt;null!==Gn&&(Si=Ct.get(Gn),Ar=Cn,Ar.setIndex(Si));const cp=null!==Gn?Gn.count:zi.count,k_=Le.drawRange.start*bi,B_=Le.drawRange.count*bi,nc=null!==wn?wn.start*bi:0,Pi=null!==wn?wn.count*bi:1/0,V_=Math.max(k_,nc),Zr=Math.min(cp,k_+B_,nc+Pi)-1,ic=Math.max(0,Zr-V_+1);if(0!==ic){if(Ge.isMesh)!0===Te.wireframe?(ft.setLineWidth(Te.wireframeLinewidth*$t()),Ar.setMode(1)):Ar.setMode(4);else if(Ge.isLine){let Kd=Te.linewidth;void 0===Kd&&(Kd=1),ft.setLineWidth(Kd*$t()),Ar.setMode(Ge.isLineSegments?1:Ge.isLineLoop?2:3)}else Ge.isPoints?Ar.setMode(0):Ge.isSprite&&Ar.setMode(4);if(Ge.isInstancedMesh)Ar.renderInstances(V_,ic,Ge.count);else if(Le.isInstancedBufferGeometry){const Kd=Math.min(Le.instanceCount,Le._maxInstanceCount);Ar.renderInstances(V_,ic,Kd)}else Ar.render(V_,ic)}},this.compile=function(J,Me){x=te.get(J),x.init(),S.push(x),J.traverseVisible(function(Le){Le.isLight&&Le.layers.test(Me.layers)&&(x.pushLight(Le),Le.castShadow&&x.pushShadow(Le))}),x.setupLights(C.physicallyCorrectLights),J.traverse(function(Le){const Te=Le.material;if(Te)if(Array.isArray(Te))for(let Ge=0;Ge<Te.length;Ge++)WL(Te[Ge],J,Le);else WL(Te,J,Le)}),S.pop(),x=null};let ut=null;function Vi(){vo.stop()}function Ui(){vo.start()}const vo=new W3;function tc(J,Me,Le,Te){if(!1===J.visible)return;if(J.layers.test(Me.layers))if(J.isGroup)Le=J.renderOrder;else if(J.isLOD)!0===J.autoUpdate&&J.update(Me);else if(J.isLight)x.pushLight(J),J.castShadow&&x.pushShadow(J);else if(J.isSprite){if(!J.frustumCulled||ye.intersectsSprite(J)){Te&&ot.setFromMatrixPosition(J.matrixWorld).applyMatrix4(Je);const Fn=_n.update(J),$n=J.material;$n.visible&&y.push(J,Fn,$n,Le,ot.z,null)}}else if((J.isMesh||J.isLine||J.isPoints)&&(J.isSkinnedMesh&&J.skeleton.frame!==Dn.render.frame&&(J.skeleton.update(),J.skeleton.frame=Dn.render.frame),!J.frustumCulled||ye.intersectsObject(J))){Te&&ot.setFromMatrixPosition(J.matrixWorld).applyMatrix4(Je);const Fn=_n.update(J),$n=J.material;if(Array.isArray($n)){const Gn=Fn.groups;for(let zi=0,bi=Gn.length;zi<bi;zi++){const Si=Gn[zi],Ar=$n[Si.materialIndex];Ar&&Ar.visible&&y.push(J,Fn,Ar,Le,ot.z,Si)}}else $n.visible&&y.push(J,Fn,$n,Le,ot.z,null)}const wn=J.children;for(let Fn=0,$n=wn.length;Fn<$n;Fn++)tc(wn[Fn],Me,Le,Te)}function lH(J,Me,Le,Te){const Ge=J.opaque,wn=J.transmissive,Fn=J.transparent;x.setupLightsView(Le),wn.length>0&&function yre(J,Me,Le){const Te=Kt.isWebGL2;null===Se&&(Se=new Wf(1,1,{generateMipmaps:!0,type:dn.has("EXT_color_buffer_half_float")?F0:kf,minFilter:1008,samples:Te&&!0===o?4:0})),C.getDrawingBufferSize(Ve),Te?Se.setSize(Ve.x,Ve.y):Se.setSize(ES(Ve.x),ES(Ve.y));const Ge=C.getRenderTarget();C.setRenderTarget(Se),C.clear();const wn=C.toneMapping;C.toneMapping=0,FC(J,Me,Le),C.toneMapping=wn,ze.updateMultisampleRenderTarget(Se),ze.updateRenderTargetMipmap(Se),C.setRenderTarget(Ge)}(Ge,Me,Le),Te&&ft.viewport(q.copy(Te)),Ge.length>0&&FC(Ge,Me,Le),wn.length>0&&FC(wn,Me,Le),Fn.length>0&&FC(Fn,Me,Le),ft.buffers.depth.setTest(!0),ft.buffers.depth.setMask(!0),ft.buffers.color.setMask(!0),ft.setPolygonOffset(!1)}function FC(J,Me,Le){const Te=!0===Me.isScene?Me.overrideMaterial:null;for(let Ge=0,wn=J.length;Ge<wn;Ge++){const Fn=J[Ge],$n=Fn.object,Gn=Fn.geometry,zi=null===Te?Fn.material:Te,bi=Fn.group;$n.layers.test(Le.layers)&&vre($n,Me,Le,Gn,zi,bi)}}function vre(J,Me,Le,Te,Ge,wn){J.onBeforeRender(C,Me,Le,Te,Ge,wn),J.modelViewMatrix.multiplyMatrices(Le.matrixWorldInverse,J.matrixWorld),J.normalMatrix.getNormalMatrix(J.modelViewMatrix),Ge.onBeforeRender(C,Me,Le,Te,J,wn),!0===Ge.transparent&&2===Ge.side?(Ge.side=1,Ge.needsUpdate=!0,C.renderBufferDirect(Le,Me,Te,Ge,J,wn),Ge.side=0,Ge.needsUpdate=!0,C.renderBufferDirect(Le,Me,Te,Ge,J,wn),Ge.side=2):C.renderBufferDirect(Le,Me,Te,Ge,J,wn),J.onAfterRender(C,Me,Le,Te,Ge,wn)}function WL(J,Me,Le){!0!==Me.isScene&&(Me=ct);const Te=je.get(J),Ge=x.state.lights,Fn=Ge.state.version,$n=cn.getParameters(J,Ge.state,x.state.shadowsArray,Me,Le),Gn=cn.getProgramCacheKey($n);let zi=Te.programs;Te.environment=J.isMeshStandardMaterial?Me.environment:null,Te.fog=Me.fog,Te.envMap=(J.isMeshStandardMaterial?qt:pt).get(J.envMap||Te.environment),void 0===zi&&(J.addEventListener("dispose",xn),zi=new Map,Te.programs=zi);let bi=zi.get(Gn);if(void 0!==bi){if(Te.currentProgram===bi&&Te.lightsStateVersion===Fn)return cH(J,$n),bi}else $n.uniforms=cn.getUniforms(J),J.onBuild(Le,$n,C),J.onBeforeCompile($n,C),bi=cn.acquireProgram($n,Gn),zi.set(Gn,bi),Te.uniforms=$n.uniforms;const Si=Te.uniforms;(!J.isShaderMaterial&&!J.isRawShaderMaterial||!0===J.clipping)&&(Si.clippingPlanes=$.uniform),cH(J,$n),Te.needsLights=function wre(J){return J.isMeshLambertMaterial||J.isMeshToonMaterial||J.isMeshPhongMaterial||J.isMeshStandardMaterial||J.isShadowMaterial||J.isShaderMaterial&&!0===J.lights}(J),Te.lightsStateVersion=Fn,Te.needsLights&&(Si.ambientLightColor.value=Ge.state.ambient,Si.lightProbe.value=Ge.state.probe,Si.directionalLights.value=Ge.state.directional,Si.directionalLightShadows.value=Ge.state.directionalShadow,Si.spotLights.value=Ge.state.spot,Si.spotLightShadows.value=Ge.state.spotShadow,Si.rectAreaLights.value=Ge.state.rectArea,Si.ltc_1.value=Ge.state.rectAreaLTC1,Si.ltc_2.value=Ge.state.rectAreaLTC2,Si.pointLights.value=Ge.state.point,Si.pointLightShadows.value=Ge.state.pointShadow,Si.hemisphereLights.value=Ge.state.hemi,Si.directionalShadowMap.value=Ge.state.directionalShadowMap,Si.directionalShadowMatrix.value=Ge.state.directionalShadowMatrix,Si.spotShadowMap.value=Ge.state.spotShadowMap,Si.spotShadowMatrix.value=Ge.state.spotShadowMatrix,Si.pointShadowMap.value=Ge.state.pointShadowMap,Si.pointShadowMatrix.value=Ge.state.pointShadowMatrix);const Ar=bi.getUniforms(),cp=YS.seqWithValue(Ar.seq,Si);return Te.currentProgram=bi,Te.uniformsList=cp,bi}function cH(J,Me){const Le=je.get(J);Le.outputEncoding=Me.outputEncoding,Le.instancing=Me.instancing,Le.skinning=Me.skinning,Le.morphTargets=Me.morphTargets,Le.morphNormals=Me.morphNormals,Le.morphColors=Me.morphColors,Le.morphTargetsCount=Me.morphTargetsCount,Le.numClippingPlanes=Me.numClippingPlanes,Le.numIntersection=Me.numClipIntersection,Le.vertexAlphas=Me.vertexAlphas,Le.vertexTangents=Me.vertexTangents,Le.toneMapping=Me.toneMapping}vo.setAnimationLoop(function An(J){ut&&ut(J)}),"undefined"!=typeof self&&vo.setContext(self),this.setAnimationLoop=function(J){ut=J,kt.setAnimationLoop(J),null===J?vo.stop():vo.start()},kt.addEventListener("sessionstart",Vi),kt.addEventListener("sessionend",Ui),this.render=function(J,Me){if(void 0===Me||!0===Me.isCamera){if(!0!==T){if(!0===J.autoUpdate&&J.updateMatrixWorld(),null===Me.parent&&Me.updateMatrixWorld(),!0===kt.enabled&&!0===kt.isPresenting&&(!0===kt.cameraAutoUpdate&&kt.updateCamera(Me),Me=kt.getCamera()),!0===J.isScene&&J.onBeforeRender(C,J,Me,k),x=te.get(J,S.length),x.init(),S.push(x),Je.multiplyMatrices(Me.projectionMatrix,Me.matrixWorldInverse),ye.setFromProjectionMatrix(Je),_e=this.localClippingEnabled,xe=$.init(this.clippingPlanes,_e,Me),y=$i.get(J,M.length),y.init(),M.push(y),tc(J,Me,0,C.sortObjects),y.finish(),!0===C.sortObjects&&y.sort(Oe,tt),!0===xe&&$.beginShadows(),Re.render(x.state.shadowsArray,J,Me),!0===xe&&$.endShadows(),!0===this.info.autoReset&&this.info.reset(),rt.render(y,J),x.setupLights(C.physicallyCorrectLights),Me.isArrayCamera){const Te=Me.cameras;for(let Ge=0,wn=Te.length;Ge<wn;Ge++){const Fn=Te[Ge];lH(y,J,Fn,Fn.viewport)}}else lH(y,J,Me);null!==k&&(ze.updateMultisampleRenderTarget(k),ze.updateRenderTargetMipmap(k)),!0===J.isScene&&J.onAfterRender(C,J,Me),Qt.resetDefaultState(),B=-1,z=null,S.pop(),x=S.length>0?S[S.length-1]:null,M.pop(),y=M.length>0?M[M.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return O},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(J,Me,Le){je.get(J.texture).__webglTexture=Me,je.get(J.depthTexture).__webglTexture=Le;const Te=je.get(J);Te.__hasExternalTextures=!0,Te.__hasExternalTextures&&(Te.__autoAllocateDepthBuffer=void 0===Le,Te.__autoAllocateDepthBuffer||!0===dn.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Te.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(J,Me){const Le=je.get(J);Le.__webglFramebuffer=Me,Le.__useDefaultFramebuffer=void 0===Me},this.setRenderTarget=function(J,Me=0,Le=0){k=J,P=Me,O=Le;let Te=!0;if(J){const Gn=je.get(J);void 0!==Gn.__useDefaultFramebuffer?(ft.bindFramebuffer(36160,null),Te=!1):void 0===Gn.__webglFramebuffer?ze.setupRenderTarget(J):Gn.__hasExternalTextures&&ze.rebindTextures(J,je.get(J.texture).__webglTexture,je.get(J.depthTexture).__webglTexture)}let Ge=null,wn=!1,Fn=!1;if(J){const Gn=J.texture;(Gn.isData3DTexture||Gn.isDataArrayTexture)&&(Fn=!0);const zi=je.get(J).__webglFramebuffer;J.isWebGLCubeRenderTarget?(Ge=zi[Me],wn=!0):Ge=Kt.isWebGL2&&J.samples>0&&!1===ze.useMultisampledRTT(J)?je.get(J).__webglMultisampledFramebuffer:zi,q.copy(J.viewport),ne.copy(J.scissor),U=J.scissorTest}else q.copy(ge).multiplyScalar(me).floor(),ne.copy(Pe).multiplyScalar(me).floor(),U=ae;if(ft.bindFramebuffer(36160,Ge)&&Kt.drawBuffers&&Te&&ft.drawBuffers(J,Ge),ft.viewport(q),ft.scissor(ne),ft.setScissorTest(U),wn){const Gn=je.get(J.texture);Ne.framebufferTexture2D(36160,36064,34069+Me,Gn.__webglTexture,Le)}else if(Fn){const Gn=je.get(J.texture);Ne.framebufferTextureLayer(36160,36064,Gn.__webglTexture,Le||0,Me||0)}B=-1},this.readRenderTargetPixels=function(J,Me,Le,Te,Ge,wn,Fn){if(!J||!J.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let $n=je.get(J).__webglFramebuffer;if(J.isWebGLCubeRenderTarget&&void 0!==Fn&&($n=$n[Fn]),$n){ft.bindFramebuffer(36160,$n);try{const Gn=J.texture,zi=Gn.format,bi=Gn.type;if(zi!==dl&&Ie.convert(zi)!==Ne.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const Si=bi===F0&&(dn.has("EXT_color_buffer_half_float")||Kt.isWebGL2&&dn.has("EXT_color_buffer_float"));if(!(bi===kf||Ie.convert(bi)===Ne.getParameter(35738)||bi===Dd&&(Kt.isWebGL2||dn.has("OES_texture_float")||dn.has("WEBGL_color_buffer_float"))||Si))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Me>=0&&Me<=J.width-Te&&Le>=0&&Le<=J.height-Ge&&Ne.readPixels(Me,Le,Te,Ge,Ie.convert(zi),Ie.convert(bi),wn)}finally{const Gn=null!==k?je.get(k).__webglFramebuffer:null;ft.bindFramebuffer(36160,Gn)}}},this.copyFramebufferToTexture=function(J,Me,Le=0){const Te=Math.pow(2,-Le),Ge=Math.floor(Me.image.width*Te),wn=Math.floor(Me.image.height*Te);ze.setTexture2D(Me,0),Ne.copyTexSubImage2D(3553,Le,0,0,J.x,J.y,Ge,wn),ft.unbindTexture()},this.copyTextureToTexture=function(J,Me,Le,Te=0){const Ge=Me.image.width,wn=Me.image.height,Fn=Ie.convert(Le.format),$n=Ie.convert(Le.type);ze.setTexture2D(Le,0),Ne.pixelStorei(37440,Le.flipY),Ne.pixelStorei(37441,Le.premultiplyAlpha),Ne.pixelStorei(3317,Le.unpackAlignment),Me.isDataTexture?Ne.texSubImage2D(3553,Te,J.x,J.y,Ge,wn,Fn,$n,Me.image.data):Me.isCompressedTexture?Ne.compressedTexSubImage2D(3553,Te,J.x,J.y,Me.mipmaps[0].width,Me.mipmaps[0].height,Fn,Me.mipmaps[0].data):Ne.texSubImage2D(3553,Te,J.x,J.y,Fn,$n,Me.image),0===Te&&Le.generateMipmaps&&Ne.generateMipmap(3553),ft.unbindTexture()},this.copyTextureToTexture3D=function(J,Me,Le,Te,Ge=0){if(C.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const wn=J.max.x-J.min.x+1,Fn=J.max.y-J.min.y+1,$n=J.max.z-J.min.z+1,Gn=Ie.convert(Te.format),zi=Ie.convert(Te.type);let bi;if(Te.isData3DTexture)ze.setTexture3D(Te,0),bi=32879;else{if(!Te.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ze.setTexture2DArray(Te,0),bi=35866}Ne.pixelStorei(37440,Te.flipY),Ne.pixelStorei(37441,Te.premultiplyAlpha),Ne.pixelStorei(3317,Te.unpackAlignment);const Si=Ne.getParameter(3314),Ar=Ne.getParameter(32878),cp=Ne.getParameter(3316),k_=Ne.getParameter(3315),B_=Ne.getParameter(32877),nc=Le.isCompressedTexture?Le.mipmaps[0]:Le.image;Ne.pixelStorei(3314,nc.width),Ne.pixelStorei(32878,nc.height),Ne.pixelStorei(3316,J.min.x),Ne.pixelStorei(3315,J.min.y),Ne.pixelStorei(32877,J.min.z),Le.isDataTexture||Le.isData3DTexture?Ne.texSubImage3D(bi,Ge,Me.x,Me.y,Me.z,wn,Fn,$n,Gn,zi,nc.data):Le.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ne.compressedTexSubImage3D(bi,Ge,Me.x,Me.y,Me.z,wn,Fn,$n,Gn,nc.data)):Ne.texSubImage3D(bi,Ge,Me.x,Me.y,Me.z,wn,Fn,$n,Gn,zi,nc),Ne.pixelStorei(3314,Si),Ne.pixelStorei(32878,Ar),Ne.pixelStorei(3316,cp),Ne.pixelStorei(3315,k_),Ne.pixelStorei(32877,B_),0===Ge&&Te.generateMipmaps&&Ne.generateMipmap(bi),ft.unbindTexture()},this.initTexture=function(J){J.isCubeTexture?ze.setTextureCube(J,0):J.isData3DTexture?ze.setTexture3D(J,0):J.isDataArrayTexture?ze.setTexture2DArray(J,0):ze.setTexture2D(J,0),ft.unbindTexture()},this.resetState=function(){P=0,O=0,k=null,ft.reset(),Qt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}(class NZ extends xk{}).prototype.isWebGL1Renderer=!0;class bk extends fo{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}class pa extends s_{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ft(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Ok=new Z,kk=new Z,Bk=new Bn,$R=new FS,nE=new e_;class Z0 extends fo{constructor(e=new Kn,t=new pa){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[0];for(let r=1,o=t.count;r<o;r++)Ok.fromBufferAttribute(t,r-1),kk.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=Ok.distanceTo(kk);e.setAttribute("lineDistance",new Wt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,l=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),nE.copy(i.boundingSphere),nE.applyMatrix4(r),nE.radius+=o,!1===e.ray.intersectsSphere(nE))return;Bk.copy(r).invert(),$R.copy(e.ray).applyMatrix4(Bk);const c=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,p=new Z,g=new Z,y=new Z,x=new Z,M=this.isLineSegments?2:1,S=i.index,T=i.attributes.position;if(null!==S)for(let k=Math.max(0,l.start),B=Math.min(S.count,l.start+l.count)-1;k<B;k+=M){const z=S.getX(k),q=S.getX(k+1);if(p.fromBufferAttribute(T,z),g.fromBufferAttribute(T,q),$R.distanceSqToSegment(p,g,x,y)>h)continue;x.applyMatrix4(this.matrixWorld);const U=e.ray.origin.distanceTo(x);U<e.near||U>e.far||t.push({distance:U,point:y.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this})}else for(let k=Math.max(0,l.start),B=Math.min(T.count,l.start+l.count)-1;k<B;k+=M){if(p.fromBufferAttribute(T,k),g.fromBufferAttribute(T,k+1),$R.distanceSqToSegment(p,g,x,y)>h)continue;x.applyMatrix4(this.matrixWorld);const q=e.ray.origin.distanceTo(x);q<e.near||q>e.far||t.push({distance:q,point:y.clone().applyMatrix4(this.matrixWorld),index:k,face:null,faceIndex:null,object:this})}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){const c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}}const Vk=new Z,Uk=new Z;class XR extends Z0{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(null===e.index){const t=e.attributes.position,i=[];for(let r=0,o=t.count;r<o;r+=2)Vk.fromBufferAttribute(t,r),Uk.fromBufferAttribute(t,r+1),i[r]=0===r?0:i[r-1],i[r+1]=i[r]+Vk.distanceTo(Uk);e.setAttribute("lineDistance",new Wt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}const dr={arraySlice:function(n,e,t){return dr.isTypedArray(n)?new n.constructor(n.subarray(e,void 0!==t?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:"number"==typeof e.BYTES_PER_ELEMENT?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(function e(r,o){return n[r]-n[o]}),i},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let o=0,l=0;l!==i;++o){const c=t[o]*e;for(let h=0;h!==e;++h)r[l++]=n[c+h]}return r},flattenJSON:function(n,e,t,i){let r=1,o=n[0];for(;void 0!==o&&void 0===o[i];)o=n[r++];if(void 0===o)return;let l=o[i];if(void 0!==l)if(Array.isArray(l))do{l=o[i],void 0!==l&&(e.push(o.time),t.push.apply(t,l)),o=n[r++]}while(void 0!==o);else if(void 0!==l.toArray)do{l=o[i],void 0!==l&&(e.push(o.time),l.toArray(t,t.length)),o=n[r++]}while(void 0!==o);else do{l=o[i],void 0!==l&&(e.push(o.time),t.push(l)),o=n[r++]}while(void 0!==o)},subclip:function(n,e,t,i,r=30){const o=n.clone();o.name=e;const l=[];for(let h=0;h<o.tracks.length;++h){const p=o.tracks[h],g=p.getValueSize(),y=[],x=[];for(let M=0;M<p.times.length;++M){const S=p.times[M]*r;if(!(S<t||S>=i)){y.push(p.times[M]);for(let C=0;C<g;++C)x.push(p.values[M*g+C])}}0!==y.length&&(p.times=dr.convertArray(y,p.times.constructor),p.values=dr.convertArray(x,p.values.constructor),l.push(p))}o.tracks=l;let c=1/0;for(let h=0;h<o.tracks.length;++h)c>o.tracks[h].times[0]&&(c=o.tracks[h].times[0]);for(let h=0;h<o.tracks.length;++h)o.tracks[h].shift(-1*c);return o.resetDuration(),o},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,o=e/i;for(let l=0;l<r;++l){const c=t.tracks[l],h=c.ValueTypeName;if("bool"===h||"string"===h)continue;const p=n.tracks.find(function(P){return P.name===c.name&&P.ValueTypeName===h});if(void 0===p)continue;let g=0;const y=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=y/3);let x=0;const M=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(x=M/3);const S=c.times.length-1;let C;if(o<=c.times[0])C=dr.arraySlice(c.values,g,y-g);else if(o>=c.times[S]){const P=S*y+g;C=dr.arraySlice(c.values,P,P+y-g)}else{const P=c.createInterpolant(),O=g,k=y-g;P.evaluate(o),C=dr.arraySlice(P.resultBuffer,O,k)}"quaternion"===h&&(new da).fromArray(C).normalize().conjugate().toArray(C);const T=p.times.length;for(let P=0;P<T;++P){const O=P*M+x;if("quaternion"===h)da.multiplyQuaternionsFlat(p.values,O,C,0,p.values,O);else{const k=M-2*x;for(let B=0;B<k;++B)p.values[O+B]-=C[B]}}}return n.blendMode=2501,n}};class EE{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],o=t[i-1];e:{t:{let l;n:{i:if(!(e<r)){for(let c=i+2;;){if(void 0===r){if(e<o)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===c)break;if(o=r,r=t[++i],e<r)break t}l=t.length;break n}if(e>=o)break e;{const c=t[1];e<c&&(i=2,o=c);for(let h=i-2;;){if(void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(i===h)break;if(r=o,o=t[--i-1],e>=o)break t}l=i,i=0}}for(;i<l;){const c=i+l>>>1;e<t[c]?l=c:i=c+1}if(r=t[i],o=t[i-1],void 0===o)return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=e*r;for(let l=0;l!==r;++l)t[l]=i[o+l];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class NY extends EE{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,t,i){const r=this.parameterPositions;let o=e-2,l=e+1,c=r[o],h=r[l];if(void 0===c)switch(this.getSettings_().endingStart){case 2401:o=e,c=2*t-i;break;case 2402:o=r.length-2,c=t+r[o]-r[o+1];break;default:o=e,c=i}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:l=e,h=2*i-t;break;case 2402:l=1,h=i+r[1]-r[0];break;default:l=e-1,h=t}const p=.5*(i-t),g=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(h-i),this._offsetPrev=o*g,this._offsetNext=l*g}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=e*c,p=h-c,g=this._offsetPrev,y=this._offsetNext,x=this._weightPrev,M=this._weightNext,S=(i-t)/(r-t),C=S*S,T=C*S,P=-x*T+2*x*C-x*S,O=(1+x)*T+(-1.5-2*x)*C+(-.5+x)*S+1,k=(-1-M)*T+(1.5+M)*C+.5*S,B=M*T-M*C;for(let z=0;z!==c;++z)o[z]=P*l[g+z]+O*l[p+z]+k*l[h+z]+B*l[y+z];return o}}class iB extends EE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=e*c,p=h-c,g=(i-t)/(r-t),y=1-g;for(let x=0;x!==c;++x)o[x]=l[p+x]*y+l[h+x]*g;return o}}class OY extends EE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Ql{constructor(e,t,i,r){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=dr.convertArray(t,this.TimeBufferType),this.values=dr.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:dr.convertArray(e.times,Array),values:dr.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new OY(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new iB(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new NY(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let o=0,l=r-1;for(;o!==r&&i[o]<e;)++o;for(;-1!==l&&i[l]>t;)--l;if(++l,0!==o||l!==r){o>=l&&(l=Math.max(l,1),o=l-1);const c=this.getValueSize();this.times=dr.arraySlice(i,o,l),this.values=dr.arraySlice(this.values,o*c,l*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,o=i.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let l=null;for(let c=0;c!==o;c++){const h=i[c];if("number"==typeof h&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,h),e=!1;break}if(null!==l&&l>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,h,l),e=!1;break}l=h}if(void 0!==r&&dr.isTypedArray(r))for(let c=0,h=r.length;c!==h;++c){const p=r[c];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=dr.arraySlice(this.times),t=dr.arraySlice(this.values),i=this.getValueSize(),r=2302===this.getInterpolation(),o=e.length-1;let l=1;for(let c=1;c<o;++c){let h=!1;const p=e[c];if(p!==e[c+1]&&(1!==c||p!==e[0]))if(r)h=!0;else{const y=c*i,x=y-i,M=y+i;for(let S=0;S!==i;++S){const C=t[y+S];if(C!==t[x+S]||C!==t[M+S]){h=!0;break}}}if(h){if(c!==l){e[l]=e[c];const y=c*i,x=l*i;for(let M=0;M!==i;++M)t[x+M]=t[y+M]}++l}}if(o>0){e[l]=e[o];for(let c=o*i,h=l*i,p=0;p!==i;++p)t[h+p]=t[c+p];++l}return l!==e.length?(this.times=dr.arraySlice(e,0,l),this.values=dr.arraySlice(t,0,l*i)):(this.times=e,this.values=t),this}clone(){const e=dr.arraySlice(this.times,0),t=dr.arraySlice(this.values,0),r=new(0,this.constructor)(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Ql.prototype.TimeBufferType=Float32Array,Ql.prototype.ValueBufferType=Float32Array,Ql.prototype.DefaultInterpolation=2301;class S_ extends Ql{}S_.prototype.ValueTypeName="bool",S_.prototype.ValueBufferType=Array,S_.prototype.DefaultInterpolation=2300,S_.prototype.InterpolantFactoryMethodLinear=void 0,S_.prototype.InterpolantFactoryMethodSmooth=void 0;(class rB extends Ql{}).prototype.ValueTypeName="color";(class CE extends Ql{}).prototype.ValueTypeName="number";class kY extends EE{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=(i-t)/(r-t);let p=e*c;for(let g=p+c;p!==g;p+=4)da.slerpFlat(o,0,l,p-c,l,p,h);return o}}class rx extends Ql{InterpolantFactoryMethodLinear(e){return new kY(this.times,this.values,this.getValueSize(),e)}}rx.prototype.ValueTypeName="quaternion",rx.prototype.DefaultInterpolation=2301,rx.prototype.InterpolantFactoryMethodSmooth=void 0;class E_ extends Ql{}E_.prototype.ValueTypeName="string",E_.prototype.ValueBufferType=Array,E_.prototype.DefaultInterpolation=2300,E_.prototype.InterpolantFactoryMethodLinear=void 0,E_.prototype.InterpolantFactoryMethodSmooth=void 0;(class TE extends Ql{}).prototype.ValueTypeName="vector";new class sB{constructor(e,t,i){const r=this;let h,o=!1,l=0,c=0;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(g){c++,!1===o&&void 0!==r.onStart&&r.onStart(g,l,c),o=!0},this.itemEnd=function(g){l++,void 0!==r.onProgress&&r.onProgress(g,l,c),l===c&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(g){void 0!==r.onError&&r.onError(g)},this.resolveURL=function(g){return h?h(g):g},this.setURLModifier=function(g){return h=g,this},this.addHandler=function(g,y){return p.push(g,y),this},this.removeHandler=function(g){const y=p.indexOf(g);return-1!==y&&p.splice(y,2),this},this.getHandler=function(g){for(let y=0,x=p.length;y<x;y+=2){const M=p[y],S=p[y+1];if(M.global&&(M.lastIndex=0),M.test(g))return S}return null}}};class zY extends fo{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Ft(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class uB extends zY{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}const lI="\\[\\]\\.:\\/",sJ=new RegExp("["+lI+"]","g"),cI="[^"+lI+"]",oJ="[^"+lI.replace("\\.","")+"]",dJ=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",cI)+/(WCOD+)?/.source.replace("WCOD",oJ)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cI)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cI)+"$"),hJ=["material","materials","bones"];class fJ{constructor(e,t,i){const r=i||nr.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const r=this._bindings[this._targetGroup.nCachedObjects_];void 0!==r&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}let nr=(()=>{class n{constructor(t,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,i,r){return t&&t.isAnimationObjectGroup?new n.Composite(t,i,r):new n(t,i,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(sJ,"")}static parseTrackName(t){const i=dJ.exec(t);if(null===i)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==o&&-1!==o){const l=r.nodeName.substring(o+1);-1!==hJ.indexOf(l)&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=l)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,i){if(void 0===i||""===i||"."===i||-1===i||i===t.name||i===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(i);if(void 0!==r)return r}if(t.children){const r=function(l){for(let c=0;c<l.length;c++){const h=l[c];if(h.name===i||h.uuid===i)return h;const p=r(h.children);if(p)return p}return null},o=r(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,i){t[i]=this.targetObject[this.propertyName]}_getValue_array(t,i){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)t[i++]=r[o]}_getValue_arrayElement(t,i){t[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,i){this.resolvedProperty.toArray(t,i)}_setValue_direct(t,i){this.targetObject[this.propertyName]=t[i]}_setValue_direct_setNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,i){this.targetObject[this.propertyName]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,i){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=t[i++]}_setValue_array_setNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=t[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,i){const r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=t[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,i){this.resolvedProperty[this.propertyIndex]=t[i]}_setValue_arrayElement_setNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty[this.propertyIndex]=t[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,i){this.resolvedProperty.fromArray(t,i)}_setValue_fromArray_setNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,i){this.resolvedProperty.fromArray(t,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,i){this.bind(),this.getValue(t,i)}_setValue_unbound(t,i){this.bind(),this.setValue(t,i)}bind(){let t=this.node;const i=this.parsedPath,r=i.objectName,o=i.propertyName;let l=i.propertyIndex;if(t||(t=n.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(r){let g=i.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let y=0;y<t.length;y++)if(t[y].name===g){g=y;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==g){if(void 0===t[g])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[g]}}const c=t[o];if(void 0===c)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+i.nodeName+"."+o+" but it wasn't found.",t);let h=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?h=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(h=this.Versioning.MatrixWorldNeedsUpdate);let p=this.BindingType.Direct;if(void 0!==l){if("morphTargetInfluences"===o){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[l]&&(l=t.morphTargetDictionary[l])}p=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=l}else void 0!==c.fromArray&&void 0!==c.toArray?(p=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(p=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=o;this.getValue=this.GetterByBindingType[p],this.setValue=this.SetterByBindingTypeAndVersioning[p][h]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=fJ,n})();nr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},nr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},nr.prototype.GetterByBindingType=[nr.prototype._getValue_direct,nr.prototype._getValue_array,nr.prototype._getValue_arrayElement,nr.prototype._getValue_toArray],nr.prototype.SetterByBindingTypeAndVersioning=[[nr.prototype._setValue_direct,nr.prototype._setValue_direct_setNeedsUpdate,nr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[nr.prototype._setValue_array,nr.prototype._setValue_array_setNeedsUpdate,nr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[nr.prototype._setValue_arrayElement,nr.prototype._setValue_arrayElement_setNeedsUpdate,nr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[nr.prototype._setValue_fromArray,nr.prototype._setValue_fromArray_setNeedsUpdate,nr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class _J extends XR{constructor(e=10,t=10,i=4473924,r=8947848){i=new Ft(i),r=new Ft(r);const o=t/2,l=e/t,c=e/2,h=[],p=[];for(let x=0,M=0,S=-c;x<=t;x++,S+=l){h.push(-c,0,S,c,0,S),h.push(S,0,-c,S,0,c);const C=x===o?i:r;C.toArray(p,M),M+=3,C.toArray(p,M),M+=3,C.toArray(p,M),M+=3,C.toArray(p,M),M+=3}const g=new Kn;g.setAttribute("position",new Wt(h,3)),g.setAttribute("color",new Wt(p,3)),super(g,new pa({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}function MJ(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let h=0;h<256;++h){const p=h-127;p<-27?(i[h]=0,i[256|h]=32768,r[h]=24,r[256|h]=24):p<-14?(i[h]=1024>>-p-14,i[256|h]=1024>>-p-14|32768,r[h]=-p-1,r[256|h]=-p-1):p<=15?(i[h]=p+15<<10,i[256|h]=p+15<<10|32768,r[h]=13,r[256|h]=13):p<128?(i[h]=31744,i[256|h]=64512,r[h]=24,r[256|h]=24):(i[h]=31744,i[256|h]=64512,r[h]=13,r[256|h]=13)}const o=new Uint32Array(2048),l=new Uint32Array(64),c=new Uint32Array(64);for(let h=1;h<1024;++h){let p=h<<13,g=0;for(;0==(8388608&p);)p<<=1,g-=8388608;p&=-8388609,g+=947912704,o[h]=p|g}for(let h=1024;h<2048;++h)o[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)l[h]=h<<23;l[31]=1199570944,l[32]=2147483648;for(let h=33;h<63;++h)l[h]=2147483648+(h-32<<23);l[63]=3347054592;for(let h=1;h<64;++h)32!==h&&(c[h]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:o,exponentTable:l,offsetTable:c}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"142"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="142");class CJ{parse(e,t={}){const i=void 0!==t.binary&&t.binary,r=[];let o=0;e.traverse(function(P){if(P.isMesh){const O=P.geometry;if(!0!==O.isBufferGeometry)throw new Error("THREE.STLExporter: Geometry is not of type THREE.BufferGeometry.");const k=O.index,B=O.getAttribute("position");o+=null!==k?k.count/3:B.count/3,r.push({object3d:P,geometry:O})}});let l,c=80;if(!0===i){const O=new ArrayBuffer(2*o+3*o*4*4+80+4);l=new DataView(O),l.setUint32(c,o,!0),c+=4}else l="",l+="solid exported\n";const h=new Z,p=new Z,g=new Z,y=new Z,x=new Z,M=new Z;for(let P=0,O=r.length;P<O;P++){const k=r[P].object3d,B=r[P].geometry,z=B.index,q=B.getAttribute("position");if(null!==z)for(let ne=0;ne<z.count;ne+=3)S(z.getX(ne+0),z.getX(ne+1),z.getX(ne+2),q,k);else for(let ne=0;ne<q.count;ne+=3)S(ne+0,ne+1,ne+2,q,k)}return!1===i&&(l+="endsolid exported\n"),l;function S(P,O,k,B,z){h.fromBufferAttribute(B,P),p.fromBufferAttribute(B,O),g.fromBufferAttribute(B,k),!0===z.isSkinnedMesh&&(z.boneTransform(P,h),z.boneTransform(O,p),z.boneTransform(k,g)),h.applyMatrix4(z.matrixWorld),p.applyMatrix4(z.matrixWorld),g.applyMatrix4(z.matrixWorld),function C(P,O,k){y.subVectors(k,O),x.subVectors(P,O),y.cross(x).normalize(),M.copy(y).normalize(),!0===i?(l.setFloat32(c,M.x,!0),c+=4,l.setFloat32(c,M.y,!0),c+=4,l.setFloat32(c,M.z,!0),c+=4):(l+="\tfacet normal "+M.x+" "+M.y+" "+M.z+"\n",l+="\t\touter loop\n")}(h,p,g),T(h),T(p),T(g),!0===i?(l.setUint16(c,0,!0),c+=2):(l+="\t\tendloop\n",l+="\tendfacet\n")}function T(P){!0===i?(l.setFloat32(c,P.x,!0),c+=4,l.setFloat32(c,P.y,!0),c+=4,l.setFloat32(c,P.z,!0),c+=4):l+="\t\t\tvertex "+P.x+" "+P.y+" "+P.z+"\n"}}}var TJ=xs(327),AJ=xs(181);let PB=(()=>{class n{constructor(){this.aspectRatio=0,this.Width=0,this.Height=0,this.scene=new bk,this.scene.background=new Ft(16777215),this.render=this.render.bind(this)}OnInit(t,i,r,o,l){this.aspectRatio=t,this.Width=o,this.Height=l,this.createCamera(t,o,l),this.add(new uB(15790320)),this.createRender(i,r,o,l),this.addControls()}createHelper(){this.GridHelper=new _J(50,50),this.GridHelper.geometry.rotateX(Math.PI/2),this.scene.add(this.GridHelper)}addControls(){new AJ.OrbitControls(this.camera,this.renderer.domElement).addEventListener("change",this.render)}createCamera(t,i,r){t=null===t?this.aspectRatio:t,i=null===i?this.Width:i,r=null===r?this.Height:r,void 0!==this.scene.getObjectByName("camera")&&this.scene.remove(this.camera),this.camera=new Ds(70,t,.1,1e3),this.camera.position.set(0,-25,10),this.camera.name="camera",this.scene.add(this.camera)}createRender(t,i,r,o){this.renderer=new xk({preserveDrawingBuffer:!0,canvas:t,alpha:!0,antialias:!0}),this.renderer.setPixelRatio(i),this.renderer.setSize(r,o),this.renderer.shadowMap.enabled=!0}onResize(t,i,r){this.camera.updateProjectionMatrix(),this.renderer.setSize(i,r),this.render()}render(){this.renderer.render(this.scene,this.camera)}getBoundingClientRect(){return this.renderer.domElement.getBoundingClientRect()}add(...t){for(const i of t)this.scene.add(i)}remove(...t){for(const i of t)this.scene.remove(i)}removeByName(...t){for(const i of t){const r=this.scene.getObjectByName(i);void 0!==r&&this.scene.remove(r)}}getSettingJson(){return{camera:{x:this.camera.position.x,y:this.camera.position.y,z:this.camera.position.z}}}clear(){for(;this.scene.children.length>0;)this.scene.remove(this.scene.children[0])}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),FB=(()=>{class n{constructor(t){this.scene=t,this.Exporter=new CJ,this.slab=this.create(65280),this.scene.add(this.slab),this.H1=this.createH(16711680),this.scene.add(this.H1),this.H2=this.createH(16711680),this.scene.add(this.H2),this.H3=this.createH(16711680),this.scene.add(this.H3)}create(t){const i=new Bd(1,1,1),r=new Kc({color:t,transparent:!0,opacity:.5}),o=new po(i,r),l=new Kc({color:0,wireframe:!0}),c=new po(i,l);return o.add(c),o}createH(t){const i=new m_,r=this.create(t);r.scale.set(1,1,.1),r.position.set(0,0,1),i.add(r);const o=this.create(t);o.scale.set(1,1,.1),o.position.set(0,0,0),i.add(o);const l=this.create(t);return l.scale.set(.1,1,1),l.position.set(0,0,.5),i.add(l),i}reSetModel(t,i,r,o,l,c,h,p,g,y){this.slab.scale.set(i/1e3,t/1e3,o/1e3),this.slab.position.set(0,0,c/1e3+o/2e3),this.H1.scale.set(h/1e3,t/1e3,c/1e3),this.H1.position.set(-i/3e3,0,0),this.H2.scale.set(h/1e3,t/1e3,c/1e3),this.H2.position.set(0,0,0),this.H3.scale.set(h/1e3,t/1e3,c/1e3),this.H3.position.set(i/3e3,0,0),this.scene.render()}download(){const t=this.Exporter.parse(this.scene.scene),i=new window.Blob([t],{type:"text/plain"});TJ.saveAs(i,"test.stl")}}return n.\u0275fac=function(t){return new(t||n)(Be(PB))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function NB(...n){const e=ny(n),{args:t,keys:i}=AN(n),r=new Ci(o=>{const{length:l}=t;if(!l)return void o.complete();const c=new Array(l);let h=l,p=l;for(let g=0;g<l;g++){let y=!1;Br(t[g]).subscribe(ji(o,x=>{y||(y=!0,p--),c[g]=x},()=>h--,void 0,()=>{(!h||!y)&&(p||o.next(i?DN(i,c):c),o.complete())}))}});return e?r.pipe(yD(e)):r}let OB=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(oe(hs),oe(In))},n.\u0275dir=st({type:n}),n})(),np=(()=>{class n extends OB{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ni(n)))(i||n)}}(),n.\u0275dir=st({type:n,features:[Dt]}),n})();const Va=new at("NgValueAccessor"),RJ={provide:Va,useExisting:ci(()=>fI),multi:!0},LJ=new at("CompositionEventMode");let fI=(()=>{class n extends OB{constructor(t,i,r){super(t,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function IJ(){const n=Xl()?Xl().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",null==t?"":t)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(oe(hs),oe(In),oe(LJ,8))},n.\u0275dir=st({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&se("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[gn([RJ]),Dt]}),n})();const $s=new at("NgValidators"),jd=new at("NgAsyncValidators");function $B(n){return null!=n}function XB(n){return H(n)?sr(n):n}function ZB(n){let e={};return n.forEach(t=>{e=null!=t?Object.assign(Object.assign({},e),t):e}),0===Object.keys(e).length?null:e}function YB(n,e){return e.map(t=>t(n))}function JB(n){return n.map(e=>function NJ(n){return!n.validate}(e)?e:t=>e.validate(t))}function pI(n){return null!=n?function KB(n){if(!n)return null;const e=n.filter($B);return 0==e.length?null:function(t){return ZB(YB(t,e))}}(JB(n)):null}function mI(n){return null!=n?function QB(n){if(!n)return null;const e=n.filter($B);return 0==e.length?null:function(t){return NB(YB(t,e).map(XB)).pipe(an(ZB))}}(JB(n)):null}function eV(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function gI(n){return n?Array.isArray(n)?n:[n]:[]}function BE(n,e){return Array.isArray(n)?n.includes(e):n===e}function iV(n,e){const t=gI(e);return gI(n).forEach(r=>{BE(t,r)||t.push(r)}),t}function rV(n,e){return gI(e).filter(t=>!BE(n,t))}class sV{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=pI(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=mI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class qd extends sV{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class yo extends sV{get formDirective(){return null}get path(){return null}}let aV=(()=>{class n extends class oV{constructor(e){this._cd=e}get isTouched(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.touched)}get isUntouched(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.untouched)}get isPristine(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.pristine)}get isDirty(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.dirty)}get isValid(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.valid)}get isInvalid(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.invalid)}get isPending(){var e,t;return!(null===(t=null===(e=this._cd)||void 0===e?void 0:e.control)||void 0===t||!t.pending)}get isSubmitted(){var e;return!(null===(e=this._cd)||void 0===e||!e.submitted)}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(oe(qd,2))},n.\u0275dir=st({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&wt("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Dt]}),n})();const ox="VALID",UE="INVALID",T_="PENDING",ax="DISABLED";function cV(n){return Array.isArray(n)?pI(n):n||null}function uV(n){return Array.isArray(n)?mI(n):n||null}function zE(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function lx(n,e){var t,i;(function MI(n,e){const t=function tV(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(eV(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function nV(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(eV(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const r=()=>n.updateValueAndValidity();WE(e._rawValidators,r),WE(e._rawAsyncValidators,r)})(n,e),e.valueAccessor.writeValue(n.value),n.disabled&&(null===(i=(t=e.valueAccessor).setDisabledState)||void 0===i||i.call(t,!0)),function jJ(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&pV(n,e)})}(n,e),function $J(n,e){const t=(i,r)=>{e.valueAccessor.writeValue(i),r&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function qJ(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&pV(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function WJ(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function WE(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function pV(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function yV(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function vV(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const tK={provide:qd,useExisting:ci(()=>TI)},MV=(()=>Promise.resolve(null))();let TI=(()=>{class n extends qd{constructor(t,i,r,o,l){super(),this._changeDetectorRef=l,this.control=new class extends class fV{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=cV(this._rawValidators),this._composedAsyncValidatorFn=uV(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===ox}get invalid(){return this.status===UE}get pending(){return this.status==T_}get disabled(){return this.status===ax}get enabled(){return this.status!==ax}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=cV(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=uV(e)}addValidators(e){this.setValidators(iV(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(iV(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(rV(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(rV(e,this._rawAsyncValidators))}hasValidator(e){return BE(this._rawValidators,e)}hasAsyncValidator(e){return BE(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=T_,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ax,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=ox,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ox||this.status===T_)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ax:ox}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=T_,this._hasOwnPendingAsyncValidator=!0;const t=XB(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,r)=>i&&i._find(r),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Mi,this.statusChanges=new Mi}_calculateStatus(){return this._allControlsDisabled()?ax:this.errors?UE:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(T_)?T_:this._anyControlsHaveStatus(UE)?UE:ox}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){zE(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}{constructor(e=null,t,i){super(function xI(n){return(zE(n)?n.validators:n)||null}(t),function bI(n,e){return(zE(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),zE(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=vV(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){yV(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){yV(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){vV(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},this._registered=!1,this.update=new Mi,this._parent=t,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function EI(n,e){if(!e)return null;let t,i,r;return Array.isArray(e),e.forEach(o=>{o.constructor===fI?t=o:function YJ(n){return Object.getPrototypeOf(n.constructor)===np}(o)?i=o:r=o}),r||i||t||null}(0,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function SI(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){lx(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){MV.then(()=>{var i;this.control.setValue(t,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,r=0!==i&&function kc(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}(i);MV.then(()=>{var o;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(o=this._changeDetectorRef)||void 0===o||o.markForCheck()})}_getPath(t){return this._parent?function HE(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(oe(yo,9),oe($s,10),oe(jd,10),oe(Va,10),oe(aa,8))},n.\u0275dir=st({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[gn([tK]),Dt,Qr]}),n})(),EV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})();const AI=new at("NgModelWithFormControlWarning");let HV=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[EV]}),n})(),CK=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[HV]}),n})(),TK=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:AI,useValue:t.warnOnNgModelWithFormControl}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[HV]}),n})();function Nr(n){return null!=n&&"false"!=`${n}`}function $d(n,e=0){return function DK(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function GV(n){return Array.isArray(n)?n:[n]}function A_(n){return n instanceof In?n.nativeElement:n}const RK=["addListener","removeListener"],IK=["addEventListener","removeEventListener"],LK=["on","off"];function ux(n,e,t,i){if(Mn(t)&&(i=t,t=void 0),i)return ux(n,e,t).pipe(yD(i));const[r,o]=function NK(n){return Mn(n.addEventListener)&&Mn(n.removeEventListener)}(n)?IK.map(l=>c=>n[l](e,c,t)):function PK(n){return Mn(n.addListener)&&Mn(n.removeListener)}(n)?RK.map(WV(n,e)):function FK(n){return Mn(n.on)&&Mn(n.off)}(n)?LK.map(WV(n,e)):[];if(!r&&fr(n))return Dr(l=>ux(l,e,t))(Br(n));if(!r)throw new TypeError("Invalid event target");return new Ci(l=>{const c=(...h)=>l.next(1<h.length?h:h[0]);return r(c),()=>o(c)})}function WV(n,e){return t=>i=>n[t](e,i)}class OK extends Ei{constructor(e,t){super()}schedule(e,t=0){return this}}const qE={setInterval(n,e,...t){const{delegate:i}=qE;return null!=i&&i.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=qE;return((null==e?void 0:e.clearInterval)||clearInterval)(n)},delegate:void 0};class NI extends OK{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,r=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(r,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(r,this.id,t),this}requestAsyncId(e,t,i=0){return qE.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;qE.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r,i=!1;try{this.work(e)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Yr(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const dx={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=dx;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const r=e(o=>{t=void 0,n(o)});return new Ei(()=>null==t?void 0:t(r))},requestAnimationFrame(...n){const{delegate:e}=dx;return((null==e?void 0:e.requestAnimationFrame)||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=dx;return((null==e?void 0:e.cancelAnimationFrame)||cancelAnimationFrame)(...n)},delegate:void 0},jV={now:()=>(jV.delegate||Date).now(),delegate:void 0};class hx{constructor(e,t=hx.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}hx.now=jV.now;class OI extends hx{constructor(e,t=hx.now){super(e,t),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}new class BK extends OI{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class kK extends NI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=dx.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,t,i);e.actions.some(r=>r.id===t)||(dx.cancelAnimationFrame(t),e._scheduled=void 0)}});let kI,UK=1;const $E={};function qV(n){return n in $E&&(delete $E[n],!0)}const zK={setImmediate(n){const e=UK++;return $E[e]=!0,kI||(kI=Promise.resolve()),kI.then(()=>qV(e)&&n()),e},clearImmediate(n){qV(n)}},{setImmediate:HK,clearImmediate:GK}=zK,XE={setImmediate(...n){const{delegate:e}=XE;return((null==e?void 0:e.setImmediate)||HK)(...n)},clearImmediate(n){const{delegate:e}=XE;return((null==e?void 0:e.clearImmediate)||GK)(n)},delegate:void 0},BI=(new class jK extends OI{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let r;e=e||i.shift();do{if(r=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,r){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw r}}}(class WK extends NI{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=XE.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){if(null!=i&&i>0||null==i&&this.delay>0)return super.recycleAsyncId(e,t,i);e.actions.some(r=>r.id===t)||(XE.clearImmediate(t),e._scheduled=void 0)}}),new OI(NI)),$K=BI;function $V(n,e=BI){return function XK(n){return Zi((e,t)=>{let i=!1,r=null,o=null,l=!1;const c=()=>{if(null==o||o.unsubscribe(),o=null,i){i=!1;const p=r;r=null,t.next(p)}l&&t.complete()},h=()=>{o=null,l&&t.complete()};e.subscribe(ji(t,p=>{i=!0,r=p,o||Br(n(p)).subscribe(o=ji(t,c,h))},()=>{l=!0,(!i||!o||o.closed)&&t.complete()}))})}(()=>function YK(n=0,e,t=$K){let i=-1;return null!=e&&(ty(e)?t=e:i=e),new Ci(r=>{let o=function ZK(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;o<0&&(o=0);let l=0;return t.schedule(function(){r.closed||(r.next(l++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(n,e))}function Tr(n){return Zi((e,t)=>{Br(n).subscribe(ji(t,()=>t.complete(),Nn)),!t.closed&&e.subscribe(t)})}let VI;try{VI="undefined"!=typeof Intl&&Intl.v8BreakIterator}catch(n){VI=!1}let fx,ZE,rp,UI,_l=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?function GW(n){return n===sN}(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!VI)&&"undefined"!=typeof CSS&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(Be(AM))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function px(n){return function JK(){if(null==fx&&"undefined"!=typeof window)try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>fx=!0}))}finally{fx=fx||!1}return fx}()?n:!!n.capture}function mx(){if("object"!=typeof document||!document)return 0;if(null==ZE){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),ZE=0,0===n.scrollLeft&&(n.scrollLeft=1,ZE=0===n.scrollLeft?1:2),n.remove()}return ZE}function gx(n){return n.composedPath?n.composedPath()[0]:n.target}const nQ=new at("cdk-dir-doc",{providedIn:"root",factory:function iQ(){return Eo(pi)}}),rQ=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let YE=(()=>{class n{constructor(t){if(this.value="ltr",this.change=new Mi,t){const r=t.documentElement?t.documentElement.dir:null;this.value=function sQ(n){const e=(null==n?void 0:n.toLowerCase())||"";return"auto"===e&&"undefined"!=typeof navigator&&(null==navigator?void 0:navigator.language)?rQ.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||r||"ltr")}}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(Be(nQ,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),JE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})(),zI=(()=>{class n{constructor(t,i,r){this._ngZone=t,this._platform=i,this._scrolled=new ri,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=r}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Ci(i=>{this._globalSubscription||this._addGlobalListener();const r=t>0?this._scrolled.pipe($V(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{r.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Gt()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const r=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(_s(o=>!o||r.indexOf(o)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((r,o)=>{this._scrollableContainsElement(o,t)&&i.push(o)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let r=A_(i),o=t.getElementRef().nativeElement;do{if(r==o)return!0}while(r=r.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>ux(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(Be(zn),Be(_l),Be(pi,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_x=(()=>{class n{constructor(t,i,r,o){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=r,this.dir=o,this._destroyed=new ri,this._elementScrolled=new Ci(l=>this.ngZone.runOutsideAngular(()=>ux(this.elementRef.nativeElement,"scroll").pipe(Tr(this._destroyed)).subscribe(l)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,r=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=r?t.end:t.start),null==t.right&&(t.right=r?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),r&&0!=mx()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==mx()?t.left=t.right:1==mx()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;!function KK(){if(null==rp){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return rp=!1,rp;if("scrollBehavior"in document.documentElement.style)rp=!0;else{const n=Element.prototype.scrollTo;rp=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return rp}()?(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left)):i.scrollTo(t)}measureScrollOffset(t){const i="left",r="right",o=this.elementRef.nativeElement;if("top"==t)return o.scrollTop;if("bottom"==t)return o.scrollHeight-o.clientHeight-o.scrollTop;const l=this.dir&&"rtl"==this.dir.value;return"start"==t?t=l?r:i:"end"==t&&(t=l?i:r),l&&2==mx()?t==i?o.scrollWidth-o.clientWidth-o.scrollLeft:o.scrollLeft:l&&1==mx()?t==i?o.scrollLeft+o.scrollWidth-o.clientWidth:-o.scrollLeft:t==i?o.scrollLeft:o.scrollWidth-o.clientWidth-o.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(zI),oe(zn),oe(YE,8))},n.\u0275dir=st({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]}),n})(),ZV=(()=>{class n{constructor(t,i,r){this._platform=t,this._change=new ri,this._changeListener=o=>{this._change.next(o)},this._document=r,i.runOutsideAngular(()=>{if(t.isBrowser){const o=this._getWindow();o.addEventListener("resize",this._changeListener),o.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:r}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+r,right:t.left+i,height:r,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),r=t.documentElement,o=r.getBoundingClientRect();return{top:-o.top||t.body.scrollTop||i.scrollY||r.scrollTop||0,left:-o.left||t.body.scrollLeft||i.scrollX||r.scrollLeft||0}}change(t=20){return t>0?this._change.pipe($V(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(Be(_l),Be(zn),Be(pi,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),KE=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})(),lQ=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[JE,KE,JE,KE]}),n})();function yx(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function WI(n,e=BI){return Zi((t,i)=>{let r=null,o=null,l=null;const c=()=>{if(r){r.unsubscribe(),r=null;const p=o;o=null,i.next(p)}};function h(){const p=l+n,g=e.now();if(g<p)return r=this.schedule(void 0,p-g),void i.add(r);c()}t.subscribe(ji(i,p=>{o=p,l=e.now(),r||(r=e.schedule(h,n),i.add(r))},()=>{c(),i.complete()},void 0,()=>{o=r=null}))})}function nU(n){return _s((e,t)=>n<=t)}function iU(n,e=Ga){return n=null!=n?n:MQ,Zi((t,i)=>{let r,o=!0;t.subscribe(ji(i,l=>{const c=e(l);(o||!n(r,c))&&(o=!1,r=c,i.next(l))}))})}function MQ(n,e){return n===e}let SQ=(()=>{class n{create(t){return"undefined"==typeof MutationObserver?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),rU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({providers:[SQ]}),n})();const sU=new Set;let R_,EQ=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):TQ}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function CQ(n){if(!sU.has(n))try{R_||(R_=document.createElement("style"),R_.setAttribute("type","text/css"),document.head.appendChild(R_)),R_.sheet&&(R_.sheet.insertRule(`@media ${n} {body{ }}`,0),sU.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(Be(_l))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function TQ(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let AQ=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new ri}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return oU(GV(t)).some(r=>this._registerQuery(r).mql.matches)}observe(t){let o=vD(oU(GV(t)).map(l=>this._registerQuery(l).observable));return o=YM(o.pipe(Na(1)),o.pipe(nU(1),WI(0))),o.pipe(an(l=>{const c={matches:!1,breakpoints:{}};return l.forEach(({matches:h,query:p})=>{c.matches=c.matches||h,c.breakpoints[p]=h}),c}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),o={observable:new Ci(l=>{const c=h=>this._zone.run(()=>l.next(h));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(Dg(i),an(({matches:l})=>({query:t,matches:l})),Tr(this._destroySubject)),mql:i};return this._queries.set(t,o),o}}return n.\u0275fac=function(t){return new(t||n)(Be(EQ),Be(zn))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function oU(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}let cU=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function FQ(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function PQ(n){try{return n.frameElement}catch(e){return null}}(function HQ(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===dU(i)||!this.isVisible(i)))return!1;let r=t.nodeName.toLowerCase(),o=dU(t);return t.hasAttribute("contenteditable")?-1!==o:!("iframe"===r||"object"===r||this._platform.WEBKIT&&this._platform.IOS&&!function UQ(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===r?!!t.hasAttribute("controls")&&-1!==o:"video"===r?-1!==o&&(null!==o||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function zQ(n){return!function OQ(n){return function BQ(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function NQ(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function kQ(n){return function VQ(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||uU(n))}(t)&&!this.isDisabled(t)&&((null==i?void 0:i.ignoreVisibility)||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(Be(_l))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function uU(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function dU(n){if(!uU(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class GQ{constructor(e,t,i,r,o=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=r,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,o||this.attachAnchors()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return null==i||i.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(r)return r}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const r=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(r)return r}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(Na(1)).subscribe(e)}}let WQ=(()=>{class n{constructor(t,i,r){this._checker=t,this._ngZone=i,this._document=r}create(t,i=!1){return new GQ(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(Be(cU),Be(zn),Be(pi))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function hU(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function fU(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const jQ=new at("cdk-input-modality-detector-options"),qQ={ignoreKeys:[18,17,224,91,16]},I_=px({passive:!0,capture:!0});let $Q=(()=>{class n{constructor(t,i,r,o){this._platform=t,this._mostRecentTarget=null,this._modality=new la(null),this._lastTouchMs=0,this._onKeydown=l=>{var c,h;null!==(h=null===(c=this._options)||void 0===c?void 0:c.ignoreKeys)&&void 0!==h&&h.some(p=>p===l.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=gx(l))},this._onMousedown=l=>{Date.now()-this._lastTouchMs<650||(this._modality.next(hU(l)?"keyboard":"mouse"),this._mostRecentTarget=gx(l))},this._onTouchstart=l=>{fU(l)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=gx(l))},this._options=Object.assign(Object.assign({},qQ),o),this.modalityDetected=this._modality.pipe(nU(1)),this.modalityChanged=this.modalityDetected.pipe(iU()),t.isBrowser&&i.runOutsideAngular(()=>{r.addEventListener("keydown",this._onKeydown,I_),r.addEventListener("mousedown",this._onMousedown,I_),r.addEventListener("touchstart",this._onTouchstart,I_)})}get mostRecentModality(){return this._modality.value}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,I_),document.removeEventListener("mousedown",this._onMousedown,I_),document.removeEventListener("touchstart",this._onTouchstart,I_))}}return n.\u0275fac=function(t){return new(t||n)(Be(_l),Be(zn),Be(pi),Be(jQ,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ZQ=new at("cdk-focus-monitor-default-options"),QE=px({passive:!0,capture:!0});let jI=(()=>{class n{constructor(t,i,r,o,l){this._ngZone=t,this._platform=i,this._inputModalityDetector=r,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new ri,this._rootNodeFocusAndBlurListener=c=>{for(let p=gx(c);p;p=p.parentElement)"focus"===c.type?this._onFocus(c,p):this._onBlur(c,p)},this._document=o,this._detectionMode=(null==l?void 0:l.detectionMode)||0}monitor(t,i=!1){const r=A_(t);if(!this._platform.isBrowser||1!==r.nodeType)return Gt(null);const o=function eQ(n){if(function QK(){if(null==UI){const n="undefined"!=typeof document?document.head:null;UI=!(!n||!n.createShadowRoot&&!n.attachShadow)}return UI}()){const e=n.getRootNode?n.getRootNode():null;if("undefined"!=typeof ShadowRoot&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(r)||this._getDocument(),l=this._elementInfo.get(r);if(l)return i&&(l.checkChildren=!0),l.subject;const c={checkChildren:i,subject:new ri,rootNode:o};return this._elementInfo.set(r,c),this._registerGlobalListeners(c),c.subject}stopMonitoring(t){const i=A_(t),r=this._elementInfo.get(i);r&&(r.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(r))}focusVia(t,i,r){const o=A_(t);o===this._getDocument().activeElement?this._getClosestElementsInfo(o).forEach(([c,h])=>this._originChanged(c,i,h)):(this._setOrigin(i),"function"==typeof o.focus&&o.focus(r))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!(null==t||!t.contains(this._inputModalityDetector._mostRecentTarget))}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const r=this._elementInfo.get(i),o=gx(t);!r||!r.checkChildren&&i!==o||this._originChanged(i,this._getFocusOrigin(o),r)}_onBlur(t,i){const r=this._elementInfo.get(i);!r||r.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(r,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,r=this._rootNodeFocusListenerCount.get(i)||0;r||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,QE),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,QE)}),this._rootNodeFocusListenerCount.set(i,r+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(Tr(this._stopInputModalityDetector)).subscribe(o=>{this._setOrigin(o,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const r=this._rootNodeFocusListenerCount.get(i);r>1?this._rootNodeFocusListenerCount.set(i,r-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,QE),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,QE),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,r){this._setClasses(t,i),this._emitOrigin(r,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((r,o)=>{(o===t||r.checkChildren&&o.contains(t))&&i.push([o,r])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:r}=this._inputModalityDetector;if("mouse"!==r||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const o=t.labels;if(o)for(let l=0;l<o.length;l++)if(o[l].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(Be(zn),Be(_l),Be($Q),Be(pi,8),Be(ZQ,8))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const mU="cdk-high-contrast-black-on-white",gU="cdk-high-contrast-white-on-black",qI="cdk-high-contrast-active";let _U=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Eo(AQ).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,r=i&&i.getComputedStyle?i.getComputedStyle(t):null,o=(r&&r.backgroundColor||"").replace(/ /g,"");switch(t.remove(),o){case"rgb(0,0,0)":return 2;case"rgb(255,255,255)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(qI,mU,gU),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(qI,mU):2===i&&t.add(qI,gU)}}}return n.\u0275fac=function(t){return new(t||n)(Be(_l),Be(pi))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),YQ=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(Be(_U))},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[rU]}),n})();const KQ=new at("mat-sanity-checks",{providedIn:"root",factory:function JQ(){return!0}});let hr=(()=>{class n{constructor(t,i,r){this._sanityChecks=i,this._document=r,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function tQ(){return"undefined"!=typeof __karma__&&!!__karma__||"undefined"!=typeof jasmine&&!!jasmine||"undefined"!=typeof jest&&!!jest||"undefined"!=typeof Mocha&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(Be(_U),Be(KQ,8),Be(pi))},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[JE,JE]}),n})();function vU(n){return class extends n{constructor(...e){super(...e),this._disabled=!1}get disabled(){return this._disabled}set disabled(e){this._disabled=Nr(e)}}}function $I(n,e){return class extends n{constructor(...t){super(...t),this.defaultColor=e,this.color=e}get color(){return this._color}set color(t){const i=t||this.defaultColor;i!==this._color&&(this._color&&this._elementRef.nativeElement.classList.remove(`mat-${this._color}`),i&&this._elementRef.nativeElement.classList.add(`mat-${i}`),this._color=i)}}}function eC(n){return class extends n{constructor(...e){super(...e),this._disableRipple=!1}get disableRipple(){return this._disableRipple}set disableRipple(e){this._disableRipple=Nr(e)}}}function QQ(n,e=0){return class extends n{constructor(...t){super(...t),this._tabIndex=e,this.defaultTabIndex=e}get tabIndex(){return this.disabled?-1:this._tabIndex}set tabIndex(t){this._tabIndex=null!=t?$d(t):this.defaultTabIndex}}}let tee=(()=>{class n{isErrorState(t,i){return!!(t&&t.invalid&&(t.touched||i&&i.submitted))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),xU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=st({type:n,selectors:[["","mat-line",""],["","matLine",""]],hostAttrs:[1,"mat-line"]}),n})();function vx(n,e,t){n.nativeElement.classList.toggle(e,t)}let wU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[hr,hr]}),n})();class nee{constructor(e,t,i,r=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=r,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const MU={enterDuration:225,exitDuration:150},XI=px({passive:!0}),SU=["mousedown","touchstart"],EU=["mouseup","mouseleave","touchend","touchcancel"];class ree{constructor(e,t,i,r){this._target=e,this._ngZone=t,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,r.isBrowser&&(this._containerElement=A_(i))}fadeInRipple(e,t,i={}){const r=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),o=Object.assign(Object.assign({},MU),i.animation);i.centered&&(e=r.left+r.width/2,t=r.top+r.height/2);const l=i.radius||function see(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),r=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+r*r)}(e,t,r),c=e-r.left,h=t-r.top,p=o.enterDuration,g=document.createElement("div");g.classList.add("mat-ripple-element"),g.style.left=c-l+"px",g.style.top=h-l+"px",g.style.height=2*l+"px",g.style.width=2*l+"px",null!=i.color&&(g.style.backgroundColor=i.color),g.style.transitionDuration=`${p}ms`,this._containerElement.appendChild(g);const y=window.getComputedStyle(g),M=y.transitionDuration,S="none"===y.transitionProperty||"0s"===M||"0s, 0s"===M,C=new nee(this,g,i,S);g.style.transform="scale3d(1, 1, 1)",C.state=0,i.persistent||(this._mostRecentTransientRipple=C);let T=null;return!S&&(p||o.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const P=()=>this._finishRippleTransition(C),O=()=>this._destroyRipple(C);g.addEventListener("transitionend",P),g.addEventListener("transitioncancel",O),T={onTransitionEnd:P,onTransitionCancel:O}}),this._activeRipples.set(C,T),(S||!p)&&this._finishRippleTransition(C),C}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i=Object.assign(Object.assign({},MU),e.config.animation);t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=A_(e);!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,this._registerEvents(SU))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._registerEvents(EU),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){var t;const i=null!==(t=this._activeRipples.get(e))&&void 0!==t?t:null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==i&&(e.element.removeEventListener("transitionend",i.onTransitionEnd),e.element.removeEventListener("transitioncancel",i.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=hU(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!fU(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){!this._isPointerDown||(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_registerEvents(e){this._ngZone.runOutsideAngular(()=>{e.forEach(t=>{this._triggerElement.addEventListener(t,this,XI)})})}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){this._triggerElement&&(SU.forEach(e=>{this._triggerElement.removeEventListener(e,this,XI)}),this._pointerUpEventsRegistered&&EU.forEach(e=>{this._triggerElement.removeEventListener(e,this,XI)}))}}const oee=new at("mat-ripple-global-options");let CU=(()=>{class n{constructor(t,i,r,o,l){this._elementRef=t,this._animationMode=l,this.radius=0,this._disabled=!1,this._isInitialized=!1,this._globalOptions=o||{},this._rippleRenderer=new ree(this,i,t,r)}get disabled(){return this._disabled}set disabled(t){t&&this.fadeOutAllNonPersistent(),this._disabled=t,this._setupTriggerEventsIfEnabled()}get trigger(){return this._trigger||this._elementRef.nativeElement}set trigger(t){this._trigger=t,this._setupTriggerEventsIfEnabled()}ngOnInit(){this._isInitialized=!0,this._setupTriggerEventsIfEnabled()}ngOnDestroy(){this._rippleRenderer._removeTriggerEvents()}fadeOutAll(){this._rippleRenderer.fadeOutAll()}fadeOutAllNonPersistent(){this._rippleRenderer.fadeOutAllNonPersistent()}get rippleConfig(){return{centered:this.centered,radius:this.radius,color:this.color,animation:Object.assign(Object.assign(Object.assign({},this._globalOptions.animation),"NoopAnimations"===this._animationMode?{enterDuration:0,exitDuration:0}:{}),this.animation),terminateOnPointerUp:this._globalOptions.terminateOnPointerUp}}get rippleDisabled(){return this.disabled||!!this._globalOptions.disabled}_setupTriggerEventsIfEnabled(){!this.disabled&&this._isInitialized&&this._rippleRenderer.setupTriggerEvents(this.trigger)}launch(t,i=0,r){return"number"==typeof t?this._rippleRenderer.fadeInRipple(t,i,Object.assign(Object.assign({},this.rippleConfig),r)):this._rippleRenderer.fadeInRipple(0,0,Object.assign(Object.assign({},this.rippleConfig),t))}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(zn),oe(_l),oe(oee,8),oe(Cg,8))},n.\u0275dir=st({type:n,selectors:[["","mat-ripple",""],["","matRipple",""]],hostAttrs:[1,"mat-ripple"],hostVars:2,hostBindings:function(t,i){2&t&&wt("mat-ripple-unbounded",i.unbounded)},inputs:{color:["matRippleColor","color"],unbounded:["matRippleUnbounded","unbounded"],centered:["matRippleCentered","centered"],radius:["matRippleRadius","radius"],animation:["matRippleAnimation","animation"],disabled:["matRippleDisabled","disabled"],trigger:["matRippleTrigger","trigger"]},exportAs:["matRipple"]}),n})(),aee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[hr,hr]}),n})(),TU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[hr]}),n})();class AU{}const tu="*";function DU(n,e){return{type:7,name:n,definitions:e,options:{}}}function ZI(n,e=null){return{type:4,styles:e,timings:n}}function RU(n,e=null){return{type:2,steps:n,options:e}}function L_(n){return{type:6,styles:n,offset:null}}function YI(n,e,t){return{type:0,name:n,styles:e,options:t}}function JI(n,e,t=null){return{type:1,expr:n,animation:e,options:t}}function IU(n){Promise.resolve(null).then(n)}class xx{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){IU(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class LU{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,r=0;const o=this.players.length;0==o?IU(()=>this._onFinish()):this.players.forEach(l=>{l.onDone(()=>{++t==o&&this._onFinish()}),l.onDestroy(()=>{++i==o&&this._onDestroy()}),l.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((l,c)=>Math.max(l,c.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(r)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const tC=["*"],uee=["content"];function dee(n,e){if(1&n){const t=K();I(0,"div",2),se("click",function(){return _h(t),Np(ve()._onBackdropClicked())}),F()}2&n&&wt("mat-drawer-shown",ve()._isShowingBackdrop())}function hee(n,e){1&n&&(I(0,"mat-drawer-content"),Ze(1,2),F())}const fee=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],pee=["mat-drawer","mat-drawer-content","*"];function mee(n,e){if(1&n){const t=K();I(0,"div",2),se("click",function(){return _h(t),Np(ve()._onBackdropClicked())}),F()}2&n&&wt("mat-drawer-shown",ve()._isShowingBackdrop())}function gee(n,e){1&n&&(I(0,"mat-sidenav-content"),Ze(1,2),F())}const _ee=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],yee=["mat-sidenav","mat-sidenav-content","*"],PU={transformDrawer:DU("transform",[YI("open, open-instant",L_({transform:"none",visibility:"visible"})),YI("void",L_({"box-shadow":"none",visibility:"hidden"})),JI("void => open-instant",ZI("0ms")),JI("void <=> open, open-instant => void",ZI("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},xee=new at("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function bee(){return!1}}),QI=new at("MAT_DRAWER_CONTAINER");let nC=(()=>{class n extends _x{constructor(t,i,r,o,l){super(r,o,l),this._changeDetectorRef=t,this._container=i}ngAfterContentInit(){this._container._contentMarginChanges.subscribe(()=>{this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(oe(aa),oe(ci(()=>NU)),oe(In),oe(zI),oe(zn))},n.\u0275cmp=si({type:n,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,i){2&t&&Bt("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[gn([{provide:_x,useExisting:n}]),Dt],ngContentSelectors:tC,decls:1,vars:0,template:function(t,i){1&t&&(He(),Ze(0))},encapsulation:2,changeDetection:0}),n})(),FU=(()=>{class n{constructor(t,i,r,o,l,c,h,p){this._elementRef=t,this._focusTrapFactory=i,this._focusMonitor=r,this._platform=o,this._ngZone=l,this._interactivityChecker=c,this._doc=h,this._container=p,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new ri,this._animationEnd=new ri,this._animationState="void",this.openedChange=new Mi(!0),this._openedStream=this.openedChange.pipe(_s(g=>g),an(()=>{})),this.openedStart=this._animationStarted.pipe(_s(g=>g.fromState!==g.toState&&0===g.toState.indexOf("open")),wD(void 0)),this._closedStream=this.openedChange.pipe(_s(g=>!g),an(()=>{})),this.closedStart=this._animationStarted.pipe(_s(g=>g.fromState!==g.toState&&"void"===g.toState),wD(void 0)),this._destroyed=new ri,this.onPositionChanged=new Mi,this._modeChanged=new ri,this.openedChange.subscribe(g=>{g?(this._doc&&(this._elementFocusedBeforeDrawerWasOpened=this._doc.activeElement),this._takeFocus()):this._isFocusWithinDrawer()&&this._restoreFocus(this._openedVia||"program")}),this._ngZone.runOutsideAngular(()=>{ux(this._elementRef.nativeElement,"keydown").pipe(_s(g=>27===g.keyCode&&!this.disableClose&&!yx(g)),Tr(this._destroyed)).subscribe(g=>this._ngZone.run(()=>{this.close(),g.stopPropagation(),g.preventDefault()}))}),this._animationEnd.pipe(iU((g,y)=>g.fromState===y.fromState&&g.toState===y.toState)).subscribe(g=>{const{fromState:y,toState:x}=g;(0===x.indexOf("open")&&"void"===y||"void"===x&&0===y.indexOf("open"))&&this.openedChange.emit(this._opened)})}get position(){return this._position}set position(t){(t="end"===t?"end":"start")!==this._position&&(this._isAttached&&this._updatePositionInParent(t),this._position=t,this.onPositionChanged.emit())}get mode(){return this._mode}set mode(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}get disableClose(){return this._disableClose}set disableClose(t){this._disableClose=Nr(t)}get autoFocus(){const t=this._autoFocus;return null==t?"side"===this.mode?"dialog":"first-tabbable":t}set autoFocus(t){("true"===t||"false"===t||null==t)&&(t=Nr(t)),this._autoFocus=t}get opened(){return this._opened}set opened(t){this.toggle(Nr(t))}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const r=()=>{t.removeEventListener("blur",r),t.removeEventListener("mousedown",r),t.removeAttribute("tabindex")};t.addEventListener("blur",r),t.addEventListener("mousedown",r)})),t.focus(i)}_focusByCssSelector(t,i){let r=this._elementRef.nativeElement.querySelector(t);r&&this._forceFocus(r,i)}_takeFocus(){if(!this._focusTrap)return;const t=this._elementRef.nativeElement;switch(this.autoFocus){case!1:case"dialog":return;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{!i&&"function"==typeof this._elementRef.nativeElement.focus&&t.focus()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this.autoFocus)}}_restoreFocus(t){"dialog"!==this.autoFocus&&(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,t):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null)}_isFocusWithinDrawer(){const t=this._doc.activeElement;return!!t&&this._elementRef.nativeElement.contains(t)}ngAfterViewInit(){this._isAttached=!0,this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState(),"end"===this._position&&this._updatePositionInParent("end")}ngAfterContentChecked(){this._platform.isBrowser&&(this._enableAnimations=!0)}ngOnDestroy(){var t;this._focusTrap&&this._focusTrap.destroy(),null===(t=this._anchor)||void 0===t||t.remove(),this._anchor=null,this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}open(t){return this.toggle(!0,t)}close(){return this.toggle(!1)}_closeViaBackdropClick(){return this._setOpen(!1,!0,"mouse")}toggle(t=!this.opened,i){t&&i&&(this._openedVia=i);const r=this._setOpen(t,!t&&this._isFocusWithinDrawer(),this._openedVia||"program");return t||(this._openedVia=null),r}_setOpen(t,i,r){return this._opened=t,t?this._animationState=this._enableAnimations?"open":"open-instant":(this._animationState="void",i&&this._restoreFocus(r)),this._updateFocusTrapState(),new Promise(o=>{this.openedChange.pipe(Na(1)).subscribe(l=>o(l?"open":"close"))})}_getWidth(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}_updateFocusTrapState(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}_updatePositionInParent(t){const i=this._elementRef.nativeElement,r=i.parentNode;"end"===t?(this._anchor||(this._anchor=this._doc.createComment("mat-drawer-anchor"),r.insertBefore(this._anchor,i)),r.appendChild(i)):this._anchor&&this._anchor.parentNode.insertBefore(i,this._anchor)}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(WQ),oe(jI),oe(_l),oe(zn),oe(cU),oe(pi,8),oe(QI,8))},n.\u0275cmp=si({type:n,selectors:[["mat-drawer"]],viewQuery:function(t,i){if(1&t&&oa(uee,5),2&t){let r;ai(r=li())&&(i._content=r.first)}},hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,i){1&t&&fe("@transform.start",function(o){return i._animationStarted.next(o)})("@transform.done",function(o){return i._animationEnd.next(o)}),2&t&&(gs("align",null),_A("@transform",i._animationState),wt("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:tC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(He(),I(0,"div",0,1),Ze(2),F())},dependencies:[_x],encapsulation:2,data:{animation:[PU.transformDrawer]},changeDetection:0}),n})(),NU=(()=>{class n{constructor(t,i,r,o,l,c=!1,h){this._dir=t,this._element=i,this._ngZone=r,this._changeDetectorRef=o,this._animationMode=h,this._drawers=new wg,this.backdropClick=new Mi,this._destroyed=new ri,this._doCheckSubject=new ri,this._contentMargins={left:null,right:null},this._contentMarginChanges=new ri,t&&t.change.pipe(Tr(this._destroyed)).subscribe(()=>{this._validateDrawers(),this.updateContentMargins()}),l.change().pipe(Tr(this._destroyed)).subscribe(()=>this.updateContentMargins()),this._autosize=c}get start(){return this._start}get end(){return this._end}get autosize(){return this._autosize}set autosize(t){this._autosize=Nr(t)}get hasBackdrop(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride}set hasBackdrop(t){this._backdropOverride=null==t?null:Nr(t)}get scrollable(){return this._userContent||this._content}ngAfterContentInit(){this._allDrawers.changes.pipe(Dg(this._allDrawers),Tr(this._destroyed)).subscribe(t=>{this._drawers.reset(t.filter(i=>!i._container||i._container===this)),this._drawers.notifyOnChanges()}),this._drawers.changes.pipe(Dg(null)).subscribe(()=>{this._validateDrawers(),this._drawers.forEach(t=>{this._watchDrawerToggle(t),this._watchDrawerPosition(t),this._watchDrawerMode(t)}),(!this._drawers.length||this._isDrawerOpen(this._start)||this._isDrawerOpen(this._end))&&this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(()=>{this._doCheckSubject.pipe(WI(10),Tr(this._destroyed)).subscribe(()=>this.updateContentMargins())})}ngOnDestroy(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}open(){this._drawers.forEach(t=>t.open())}close(){this._drawers.forEach(t=>t.close())}updateContentMargins(){let t=0,i=0;if(this._left&&this._left.opened)if("side"==this._left.mode)t+=this._left._getWidth();else if("push"==this._left.mode){const r=this._left._getWidth();t+=r,i-=r}if(this._right&&this._right.opened)if("side"==this._right.mode)i+=this._right._getWidth();else if("push"==this._right.mode){const r=this._right._getWidth();i+=r,t-=r}t=t||null,i=i||null,(t!==this._contentMargins.left||i!==this._contentMargins.right)&&(this._contentMargins={left:t,right:i},this._ngZone.run(()=>this._contentMarginChanges.next(this._contentMargins)))}ngDoCheck(){this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(()=>this._doCheckSubject.next())}_watchDrawerToggle(t){t._animationStarted.pipe(_s(i=>i.fromState!==i.toState),Tr(this._drawers.changes)).subscribe(i=>{"open-instant"!==i.toState&&"NoopAnimations"!==this._animationMode&&this._element.nativeElement.classList.add("mat-drawer-transition"),this.updateContentMargins(),this._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe(Tr(this._drawers.changes)).subscribe(()=>this._setContainerClass(t.opened))}_watchDrawerPosition(t){!t||t.onPositionChanged.pipe(Tr(this._drawers.changes)).subscribe(()=>{this._ngZone.onMicrotaskEmpty.pipe(Na(1)).subscribe(()=>{this._validateDrawers()})})}_watchDrawerMode(t){t&&t._modeChanged.pipe(Tr(Mp(this._drawers.changes,this._destroyed))).subscribe(()=>{this.updateContentMargins(),this._changeDetectorRef.markForCheck()})}_setContainerClass(t){const i=this._element.nativeElement.classList,r="mat-drawer-container-has-open";t?i.add(r):i.remove(r)}_validateDrawers(){this._start=this._end=null,this._drawers.forEach(t=>{"end"==t.position?this._end=t:this._start=t}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}_isPushed(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}_onBackdropClicked(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}_closeModalDrawersViaBackdrop(){[this._start,this._end].filter(t=>t&&!t.disableClose&&this._canHaveBackdrop(t)).forEach(t=>t._closeViaBackdropClick())}_isShowingBackdrop(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}_canHaveBackdrop(t){return"side"!==t.mode||!!this._backdropOverride}_isDrawerOpen(t){return null!=t&&t.opened}}return n.\u0275fac=function(t){return new(t||n)(oe(YE,8),oe(In),oe(zn),oe(aa),oe(ZV),oe(xee),oe(Cg,8))},n.\u0275cmp=si({type:n,selectors:[["mat-drawer-container"]],contentQueries:function(t,i,r){if(1&t&&(mr(r,nC,5),mr(r,FU,5)),2&t){let o;ai(o=li())&&(i._content=o.first),ai(o=li())&&(i._allDrawers=o)}},viewQuery:function(t,i){if(1&t&&oa(nC,5),2&t){let r;ai(r=li())&&(i._userContent=r.first)}},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,i){2&t&&wt("mat-drawer-container-explicit-backdrop",i._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[gn([{provide:QI,useExisting:n}])],ngContentSelectors:pee,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(He(fee),b(0,dee,1,2,"div",0),Ze(1),Ze(2,1),b(3,hee,2,0,"mat-drawer-content",1)),2&t&&(E("ngIf",i.hasBackdrop),jn(3),E("ngIf",!i._content))},dependencies:[WM,nC],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),OU=(()=>{class n extends nC{constructor(t,i,r,o,l){super(t,i,r,o,l)}}return n.\u0275fac=function(t){return new(t||n)(oe(aa),oe(ci(()=>BU)),oe(In),oe(zI),oe(zn))},n.\u0275cmp=si({type:n,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,i){2&t&&Bt("margin-left",i._container._contentMargins.left,"px")("margin-right",i._container._contentMargins.right,"px")},features:[gn([{provide:_x,useExisting:n}]),Dt],ngContentSelectors:tC,decls:1,vars:0,template:function(t,i){1&t&&(He(),Ze(0))},encapsulation:2,changeDetection:0}),n})(),kU=(()=>{class n extends FU{constructor(){super(...arguments),this._fixedInViewport=!1,this._fixedTopGap=0,this._fixedBottomGap=0}get fixedInViewport(){return this._fixedInViewport}set fixedInViewport(t){this._fixedInViewport=Nr(t)}get fixedTopGap(){return this._fixedTopGap}set fixedTopGap(t){this._fixedTopGap=$d(t)}get fixedBottomGap(){return this._fixedBottomGap}set fixedBottomGap(t){this._fixedBottomGap=$d(t)}}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ni(n)))(i||n)}}(),n.\u0275cmp=si({type:n,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,i){2&t&&(gs("align",null),Bt("top",i.fixedInViewport?i.fixedTopGap:null,"px")("bottom",i.fixedInViewport?i.fixedBottomGap:null,"px"),wt("mat-drawer-end","end"===i.position)("mat-drawer-over","over"===i.mode)("mat-drawer-push","push"===i.mode)("mat-drawer-side","side"===i.mode)("mat-drawer-opened",i.opened)("mat-sidenav-fixed",i.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[Dt],ngContentSelectors:tC,decls:3,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"],["content",""]],template:function(t,i){1&t&&(He(),I(0,"div",0,1),Ze(2),F())},dependencies:[_x],encapsulation:2,data:{animation:[PU.transformDrawer]},changeDetection:0}),n})(),BU=(()=>{class n extends NU{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=ni(n)))(i||n)}}(),n.\u0275cmp=si({type:n,selectors:[["mat-sidenav-container"]],contentQueries:function(t,i,r){if(1&t&&(mr(r,OU,5),mr(r,kU,5)),2&t){let o;ai(o=li())&&(i._content=o.first),ai(o=li())&&(i._allDrawers=o)}},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,i){2&t&&wt("mat-drawer-container-explicit-backdrop",i._backdropOverride)},exportAs:["matSidenavContainer"],features:[gn([{provide:QI,useExisting:n}]),Dt],ngContentSelectors:yee,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,i){1&t&&(He(_ee),b(0,mee,1,2,"div",0),Ze(1),Ze(2,1),b(3,gee,2,0,"mat-sidenav-content",1)),2&t&&(E("ngIf",i.hasBackdrop),jn(3),E("ngIf",!i._content))},dependencies:[WM,OU],styles:['.mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer[style*="visibility: hidden"]{display:none}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}'],encapsulation:2,changeDetection:0}),n})(),wee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[y0,hr,KE,KE,hr]}),n})();class VU{}class UU{}class nu{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const r=t.slice(0,i),o=r.toLowerCase(),l=t.slice(i+1).trim();this.maybeSetNormalizedName(r,o),this.headers.has(o)?this.headers.get(o).push(l):this.headers.set(o,[l])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let i=e[t];const r=t.toLowerCase();"string"==typeof i&&(i=[i]),i.length>0&&(this.headers.set(r,i),this.maybeSetNormalizedName(t,r))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof nu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new nu;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof nu?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const r=("a"===e.op?this.headers.get(t):void 0)||[];r.push(...i),this.headers.set(t,r);break;case"d":const o=e.value;if(o){let l=this.headers.get(t);if(!l)return;l=l.filter(c=>-1===o.indexOf(c)),0===l.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,l)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Mee{encodeKey(e){return zU(e)}encodeValue(e){return zU(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Eee=/%(\d[a-f0-9])/gi,Cee={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function zU(n){return encodeURIComponent(n).replace(Eee,(e,t)=>{var i;return null!==(i=Cee[t])&&void 0!==i?i:e})}function iC(n){return`${n}`}class Xd{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Mee,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function See(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{const o=r.indexOf("="),[l,c]=-1==o?[e.decodeKey(r),""]:[e.decodeKey(r.slice(0,o)),e.decodeValue(r.slice(o+1))],h=t.get(l)||[];h.push(c),t.set(l,h)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],r=Array.isArray(i)?i.map(iC):[iC(i)];this.map.set(t,r)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const r=e[i];Array.isArray(r)?r.forEach(o=>{t.push({param:i,value:o,op:"a"})}):t.push({param:i,value:r,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Xd({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(iC(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const r=i.indexOf(iC(e.value));-1!==r&&i.splice(r,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Tee{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function HU(n){return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer}function GU(n){return"undefined"!=typeof Blob&&n instanceof Blob}function WU(n){return"undefined"!=typeof FormData&&n instanceof FormData}class bx{constructor(e,t,i,r){let o;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Aee(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||r?(this.body=void 0!==i?i:null,o=r):o=i,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params)),this.headers||(this.headers=new nu),this.context||(this.context=new Tee),this.params){const l=this.params.toString();if(0===l.length)this.urlWithParams=t;else{const c=t.indexOf("?");this.urlWithParams=t+(-1===c?"?":c<t.length-1?"&":"")+l}}else this.params=new Xd,this.urlWithParams=t}serializeBody(){return null===this.body?null:HU(this.body)||GU(this.body)||WU(this.body)||function Dee(n){return"undefined"!=typeof URLSearchParams&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Xd?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||WU(this.body)?null:GU(this.body)?this.body.type||null:HU(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Xd?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){var t;const i=e.method||this.method,r=e.url||this.url,o=e.responseType||this.responseType,l=void 0!==e.body?e.body:this.body,c=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,h=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let p=e.headers||this.headers,g=e.params||this.params;const y=null!==(t=e.context)&&void 0!==t?t:this.context;return void 0!==e.setHeaders&&(p=Object.keys(e.setHeaders).reduce((x,M)=>x.set(M,e.setHeaders[M]),p)),e.setParams&&(g=Object.keys(e.setParams).reduce((x,M)=>x.set(M,e.setParams[M]),g)),new bx(i,r,l,{params:g,headers:p,context:y,reportProgress:h,responseType:o,withCredentials:c})}}var Xr=(()=>((Xr=Xr||{})[Xr.Sent=0]="Sent",Xr[Xr.UploadProgress=1]="UploadProgress",Xr[Xr.ResponseHeader=2]="ResponseHeader",Xr[Xr.DownloadProgress=3]="DownloadProgress",Xr[Xr.Response=4]="Response",Xr[Xr.User=5]="User",Xr))();class eL{constructor(e,t=200,i="OK"){this.headers=e.headers||new nu,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class tL extends eL{constructor(e={}){super(e),this.type=Xr.ResponseHeader}clone(e={}){return new tL({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class rC extends eL{constructor(e={}){super(e),this.type=Xr.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new rC({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class jU extends eL{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function nL(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let iL=(()=>{class n{constructor(t){this.handler=t}request(t,i,r={}){let o;if(t instanceof bx)o=t;else{let h,p;h=r.headers instanceof nu?r.headers:new nu(r.headers),r.params&&(p=r.params instanceof Xd?r.params:new Xd({fromObject:r.params})),o=new bx(t,i,void 0!==r.body?r.body:null,{headers:h,context:r.context,params:p,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials})}const l=Gt(o).pipe(Td(h=>this.handler.handle(h)));if(t instanceof bx||"events"===r.observe)return l;const c=l.pipe(_s(h=>h instanceof rC));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(an(h=>{if(null!==h.body&&!(h.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return h.body}));case"blob":return c.pipe(an(h=>{if(null!==h.body&&!(h.body instanceof Blob))throw new Error("Response is not a Blob.");return h.body}));case"text":return c.pipe(an(h=>{if(null!==h.body&&"string"!=typeof h.body)throw new Error("Response is not a string.");return h.body}));default:return c.pipe(an(h=>h.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${r.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Xd).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,r={}){return this.request("PATCH",t,nL(r,i))}post(t,i,r={}){return this.request("POST",t,nL(r,i))}put(t,i,r={}){return this.request("PUT",t,nL(r,i))}}return n.\u0275fac=function(t){return new(t||n)(Be(VU))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();class qU{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const $U=new at("HTTP_INTERCEPTORS");let Ree=(()=>{class n{intercept(t,i){return i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const Iee=/^\)\]\}',?\n/;let XU=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Ci(i=>{const r=this.xhrFactory.build();if(r.open(t.method,t.urlWithParams),t.withCredentials&&(r.withCredentials=!0),t.headers.forEach((M,S)=>r.setRequestHeader(M,S.join(","))),t.headers.has("Accept")||r.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const M=t.detectContentTypeHeader();null!==M&&r.setRequestHeader("Content-Type",M)}if(t.responseType){const M=t.responseType.toLowerCase();r.responseType="json"!==M?M:"text"}const o=t.serializeBody();let l=null;const c=()=>{if(null!==l)return l;const M=r.statusText||"OK",S=new nu(r.getAllResponseHeaders()),C=function Lee(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(r)||t.url;return l=new tL({headers:S,status:r.status,statusText:M,url:C}),l},h=()=>{let{headers:M,status:S,statusText:C,url:T}=c(),P=null;204!==S&&(P=void 0===r.response?r.responseText:r.response),0===S&&(S=P?200:0);let O=S>=200&&S<300;if("json"===t.responseType&&"string"==typeof P){const k=P;P=P.replace(Iee,"");try{P=""!==P?JSON.parse(P):null}catch(B){P=k,O&&(O=!1,P={error:B,text:P})}}O?(i.next(new rC({body:P,headers:M,status:S,statusText:C,url:T||void 0})),i.complete()):i.error(new jU({error:P,headers:M,status:S,statusText:C,url:T||void 0}))},p=M=>{const{url:S}=c(),C=new jU({error:M,status:r.status||0,statusText:r.statusText||"Unknown Error",url:S||void 0});i.error(C)};let g=!1;const y=M=>{g||(i.next(c()),g=!0);let S={type:Xr.DownloadProgress,loaded:M.loaded};M.lengthComputable&&(S.total=M.total),"text"===t.responseType&&!!r.responseText&&(S.partialText=r.responseText),i.next(S)},x=M=>{let S={type:Xr.UploadProgress,loaded:M.loaded};M.lengthComputable&&(S.total=M.total),i.next(S)};return r.addEventListener("load",h),r.addEventListener("error",p),r.addEventListener("timeout",p),r.addEventListener("abort",p),t.reportProgress&&(r.addEventListener("progress",y),null!==o&&r.upload&&r.upload.addEventListener("progress",x)),r.send(o),i.next({type:Xr.Sent}),()=>{r.removeEventListener("error",p),r.removeEventListener("abort",p),r.removeEventListener("load",h),r.removeEventListener("timeout",p),t.reportProgress&&(r.removeEventListener("progress",y),null!==o&&r.upload&&r.upload.removeEventListener("progress",x)),r.readyState!==r.DONE&&r.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(Be(aN))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();const rL=new at("XSRF_COOKIE_NAME"),sL=new at("XSRF_HEADER_NAME");class ZU{}let Pee=(()=>{class n{constructor(t,i,r){this.doc=t,this.platform=i,this.cookieName=r,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=J2(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(Be(pi),Be(AM),Be(rL))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),oL=(()=>{class n{constructor(t,i){this.tokenService=t,this.headerName=i}intercept(t,i){const r=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||r.startsWith("http://")||r.startsWith("https://"))return i.handle(t);const o=this.tokenService.getToken();return null!==o&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,o)})),i.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Be(ZU),Be(sL))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),Fee=(()=>{class n{constructor(t,i){this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=this.injector.get($U,[]);this.chain=i.reduceRight((r,o)=>new qU(r,o),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(Be(UU),Be(Ii))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),Nee=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:oL,useClass:Ree}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:rL,useValue:t.cookieName}:[],t.headerName?{provide:sL,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({providers:[oL,{provide:$U,useExisting:oL,multi:!0},{provide:ZU,useClass:Pee},{provide:rL,useValue:"XSRF-TOKEN"},{provide:sL,useValue:"X-XSRF-TOKEN"}]}),n})(),Oee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({providers:[iL,{provide:VU,useClass:Fee},XU,{provide:UU,useExisting:XU}],imports:[Nee.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();const kee=["*"];let sC;function wx(n){var e;return(null===(e=function Bee(){if(void 0===sC&&(sC=null,"undefined"!=typeof window)){const n=window;void 0!==n.trustedTypes&&(sC=n.trustedTypes.createPolicy("angular#components",{createHTML:e=>e}))}return sC}())||void 0===e?void 0:e.createHTML(n))||n}function YU(n){return Error(`Unable to find icon with the name "${n}"`)}function JU(n){return Error(`The URL provided to MatIconRegistry was not trusted as a resource URL via Angular's DomSanitizer. Attempted URL was "${n}".`)}function KU(n){return Error(`The literal provided to MatIconRegistry was not trusted as safe HTML by Angular's DomSanitizer. Attempted literal was "${n}".`)}class sp{constructor(e,t,i){this.url=e,this.svgText=t,this.options=i}}let oC=(()=>{class n{constructor(t,i,r,o){this._httpClient=t,this._sanitizer=i,this._errorHandler=o,this._svgIconConfigs=new Map,this._iconSetConfigs=new Map,this._cachedIconsByUrl=new Map,this._inProgressUrlFetches=new Map,this._fontCssClassesByAlias=new Map,this._resolvers=[],this._defaultFontSetClass=["material-icons","mat-ligature-font"],this._document=r}addSvgIcon(t,i,r){return this.addSvgIconInNamespace("",t,i,r)}addSvgIconLiteral(t,i,r){return this.addSvgIconLiteralInNamespace("",t,i,r)}addSvgIconInNamespace(t,i,r,o){return this._addSvgIconConfig(t,i,new sp(r,null,o))}addSvgIconResolver(t){return this._resolvers.push(t),this}addSvgIconLiteralInNamespace(t,i,r,o){const l=this._sanitizer.sanitize(di.HTML,r);if(!l)throw KU(r);const c=wx(l);return this._addSvgIconConfig(t,i,new sp("",c,o))}addSvgIconSet(t,i){return this.addSvgIconSetInNamespace("",t,i)}addSvgIconSetLiteral(t,i){return this.addSvgIconSetLiteralInNamespace("",t,i)}addSvgIconSetInNamespace(t,i,r){return this._addSvgIconSetConfig(t,new sp(i,null,r))}addSvgIconSetLiteralInNamespace(t,i,r){const o=this._sanitizer.sanitize(di.HTML,i);if(!o)throw KU(i);const l=wx(o);return this._addSvgIconSetConfig(t,new sp("",l,r))}registerFontClassAlias(t,i=t){return this._fontCssClassesByAlias.set(t,i),this}classNameForFontAlias(t){return this._fontCssClassesByAlias.get(t)||t}setDefaultFontSetClass(...t){return this._defaultFontSetClass=t,this}getDefaultFontSetClass(){return this._defaultFontSetClass}getSvgIconFromUrl(t){const i=this._sanitizer.sanitize(di.RESOURCE_URL,t);if(!i)throw JU(t);const r=this._cachedIconsByUrl.get(i);return r?Gt(aC(r)):this._loadSvgIconFromConfig(new sp(t,null)).pipe(jr(o=>this._cachedIconsByUrl.set(i,o)),an(o=>aC(o)))}getNamedSvgIcon(t,i=""){const r=QU(i,t);let o=this._svgIconConfigs.get(r);if(o)return this._getSvgFromConfig(o);if(o=this._getIconConfigFromResolvers(i,t),o)return this._svgIconConfigs.set(r,o),this._getSvgFromConfig(o);const l=this._iconSetConfigs.get(i);return l?this._getSvgFromIconSetConfigs(t,l):Tg(YU(r))}ngOnDestroy(){this._resolvers=[],this._svgIconConfigs.clear(),this._iconSetConfigs.clear(),this._cachedIconsByUrl.clear()}_getSvgFromConfig(t){return t.svgText?Gt(aC(this._svgElementFromConfig(t))):this._loadSvgIconFromConfig(t).pipe(an(i=>aC(i)))}_getSvgFromIconSetConfigs(t,i){const r=this._extractIconWithNameFromAnySet(t,i);return r?Gt(r):NB(i.filter(l=>!l.svgText).map(l=>this._loadSvgIconSetFromConfig(l).pipe(Uc(c=>{const p=`Loading icon set URL: ${this._sanitizer.sanitize(di.RESOURCE_URL,l.url)} failed: ${c.message}`;return this._errorHandler.handleError(new Error(p)),Gt(null)})))).pipe(an(()=>{const l=this._extractIconWithNameFromAnySet(t,i);if(!l)throw YU(t);return l}))}_extractIconWithNameFromAnySet(t,i){for(let r=i.length-1;r>=0;r--){const o=i[r];if(o.svgText&&o.svgText.toString().indexOf(t)>-1){const l=this._svgElementFromConfig(o),c=this._extractSvgIconFromSet(l,t,o.options);if(c)return c}}return null}_loadSvgIconFromConfig(t){return this._fetchIcon(t).pipe(jr(i=>t.svgText=i),an(()=>this._svgElementFromConfig(t)))}_loadSvgIconSetFromConfig(t){return t.svgText?Gt(null):this._fetchIcon(t).pipe(jr(i=>t.svgText=i))}_extractSvgIconFromSet(t,i,r){const o=t.querySelector(`[id="${i}"]`);if(!o)return null;const l=o.cloneNode(!0);if(l.removeAttribute("id"),"svg"===l.nodeName.toLowerCase())return this._setSvgAttributes(l,r);if("symbol"===l.nodeName.toLowerCase())return this._setSvgAttributes(this._toSvgElement(l),r);const c=this._svgElementFromString(wx("<svg></svg>"));return c.appendChild(l),this._setSvgAttributes(c,r)}_svgElementFromString(t){const i=this._document.createElement("DIV");i.innerHTML=t;const r=i.querySelector("svg");if(!r)throw Error("<svg> tag not found");return r}_toSvgElement(t){const i=this._svgElementFromString(wx("<svg></svg>")),r=t.attributes;for(let o=0;o<r.length;o++){const{name:l,value:c}=r[o];"id"!==l&&i.setAttribute(l,c)}for(let o=0;o<t.childNodes.length;o++)t.childNodes[o].nodeType===this._document.ELEMENT_NODE&&i.appendChild(t.childNodes[o].cloneNode(!0));return i}_setSvgAttributes(t,i){return t.setAttribute("fit",""),t.setAttribute("height","100%"),t.setAttribute("width","100%"),t.setAttribute("preserveAspectRatio","xMidYMid meet"),t.setAttribute("focusable","false"),i&&i.viewBox&&t.setAttribute("viewBox",i.viewBox),t}_fetchIcon(t){var i;const{url:r,options:o}=t,l=null!==(i=null==o?void 0:o.withCredentials)&&void 0!==i&&i;if(!this._httpClient)throw function Vee(){return Error("Could not find HttpClient provider for use with Angular Material icons. Please include the HttpClientModule from @angular/common/http in your app imports.")}();if(null==r)throw Error(`Cannot fetch icon from URL "${r}".`);const c=this._sanitizer.sanitize(di.RESOURCE_URL,r);if(!c)throw JU(r);const h=this._inProgressUrlFetches.get(c);if(h)return h;const p=this._httpClient.get(c,{responseType:"text",withCredentials:l}).pipe(an(g=>wx(g)),KM(()=>this._inProgressUrlFetches.delete(c)),Sp());return this._inProgressUrlFetches.set(c,p),p}_addSvgIconConfig(t,i,r){return this._svgIconConfigs.set(QU(t,i),r),this}_addSvgIconSetConfig(t,i){const r=this._iconSetConfigs.get(t);return r?r.push(i):this._iconSetConfigs.set(t,[i]),this}_svgElementFromConfig(t){if(!t.svgElement){const i=this._svgElementFromString(t.svgText);this._setSvgAttributes(i,t.options),t.svgElement=i}return t.svgElement}_getIconConfigFromResolvers(t,i){for(let r=0;r<this._resolvers.length;r++){const o=this._resolvers[r](i,t);if(o)return zee(o)?new sp(o.url,null,o.options):new sp(o,null)}}}return n.\u0275fac=function(t){return new(t||n)(Be(iL,8),Be(_D),Be(pi,8),Be(ao))},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function aC(n){return n.cloneNode(!0)}function QU(n,e){return n+":"+e}function zee(n){return!(!n.url||!n.options)}const Hee=$I(class{constructor(n){this._elementRef=n}}),Gee=new at("MAT_ICON_DEFAULT_OPTIONS"),Wee=new at("mat-icon-location",{providedIn:"root",factory:function jee(){const n=Eo(pi),e=n?n.location:null;return{getPathname:()=>e?e.pathname+e.search:""}}}),ez=["clip-path","color-profile","src","cursor","fill","filter","marker","marker-start","marker-mid","marker-end","mask","stroke"],qee=ez.map(n=>`[${n}]`).join(", "),$ee=/^url\(['"]?#(.*?)['"]?\)$/;let Xee=(()=>{class n extends Hee{constructor(t,i,r,o,l,c){super(t),this._iconRegistry=i,this._location=o,this._errorHandler=l,this._inline=!1,this._previousFontSetClass=[],this._currentIconFetch=Ei.EMPTY,c&&(c.color&&(this.color=this.defaultColor=c.color),c.fontSet&&(this.fontSet=c.fontSet)),r||t.nativeElement.setAttribute("aria-hidden","true")}get inline(){return this._inline}set inline(t){this._inline=Nr(t)}get svgIcon(){return this._svgIcon}set svgIcon(t){t!==this._svgIcon&&(t?this._updateSvgIcon(t):this._svgIcon&&this._clearSvgElement(),this._svgIcon=t)}get fontSet(){return this._fontSet}set fontSet(t){const i=this._cleanupFontValue(t);i!==this._fontSet&&(this._fontSet=i,this._updateFontIconClasses())}get fontIcon(){return this._fontIcon}set fontIcon(t){const i=this._cleanupFontValue(t);i!==this._fontIcon&&(this._fontIcon=i,this._updateFontIconClasses())}_splitIconName(t){if(!t)return["",""];const i=t.split(":");switch(i.length){case 1:return["",i[0]];case 2:return i;default:throw Error(`Invalid icon name: "${t}"`)}}ngOnInit(){this._updateFontIconClasses()}ngAfterViewChecked(){const t=this._elementsWithExternalReferences;if(t&&t.size){const i=this._location.getPathname();i!==this._previousPath&&(this._previousPath=i,this._prependPathToReferences(i))}}ngOnDestroy(){this._currentIconFetch.unsubscribe(),this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear()}_usingFontIcon(){return!this.svgIcon}_setSvgElement(t){this._clearSvgElement();const i=this._location.getPathname();this._previousPath=i,this._cacheChildrenWithExternalReferences(t),this._prependPathToReferences(i),this._elementRef.nativeElement.appendChild(t)}_clearSvgElement(){const t=this._elementRef.nativeElement;let i=t.childNodes.length;for(this._elementsWithExternalReferences&&this._elementsWithExternalReferences.clear();i--;){const r=t.childNodes[i];(1!==r.nodeType||"svg"===r.nodeName.toLowerCase())&&r.remove()}}_updateFontIconClasses(){if(!this._usingFontIcon())return;const t=this._elementRef.nativeElement,i=(this.fontSet?this._iconRegistry.classNameForFontAlias(this.fontSet).split(/ +/):this._iconRegistry.getDefaultFontSetClass()).filter(r=>r.length>0);this._previousFontSetClass.forEach(r=>t.classList.remove(r)),i.forEach(r=>t.classList.add(r)),this._previousFontSetClass=i,this.fontIcon!==this._previousFontIconClass&&!i.includes("mat-ligature-font")&&(this._previousFontIconClass&&t.classList.remove(this._previousFontIconClass),this.fontIcon&&t.classList.add(this.fontIcon),this._previousFontIconClass=this.fontIcon)}_cleanupFontValue(t){return"string"==typeof t?t.trim().split(" ")[0]:t}_prependPathToReferences(t){const i=this._elementsWithExternalReferences;i&&i.forEach((r,o)=>{r.forEach(l=>{o.setAttribute(l.name,`url('${t}#${l.value}')`)})})}_cacheChildrenWithExternalReferences(t){const i=t.querySelectorAll(qee),r=this._elementsWithExternalReferences=this._elementsWithExternalReferences||new Map;for(let o=0;o<i.length;o++)ez.forEach(l=>{const c=i[o],h=c.getAttribute(l),p=h?h.match($ee):null;if(p){let g=r.get(c);g||(g=[],r.set(c,g)),g.push({name:l,value:p[1]})}})}_updateSvgIcon(t){if(this._svgNamespace=null,this._svgName=null,this._currentIconFetch.unsubscribe(),t){const[i,r]=this._splitIconName(t);i&&(this._svgNamespace=i),r&&(this._svgName=r),this._currentIconFetch=this._iconRegistry.getNamedSvgIcon(r,i).pipe(Na(1)).subscribe(o=>this._setSvgElement(o),o=>{this._errorHandler.handleError(new Error(`Error retrieving icon ${i}:${r}! ${o.message}`))})}}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(oC),Ll("aria-hidden"),oe(Wee),oe(ao),oe(Gee,8))},n.\u0275cmp=si({type:n,selectors:[["mat-icon"]],hostAttrs:["role","img",1,"mat-icon","notranslate"],hostVars:7,hostBindings:function(t,i){2&t&&(gs("data-mat-icon-type",i._usingFontIcon()?"font":"svg")("data-mat-icon-name",i._svgName||i.fontIcon)("data-mat-icon-namespace",i._svgNamespace||i.fontSet),wt("mat-icon-inline",i.inline)("mat-icon-no-color","primary"!==i.color&&"accent"!==i.color&&"warn"!==i.color))},inputs:{color:"color",inline:"inline",svgIcon:"svgIcon",fontSet:"fontSet",fontIcon:"fontIcon"},exportAs:["matIcon"],features:[Dt],ngContentSelectors:kee,decls:1,vars:0,template:function(t,i){1&t&&(He(),Ze(0))},styles:[".mat-icon{-webkit-user-select:none;user-select:none;background-repeat:no-repeat;display:inline-block;fill:currentColor;height:24px;width:24px;overflow:hidden}.mat-icon.mat-icon-inline{font-size:inherit;height:inherit;line-height:inherit;width:inherit}.mat-icon.mat-ligature-font[fontIcon]::before{content:attr(fontIcon)}[dir=rtl] .mat-icon-rtl-mirror{transform:scale(-1, 1)}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon{display:block}.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-prefix .mat-icon-button .mat-icon,.mat-form-field:not(.mat-form-field-appearance-legacy) .mat-form-field-suffix .mat-icon-button .mat-icon{margin:auto}"],encapsulation:2,changeDetection:0}),n})(),Zee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[hr,hr]}),n})();const Yee=["*",[["mat-toolbar-row"]]],Jee=["*","mat-toolbar-row"],Kee=$I(class{constructor(n){this._elementRef=n}});let Qee=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=st({type:n,selectors:[["mat-toolbar-row"]],hostAttrs:[1,"mat-toolbar-row"],exportAs:["matToolbarRow"]}),n})(),ete=(()=>{class n extends Kee{constructor(t,i,r){super(t),this._platform=i,this._document=r}ngAfterViewInit(){this._platform.isBrowser&&(this._checkToolbarMixedModes(),this._toolbarRows.changes.subscribe(()=>this._checkToolbarMixedModes()))}_checkToolbarMixedModes(){}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(_l),oe(pi))},n.\u0275cmp=si({type:n,selectors:[["mat-toolbar"]],contentQueries:function(t,i,r){if(1&t&&mr(r,Qee,5),2&t){let o;ai(o=li())&&(i._toolbarRows=o)}},hostAttrs:[1,"mat-toolbar"],hostVars:4,hostBindings:function(t,i){2&t&&wt("mat-toolbar-multiple-rows",i._toolbarRows.length>0)("mat-toolbar-single-row",0===i._toolbarRows.length)},inputs:{color:"color"},exportAs:["matToolbar"],features:[Dt],ngContentSelectors:Jee,decls:2,vars:0,template:function(t,i){1&t&&(He(Yee),Ze(0),Ze(1,1))},styles:[".cdk-high-contrast-active .mat-toolbar{outline:solid 1px}.mat-toolbar-row,.mat-toolbar-single-row{display:flex;box-sizing:border-box;padding:0 16px;width:100%;flex-direction:row;align-items:center;white-space:nowrap}.mat-toolbar-multiple-rows{display:flex;box-sizing:border-box;flex-direction:column;width:100%}"],encapsulation:2,changeDetection:0}),n})(),tte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[hr,hr]}),n})(),nte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[hr,hr]}),n})();const rz=["*"],ite=[[["","mat-list-avatar",""],["","mat-list-icon",""],["","matListAvatar",""],["","matListIcon",""]],[["","mat-line",""],["","matLine",""]],"*"],rte=["[mat-list-avatar], [mat-list-icon], [matListAvatar], [matListIcon]","[mat-line], [matLine]","*"],cte=vU(eC(class{})),ute=eC(class{}),oz=new at("MatList"),dte=new at("MatNavList");let hte=(()=>{class n extends cte{constructor(t){super(),this._elementRef=t,this._stateChanges=new ri,"action-list"===this._getListType()&&t.nativeElement.classList.add("mat-action-list")}_getListType(){const t=this._elementRef.nativeElement.nodeName.toLowerCase();return"mat-list"===t?"list":"mat-action-list"===t?"action-list":null}ngOnChanges(){this._stateChanges.next()}ngOnDestroy(){this._stateChanges.complete()}}return n.\u0275fac=function(t){return new(t||n)(oe(In))},n.\u0275cmp=si({type:n,selectors:[["mat-list"],["mat-action-list"]],hostAttrs:[1,"mat-list","mat-list-base"],inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matList"],features:[gn([{provide:oz,useExisting:n}]),Dt,Qr],ngContentSelectors:rz,decls:1,vars:0,template:function(t,i){1&t&&(He(),Ze(0))},styles:['.mat-subheader{display:flex;box-sizing:border-box;padding:16px;align-items:center}.mat-list-base .mat-subheader{margin:0}button.mat-list-item,button.mat-list-option{padding:0;width:100%;background:none;color:inherit;border:none;outline:inherit;-webkit-tap-highlight-color:rgba(0,0,0,0);text-align:left}[dir=rtl] button.mat-list-item,[dir=rtl] button.mat-list-option{text-align:right}button.mat-list-item::-moz-focus-inner,button.mat-list-option::-moz-focus-inner{border:0}.mat-list-base{padding-top:8px;display:block;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-list-base .mat-subheader{height:48px;line-height:16px}.mat-list-base .mat-subheader:first-child{margin-top:-8px}.mat-list-base .mat-list-item,.mat-list-base .mat-list-option{display:block;height:48px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base .mat-list-item .mat-list-item-content,.mat-list-base .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base .mat-list-item .mat-list-item-content-reverse,.mat-list-base .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base .mat-list-item .mat-list-item-ripple,.mat-list-base .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar,.mat-list-base .mat-list-option.mat-list-item-with-avatar{height:56px}.mat-list-base .mat-list-item.mat-2-line,.mat-list-base .mat-list-option.mat-2-line{height:72px}.mat-list-base .mat-list-item.mat-3-line,.mat-list-base .mat-list-option.mat-3-line{height:88px}.mat-list-base .mat-list-item.mat-multi-line,.mat-list-base .mat-list-option.mat-multi-line{height:auto}.mat-list-base .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base .mat-list-item .mat-list-text,.mat-list-base .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base .mat-list-item .mat-list-text>*,.mat-list-base .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base .mat-list-item .mat-list-text:empty,.mat-list-base .mat-list-option .mat-list-text:empty{display:none}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base .mat-list-item .mat-list-avatar,.mat-list-base .mat-list-option .mat-list-avatar{flex-shrink:0;width:40px;height:40px;border-radius:50%;object-fit:cover}.mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:72px;width:calc(100% - 72px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:72px}.mat-list-base .mat-list-item .mat-list-icon,.mat-list-base .mat-list-option .mat-list-icon{flex-shrink:0;width:24px;height:24px;font-size:24px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:64px;width:calc(100% - 64px)}[dir=rtl] .mat-list-base .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:64px}.mat-list-base .mat-list-item .mat-divider,.mat-list-base .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base .mat-list-item .mat-divider,[dir=rtl] .mat-list-base .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-list-base[dense]{padding-top:4px;display:block}.mat-list-base[dense] .mat-subheader{height:40px;line-height:8px}.mat-list-base[dense] .mat-subheader:first-child{margin-top:-4px}.mat-list-base[dense] .mat-list-item,.mat-list-base[dense] .mat-list-option{display:block;height:40px;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-item-content,.mat-list-base[dense] .mat-list-option .mat-list-item-content{display:flex;flex-direction:row;align-items:center;box-sizing:border-box;padding:0 16px;position:relative;height:inherit}.mat-list-base[dense] .mat-list-item .mat-list-item-content-reverse,.mat-list-base[dense] .mat-list-option .mat-list-item-content-reverse{display:flex;align-items:center;padding:0 16px;flex-direction:row-reverse;justify-content:space-around}.mat-list-base[dense] .mat-list-item .mat-list-item-ripple,.mat-list-base[dense] .mat-list-option .mat-list-item-ripple{display:block;top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar{height:48px}.mat-list-base[dense] .mat-list-item.mat-2-line,.mat-list-base[dense] .mat-list-option.mat-2-line{height:60px}.mat-list-base[dense] .mat-list-item.mat-3-line,.mat-list-base[dense] .mat-list-option.mat-3-line{height:76px}.mat-list-base[dense] .mat-list-item.mat-multi-line,.mat-list-base[dense] .mat-list-option.mat-multi-line{height:auto}.mat-list-base[dense] .mat-list-item.mat-multi-line .mat-list-item-content,.mat-list-base[dense] .mat-list-option.mat-multi-line .mat-list-item-content{padding-top:16px;padding-bottom:16px}.mat-list-base[dense] .mat-list-item .mat-list-text,.mat-list-base[dense] .mat-list-option .mat-list-text{display:flex;flex-direction:column;flex:auto;box-sizing:border-box;overflow:hidden;padding:0}.mat-list-base[dense] .mat-list-item .mat-list-text>*,.mat-list-base[dense] .mat-list-option .mat-list-text>*{margin:0;padding:0;font-weight:normal;font-size:inherit}.mat-list-base[dense] .mat-list-item .mat-list-text:empty,.mat-list-base[dense] .mat-list-option .mat-list-text:empty{display:none}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:0;padding-left:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:0}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-left:0;padding-right:16px}[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-item.mat-list-option .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar .mat-list-item-content-reverse .mat-list-text,[dir=rtl] .mat-list-base[dense] .mat-list-option.mat-list-option .mat-list-item-content-reverse .mat-list-text{padding-right:0;padding-left:16px}.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-item.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content-reverse .mat-list-text,.mat-list-base[dense] .mat-list-option.mat-list-item-with-avatar.mat-list-option .mat-list-item-content .mat-list-text{padding-right:16px;padding-left:16px}.mat-list-base[dense] .mat-list-item .mat-list-avatar,.mat-list-base[dense] .mat-list-option .mat-list-avatar{flex-shrink:0;width:36px;height:36px;border-radius:50%;object-fit:cover}.mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:68px;width:calc(100% - 68px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-avatar~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-avatar~.mat-divider-inset{margin-left:auto;margin-right:68px}.mat-list-base[dense] .mat-list-item .mat-list-icon,.mat-list-base[dense] .mat-list-option .mat-list-icon{flex-shrink:0;width:20px;height:20px;font-size:20px;box-sizing:content-box;border-radius:50%;padding:4px}.mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:60px;width:calc(100% - 60px)}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-list-icon~.mat-divider-inset,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-list-icon~.mat-divider-inset{margin-left:auto;margin-right:60px}.mat-list-base[dense] .mat-list-item .mat-divider,.mat-list-base[dense] .mat-list-option .mat-divider{position:absolute;bottom:0;left:0;width:100%;margin:0}[dir=rtl] .mat-list-base[dense] .mat-list-item .mat-divider,[dir=rtl] .mat-list-base[dense] .mat-list-option .mat-divider{margin-left:auto;margin-right:0}.mat-list-base[dense] .mat-list-item .mat-divider.mat-divider-inset,.mat-list-base[dense] .mat-list-option .mat-divider.mat-divider-inset{position:absolute}.mat-nav-list a{text-decoration:none;color:inherit}.mat-nav-list .mat-list-item{cursor:pointer;outline:none}mat-action-list .mat-list-item{cursor:pointer;outline:inherit}.mat-list-option:not(.mat-list-item-disabled){cursor:pointer;outline:none}.mat-list-item-disabled{pointer-events:none}.cdk-high-contrast-active .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active :host .mat-list-item-disabled{opacity:.5}.cdk-high-contrast-active .mat-list-option:hover,.cdk-high-contrast-active .mat-nav-list .mat-list-item:hover,.cdk-high-contrast-active mat-action-list .mat-list-item:hover{outline:dotted 1px;z-index:1}.cdk-high-contrast-active .mat-list-single-selected-option::after{content:"";position:absolute;top:50%;right:16px;transform:translateY(-50%);width:10px;height:0;border-bottom:solid 10px;border-radius:10px}.cdk-high-contrast-active [dir=rtl] .mat-list-single-selected-option::after{right:auto;left:16px}@media(hover: none){.mat-list-option:not(.mat-list-single-selected-option):not(.mat-list-item-disabled):hover,.mat-nav-list .mat-list-item:not(.mat-list-item-disabled):hover,.mat-action-list .mat-list-item:not(.mat-list-item-disabled):hover{background:none}}'],encapsulation:2,changeDetection:0}),n})(),az=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=st({type:n,selectors:[["","mat-list-avatar",""],["","matListAvatar",""]],hostAttrs:[1,"mat-list-avatar"]}),n})(),lz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=st({type:n,selectors:[["","mat-list-icon",""],["","matListIcon",""]],hostAttrs:[1,"mat-list-icon"]}),n})(),fte=(()=>{class n extends ute{constructor(t,i,r,o){super(),this._element=t,this._isInteractiveList=!1,this._destroyed=new ri,this._disabled=!1,this._isInteractiveList=!!(r||o&&"action-list"===o._getListType()),this._list=r||o;const l=this._getHostElement();"button"===l.nodeName.toLowerCase()&&!l.hasAttribute("type")&&l.setAttribute("type","button"),this._list&&this._list._stateChanges.pipe(Tr(this._destroyed)).subscribe(()=>{i.markForCheck()})}get disabled(){return this._disabled||!(!this._list||!this._list.disabled)}set disabled(t){this._disabled=Nr(t)}ngAfterContentInit(){!function bU(n,e,t="mat"){n.changes.pipe(Dg(n)).subscribe(({length:i})=>{vx(e,`${t}-2-line`,!1),vx(e,`${t}-3-line`,!1),vx(e,`${t}-multi-line`,!1),2===i||3===i?vx(e,`${t}-${i}-line`,!0):i>3&&vx(e,`${t}-multi-line`,!0)})}(this._lines,this._element)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_isRippleDisabled(){return!this._isInteractiveList||this.disableRipple||!(!this._list||!this._list.disableRipple)}_getHostElement(){return this._element.nativeElement}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(aa),oe(dte,8),oe(oz,8))},n.\u0275cmp=si({type:n,selectors:[["mat-list-item"],["a","mat-list-item",""],["button","mat-list-item",""]],contentQueries:function(t,i,r){if(1&t&&(mr(r,az,5),mr(r,lz,5),mr(r,xU,5)),2&t){let o;ai(o=li())&&(i._avatar=o.first),ai(o=li())&&(i._icon=o.first),ai(o=li())&&(i._lines=o)}},hostAttrs:[1,"mat-list-item","mat-focus-indicator"],hostVars:4,hostBindings:function(t,i){2&t&&wt("mat-list-item-disabled",i.disabled)("mat-list-item-with-avatar",i._avatar||i._icon)},inputs:{disableRipple:"disableRipple",disabled:"disabled"},exportAs:["matListItem"],features:[Dt],ngContentSelectors:rte,decls:6,vars:2,consts:[[1,"mat-list-item-content"],["mat-ripple","",1,"mat-list-item-ripple",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-list-text"]],template:function(t,i){1&t&&(He(ite),I(0,"span",0),V(1,"span",1),Ze(2),I(3,"span",2),Ze(4,1),F(),Ze(5,2),F()),2&t&&(jn(1),E("matRippleTrigger",i._getHostElement())("matRippleDisabled",i._isRippleDisabled()))},dependencies:[CU],encapsulation:2,changeDetection:0}),n})(),vte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[wU,aee,hr,TU,y0,wU,hr,TU,nte]}),n})();const xte=["sliderWrapper"],Ua=px({passive:!1}),Ete={provide:Va,useExisting:ci(()=>uz),multi:!0};class Cte{}const Tte=QQ($I(vU(class{constructor(n){this._elementRef=n}}),"accent"));let uz=(()=>{class n extends Tte{constructor(t,i,r,o,l,c,h,p){super(t),this._focusMonitor=i,this._changeDetectorRef=r,this._dir=o,this._ngZone=c,this._animationMode=p,this._invert=!1,this._max=100,this._min=0,this._step=1,this._thumbLabel=!1,this._tickInterval=0,this._value=null,this._vertical=!1,this.change=new Mi,this.input=new Mi,this.valueChange=new Mi,this.onTouched=()=>{},this._percent=0,this._isSliding=null,this._isActive=!1,this._tickIntervalPercent=0,this._sliderDimensions=null,this._controlValueAccessorChangeFn=()=>{},this._dirChangeSubscription=Ei.EMPTY,this._pointerDown=g=>{this.disabled||this._isSliding||!Sx(g)&&0!==g.button||this._ngZone.run(()=>{this._touchId=Sx(g)?function Ate(n,e){for(let t=0;t<n.touches.length;t++){const i=n.touches[t].target;if(e===i||e.contains(i))return n.touches[t].identifier}}(g,this._elementRef.nativeElement):void 0;const y=hz(g,this._touchId);if(y){const x=this.value;this._isSliding="pointer",this._lastPointerEvent=g,this._focusHostElement(),this._onMouseenter(),this._bindGlobalEvents(g),this._focusHostElement(),this._updateValueFromPosition(y),this._valueOnSlideStart=x,g.cancelable&&g.preventDefault(),x!=this.value&&this._emitInputEvent()}})},this._pointerMove=g=>{if("pointer"===this._isSliding){const y=hz(g,this._touchId);if(y){g.cancelable&&g.preventDefault();const x=this.value;this._lastPointerEvent=g,this._updateValueFromPosition(y),x!=this.value&&this._emitInputEvent()}}},this._pointerUp=g=>{"pointer"===this._isSliding&&(!Sx(g)||"number"!=typeof this._touchId||lL(g.changedTouches,this._touchId))&&(g.cancelable&&g.preventDefault(),this._removeGlobalEvents(),this._isSliding=null,this._touchId=void 0,this._valueOnSlideStart!=this.value&&!this.disabled&&this._emitChangeEvent(),this._valueOnSlideStart=this._lastPointerEvent=null)},this._windowBlur=()=>{this._lastPointerEvent&&this._pointerUp(this._lastPointerEvent)},this._document=h,this.tabIndex=parseInt(l)||0,c.runOutsideAngular(()=>{const g=t.nativeElement;g.addEventListener("mousedown",this._pointerDown,Ua),g.addEventListener("touchstart",this._pointerDown,Ua)})}get invert(){return this._invert}set invert(t){this._invert=Nr(t)}get max(){return this._max}set max(t){this._max=$d(t,this._max),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get min(){return this._min}set min(t){this._min=$d(t,this._min),this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}get step(){return this._step}set step(t){this._step=$d(t,this._step),this._step%1!=0&&(this._roundToDecimal=this._step.toString().split(".").pop().length),this._changeDetectorRef.markForCheck()}get thumbLabel(){return this._thumbLabel}set thumbLabel(t){this._thumbLabel=Nr(t)}get tickInterval(){return this._tickInterval}set tickInterval(t){this._tickInterval="auto"===t?"auto":"number"==typeof t||"string"==typeof t?$d(t,this._tickInterval):0}get value(){return null===this._value&&(this.value=this._min),this._value}set value(t){if(t!==this._value){let i=$d(t,0);this._roundToDecimal&&i!==this.min&&i!==this.max&&(i=parseFloat(i.toFixed(this._roundToDecimal))),this._value=i,this._percent=this._calculatePercentage(this._value),this._changeDetectorRef.markForCheck()}}get vertical(){return this._vertical}set vertical(t){this._vertical=Nr(t)}get displayValue(){return this.displayWith?this.displayWith(this.value):this._roundToDecimal&&this.value&&this.value%1!=0?this.value.toFixed(this._roundToDecimal):this.value||0}focus(t){this._focusHostElement(t)}blur(){this._blurHostElement()}get percent(){return this._clamp(this._percent)}_shouldInvertAxis(){return this.vertical?!this.invert:this.invert}_isMinValue(){return 0===this.percent}_getThumbGap(){return this.disabled?7:this._isMinValue()&&!this.thumbLabel?this._isActive?10:7:0}_getTrackBackgroundStyles(){const i=this.vertical?`1, ${1-this.percent}, 1`:1-this.percent+", 1, 1";return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"-":""}${this._getThumbGap()}px) scale3d(${i})`}}_getTrackFillStyles(){const t=this.percent,r=this.vertical?`1, ${t}, 1`:`${t}, 1, 1`;return{transform:`translate${this.vertical?"Y":"X"}(${this._shouldInvertMouseCoords()?"":"-"}${this._getThumbGap()}px) scale3d(${r})`,display:0===t?"none":""}}_getTicksContainerStyles(){return{transform:`translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"-":""}${this._tickIntervalPercent/2*100}%)`}}_getTicksStyles(){let t=100*this._tickIntervalPercent,c={backgroundSize:this.vertical?`2px ${t}%`:`${t}% 2px`,transform:`translateZ(0) translate${this.vertical?"Y":"X"}(${this.vertical||"rtl"!=this._getDirection()?"":"-"}${t/2}%)${this.vertical||"rtl"!=this._getDirection()?"":" rotate(180deg)"}`};if(this._isMinValue()&&this._getThumbGap()){const h=this._shouldInvertAxis();let p;p=this.vertical?h?"Bottom":"Top":h?"Right":"Left",c[`padding${p}`]=`${this._getThumbGap()}px`}return c}_getThumbContainerStyles(){const t=this._shouldInvertAxis();return{transform:`translate${this.vertical?"Y":"X"}(-${100*(("rtl"!=this._getDirection()||this.vertical?t:!t)?this.percent:1-this.percent)}%)`}}_shouldInvertMouseCoords(){const t=this._shouldInvertAxis();return"rtl"!=this._getDirection()||this.vertical?t:!t}_getDirection(){return this._dir&&"rtl"==this._dir.value?"rtl":"ltr"}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0).subscribe(t=>{this._isActive=!!t&&"keyboard"!==t,this._changeDetectorRef.detectChanges()}),this._dir&&(this._dirChangeSubscription=this._dir.change.subscribe(()=>{this._changeDetectorRef.markForCheck()}))}ngOnDestroy(){const t=this._elementRef.nativeElement;t.removeEventListener("mousedown",this._pointerDown,Ua),t.removeEventListener("touchstart",this._pointerDown,Ua),this._lastPointerEvent=null,this._removeGlobalEvents(),this._focusMonitor.stopMonitoring(this._elementRef),this._dirChangeSubscription.unsubscribe()}_onMouseenter(){this.disabled||(this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent())}_onFocus(){this._sliderDimensions=this._getSliderDimensions(),this._updateTickIntervalPercent()}_onBlur(){this.onTouched()}_onKeydown(t){if(this.disabled||yx(t)||this._isSliding&&"keyboard"!==this._isSliding)return;const i=this.value;switch(t.keyCode){case 33:this._increment(10);break;case 34:this._increment(-10);break;case 35:this.value=this.max;break;case 36:this.value=this.min;break;case 37:this._increment("rtl"==this._getDirection()?1:-1);break;case 38:this._increment(1);break;case 39:this._increment("rtl"==this._getDirection()?-1:1);break;case 40:this._increment(-1);break;default:return}i!=this.value&&(this._emitInputEvent(),this._emitChangeEvent()),this._isSliding="keyboard",t.preventDefault()}_onKeyup(){"keyboard"===this._isSliding&&(this._isSliding=null)}_getWindow(){return this._document.defaultView||window}_bindGlobalEvents(t){const i=this._document,r=Sx(t),l=r?"touchend":"mouseup";i.addEventListener(r?"touchmove":"mousemove",this._pointerMove,Ua),i.addEventListener(l,this._pointerUp,Ua),r&&i.addEventListener("touchcancel",this._pointerUp,Ua);const c=this._getWindow();void 0!==c&&c&&c.addEventListener("blur",this._windowBlur)}_removeGlobalEvents(){const t=this._document;t.removeEventListener("mousemove",this._pointerMove,Ua),t.removeEventListener("mouseup",this._pointerUp,Ua),t.removeEventListener("touchmove",this._pointerMove,Ua),t.removeEventListener("touchend",this._pointerUp,Ua),t.removeEventListener("touchcancel",this._pointerUp,Ua);const i=this._getWindow();void 0!==i&&i&&i.removeEventListener("blur",this._windowBlur)}_increment(t){const i=this._clamp(this.value||0,this.min,this.max);this.value=this._clamp(i+this.step*t,this.min,this.max)}_updateValueFromPosition(t){if(!this._sliderDimensions)return;let l=this._clamp(((this.vertical?t.y:t.x)-(this.vertical?this._sliderDimensions.top:this._sliderDimensions.left))/(this.vertical?this._sliderDimensions.height:this._sliderDimensions.width));if(this._shouldInvertMouseCoords()&&(l=1-l),0===l)this.value=this.min;else if(1===l)this.value=this.max;else{const c=this._calculateValue(l),h=Math.round((c-this.min)/this.step)*this.step+this.min;this.value=this._clamp(h,this.min,this.max)}}_emitChangeEvent(){this._controlValueAccessorChangeFn(this.value),this.valueChange.emit(this.value),this.change.emit(this._createChangeEvent())}_emitInputEvent(){this.input.emit(this._createChangeEvent())}_updateTickIntervalPercent(){if(!this.tickInterval||!this._sliderDimensions)return;let t;if("auto"==this.tickInterval){let i=this.vertical?this._sliderDimensions.height:this._sliderDimensions.width;t=Math.ceil(30/(i*this.step/(this.max-this.min)))*this.step/i}else t=this.tickInterval*this.step/(this.max-this.min);this._tickIntervalPercent=dz(t)?t:0}_createChangeEvent(t=this.value){let i=new Cte;return i.source=this,i.value=t,i}_calculatePercentage(t){const i=((t||0)-this.min)/(this.max-this.min);return dz(i)?i:0}_calculateValue(t){return this.min+t*(this.max-this.min)}_clamp(t,i=0,r=1){return Math.max(i,Math.min(t,r))}_getSliderDimensions(){return this._sliderWrapper?this._sliderWrapper.nativeElement.getBoundingClientRect():null}_focusHostElement(t){this._elementRef.nativeElement.focus(t)}_blurHostElement(){this._elementRef.nativeElement.blur()}writeValue(t){this.value=t}registerOnChange(t){this._controlValueAccessorChangeFn=t}registerOnTouched(t){this.onTouched=t}setDisabledState(t){this.disabled=t}}return n.\u0275fac=function(t){return new(t||n)(oe(In),oe(jI),oe(aa),oe(YE,8),Ll("tabindex"),oe(zn),oe(pi),oe(Cg,8))},n.\u0275cmp=si({type:n,selectors:[["mat-slider"]],viewQuery:function(t,i){if(1&t&&oa(xte,5),2&t){let r;ai(r=li())&&(i._sliderWrapper=r.first)}},hostAttrs:["role","slider",1,"mat-slider","mat-focus-indicator"],hostVars:29,hostBindings:function(t,i){1&t&&se("focus",function(){return i._onFocus()})("blur",function(){return i._onBlur()})("keydown",function(o){return i._onKeydown(o)})("keyup",function(){return i._onKeyup()})("mouseenter",function(){return i._onMouseenter()})("selectstart",function(o){return o.preventDefault()}),2&t&&(gA("tabIndex",i.tabIndex),gs("aria-disabled",i.disabled)("aria-valuemax",i.max)("aria-valuemin",i.min)("aria-valuenow",i.value)("aria-valuetext",null==i.valueText?i.displayValue:i.valueText)("aria-orientation",i.vertical?"vertical":"horizontal"),wt("mat-slider-disabled",i.disabled)("mat-slider-has-ticks",i.tickInterval)("mat-slider-horizontal",!i.vertical)("mat-slider-axis-inverted",i._shouldInvertAxis())("mat-slider-invert-mouse-coords",i._shouldInvertMouseCoords())("mat-slider-sliding",i._isSliding)("mat-slider-thumb-label-showing",i.thumbLabel)("mat-slider-vertical",i.vertical)("mat-slider-min-value",i._isMinValue())("mat-slider-hide-last-tick",i.disabled||i._isMinValue()&&i._getThumbGap()&&i._shouldInvertAxis())("_mat-animation-noopable","NoopAnimations"===i._animationMode))},inputs:{disabled:"disabled",color:"color",tabIndex:"tabIndex",invert:"invert",max:"max",min:"min",step:"step",thumbLabel:"thumbLabel",tickInterval:"tickInterval",value:"value",displayWith:"displayWith",valueText:"valueText",vertical:"vertical"},outputs:{change:"change",input:"input",valueChange:"valueChange"},exportAs:["matSlider"],features:[gn([Ete]),Dt],decls:13,vars:6,consts:[[1,"mat-slider-wrapper"],["sliderWrapper",""],[1,"mat-slider-track-wrapper"],[1,"mat-slider-track-background",3,"ngStyle"],[1,"mat-slider-track-fill",3,"ngStyle"],[1,"mat-slider-ticks-container",3,"ngStyle"],[1,"mat-slider-ticks",3,"ngStyle"],[1,"mat-slider-thumb-container",3,"ngStyle"],[1,"mat-slider-focus-ring"],[1,"mat-slider-thumb"],[1,"mat-slider-thumb-label"],[1,"mat-slider-thumb-label-text"]],template:function(t,i){1&t&&(I(0,"div",0,1)(2,"div",2),V(3,"div",3)(4,"div",4),F(),I(5,"div",5),V(6,"div",6),F(),I(7,"div",7),V(8,"div",8)(9,"div",9),I(10,"div",10)(11,"span",11),Pt(12),F()()()()),2&t&&(jn(3),E("ngStyle",i._getTrackBackgroundStyles()),jn(1),E("ngStyle",i._getTrackFillStyles()),jn(1),E("ngStyle",i._getTicksContainerStyles()),jn(1),E("ngStyle",i._getTicksStyles()),jn(1),E("ngStyle",i._getThumbContainerStyles()),jn(5),Ut(i.displayValue))},dependencies:[iN],styles:['.mat-slider{display:inline-block;position:relative;box-sizing:border-box;padding:8px;outline:none;vertical-align:middle}.mat-slider:not(.mat-slider-disabled):active,.mat-slider.mat-slider-sliding:not(.mat-slider-disabled){cursor:grabbing}.mat-slider-wrapper{-webkit-print-color-adjust:exact;color-adjust:exact;position:absolute}.mat-slider-track-wrapper{position:absolute;top:0;left:0;overflow:hidden}.mat-slider-track-fill{position:absolute;transform-origin:0 0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-track-background{position:absolute;transform-origin:100% 100%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-ticks-container{position:absolute;left:0;top:0;overflow:hidden}.mat-slider-ticks{-webkit-background-clip:content-box;background-clip:content-box;background-repeat:repeat;box-sizing:border-box;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-container{position:absolute;z-index:1;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-focus-ring{position:absolute;width:30px;height:30px;border-radius:50%;transform:scale(0);opacity:0;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider.cdk-keyboard-focused .mat-slider-focus-ring,.mat-slider.cdk-program-focused .mat-slider-focus-ring{transform:scale(1);opacity:1}.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb-label,.mat-slider:not(.mat-slider-disabled):not(.mat-slider-sliding) .mat-slider-thumb{cursor:grab}.mat-slider-thumb{position:absolute;right:-10px;bottom:-10px;box-sizing:border-box;width:20px;height:20px;border:3px solid rgba(0,0,0,0);border-radius:50%;transform:scale(0.7);transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-thumb-label{display:none;align-items:center;justify-content:center;position:absolute;width:28px;height:28px;border-radius:50%;transition:transform 400ms cubic-bezier(0.25, 0.8, 0.25, 1),border-radius 400ms cubic-bezier(0.25, 0.8, 0.25, 1),background-color 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.cdk-high-contrast-active .mat-slider-thumb-label{outline:solid 1px}.mat-slider-thumb-label-text{z-index:1;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-sliding .mat-slider-track-fill,.mat-slider-sliding .mat-slider-track-background,.mat-slider-sliding .mat-slider-thumb-container{transition-duration:0ms}.mat-slider-has-ticks .mat-slider-wrapper::after{content:"";position:absolute;border-width:0;border-style:solid;opacity:0;transition:opacity 400ms cubic-bezier(0.25, 0.8, 0.25, 1)}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after,.mat-slider-has-ticks:hover:not(.mat-slider-hide-last-tick) .mat-slider-wrapper::after{opacity:1}.mat-slider-has-ticks.cdk-focused:not(.mat-slider-disabled) .mat-slider-ticks,.mat-slider-has-ticks:hover:not(.mat-slider-disabled) .mat-slider-ticks{opacity:1}.mat-slider-thumb-label-showing .mat-slider-focus-ring{display:none}.mat-slider-thumb-label-showing .mat-slider-thumb-label{display:flex}.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:100% 100%}.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:0 0}.mat-slider:not(.mat-slider-disabled).cdk-focused.mat-slider-thumb-label-showing .mat-slider-thumb{transform:scale(0)}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label{border-radius:50% 50% 0}.mat-slider:not(.mat-slider-disabled).cdk-focused .mat-slider-thumb-label-text{opacity:1}.mat-slider:not(.mat-slider-disabled).cdk-mouse-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-touch-focused .mat-slider-thumb,.mat-slider:not(.mat-slider-disabled).cdk-program-focused .mat-slider-thumb{border-width:2px;transform:scale(1)}.mat-slider-disabled .mat-slider-focus-ring{transform:scale(0);opacity:0}.mat-slider-disabled .mat-slider-thumb{border-width:4px;transform:scale(0.5)}.mat-slider-disabled .mat-slider-thumb-label{display:none}.mat-slider-horizontal{height:48px;min-width:128px}.mat-slider-horizontal .mat-slider-wrapper{height:2px;top:23px;left:8px;right:8px}.mat-slider-horizontal .mat-slider-wrapper::after{height:2px;border-left-width:2px;right:0;top:0}.mat-slider-horizontal .mat-slider-track-wrapper{height:2px;width:100%}.mat-slider-horizontal .mat-slider-track-fill{height:2px;width:100%;transform:scaleX(0)}.mat-slider-horizontal .mat-slider-track-background{height:2px;width:100%;transform:scaleX(1)}.mat-slider-horizontal .mat-slider-ticks-container{height:2px;width:100%}.cdk-high-contrast-active .mat-slider-horizontal .mat-slider-ticks-container{height:0;outline:solid 2px;top:1px}.mat-slider-horizontal .mat-slider-ticks{height:2px;width:100%}.mat-slider-horizontal .mat-slider-thumb-container{width:100%;height:0;top:50%}.mat-slider-horizontal .mat-slider-focus-ring{top:-15px;right:-15px}.mat-slider-horizontal .mat-slider-thumb-label{right:-14px;top:-40px;transform:translateY(26px) scale(0.01) rotate(45deg)}.mat-slider-horizontal .mat-slider-thumb-label-text{transform:rotate(-45deg)}.mat-slider-horizontal.cdk-focused .mat-slider-thumb-label{transform:rotate(45deg)}.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label,.cdk-high-contrast-active .mat-slider-horizontal.cdk-focused .mat-slider-thumb-label-text{transform:none}.mat-slider-vertical{width:48px;min-height:128px}.mat-slider-vertical .mat-slider-wrapper{width:2px;top:8px;bottom:8px;left:23px}.mat-slider-vertical .mat-slider-wrapper::after{width:2px;border-top-width:2px;bottom:0;left:0}.mat-slider-vertical .mat-slider-track-wrapper{height:100%;width:2px}.mat-slider-vertical .mat-slider-track-fill{height:100%;width:2px;transform:scaleY(0)}.mat-slider-vertical .mat-slider-track-background{height:100%;width:2px;transform:scaleY(1)}.mat-slider-vertical .mat-slider-ticks-container{width:2px;height:100%}.cdk-high-contrast-active .mat-slider-vertical .mat-slider-ticks-container{width:0;outline:solid 2px;left:1px}.mat-slider-vertical .mat-slider-focus-ring{bottom:-15px;left:-15px}.mat-slider-vertical .mat-slider-ticks{width:2px;height:100%}.mat-slider-vertical .mat-slider-thumb-container{height:100%;width:0;left:50%}.mat-slider-vertical .mat-slider-thumb{-webkit-backface-visibility:hidden;backface-visibility:hidden}.mat-slider-vertical .mat-slider-thumb-label{bottom:-14px;left:-40px;transform:translateX(26px) scale(0.01) rotate(-45deg)}.mat-slider-vertical .mat-slider-thumb-label-text{transform:rotate(45deg)}.mat-slider-vertical.cdk-focused .mat-slider-thumb-label{transform:rotate(-45deg)}[dir=rtl] .mat-slider-wrapper::after{left:0;right:auto}[dir=rtl] .mat-slider-horizontal .mat-slider-track-fill{transform-origin:100% 100%}[dir=rtl] .mat-slider-horizontal .mat-slider-track-background{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-fill{transform-origin:0 0}[dir=rtl] .mat-slider-horizontal.mat-slider-axis-inverted .mat-slider-track-background{transform-origin:100% 100%}.mat-slider._mat-animation-noopable .mat-slider-track-fill,.mat-slider._mat-animation-noopable .mat-slider-track-background,.mat-slider._mat-animation-noopable .mat-slider-ticks,.mat-slider._mat-animation-noopable .mat-slider-thumb-container,.mat-slider._mat-animation-noopable .mat-slider-focus-ring,.mat-slider._mat-animation-noopable .mat-slider-thumb,.mat-slider._mat-animation-noopable .mat-slider-thumb-label,.mat-slider._mat-animation-noopable .mat-slider-thumb-label-text,.mat-slider._mat-animation-noopable .mat-slider-has-ticks .mat-slider-wrapper::after{transition:none}'],encapsulation:2,changeDetection:0}),n})();function dz(n){return!isNaN(n)&&isFinite(n)}function Sx(n){return"t"===n.type[0]}function hz(n,e){let t;return t=Sx(n)?"number"==typeof e?lL(n.touches,e)||lL(n.changedTouches,e):n.touches[0]||n.changedTouches[0]:n,t?{x:t.clientX,y:t.clientY}:void 0}function lL(n,e){for(let t=0;t<n.length;t++)if(n[t].identifier===e)return n[t]}let Dte=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[y0,hr,hr]}),n})();const Rte=["myCanvas"];let Ite=(()=>{class n{constructor(t,i,r){this.ngZone=t,this.scene=i,this.model=r,fo.DefaultUp.set(0,0,1)}get canvas(){return this.canvasRef.nativeElement}ngAfterViewInit(){this.scene.OnInit(this.getAspectRatio(),this.canvas,devicePixelRatio,window.innerWidth,window.innerHeight),this.animate()}ngOnDestroy(){}animate(){this.ngZone.runOutsideAngular(()=>{window.addEventListener("DOMContentLoaded",()=>{this.scene.render()})})}onMouseDown(t){}onMouseUp(t){}onMouseMove(t){}onResize(t){this.scene.onResize(this.getAspectRatio(),window.innerWidth,window.innerHeight-120)}getAspectRatio(){return 0===this.canvas.clientHeight?0:this.canvas.clientWidth/this.canvas.clientHeight}}return n.\u0275fac=function(t){return new(t||n)(oe(zn),oe(PB),oe(FB))},n.\u0275cmp=si({type:n,selectors:[["app-three"]],viewQuery:function(t,i){if(1&t&&oa(Rte,7),2&t){let r;ai(r=li())&&(i.canvasRef=r.first)}},hostBindings:function(t,i){1&t&&se("mousedown",function(o){return i.onMouseDown(o)})("mouseup",function(o){return i.onMouseUp(o)})("mousemove",function(o){return i.onMouseMove(o)})("resize",function(o){return i.onResize(o)},!1,Xh)},decls:2,vars:0,consts:[["id","myCanvas",2,"overflow","hidden","position","absolute",3,"mousedown","mouseup","mousemove"],["myCanvas",""]],template:function(t,i){1&t&&(I(0,"canvas",0,1),se("mousedown",function(o){return i.onMouseDown(o)})("mouseup",function(o){return i.onMouseUp(o)})("mousemove",function(o){return i.onMouseMove(o)}),F())}}),n})(),Lte=(()=>{class n{constructor(t,i){this.changeDetectorRef=t,this.model=i,this.L=2e4,this.B1=6e3,this.B3=200,this.T1=300,this.T2=400,this.HH=800,this.BB=400,this.TT1=12,this.TT2=20,this.n=3}ngAfterViewInit(){this.redraw()}redraw(){this.model.reSetModel(this.L,this.B1,this.B3,this.T1,this.T2,this.HH,this.BB,this.TT1,this.TT2,this.n)}download(){this.model.download()}}return n.\u0275fac=function(t){return new(t||n)(oe(aa),oe(FB))},n.\u0275cmp=si({type:n,selectors:[["app-root"]],decls:65,vars:20,consts:[[1,"example-container"],["color","primary",1,"example-toolbar"],["mat-icon-button","",3,"click"],[1,"example-app-name"],["mat-icon-button","",1,"right-button",3,"click"],[1,"example-sidenav-container"],["sidenav",""],["role","list"],["role","listitem"],["min","5000","max","50000","step","1000",3,"ngModel","ngModelChange","change"],[1,"example-value-label"],["min","1000","max","10000","step","100",3,"ngModel","ngModelChange","change"],["min","0","max","500","step","10",3,"ngModel","ngModelChange","change"],["min","100","max","500","step","10",3,"ngModel","ngModelChange","change"],["min","100","max","500","step","1",3,"ngModel","ngModelChange","change"],["min","300","max","3000","step","1",3,"ngModel","ngModelChange","change"],["min","300","max","1000","step","1",3,"ngModel","ngModelChange","change"],["min","3","max","50","step","1",3,"ngModel","ngModelChange","change"],["min","2","max","5","step","1",3,"ngModel","ngModelChange","change"]],template:function(t,i){if(1&t){const r=K();I(0,"div",0)(1,"mat-toolbar",1)(2,"button",2),se("click",function(){return _h(r),Np(function A(n){return function Ja(n,e){return n[e]}(function Vr(){return Ke.lFrame.contextLView}(),22+n)}(13).toggle())}),I(3,"mat-icon"),Pt(4,"menu"),F()(),I(5,"h1",3),Pt(6,"GirderGenBrpy App"),F(),I(7,"button",4),se("click",function(){return i.download()}),I(8,"mat-icon"),Pt(9,"cloud_download"),F()()(),I(10,"mat-sidenav-container",5),V(11,"app-three"),I(12,"mat-sidenav",null,6)(14,"mat-list",7)(15,"mat-list-item",8),Pt(16,"\u5ef6\u9577 "),I(17,"mat-slider",9),se("ngModelChange",function(l){return i.L=l})("change",function(){return i.redraw()}),F(),I(18,"label",10),Pt(19),F()(),I(20,"mat-list-item",8),Pt(21,"\u5e8a\u7248\u5e45 "),I(22,"mat-slider",11),se("ngModelChange",function(l){return i.B1=l})("change",function(){return i.redraw()}),F(),I(23,"label",10),Pt(24),F()(),I(25,"mat-list-item",8),Pt(26,"\u5730\u8986\u5e45 "),I(27,"mat-slider",12),se("ngModelChange",function(l){return i.B3=l})("change",function(){return i.redraw()}),F(),I(28,"label",10),Pt(29),F()(),I(30,"mat-list-item",8),Pt(31,"\u5e8a\u7248\u539a\uff08\u4e2d\u5fc3\u70b9\uff09 "),I(32,"mat-slider",13),se("ngModelChange",function(l){return i.T1=l})("change",function(){return i.redraw()}),F(),I(33,"label",10),Pt(34),F()(),I(35,"mat-list-item",8),Pt(36,"\u5e8a\u7248\u539a\uff08\u5730\u8986\u90e8\uff09 "),I(37,"mat-slider",14),se("ngModelChange",function(l){return i.T2=l})("change",function(){return i.redraw()}),F(),I(38,"label",10),Pt(39),F()(),I(40,"mat-list-item",8),Pt(41,"\u6841\u9ad8 "),I(42,"mat-slider",15),se("ngModelChange",function(l){return i.HH=l})("change",function(){return i.redraw()}),F(),I(43,"label",10),Pt(44),F()(),I(45,"mat-list-item",8),Pt(46,"\u6841\u5e45 "),I(47,"mat-slider",16),se("ngModelChange",function(l){return i.BB=l})("change",function(){return i.redraw()}),F(),I(48,"label",10),Pt(49),F()(),I(50,"mat-list-item",8),Pt(51,"\u30a6\u30a7\u30d6\u539a "),I(52,"mat-slider",17),se("ngModelChange",function(l){return i.TT1=l})("change",function(){return i.redraw()}),F(),I(53,"label",10),Pt(54),F()(),I(55,"mat-list-item",8),Pt(56,"\u30d5\u30e9\u30f3\u30b8\u539a "),I(57,"mat-slider",17),se("ngModelChange",function(l){return i.TT2=l})("change",function(){return i.redraw()}),F(),I(58,"label",10),Pt(59),F()(),I(60,"mat-list-item",8),Pt(61,"H\u92fc\u672c\u6570 "),I(62,"mat-slider",18),se("ngModelChange",function(l){return i.n=l})("change",function(){return i.redraw()}),F(),I(63,"label",10),Pt(64),F()()()()()()}2&t&&(jn(17),E("ngModel",i.L),jn(2),Ut(i.L),jn(3),E("ngModel",i.B1),jn(2),Ut(i.B1),jn(3),E("ngModel",i.B3),jn(2),Ut(i.B3),jn(3),E("ngModel",i.T1),jn(2),Ut(i.T1),jn(3),E("ngModel",i.T2),jn(2),Ut(i.T2),jn(3),E("ngModel",i.HH),jn(2),Ut(i.HH),jn(3),E("ngModel",i.BB),jn(2),Ut(i.BB),jn(3),E("ngModel",i.TT1),jn(2),Ut(i.TT1),jn(3),E("ngModel",i.TT2),jn(2),Ut(i.TT2),jn(3),E("ngModel",i.n),jn(2),Ut(i.n))},dependencies:[aV,TI,kU,BU,Xee,ete,hte,fte,uz,Ite],styles:[".example-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;top:0;bottom:0;left:0;right:0}h1.example-app-name[_ngcontent-%COMP%]{margin-left:8px}.example-sidenav-container[_ngcontent-%COMP%]{flex:1}input[_ngcontent-%COMP%]{border:none;width:100px}.example-value-label[_ngcontent-%COMP%]{font-weight:600}.right-button[_ngcontent-%COMP%]{margin:0 0 0 auto}"]}),n})();function fz(n){return new ke(3e3,!1)}function fne(){return"undefined"!=typeof window&&void 0!==window.document}function cL(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Zd(n){switch(n.length){case 0:return new xx;case 1:return n[0];default:return new LU(n)}}function pz(n,e,t,i,r=new Map,o=new Map){const l=[],c=[];let h=-1,p=null;if(i.forEach(g=>{const y=g.get("offset"),x=y==h,M=x&&p||new Map;g.forEach((S,C)=>{let T=C,P=S;if("offset"!==C)switch(T=e.normalizePropertyName(T,l),P){case"!":P=r.get(C);break;case tu:P=o.get(C);break;default:P=e.normalizeStyleValue(C,T,P,l)}M.set(T,P)}),x||c.push(M),p=M,h=y}),l.length)throw function tne(n){return new ke(3502,!1)}();return c}function uL(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&dL(t,"start",n)));break;case"done":n.onDone(()=>i(t&&dL(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&dL(t,"destroy",n)))}}function dL(n,e,t){const i=t.totalTime,o=hL(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,null==i?n.totalTime:i,!!t.disabled),l=n._data;return null!=l&&(o._data=l),o}function hL(n,e,t,i,r="",o=0,l){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:r,totalTime:o,disabled:!!l}}function ma(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function mz(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let fL=(n,e)=>!1,gz=(n,e,t)=>[],_z=null;function pL(n){const e=n.parentNode||n.host;return e===_z?null:e}(cL()||"undefined"!=typeof Element)&&(fne()?(_z=(()=>document.documentElement)(),fL=(n,e)=>{for(;e;){if(e===n)return!0;e=pL(e)}return!1}):fL=(n,e)=>n.contains(e),gz=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let op=null,yz=!1;const vz=fL,xz=gz;let bz=(()=>{class n{validateStyleProperty(t){return function mne(n){op||(op=function gne(){return"undefined"!=typeof document?document.body:null}()||{},yz=!!op.style&&"WebkitAppearance"in op.style);let e=!0;return op.style&&!function pne(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in op.style,!e&&yz&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in op.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return vz(t,i)}getParentElement(t){return pL(t)}query(t,i,r){return xz(t,i,r)}computeStyle(t,i,r){return r||""}animate(t,i,r,o,l,c=[],h){return new xx(r,o)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})(),mL=(()=>{class n{}return n.NOOP=new bz,n})();const gL="ng-enter",lC="ng-leave",cC="ng-trigger",uC=".ng-trigger",Mz="ng-animating",_L=".ng-animating";function Yd(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:yL(parseFloat(e[1]),e[2])}function yL(n,e){return"s"===e?1e3*n:n}function dC(n,e,t){return n.hasOwnProperty("duration")?n:function vne(n,e,t){let r,o=0,l="";if("string"==typeof n){const c=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===c)return e.push(fz()),{duration:0,delay:0,easing:""};r=yL(parseFloat(c[1]),c[2]);const h=c[3];null!=h&&(o=yL(parseFloat(h),c[4]));const p=c[5];p&&(l=p)}else r=n;if(!t){let c=!1,h=e.length;r<0&&(e.push(function Pte(){return new ke(3100,!1)}()),c=!0),o<0&&(e.push(function Fte(){return new ke(3101,!1)}()),c=!0),c&&e.splice(h,0,fz())}return{duration:r,delay:o,easing:l}}(n,e,t)}function Ex(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function Sz(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Jd(n,e=new Map,t){if(t)for(let[i,r]of t)e.set(i,r);for(let[i,r]of n)e.set(i,r);return e}function Cz(n,e,t){return t?e+":"+t+";":""}function Tz(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=Cz(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=Cz(0,Mne(t),n.style[t]));n.setAttribute("style",e)}function ec(n,e,t){n.style&&(e.forEach((i,r)=>{const o=xL(r);t&&!t.has(r)&&t.set(r,n.style[o]),n.style[o]=i}),cL()&&Tz(n))}function ap(n,e){n.style&&(e.forEach((t,i)=>{const r=xL(i);n.style[r]=""}),cL()&&Tz(n))}function Cx(n){return Array.isArray(n)?1==n.length?n[0]:RU(n):n}const vL=new RegExp("{{\\s*(.+?)\\s*}}","g");function Az(n){let e=[];if("string"==typeof n){let t;for(;t=vL.exec(n);)e.push(t[1]);vL.lastIndex=0}return e}function hC(n,e,t){const i=n.toString(),r=i.replace(vL,(o,l)=>{let c=e[l];return null==c&&(t.push(function Ote(n){return new ke(3003,!1)}()),c=""),c.toString()});return r==i?n:r}function fC(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const wne=/-+([a-z0-9])/g;function xL(n){return n.replace(wne,(...e)=>e[1].toUpperCase())}function Mne(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ga(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function kte(n){return new ke(3004,!1)}()}}function Dz(n,e){return window.getComputedStyle(n)[e]}function Dne(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function Rne(n,e,t){if(":"==n[0]){const h=function Ine(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function Jte(n){return new ke(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof h)return void e.push(h);n=h}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function Yte(n){return new ke(3015,!1)}()),e;const r=i[1],o=i[2],l=i[3];e.push(Rz(r,l));"<"==o[0]&&!("*"==r&&"*"==l)&&e.push(Rz(l,r))}(i,t,e)):t.push(n),t}const _C=new Set(["true","1"]),yC=new Set(["false","0"]);function Rz(n,e){const t=_C.has(n)||yC.has(n),i=_C.has(e)||yC.has(e);return(r,o)=>{let l="*"==n||n==r,c="*"==e||e==o;return!l&&t&&"boolean"==typeof r&&(l=r?_C.has(n):yC.has(n)),!c&&i&&"boolean"==typeof o&&(c=o?_C.has(e):yC.has(e)),l&&c}}const Lne=new RegExp("s*:selfs*,?","g");function bL(n,e,t,i){return new Pne(n).build(e,t,i)}class Pne{constructor(e){this._driver=e}build(e,t,i){const r=new One(t);return this._resetContextStyleTimingState(r),ga(this,Cx(e),r)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,r=t.depCount=0;const o=[],l=[];return"@"==e.name.charAt(0)&&t.errors.push(function Vte(){return new ke(3006,!1)}()),e.definitions.forEach(c=>{if(this._resetContextStyleTimingState(t),0==c.type){const h=c,p=h.name;p.toString().split(/\s*,\s*/).forEach(g=>{h.name=g,o.push(this.visitState(h,t))}),h.name=p}else if(1==c.type){const h=this.visitTransition(c,t);i+=h.queryCount,r+=h.depCount,l.push(h)}else t.errors.push(function Ute(){return new ke(3007,!1)}())}),{type:7,name:e.name,states:o,transitions:l,queryCount:i,depCount:r,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),r=e.options&&e.options.params||null;if(i.containsDynamicStyles){const o=new Set,l=r||{};i.styles.forEach(c=>{c instanceof Map&&c.forEach(h=>{Az(h).forEach(p=>{l.hasOwnProperty(p)||o.add(p)})})}),o.size&&(fC(o.values()),t.errors.push(function zte(n,e){return new ke(3008,!1)}()))}return{type:0,name:e.name,style:i,options:r?{params:r}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=ga(this,Cx(e.animation),t);return{type:1,matchers:Dne(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:lp(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>ga(this,i,t)),options:lp(e.options)}}visitGroup(e,t){const i=t.currentTime;let r=0;const o=e.steps.map(l=>{t.currentTime=i;const c=ga(this,l,t);return r=Math.max(r,t.currentTime),c});return t.currentTime=r,{type:3,steps:o,options:lp(e.options)}}visitAnimate(e,t){const i=function Bne(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return wL(dC(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=wL(0,0,"");return o.dynamic=!0,o.strValue=t,o}const r=dC(t,e);return wL(r.duration,r.delay,r.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let r,o=e.styles?e.styles:L_({});if(5==o.type)r=this.visitKeyframes(o,t);else{let l=e.styles,c=!1;if(!l){c=!0;const p={};i.easing&&(p.easing=i.easing),l=L_(p)}t.currentTime+=i.duration+i.delay;const h=this.visitStyle(l,t);h.isEmptyStep=c,r=h}return t.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],r=Array.isArray(e.styles)?e.styles:[e.styles];for(let c of r)"string"==typeof c?c===tu?i.push(c):t.errors.push(new ke(3002,!1)):i.push(Sz(c));let o=!1,l=null;return i.forEach(c=>{if(c instanceof Map&&(c.has("easing")&&(l=c.get("easing"),c.delete("easing")),!o))for(let h of c.values())if(h.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:i,easing:l,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let r=t.currentTime,o=t.currentTime;i&&o>0&&(o-=i.duration+i.delay),e.styles.forEach(l=>{"string"!=typeof l&&l.forEach((c,h)=>{const p=t.collectedStyles.get(t.currentQuerySelector),g=p.get(h);let y=!0;g&&(o!=r&&o>=g.startTime&&r<=g.endTime&&(t.errors.push(function Gte(n,e,t,i,r){return new ke(3010,!1)}()),y=!1),o=g.startTime),y&&p.set(h,{startTime:o,endTime:r}),t.options&&function bne(n,e,t){const i=e.params||{},r=Az(n);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||t.push(function Nte(n){return new ke(3001,!1)}())})}(c,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function Wte(){return new ke(3011,!1)}()),i;let o=0;const l=[];let c=!1,h=!1,p=0;const g=e.steps.map(P=>{const O=this._makeStyleAst(P,t);let k=null!=O.offset?O.offset:function kne(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(O.styles),B=0;return null!=k&&(o++,B=O.offset=k),h=h||B<0||B>1,c=c||B<p,p=B,l.push(B),O});h&&t.errors.push(function jte(){return new ke(3012,!1)}()),c&&t.errors.push(function qte(){return new ke(3200,!1)}());const y=e.steps.length;let x=0;o>0&&o<y?t.errors.push(function $te(){return new ke(3202,!1)}()):0==o&&(x=1/(y-1));const M=y-1,S=t.currentTime,C=t.currentAnimateTimings,T=C.duration;return g.forEach((P,O)=>{const k=x>0?O==M?1:x*O:l[O],B=k*T;t.currentTime=S+C.delay+B,C.duration=B,this._validateStyleAst(P,t),P.offset=k,i.styles.push(P)}),i}visitReference(e,t){return{type:8,animation:ga(this,Cx(e.animation),t),options:lp(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:lp(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:lp(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,r=e.options||{};t.queryCount++,t.currentQuery=e;const[o,l]=function Fne(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(Lne,"")),n=n.replace(/@\*/g,uC).replace(/@\w+/g,t=>uC+"-"+t.slice(1)).replace(/:animating/g,_L),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+o:o,ma(t.collectedStyles,t.currentQuerySelector,new Map);const c=ga(this,Cx(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:l,animation:c,originalSelector:e.selector,options:lp(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function Xte(){return new ke(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:dC(e.timings,t.errors,!0);return{type:12,animation:ga(this,Cx(e.animation),t),timings:i,options:null}}}class One{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function lp(n){return n?(n=Ex(n)).params&&(n.params=function Nne(n){return n?Ex(n):null}(n.params)):n={},n}function wL(n,e,t){return{duration:n,delay:e,easing:t}}function ML(n,e,t,i,r,o,l=null,c=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:l,subTimeline:c}}class vC{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const zne=new RegExp(":enter","g"),Gne=new RegExp(":leave","g");function SL(n,e,t,i,r,o=new Map,l=new Map,c,h,p=[]){return(new Wne).buildKeyframes(n,e,t,i,r,o,l,c,h,p)}class Wne{buildKeyframes(e,t,i,r,o,l,c,h,p,g=[]){p=p||new vC;const y=new EL(e,t,p,r,o,g,[]);y.options=h;const x=h.delay?Yd(h.delay):0;y.currentTimeline.delayNextStep(x),y.currentTimeline.setStyles([l],null,y.errors,h),ga(this,i,y);const M=y.timelines.filter(S=>S.containsAnimation());if(M.length&&c.size){let S;for(let C=M.length-1;C>=0;C--){const T=M[C];if(T.element===t){S=T;break}}S&&!S.allowOnlyTimelineStyles()&&S.setStyles([c],null,y.errors,h)}return M.length?M.map(S=>S.buildKeyframes()):[ML(t,[],[],[],0,x,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const r=t.createSubContext(e.options),o=t.currentTimeline.currentTime,l=this._visitSubInstructions(i,r,r.options);o!=l&&t.transformIntoNewTimeline(l)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_visitSubInstructions(e,t,i){let o=t.currentTimeline.currentTime;const l=null!=i.duration?Yd(i.duration):null,c=null!=i.delay?Yd(i.delay):null;return 0!==l&&e.forEach(h=>{const p=t.appendInstructionToTimeline(h,l,c);o=Math.max(o,p.duration+p.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),ga(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let r=t;const o=e.options;if(o&&(o.params||o.delay)&&(r=t.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=xC);const l=Yd(o.delay);r.delayNextStep(l)}e.steps.length&&(e.steps.forEach(l=>ga(this,l,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let r=t.currentTimeline.currentTime;const o=e.options&&e.options.delay?Yd(e.options.delay):0;e.steps.forEach(l=>{const c=t.createSubContext(e.options);o&&c.delayNextStep(o),ga(this,l,c),r=Math.max(r,c.currentTimeline.currentTime),i.push(c.currentTimeline)}),i.forEach(l=>t.currentTimeline.mergeTimelineCollectedStyles(l)),t.transformIntoNewTimeline(r),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return dC(t.params?hC(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),r=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),r.snapshotCurrentStyles());const o=e.style;5==o.type?this.visitKeyframes(o,t):(t.incrementTime(i.duration),this.visitStyle(o,t),r.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,r=t.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(o):i.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,r=t.currentTimeline.duration,o=i.duration,c=t.createSubContext().currentTimeline;c.easing=i.easing,e.styles.forEach(h=>{c.forwardTime((h.offset||0)*o),c.setStyles(h.styles,h.easing,t.errors,t.options),c.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(c),t.transformIntoNewTimeline(r+o),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,r=e.options||{},o=r.delay?Yd(r.delay):0;o&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=xC);let l=i;const c=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=c.length;let h=null;c.forEach((p,g)=>{t.currentQueryIndex=g;const y=t.createSubContext(e.options,p);o&&y.delayNextStep(o),p===t.element&&(h=y.currentTimeline),ga(this,e.animation,y),y.currentTimeline.applyStylesToKeyframe(),l=Math.max(l,y.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(l),h&&(t.currentTimeline.mergeTimelineCollectedStyles(h),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,r=t.currentTimeline,o=e.timings,l=Math.abs(o.duration),c=l*(t.currentQueryTotal-1);let h=l*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":h=c-h;break;case"full":h=i.currentStaggerTime}const g=t.currentTimeline;h&&g.delayNextStep(h);const y=g.currentTime;ga(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=r.currentTime-y+(r.startTime-i.currentTimeline.startTime)}}const xC={};class EL{constructor(e,t,i,r,o,l,c,h){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=l,this.timelines=c,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=xC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new bC(this._driver,t,0),c.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let r=this.options;null!=i.duration&&(r.duration=Yd(i.duration)),null!=i.delay&&(r.delay=Yd(i.delay));const o=i.params;if(o){let l=r.params;l||(l=this.options.params={}),Object.keys(o).forEach(c=>{(!t||!l.hasOwnProperty(c))&&(l[c]=hC(o[c],l,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(r=>{i[r]=t[r]})}}return e}createSubContext(e=null,t,i){const r=t||this.element,o=new EL(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=xC,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const r={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+e.delay,easing:""},o=new jne(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,r,e.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,r,o,l){let c=[];if(r&&c.push(this.element),e.length>0){e=(e=e.replace(zne,"."+this._enterClassName)).replace(Gne,"."+this._leaveClassName);let p=this._driver.query(this.element,e,1!=i);0!==i&&(p=i<0?p.slice(p.length+i,p.length):p.slice(0,i)),c.push(...p)}return!o&&0==c.length&&l.push(function Zte(n){return new ke(3014,!1)}()),c}}class bC{constructor(e,t,i,r){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new bC(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||tu),this._currentKeyframe.set(t,tu);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,r){var o;t&&this._previousKeyframe.set("easing",t);const l=r&&r.params||{},c=function qne(n,e){const t=new Map;let i;return n.forEach(r=>{if("*"===r){i=i||e.keys();for(let o of i)t.set(o,tu)}else Jd(r,t)}),t}(e,this._globalTimelineStyles);for(let[h,p]of c){const g=hC(p,l,i);this._pendingStyles.set(h,g),this._localTimelineStyles.has(h)||this._backFill.set(h,null!==(o=this._globalTimelineStyles.get(h))&&void 0!==o?o:tu),this._updateStyle(h,g)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const r=this._styleSummary.get(i);(!r||t.time>r.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((c,h)=>{const p=Jd(c,new Map,this._backFill);p.forEach((g,y)=>{"!"===g?e.add(y):g===tu&&t.add(y)}),i||p.set("offset",h/this.duration),r.push(p)});const o=e.size?fC(e.values()):[],l=t.size?fC(t.values()):[];if(i){const c=r[0],h=new Map(c);c.set("offset",0),h.set("offset",1),r=[c,h]}return ML(this.element,r,o,l,this.duration,this.startTime,this.easing,!1)}}class jne extends bC{constructor(e,t,i,r,o,l,c=!1){super(e,t,l.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=c,this.timings={duration:l.duration,delay:l.delay,easing:l.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&t){const o=[],l=i+t,c=t/l,h=Jd(e[0]);h.set("offset",0),o.push(h);const p=Jd(e[0]);p.set("offset",Pz(c)),o.push(p);const g=e.length-1;for(let y=1;y<=g;y++){let x=Jd(e[y]);const M=x.get("offset");x.set("offset",Pz((t+M*i)/l)),o.push(x)}i=l,t=0,r="",e=o}return ML(this.element,e,this.preStyleProps,this.postStyleProps,i,t,r,!0)}}function Pz(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class CL{}const $ne=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class Xne extends CL{normalizePropertyName(e,t){return xL(e)}normalizeStyleValue(e,t,i,r){let o="";const l=i.toString().trim();if($ne.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const c=i.match(/^[+-]?[\d\.]+([a-z]*)$/);c&&0==c[1].length&&r.push(function Bte(n,e){return new ke(3005,!1)}())}return l+o}}function Fz(n,e,t,i,r,o,l,c,h,p,g,y,x){return{type:0,element:n,triggerName:e,isRemovalTransition:r,fromState:t,fromStyles:o,toState:i,toStyles:l,timelines:c,queriedElements:h,preStyleProps:p,postStyleProps:g,totalTime:y,errors:x}}const TL={};class Nz{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,r){return function Zne(n,e,t,i,r){return n.some(o=>o(e,t,i,r))}(this.ast.matchers,e,t,i,r)}buildStyles(e,t,i){let r=this._stateStyles.get("*");return void 0!==e&&(r=this._stateStyles.get(null==e?void 0:e.toString())||r),r?r.buildStyles(t,i):new Map}build(e,t,i,r,o,l,c,h,p,g){var y;const x=[],M=this.ast.options&&this.ast.options.params||TL,C=this.buildStyles(i,c&&c.params||TL,x),T=h&&h.params||TL,P=this.buildStyles(r,T,x),O=new Set,k=new Map,B=new Map,z="void"===r,q={params:Yne(T,M),delay:null===(y=this.ast.options)||void 0===y?void 0:y.delay},ne=g?[]:SL(e,t,this.ast.animation,o,l,C,P,q,p,x);let U=0;if(ne.forEach(le=>{U=Math.max(le.duration+le.delay,U)}),x.length)return Fz(t,this._triggerName,i,r,z,C,P,[],[],k,B,U,x);ne.forEach(le=>{const me=le.element,Oe=ma(k,me,new Set);le.preStyleProps.forEach(ge=>Oe.add(ge));const tt=ma(B,me,new Set);le.postStyleProps.forEach(ge=>tt.add(ge)),me!==t&&O.add(me)});const ee=fC(O.values());return Fz(t,this._triggerName,i,r,z,C,P,ne,ee,k,B,U)}}function Yne(n,e){const t=Ex(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class Jne{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,r=Ex(this.defaultParams);return Object.keys(e).forEach(o=>{const l=e[o];null!==l&&(r[o]=l)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((l,c)=>{l&&(l=hC(l,r,t));const h=this.normalizer.normalizePropertyName(c,t);l=this.normalizer.normalizeStyleValue(c,h,l,t),i.set(h,l)})}),i}}class Qne{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(r=>{this.states.set(r.name,new Jne(r.style,r.options&&r.options.params||{},i))}),Oz(this.states,"true","1"),Oz(this.states,"false","0"),t.transitions.forEach(r=>{this.transitionFactories.push(new Nz(e,r,this.states))}),this.fallbackTransition=function eie(n,e,t){return new Nz(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(l,c)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,r){return this.transitionFactories.find(l=>l.match(e,t,i,r))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function Oz(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const tie=new vC;class nie{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],o=bL(this._driver,t,i,[]);if(i.length)throw function nne(n){return new ke(3503,!1)}();this._animations.set(e,o)}_buildPlayer(e,t,i){const r=e.element,o=pz(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(r,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const r=[],o=this._animations.get(e);let l;const c=new Map;if(o?(l=SL(this._driver,t,o,gL,lC,new Map,new Map,i,tie,r),l.forEach(g=>{const y=ma(c,g.element,new Map);g.postStyleProps.forEach(x=>y.set(x,null))})):(r.push(function ine(){return new ke(3300,!1)}()),l=[]),r.length)throw function rne(n){return new ke(3504,!1)}();c.forEach((g,y)=>{g.forEach((x,M)=>{g.set(M,this._driver.computeStyle(y,M,tu))})});const p=Zd(l.map(g=>{const y=c.get(g.element);return this._buildPlayer(g,new Map,y)}));return this._playersById.set(e,p),p.onDestroy(()=>this.destroy(e)),this.players.push(p),p}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function sne(n){return new ke(3301,!1)}();return t}listen(e,t,i,r){const o=hL(t,"","","");return uL(this._getPlayer(e),i,o,r),()=>{}}command(e,t,i,r){if("register"==i)return void this.register(e,r[0]);if("create"==i)return void this.create(e,t,r[0]||{});const o=this._getPlayer(e);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(e)}}}const kz="ng-animate-queued",AL="ng-animate-disabled",aie=[],Bz={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},lie={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},za="__ng_removed";class DL{constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function hie(n){return null!=n?n:null}(i?e.value:e),i){const o=Ex(e);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(r=>{null==i[r]&&(i[r]=t[r])})}}}const Tx="void",RL=new DL(Tx);class cie{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Ha(t,this._hostClassName)}listen(e,t,i,r){if(!this._triggers.has(t))throw function one(n,e){return new ke(3302,!1)}();if(null==i||0==i.length)throw function ane(n){return new ke(3303,!1)}();if(!function fie(n){return"start"==n||"done"==n}(i))throw function lne(n,e){return new ke(3400,!1)}();const o=ma(this._elementListeners,e,[]),l={name:t,phase:i,callback:r};o.push(l);const c=ma(this._engine.statesByElement,e,new Map);return c.has(t)||(Ha(e,cC),Ha(e,cC+"-"+t),c.set(t,RL)),()=>{this._engine.afterFlush(()=>{const h=o.indexOf(l);h>=0&&o.splice(h,1),this._triggers.has(t)||c.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function cne(n){return new ke(3401,!1)}();return t}trigger(e,t,i,r=!0){const o=this._getTrigger(t),l=new IL(this.id,t,e);let c=this._engine.statesByElement.get(e);c||(Ha(e,cC),Ha(e,cC+"-"+t),this._engine.statesByElement.set(e,c=new Map));let h=c.get(t);const p=new DL(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&h&&p.absorbOptions(h.options),c.set(t,p),h||(h=RL),p.value!==Tx&&h.value===p.value){if(!function gie(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let r=0;r<t.length;r++){const o=t[r];if(!e.hasOwnProperty(o)||n[o]!==e[o])return!1}return!0}(h.params,p.params)){const C=[],T=o.matchStyles(h.value,h.params,C),P=o.matchStyles(p.value,p.params,C);C.length?this._engine.reportError(C):this._engine.afterFlush(()=>{ap(e,T),ec(e,P)})}return}const x=ma(this._engine.playersByElement,e,[]);x.forEach(C=>{C.namespaceId==this.id&&C.triggerName==t&&C.queued&&C.destroy()});let M=o.matchTransition(h.value,p.value,e,p.params),S=!1;if(!M){if(!r)return;M=o.fallbackTransition,S=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:M,fromState:h,toState:p,player:l,isFallbackTransition:S}),S||(Ha(e,kz),l.onStart(()=>{P_(e,kz)})),l.onDone(()=>{let C=this.players.indexOf(l);C>=0&&this.players.splice(C,1);const T=this._engine.playersByElement.get(e);if(T){let P=T.indexOf(l);P>=0&&T.splice(P,1)}}),this.players.push(l),x.push(l),l}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(r=>r.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,uC,!0);i.forEach(r=>{if(r[za])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(l=>l.triggerLeaveAnimation(r,t,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(e,t,i,r){const o=this._engine.statesByElement.get(e),l=new Map;if(o){const c=[];if(o.forEach((h,p)=>{if(l.set(p,h.value),this._triggers.has(p)){const g=this.trigger(e,p,Tx,r);g&&c.push(g)}}),c.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,l),i&&Zd(c).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const r=new Set;t.forEach(o=>{const l=o.name;if(r.has(l))return;r.add(l);const h=this._triggers.get(l).fallbackTransition,p=i.get(l)||RL,g=new DL(Tx),y=new IL(this.id,l,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:l,transition:h,fromState:p,toState:g,player:y,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(e):[];if(o&&o.length)r=!0;else{let l=e;for(;l=l.parentNode;)if(i.statesByElement.get(l)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{const o=e[za];(!o||o===Bz)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Ha(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,l=this._elementListeners.get(o);l&&l.forEach(c=>{if(c.name==i.triggerName){const h=hL(o,i.triggerName,i.fromState.value,i.toState.value);h._data=e,uL(i.player,c.phase,h,c.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):t.push(i)}),this._queue=[],t.sort((i,r)=>{const o=i.transition.ast.depCount,l=r.transition.ast.depCount;return 0==o||0==l?o-l:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class uie{constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new cie(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let l=!1,c=this.driver.getParentElement(t);for(;c;){const h=r.get(c);if(h){const p=i.indexOf(h);i.splice(p+1,0,e),l=!0;break}c=this.driver.getParentElement(c)}l||i.unshift(e)}else i.push(e);return r.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let r=this._namespaceLookup[e];r&&r.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&t.add(o)}return t}trigger(e,t,i,r){if(wC(t)){const o=this._fetchNamespace(e);if(o)return o.trigger(t,i,r),!0}return!1}insertNode(e,t,i,r){if(!wC(t))return;const o=t[za];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const l=this.collectedLeaveElements.indexOf(t);l>=0&&this.collectedLeaveElements.splice(l,1)}if(e){const l=this._fetchNamespace(e);l&&l.insertNode(t,i)}r&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Ha(e,AL)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),P_(e,AL))}removeNode(e,t,i,r){if(wC(t)){const o=e?this._fetchNamespace(e):null;if(o?o.removeNode(t,r):this.markElementAsRemoved(e,t,!1,r),i){const l=this.namespacesByHostElement.get(t);l&&l.id!==e&&l.removeNode(t,r)}}else this._onRemovalComplete(t,r)}markElementAsRemoved(e,t,i,r,o){this.collectedLeaveElements.push(t),t[za]={namespaceId:e,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,i,r,o){return wC(t)?this._fetchNamespace(e).listen(t,i,r,o):()=>{}}_buildInstruction(e,t,i,r,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,r,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,uC,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,_L,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Zd(this.players).onDone(()=>e());e()})}processLeaveNode(e){var t;const i=e[za];if(i&&i.setForRemoval){if(e[za]=Bz,i.namespaceId){this.destroyInnerAnimations(e);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(e)}this._onRemovalComplete(e,i.setForRemoval)}!(null===(t=e.classList)||void 0===t)&&t.contains(AL)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ha(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Zd(t).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(e){throw function une(n){return new ke(3402,!1)}()}_flushAnimations(e,t){const i=new vC,r=[],o=new Map,l=[],c=new Map,h=new Map,p=new Map,g=new Set;this.disabledNodes.forEach(ae=>{g.add(ae);const ye=this.driver.query(ae,".ng-animate-queued",!0);for(let xe=0;xe<ye.length;xe++)g.add(ye[xe])});const y=this.bodyNode,x=Array.from(this.statesByElement.keys()),M=zz(x,this.collectedEnterElements),S=new Map;let C=0;M.forEach((ae,ye)=>{const xe=gL+C++;S.set(ye,xe),ae.forEach(_e=>Ha(_e,xe))});const T=[],P=new Set,O=new Set;for(let ae=0;ae<this.collectedLeaveElements.length;ae++){const ye=this.collectedLeaveElements[ae],xe=ye[za];xe&&xe.setForRemoval&&(T.push(ye),P.add(ye),xe.hasAnimation?this.driver.query(ye,".ng-star-inserted",!0).forEach(_e=>P.add(_e)):O.add(ye))}const k=new Map,B=zz(x,Array.from(P));B.forEach((ae,ye)=>{const xe=lC+C++;k.set(ye,xe),ae.forEach(_e=>Ha(_e,xe))}),e.push(()=>{M.forEach((ae,ye)=>{const xe=S.get(ye);ae.forEach(_e=>P_(_e,xe))}),B.forEach((ae,ye)=>{const xe=k.get(ye);ae.forEach(_e=>P_(_e,xe))}),T.forEach(ae=>{this.processLeaveNode(ae)})});const z=[],q=[];for(let ae=this._namespaceList.length-1;ae>=0;ae--)this._namespaceList[ae].drainQueuedTransitions(t).forEach(xe=>{const _e=xe.player,Se=xe.element;if(z.push(_e),this.collectedEnterElements.length){const bn=Se[za];if(bn&&bn.setForMove){if(bn.previousTriggersValues&&bn.previousTriggersValues.has(xe.triggerName)){const dn=bn.previousTriggersValues.get(xe.triggerName),Kt=this.statesByElement.get(xe.element);if(Kt&&Kt.has(xe.triggerName)){const ft=Kt.get(xe.triggerName);ft.value=dn,Kt.set(xe.triggerName,ft)}}return void _e.destroy()}}const Je=!y||!this.driver.containsElement(y,Se),Ve=k.get(Se),ot=S.get(Se),ct=this._buildInstruction(xe,i,ot,Ve,Je);if(ct.errors&&ct.errors.length)return void q.push(ct);if(Je)return _e.onStart(()=>ap(Se,ct.fromStyles)),_e.onDestroy(()=>ec(Se,ct.toStyles)),void r.push(_e);if(xe.isFallbackTransition)return _e.onStart(()=>ap(Se,ct.fromStyles)),_e.onDestroy(()=>ec(Se,ct.toStyles)),void r.push(_e);const $t=[];ct.timelines.forEach(bn=>{bn.stretchStartingKeyframe=!0,this.disabledNodes.has(bn.element)||$t.push(bn)}),ct.timelines=$t,i.append(Se,ct.timelines),l.push({instruction:ct,player:_e,element:Se}),ct.queriedElements.forEach(bn=>ma(c,bn,[]).push(_e)),ct.preStyleProps.forEach((bn,dn)=>{if(bn.size){let Kt=h.get(dn);Kt||h.set(dn,Kt=new Set),bn.forEach((ft,Dn)=>Kt.add(Dn))}}),ct.postStyleProps.forEach((bn,dn)=>{let Kt=p.get(dn);Kt||p.set(dn,Kt=new Set),bn.forEach((ft,Dn)=>Kt.add(Dn))})});if(q.length){const ae=[];q.forEach(ye=>{ae.push(function dne(n,e){return new ke(3505,!1)}())}),z.forEach(ye=>ye.destroy()),this.reportError(ae)}const ne=new Map,U=new Map;l.forEach(ae=>{const ye=ae.element;i.has(ye)&&(U.set(ye,ye),this._beforeAnimationBuild(ae.player.namespaceId,ae.instruction,ne))}),r.forEach(ae=>{const ye=ae.element;this._getPreviousPlayers(ye,!1,ae.namespaceId,ae.triggerName,null).forEach(_e=>{ma(ne,ye,[]).push(_e),_e.destroy()})});const ee=T.filter(ae=>Gz(ae,h,p)),le=new Map;Uz(le,this.driver,O,p,tu).forEach(ae=>{Gz(ae,h,p)&&ee.push(ae)});const Oe=new Map;M.forEach((ae,ye)=>{Uz(Oe,this.driver,new Set(ae),h,"!")}),ee.forEach(ae=>{var ye,xe;const _e=le.get(ae),Se=Oe.get(ae);le.set(ae,new Map([...Array.from(null!==(ye=null==_e?void 0:_e.entries())&&void 0!==ye?ye:[]),...Array.from(null!==(xe=null==Se?void 0:Se.entries())&&void 0!==xe?xe:[])]))});const tt=[],ge=[],Pe={};l.forEach(ae=>{const{element:ye,player:xe,instruction:_e}=ae;if(i.has(ye)){if(g.has(ye))return xe.onDestroy(()=>ec(ye,_e.toStyles)),xe.disabled=!0,xe.overrideTotalTime(_e.totalTime),void r.push(xe);let Se=Pe;if(U.size>1){let Ve=ye;const ot=[];for(;Ve=Ve.parentNode;){const ct=U.get(Ve);if(ct){Se=ct;break}ot.push(Ve)}ot.forEach(ct=>U.set(ct,Se))}const Je=this._buildAnimation(xe.namespaceId,_e,ne,o,Oe,le);if(xe.setRealPlayer(Je),Se===Pe)tt.push(xe);else{const Ve=this.playersByElement.get(Se);Ve&&Ve.length&&(xe.parentPlayer=Zd(Ve)),r.push(xe)}}else ap(ye,_e.fromStyles),xe.onDestroy(()=>ec(ye,_e.toStyles)),ge.push(xe),g.has(ye)&&r.push(xe)}),ge.forEach(ae=>{const ye=o.get(ae.element);if(ye&&ye.length){const xe=Zd(ye);ae.setRealPlayer(xe)}}),r.forEach(ae=>{ae.parentPlayer?ae.syncPlayerEvents(ae.parentPlayer):ae.destroy()});for(let ae=0;ae<T.length;ae++){const ye=T[ae],xe=ye[za];if(P_(ye,lC),xe&&xe.hasAnimation)continue;let _e=[];if(c.size){let Je=c.get(ye);Je&&Je.length&&_e.push(...Je);let Ve=this.driver.query(ye,_L,!0);for(let ot=0;ot<Ve.length;ot++){let ct=c.get(Ve[ot]);ct&&ct.length&&_e.push(...ct)}}const Se=_e.filter(Je=>!Je.destroyed);Se.length?pie(this,ye,Se):this.processLeaveNode(ye)}return T.length=0,tt.forEach(ae=>{this.players.push(ae),ae.onDone(()=>{ae.destroy();const ye=this.players.indexOf(ae);this.players.splice(ye,1)}),ae.play()}),tt}elementContainsData(e,t){let i=!1;const r=t[za];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,r,o){let l=[];if(t){const c=this.playersByQueriedElement.get(e);c&&(l=c)}else{const c=this.playersByElement.get(e);if(c){const h=!o||o==Tx;c.forEach(p=>{p.queued||!h&&p.triggerName!=r||l.push(p)})}}return(i||r)&&(l=l.filter(c=>!(i&&i!=c.namespaceId||r&&r!=c.triggerName))),l}_beforeAnimationBuild(e,t,i){const o=t.element,l=t.isRemovalTransition?void 0:e,c=t.isRemovalTransition?void 0:t.triggerName;for(const h of t.timelines){const p=h.element,g=p!==o,y=ma(i,p,[]);this._getPreviousPlayers(p,g,l,c,t.toState).forEach(M=>{const S=M.getRealPlayer();S.beforeDestroy&&S.beforeDestroy(),M.destroy(),y.push(M)})}ap(o,t.fromStyles)}_buildAnimation(e,t,i,r,o,l){const c=t.triggerName,h=t.element,p=[],g=new Set,y=new Set,x=t.timelines.map(S=>{const C=S.element;g.add(C);const T=C[za];if(T&&T.removedBeforeQueried)return new xx(S.duration,S.delay);const P=C!==h,O=function mie(n){const e=[];return Hz(n,e),e}((i.get(C)||aie).map(ne=>ne.getRealPlayer())).filter(ne=>!!ne.element&&ne.element===C),k=o.get(C),B=l.get(C),z=pz(0,this._normalizer,0,S.keyframes,k,B),q=this._buildPlayer(S,z,O);if(S.subTimeline&&r&&y.add(C),P){const ne=new IL(e,c,C);ne.setRealPlayer(q),p.push(ne)}return q});p.forEach(S=>{ma(this.playersByQueriedElement,S.element,[]).push(S),S.onDone(()=>function die(n,e,t){let i=n.get(e);if(i){if(i.length){const r=i.indexOf(t);i.splice(r,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,S.element,S))}),g.forEach(S=>Ha(S,Mz));const M=Zd(x);return M.onDestroy(()=>{g.forEach(S=>P_(S,Mz)),ec(h,t.toStyles)}),y.forEach(S=>{ma(r,S,[]).push(M)}),M}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new xx(e.duration,e.delay)}}class IL{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new xx,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(r=>uL(e,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){ma(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function wC(n){return n&&1===n.nodeType}function Vz(n,e){const t=n.style.display;return n.style.display=null!=e?e:"none",t}function Uz(n,e,t,i,r){const o=[];t.forEach(h=>o.push(Vz(h)));const l=[];i.forEach((h,p)=>{const g=new Map;h.forEach(y=>{const x=e.computeStyle(p,y,r);g.set(y,x),(!x||0==x.length)&&(p[za]=lie,l.push(p))}),n.set(p,g)});let c=0;return t.forEach(h=>Vz(h,o[c++])),l}function zz(n,e){const t=new Map;if(n.forEach(c=>t.set(c,[])),0==e.length)return t;const r=new Set(e),o=new Map;function l(c){if(!c)return 1;let h=o.get(c);if(h)return h;const p=c.parentNode;return h=t.has(p)?p:r.has(p)?1:l(p),o.set(c,h),h}return e.forEach(c=>{const h=l(c);1!==h&&t.get(h).push(c)}),t}function Ha(n,e){var t;null===(t=n.classList)||void 0===t||t.add(e)}function P_(n,e){var t;null===(t=n.classList)||void 0===t||t.remove(e)}function pie(n,e,t){Zd(t).onDone(()=>n.processLeaveNode(e))}function Hz(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof LU?Hz(i.players,e):e.push(i)}}function Gz(n,e,t){const i=t.get(n);if(!i)return!1;let r=e.get(n);return r?i.forEach(o=>r.add(o)):e.set(n,i),t.delete(n),!0}class MC{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new uie(e,t,i),this._timelineEngine=new nie(e,t,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(e,t,i,r,o){const l=e+"-"+r;let c=this._triggerCache[l];if(!c){const h=[],g=bL(this._driver,o,h,[]);if(h.length)throw function ene(n,e){return new ke(3404,!1)}();c=function Kne(n,e,t){return new Qne(n,e,t)}(r,g,this._normalizer),this._triggerCache[l]=c}this._transitionEngine.registerTrigger(t,r,c)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,r){this._transitionEngine.insertNode(e,t,i,r)}onRemove(e,t,i,r){this._transitionEngine.removeNode(e,t,r||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,r){if("@"==i.charAt(0)){const[o,l]=mz(i);this._timelineEngine.command(o,t,l,r)}else this._transitionEngine.trigger(e,t,i,r)}listen(e,t,i,r,o){if("@"==i.charAt(0)){const[l,c]=mz(i);return this._timelineEngine.listen(l,t,c,o)}return this._transitionEngine.listen(e,t,i,r,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let yie=(()=>{class n{constructor(t,i,r){this._element=t,this._startStyles=i,this._endStyles=r,this._state=0;let o=n.initialStylesByElement.get(t);o||n.initialStylesByElement.set(t,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&ec(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(ec(this._element,this._initialStyles),this._endStyles&&(ec(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(ap(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(ap(this._element,this._endStyles),this._endStyles=null),ec(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function LL(n){let e=null;return n.forEach((t,i)=>{(function vie(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class Wz{constructor(e,t,i,r){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&e.set(r,this._finished?i:Dz(this.element,r))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class xie{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return vz(e,t)}getParentElement(e){return pL(e)}query(e,t,i){return xz(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,r,o,l=[]){const h={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(h.easing=o);const p=new Map,g=l.filter(M=>M instanceof Wz);(function Sne(n,e){return 0===n||0===e})(i,r)&&g.forEach(M=>{M.currentSnapshot.forEach((S,C)=>p.set(C,S))});let y=function xne(n){return n.length?n[0]instanceof Map?n:n.map(e=>Sz(e)):[]}(t).map(M=>Jd(M));y=function Ene(n,e,t){if(t.size&&e.length){let i=e[0],r=[];if(t.forEach((o,l)=>{i.has(l)||r.push(l),i.set(l,o)}),r.length)for(let o=1;o<e.length;o++){let l=e[o];r.forEach(c=>l.set(c,Dz(n,c)))}}return e}(e,y,p);const x=function _ie(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=LL(e[0]),e.length>1&&(i=LL(e[e.length-1]))):e instanceof Map&&(t=LL(e)),t||i?new yie(n,t,i):null}(e,y);return new Wz(e,y,h,x)}}let bie=(()=>{class n extends AU{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:Go.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(t)?RU(t):t;return jz(this._renderer,null,i,"register",[r]),new wie(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(Be(Jo),Be(pi))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();class wie extends class cee{}{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new Mie(this._id,e,t||{},this._renderer)}}class Mie{constructor(e,t,i,r){this.id=e,this.element=t,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return jz(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}function jz(n,e,t,i,r){return n.setProperty(e,`@@${t}:${i}`,r)}const qz="@.disabled";let Sie=(()=>{class n{constructor(t,i,r){this.delegate=t,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,l)=>{const c=null==l?void 0:l.parentNode(o);c&&l.removeChild(c,o)}}createRenderer(t,i){const o=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let g=this._rendererCache.get(o);return g||(g=new $z("",o,this.engine),this._rendererCache.set(o,g)),g}const l=i.id,c=i.id+"-"+this._currentId;this._currentId++,this.engine.register(c,t);const h=g=>{Array.isArray(g)?g.forEach(h):this.engine.registerTrigger(l,c,t,g.name,g)};return i.data.animation.forEach(h),new Eie(this,c,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,r){t>=0&&t<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[l,c]=o;l(c)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(Be(Jo),Be(MC),Be(zn))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})();class $z{constructor(e,t,i){this.namespaceId=e,this.delegate=t,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>t.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,r=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,r)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,r){this.delegate.setAttribute(e,t,i,r)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,r){this.delegate.setStyle(e,t,i,r)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==qz?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class Eie extends $z{constructor(e,t,i,r){super(t,i,r),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==qz?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const r=function Cie(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let o=t.slice(1),l="";return"@"!=o.charAt(0)&&([o,l]=function Tie(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(o)),this.engine.listen(this.namespaceId,r,o,l,c=>{this.factory.scheduleListenerCallback(c._data||-1,i,c)})}return this.delegate.listen(e,t,i)}}const Xz=[{provide:AU,useClass:bie},{provide:CL,useFactory:function Die(){return new Xne}},{provide:MC,useClass:(()=>{class n extends MC{constructor(t,i,r,o){super(t.body,i,r)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(Be(pi),Be(mL),Be(CL),Be(p0))},n.\u0275prov=yt({token:n,factory:n.\u0275fac}),n})()},{provide:Jo,useFactory:function Rie(n,e,t){return new Sie(n,e,t)},deps:[ZM,MC,zn]}],PL=[{provide:mL,useFactory:()=>new xie},{provide:Cg,useValue:"BrowserAnimations"},...Xz],Zz=[{provide:mL,useClass:bz},{provide:Cg,useValue:"NoopAnimations"},...Xz];let Iie=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?Zz:PL}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({providers:PL,imports:[MN]}),n})(),Lie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[YQ,hr,hr]}),n})(),Yz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[y0,hr,rU,hr]}),n})(),Jz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({}),n})(),kie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({providers:[tee],imports:[Jz,Yz,hr,Jz,Yz]}),n})(),Kie=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[lQ]}),n})(),mre=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n}),n.\u0275inj=Rn({imports:[Kie,hr,hr]}),n})(),_re=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=Xn({type:n,bootstrap:[Lte]}),n.\u0275inj=Rn({imports:[MN,CK,TK,s9,Oee,wee,Zee,tte,vte,Dte,Lie,kie,mre,Iie]}),n})();(function e5(){C2=!1})(),g8().bootstrapModule(_re).catch(n=>console.error(n))},181:function(sc,Vo,xs){"use strict";var Wi,Mn=this&&this.__extends||(Wi=function(Mt,ht){return(Wi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Nn,hn){Nn.__proto__=hn}||function(Nn,hn){for(var X in hn)Object.prototype.hasOwnProperty.call(hn,X)&&(Nn[X]=hn[X])})(Mt,ht)},function(Mt,ht){if("function"!=typeof ht&&null!==ht)throw new TypeError("Class extends value "+String(ht)+" is not a constructor or null");function Nn(){this.constructor=Mt}Wi(Mt,ht),Mt.prototype=null===ht?Object.create(ht):(Nn.prototype=ht.prototype,new Nn)});Object.defineProperty(Vo,"__esModule",{value:!0}),Vo.OrbitControls=void 0;var Vn=xs(338),Yr={type:"change"},Ei={type:"start"},Or={type:"end"},bo=function(Wi){function Mt(ht,Nn,hn){var X=Wi.call(this)||this;return X.object=ht,X.domElement=void 0!==Nn?Nn:document,X.window=void 0!==hn?hn:window,X.enabled=!0,X.target=new Vn.Vector3,X.minDistance=0,X.maxDistance=1/0,X.minZoom=0,X.maxZoom=1/0,X.minPolarAngle=0,X.maxPolarAngle=Math.PI,X.minAzimuthAngle=-1/0,X.maxAzimuthAngle=1/0,X.enableDamping=!1,X.dampingFactor=.25,X.enableZoom=!0,X.zoomSpeed=1,X.enableRotate=!0,X.rotateSpeed=1,X.enablePan=!0,X.keyPanSpeed=7,X.autoRotate=!1,X.autoRotateSpeed=2,X.enableKeys=!0,X.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},X.mouseButtons={ORBIT:Vn.MOUSE.LEFT,ZOOM:Vn.MOUSE.MIDDLE,PAN:Vn.MOUSE.RIGHT},X.target0=X.target.clone(),X.position0=X.object.position.clone(),X.zoom0=X.object.zoom,X.updateOffset=new Vn.Vector3,X.updateQuat=(new Vn.Quaternion).setFromUnitVectors(ht.up,new Vn.Vector3(0,1,0)),X.updateQuatInverse=X.updateQuat.clone().invert(),X.updateLastPosition=new Vn.Vector3,X.updateLastQuaternion=new Vn.Quaternion,X.state=-1,X.scale=1,X.spherical=new Vn.Spherical,X.sphericalDelta=new Vn.Spherical,X.panOffset=new Vn.Vector3,X.zoomChanged=!1,X.rotateStart=new Vn.Vector2,X.rotateEnd=new Vn.Vector2,X.rotateDelta=new Vn.Vector2,X.panStart=new Vn.Vector2,X.panEnd=new Vn.Vector2,X.panDelta=new Vn.Vector2,X.dollyStart=new Vn.Vector2,X.dollyEnd=new Vn.Vector2,X.dollyDelta=new Vn.Vector2,X.panLeftV=new Vn.Vector3,X.panUpV=new Vn.Vector3,X.panInternalOffset=new Vn.Vector3,X.onMouseDown=function(Nt){if(!1!==X.enabled){if(Nt.preventDefault(),Nt.button===X.mouseButtons.ORBIT){if(!1===X.enableRotate)return;X.rotateStart.set(Nt.clientX,Nt.clientY),X.state=0}else if(Nt.button===X.mouseButtons.ZOOM){if(!1===X.enableZoom)return;X.dollyStart.set(Nt.clientX,Nt.clientY),X.state=1}else if(Nt.button===X.mouseButtons.PAN){if(!1===X.enablePan)return;X.panStart.set(Nt.clientX,Nt.clientY),X.state=2}-1!==X.state&&(document.addEventListener("mousemove",X.onMouseMove,!1),document.addEventListener("mouseup",X.onMouseUp,!1),X.dispatchEvent(Ei))}},X.onMouseMove=function(Nt){if(!1!==X.enabled)if(Nt.preventDefault(),0===X.state){if(!1===X.enableRotate)return;X.rotateEnd.set(Nt.clientX,Nt.clientY),X.rotateDelta.subVectors(X.rotateEnd,X.rotateStart);var Jr=X.domElement===document?X.domElement.body:X.domElement;X.rotateLeft(2*Math.PI*X.rotateDelta.x/Jr.clientWidth*X.rotateSpeed),X.rotateUp(2*Math.PI*X.rotateDelta.y/Jr.clientHeight*X.rotateSpeed),X.rotateStart.copy(X.rotateEnd),X.update()}else if(1===X.state){if(!1===X.enableZoom)return;X.dollyEnd.set(Nt.clientX,Nt.clientY),X.dollyDelta.subVectors(X.dollyEnd,X.dollyStart),X.dollyDelta.y>0?X.dollyIn(X.getZoomScale()):X.dollyDelta.y<0&&X.dollyOut(X.getZoomScale()),X.dollyStart.copy(X.dollyEnd),X.update()}else if(2===X.state){if(!1===X.enablePan)return;X.panEnd.set(Nt.clientX,Nt.clientY),X.panDelta.subVectors(X.panEnd,X.panStart),X.pan(X.panDelta.x,X.panDelta.y),X.panStart.copy(X.panEnd),X.update()}},X.onMouseUp=function(Nt){!1!==X.enabled&&(document.removeEventListener("mousemove",X.onMouseMove,!1),document.removeEventListener("mouseup",X.onMouseUp,!1),X.dispatchEvent(Or),X.state=-1)},X.onMouseWheel=function(Nt){!1===X.enabled||!1===X.enableZoom||-1!==X.state&&0!==X.state||(Nt.preventDefault(),Nt.stopPropagation(),Nt.deltaY<0?X.dollyOut(X.getZoomScale()):Nt.deltaY>0&&X.dollyIn(X.getZoomScale()),X.update(),X.dispatchEvent(Ei),X.dispatchEvent(Or))},X.onKeyDown=function(Nt){if(!1!==X.enabled&&!1!==X.enableKeys&&!1!==X.enablePan)switch(Nt.keyCode){case X.keys.UP:X.pan(0,X.keyPanSpeed),X.update();break;case X.keys.BOTTOM:X.pan(0,-X.keyPanSpeed),X.update();break;case X.keys.LEFT:X.pan(X.keyPanSpeed,0),X.update();break;case X.keys.RIGHT:X.pan(-X.keyPanSpeed,0),X.update()}},X.onTouchStart=function(Nt){if(!1!==X.enabled){switch(Nt.touches.length){case 1:if(!1===X.enableRotate)return;X.rotateStart.set(Nt.touches[0].pageX,Nt.touches[0].pageY),X.state=3;break;case 2:if(!1===X.enableZoom)return;var Jr=Nt.touches[0].pageX-Nt.touches[1].pageX,Kr=Nt.touches[0].pageY-Nt.touches[1].pageY,yr=Math.sqrt(Jr*Jr+Kr*Kr);X.dollyStart.set(0,yr),X.state=4;break;case 3:if(!1===X.enablePan)return;X.panStart.set(Nt.touches[0].pageX,Nt.touches[0].pageY),X.state=5;break;default:X.state=-1}-1!==X.state&&X.dispatchEvent(Ei)}},X.onTouchMove=function(Nt){if(!1!==X.enabled)switch(Nt.preventDefault(),Nt.stopPropagation(),Nt.touches.length){case 1:if(!1===X.enableRotate||3!==X.state)return;X.rotateEnd.set(Nt.touches[0].pageX,Nt.touches[0].pageY),X.rotateDelta.subVectors(X.rotateEnd,X.rotateStart);var Jr=X.domElement===document?X.domElement.body:X.domElement;X.rotateLeft(2*Math.PI*X.rotateDelta.x/Jr.clientWidth*X.rotateSpeed),X.rotateUp(2*Math.PI*X.rotateDelta.y/Jr.clientHeight*X.rotateSpeed),X.rotateStart.copy(X.rotateEnd),X.update();break;case 2:if(!1===X.enableZoom||4!==X.state)return;var Kr=Nt.touches[0].pageX-Nt.touches[1].pageX,yr=Nt.touches[0].pageY-Nt.touches[1].pageY,wo=Math.sqrt(Kr*Kr+yr*yr);X.dollyEnd.set(0,wo),X.dollyDelta.subVectors(X.dollyEnd,X.dollyStart),X.dollyDelta.y>0?X.dollyOut(X.getZoomScale()):X.dollyDelta.y<0&&X.dollyIn(X.getZoomScale()),X.dollyStart.copy(X.dollyEnd),X.update();break;case 3:if(!1===X.enablePan||5!==X.state)return;X.panEnd.set(Nt.touches[0].pageX,Nt.touches[0].pageY),X.panDelta.subVectors(X.panEnd,X.panStart),X.pan(X.panDelta.x,X.panDelta.y),X.panStart.copy(X.panEnd),X.update();break;default:X.state=-1}},X.onTouchEnd=function(Nt){!1!==X.enabled&&(X.dispatchEvent(Or),X.state=-1)},X.onContextMenu=function(Nt){Nt.preventDefault()},X.domElement.addEventListener("contextmenu",X.onContextMenu,!1),X.domElement.addEventListener("mousedown",X.onMouseDown,!1),X.domElement.addEventListener("wheel",X.onMouseWheel,!1),X.domElement.addEventListener("touchstart",X.onTouchStart,!1),X.domElement.addEventListener("touchend",X.onTouchEnd,!1),X.domElement.addEventListener("touchmove",X.onTouchMove,!1),X.window.addEventListener("keydown",X.onKeyDown,!1),X.update(),X}return Mn(Mt,Wi),Mt.prototype.update=function(){var ht=this.object.position;return this.updateOffset.copy(ht).sub(this.target),this.updateOffset.applyQuaternion(this.updateQuat),this.spherical.setFromVector3(this.updateOffset),this.autoRotate&&-1===this.state&&this.rotateLeft(this.getAutoRotationAngle()),this.spherical.theta+=this.sphericalDelta.theta,this.spherical.phi+=this.sphericalDelta.phi,this.spherical.theta=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,this.spherical.theta)),this.spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this.spherical.phi)),this.spherical.makeSafe(),this.spherical.radius*=this.scale,this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius)),this.target.add(this.panOffset),this.updateOffset.setFromSpherical(this.spherical),this.updateOffset.applyQuaternion(this.updateQuatInverse),ht.copy(this.target).add(this.updateOffset),this.object.lookAt(this.target),!0===this.enableDamping?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.panOffset.set(0,0,0),!!(this.zoomChanged||this.updateLastPosition.distanceToSquared(this.object.position)>1e-6||8*(1-this.updateLastQuaternion.dot(this.object.quaternion))>1e-6)&&(this.dispatchEvent(Yr),this.updateLastPosition.copy(this.object.position),this.updateLastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0)},Mt.prototype.panLeft=function(ht,Nn){this.panLeftV.setFromMatrixColumn(Nn,0),this.panLeftV.multiplyScalar(-ht),this.panOffset.add(this.panLeftV)},Mt.prototype.panUp=function(ht,Nn){this.panUpV.setFromMatrixColumn(Nn,1),this.panUpV.multiplyScalar(ht),this.panOffset.add(this.panUpV)},Mt.prototype.pan=function(ht,Nn){var hn=this.domElement===document?this.domElement.body:this.domElement;if(this._checkPerspectiveCamera(this.object)){this.panInternalOffset.copy(this.object.position).sub(this.target);var Nt=this.panInternalOffset.length();Nt*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*ht*Nt/hn.clientHeight,this.object.matrix),this.panUp(2*Nn*Nt/hn.clientHeight,this.object.matrix)}else this._checkOrthographicCamera(this.object)?(this.panLeft(ht*(this.object.right-this.object.left)/this.object.zoom/hn.clientWidth,this.object.matrix),this.panUp(Nn*(this.object.top-this.object.bottom)/this.object.zoom/hn.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)},Mt.prototype.dollyIn=function(ht){this._checkPerspectiveCamera(this.object)?this.scale/=ht:this._checkOrthographicCamera(this.object)?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*ht)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},Mt.prototype.dollyOut=function(ht){this._checkPerspectiveCamera(this.object)?this.scale*=ht:this._checkOrthographicCamera(this.object)?(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/ht)),this.object.updateProjectionMatrix(),this.zoomChanged=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)},Mt.prototype.getAutoRotationAngle=function(){return 2*Math.PI/60/60*this.autoRotateSpeed},Mt.prototype.getZoomScale=function(){return Math.pow(.95,this.zoomSpeed)},Mt.prototype.rotateLeft=function(ht){this.sphericalDelta.theta-=ht},Mt.prototype.rotateUp=function(ht){this.sphericalDelta.phi-=ht},Mt.prototype.getPolarAngle=function(){return this.spherical.phi},Mt.prototype.getAzimuthalAngle=function(){return this.spherical.theta},Mt.prototype.dispose=function(){this.domElement.removeEventListener("contextmenu",this.onContextMenu,!1),this.domElement.removeEventListener("mousedown",this.onMouseDown,!1),this.domElement.removeEventListener("wheel",this.onMouseWheel,!1),this.domElement.removeEventListener("touchstart",this.onTouchStart,!1),this.domElement.removeEventListener("touchend",this.onTouchEnd,!1),this.domElement.removeEventListener("touchmove",this.onTouchMove,!1),document.removeEventListener("mousemove",this.onMouseMove,!1),document.removeEventListener("mouseup",this.onMouseUp,!1),this.window.removeEventListener("keydown",this.onKeyDown,!1)},Mt.prototype.reset=function(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Yr),this.update(),this.state=-1},Mt.prototype.saveState=function(){this.target0.copy(this.target),this.position0.copy(this.object.position),(this._checkOrthographicCamera(this.object)||this._checkPerspectiveCamera(this.object))&&(this.zoom0=this.object.zoom)},Object.defineProperty(Mt.prototype,"center",{get:function(){return console.warn("Three.OrbitControls: .center has been renamed to .target"),this.target},enumerable:!1,configurable:!0}),Object.defineProperty(Mt.prototype,"noZoom",{get:function(){return console.warn("Three.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(ht){console.warn("Three.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!ht},enumerable:!1,configurable:!0}),Mt.prototype._checkPerspectiveCamera=function(ht){return ht.isPerspectiveCamera},Mt.prototype._checkOrthographicCamera=function(ht){return ht.isOrthographicCamera},Mt}(Vn.EventDispatcher);Vo.OrbitControls=bo},338:(sc,Vo,xs)=>{"use strict";xs.r(Vo),xs.d(Vo,{ACESFilmicToneMapping:()=>VC,AddEquation:()=>zo,AddOperation:()=>kC,AdditiveAnimationBlendMode:()=>ah,AdditiveBlending:()=>Uo,AlphaFormat:()=>Gx,AlwaysDepth:()=>Zi,AlwaysStencilFunc:()=>Qx,AmbientLight:()=>zw,AmbientLightProbe:()=>U1,AnimationClip:()=>sf,AnimationLoader:()=>Lw,AnimationMixer:()=>kv,AnimationObjectGroup:()=>ig,AnimationUtils:()=>Hi,ArcCurve:()=>uf,ArrayCamera:()=>om,ArrowHelper:()=>qv,Audio:()=>Km,AudioAnalyser:()=>Qm,AudioContext:()=>Ww,AudioListener:()=>Lv,AudioLoader:()=>B1,AxesHelper:()=>$v,AxisHelper:()=>_d,BackSide:()=>X,BasicDepthPacking:()=>Zs,BasicShadowMap:()=>Wi,BinaryTextureLoader:()=>wd,Bone:()=>ao,BooleanKeyframeTrack:()=>Ec,BoundingBoxHelper:()=>yd,Box2:()=>zr,Box3:()=>Zn,Box3Helper:()=>K1,BoxBufferGeometry:()=>Tl,BoxGeometry:()=>Tl,BoxHelper:()=>rM,BufferAttribute:()=>Ke,BufferGeometry:()=>jt,BufferGeometryLoader:()=>Hw,ByteType:()=>J_,Cache:()=>Ul,Camera:()=>Rl,CameraHelper:()=>J1,CanvasRenderer:()=>lM,CanvasTexture:()=>uv,CatmullRomCurve3:()=>Mv,CineonToneMapping:()=>q_,CircleBufferGeometry:()=>vm,CircleGeometry:()=>vm,ClampToEdgeWrapping:()=>Rs,Clock:()=>G1,Color:()=>At,ColorKeyframeTrack:()=>bv,CompressedTexture:()=>cv,CompressedTextureLoader:()=>wv,ConeBufferGeometry:()=>Xh,ConeGeometry:()=>Xh,CubeCamera:()=>zp,CubeReflectionMapping:()=>gp,CubeRefractionMapping:()=>_p,CubeTexture:()=>Iu,CubeTextureLoader:()=>D1,CubeUVReflectionMapping:()=>ou,CubeUVRefractionMapping:()=>yp,CubicBezierCurve:()=>Bm,CubicBezierCurve3:()=>Ev,CubicInterpolant:()=>Im,CullFaceBack:()=>Or,CullFaceFront:()=>rr,CullFaceFrontBack:()=>bo,CullFaceNone:()=>Ei,Curve:()=>Ii,CurvePath:()=>Um,CustomBlending:()=>Lx,CustomToneMapping:()=>$_,CylinderBufferGeometry:()=>Ku,CylinderGeometry:()=>Ku,Cylindrical:()=>Zw,DataTexture:()=>Qa,DataTexture2DArray:()=>ju,DataTexture3D:()=>Lh,DataTextureLoader:()=>af,DataUtils:()=>Xv,DecrementStencilOp:()=>Di,DecrementWrapStencilOp:()=>JL,DefaultLoadingManager:()=>Iw,DepthFormat:()=>uu,DepthStencilFormat:()=>du,DepthTexture:()=>vw,DirectionalLight:()=>qm,DirectionalLightHelper:()=>NP,DiscreteInterpolant:()=>Lm,DodecahedronBufferGeometry:()=>xm,DodecahedronGeometry:()=>xm,DoubleSide:()=>Nt,DstAlphaFactor:()=>Nx,DstColorFactor:()=>kx,DynamicBufferAttribute:()=>fA,DynamicCopyUsage:()=>nb,DynamicDrawUsage:()=>lc,DynamicReadUsage:()=>KC,EdgesGeometry:()=>xw,EdgesHelper:()=>vd,EllipseCurve:()=>cf,EqualDepth:()=>an,EqualStencilFunc:()=>my,EquirectangularReflectionMapping:()=>X_,EquirectangularRefractionMapping:()=>_a,Euler:()=>xu,EventDispatcher:()=>Yi,ExtrudeBufferGeometry:()=>Ss,ExtrudeGeometry:()=>Ss,FaceColors:()=>aA,FileLoader:()=>Io,FlatShading:()=>Jr,Float16BufferAttribute:()=>gh,Float32Attribute:()=>md,Float32BufferAttribute:()=>pe,Float64Attribute:()=>gd,Float64BufferAttribute:()=>On,FloatType:()=>Wa,Fog:()=>In,FogExp2:()=>Ta,Font:()=>Ym,FontLoader:()=>Rv,FrontSide:()=>hn,Frustum:()=>Pu,GLBufferAttribute:()=>$w,GLSL1:()=>Ps,GLSL3:()=>gi,GammaEncoding:()=>pu,GreaterDepth:()=>NC,GreaterEqualDepth:()=>fp,GreaterEqualStencilFunc:()=>uh,GreaterStencilFunc:()=>Kx,GridHelper:()=>nM,Group:()=>Fl,HalfFloatType:()=>rh,HemisphereLight:()=>Vw,HemisphereLightHelper:()=>tM,HemisphereLightProbe:()=>V1,IcosahedronBufferGeometry:()=>Em,IcosahedronGeometry:()=>Em,ImageBitmapLoader:()=>Dv,ImageLoader:()=>Nm,ImageUtils:()=>Ys,ImmediateRenderObject:()=>vf,IncrementStencilOp:()=>Go,IncrementWrapStencilOp:()=>YL,InstancedBufferAttribute:()=>Zm,InstancedBufferGeometry:()=>Xm,InstancedInterleavedBuffer:()=>Bv,InstancedMesh:()=>fm,Int16Attribute:()=>Fc,Int16BufferAttribute:()=>mh,Int32Attribute:()=>Fo,Int32BufferAttribute:()=>Su,Int8Attribute:()=>Ia,Int8BufferAttribute:()=>Mu,IntType:()=>Q_,InterleavedBuffer:()=>oo,InterleavedBufferAttribute:()=>hs,Interpolant:()=>lo,InterpolateDiscrete:()=>ti,InterpolateLinear:()=>Dp,InterpolateSmooth:()=>uy,InvertStencilOp:()=>gu,JSONLoader:()=>cM,KeepStencilOp:()=>py,KeyframeTrack:()=>Do,LOD:()=>Gh,LatheBufferGeometry:()=>xv,LatheGeometry:()=>xv,Layers:()=>ib,LensFlare:()=>dM,LessDepth:()=>ji,LessEqualDepth:()=>hp,LessEqualStencilFunc:()=>gy,LessStencilFunc:()=>Ip,Light:()=>ta,LightProbe:()=>Rc,Line:()=>Qo,Line3:()=>Z1,LineBasicMaterial:()=>Mr,LineCurve:()=>pf,LineCurve3:()=>Bw,LineDashedMaterial:()=>Rm,LineLoop:()=>qh,LinePieces:()=>sA,LineSegments:()=>ps,LineStrip:()=>t0,LinearEncoding:()=>os,LinearFilter:()=>fr,LinearInterpolant:()=>Es,LinearMipMapLinearFilter:()=>Ux,LinearMipMapNearestFilter:()=>Vx,LinearMipmapLinearFilter:()=>oc,LinearMipmapNearestFilter:()=>vp,LinearToneMapping:()=>Bx,Loader:()=>cr,LoaderUtils:()=>_f,LoadingManager:()=>Fm,LogLuvEncoding:()=>Jx,LoopOnce:()=>Yx,LoopPingPong:()=>Ls,LoopRepeat:()=>ZC,LuminanceAlphaFormat:()=>ac,LuminanceFormat:()=>Dr,MOUSE:()=>ei,Material:()=>Wn,MaterialLoader:()=>$m,Math:()=>Jt,MathUtils:()=>Jt,Matrix3:()=>Ji,Matrix4:()=>Ht,MaxEquation:()=>z_,Mesh:()=>Ni,MeshBasicMaterial:()=>cs,MeshDepthMaterial:()=>rm,MeshDistanceMaterial:()=>Uh,MeshFaceMaterial:()=>cA,MeshLambertMaterial:()=>Dm,MeshMatcapMaterial:()=>Rw,MeshNormalMaterial:()=>tf,MeshPhongMaterial:()=>Tm,MeshPhysicalMaterial:()=>Vl,MeshStandardMaterial:()=>ea,MeshToonMaterial:()=>Am,MinEquation:()=>th,MirroredRepeatWrapping:()=>ih,MixOperation:()=>OC,MultiMaterial:()=>uA,MultiplyBlending:()=>Qd,MultiplyOperation:()=>pp,NearestFilter:()=>kr,NearestMipMapLinearFilter:()=>XL,NearestMipMapNearestFilter:()=>$L,NearestMipmapLinearFilter:()=>Y_,NearestMipmapNearestFilter:()=>Z_,NeverDepth:()=>W_,NeverStencilFunc:()=>mi,NoBlending:()=>yr,NoColors:()=>oA,NoToneMapping:()=>su,NormalAnimationBlendMode:()=>Rn,NormalBlending:()=>wo,NotEqualDepth:()=>j_,NotEqualStencilFunc:()=>qa,NumberKeyframeTrack:()=>nf,Object3D:()=>en,ObjectLoader:()=>P1,ObjectSpaceNormalMap:()=>ja,OctahedronBufferGeometry:()=>Bl,OctahedronGeometry:()=>Bl,OneFactor:()=>Ga,OneMinusDstAlphaFactor:()=>Ox,OneMinusDstColorFactor:()=>ri,OneMinusSrcAlphaFactor:()=>dp,OneMinusSrcColorFactor:()=>H_,OrthographicCamera:()=>Dc,PCFShadowMap:()=>Mt,PCFSoftShadowMap:()=>ht,PMREMGenerator:()=>tA,ParametricBufferGeometry:()=>xc,ParametricGeometry:()=>xc,Particle:()=>Pc,ParticleBasicMaterial:()=>dA,ParticleSystem:()=>BP,ParticleSystemMaterial:()=>hA,Path:()=>zm,PerspectiveCamera:()=>wr,Plane:()=>$o,PlaneBufferGeometry:()=>tl,PlaneGeometry:()=>tl,PlaneHelper:()=>cg,PointCloud:()=>mg,PointCloudMaterial:()=>wf,PointLight:()=>jm,PointLightHelper:()=>Qw,Points:()=>yc,PointsMaterial:()=>lr,PolarGridHelper:()=>Da,PolyhedronBufferGeometry:()=>Ol,PolyhedronGeometry:()=>Ol,PositionalAudio:()=>q1,PropertyBinding:()=>ts,PropertyMixer:()=>qw,QuadraticBezierCurve:()=>mf,QuadraticBezierCurve3:()=>Cv,Quaternion:()=>wi,QuaternionKeyframeTrack:()=>Cc,QuaternionLinearInterpolant:()=>Pm,REVISION:()=>Vn,RGBADepthPacking:()=>fy,RGBAFormat:()=>Xs,RGBAIntegerFormat:()=>iy,RGBA_ASTC_10x10_Format:()=>sh,RGBA_ASTC_10x5_Format:()=>Ap,RGBA_ASTC_10x6_Format:()=>UC,RGBA_ASTC_10x8_Format:()=>ke,RGBA_ASTC_12x10_Format:()=>mn,RGBA_ASTC_12x12_Format:()=>ui,RGBA_ASTC_4x4_Format:()=>Ep,RGBA_ASTC_5x4_Format:()=>Ti,RGBA_ASTC_5x5_Format:()=>Cp,RGBA_ASTC_6x5_Format:()=>Ai,RGBA_ASTC_6x6_Format:()=>Tp,RGBA_ASTC_8x5_Format:()=>jx,RGBA_ASTC_8x6_Format:()=>ci,RGBA_ASTC_8x8_Format:()=>sn,RGBA_BPTC_Format:()=>qx,RGBA_ETC2_EAC_Format:()=>Sp,RGBA_PVRTC_2BPPV1_Format:()=>cy,RGBA_PVRTC_4BPPV1_Format:()=>ly,RGBA_S3TC_DXT1_Format:()=>ry,RGBA_S3TC_DXT3_Format:()=>sy,RGBA_S3TC_DXT5_Format:()=>oy,RGBDEncoding:()=>hy,RGBEEncoding:()=>lh,RGBEFormat:()=>ya,RGBFormat:()=>ss,RGBIntegerFormat:()=>Wx,RGBM16Encoding:()=>ch,RGBM7Encoding:()=>Yt,RGB_ETC1_Format:()=>sr,RGB_ETC2_Format:()=>Mp,RGB_PVRTC_2BPPV1_Format:()=>wp,RGB_PVRTC_4BPPV1_Format:()=>ay,RGB_S3TC_DXT1_Format:()=>bp,RGFormat:()=>ny,RGIntegerFormat:()=>hu,RawShaderMaterial:()=>rd,Ray:()=>cc,Raycaster:()=>Vv,RectAreaLight:()=>ad,RedFormat:()=>ty,RedIntegerFormat:()=>xp,ReinhardToneMapping:()=>BC,RepeatWrapping:()=>nh,ReplaceStencilOp:()=>ZL,ReverseSubtractEquation:()=>Px,RingBufferGeometry:()=>Kh,RingGeometry:()=>Kh,SRGB8_ALPHA8_ASTC_10x10_Format:()=>$C,SRGB8_ALPHA8_ASTC_10x5_Format:()=>WC,SRGB8_ALPHA8_ASTC_10x6_Format:()=>jC,SRGB8_ALPHA8_ASTC_10x8_Format:()=>qC,SRGB8_ALPHA8_ASTC_12x10_Format:()=>Zx,SRGB8_ALPHA8_ASTC_12x12_Format:()=>XC,SRGB8_ALPHA8_ASTC_4x4_Format:()=>zC,SRGB8_ALPHA8_ASTC_5x4_Format:()=>$x,SRGB8_ALPHA8_ASTC_5x5_Format:()=>oh,SRGB8_ALPHA8_ASTC_6x5_Format:()=>Is,SRGB8_ALPHA8_ASTC_6x6_Format:()=>HC,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Xx,SRGB8_ALPHA8_ASTC_8x6_Format:()=>GC,SRGB8_ALPHA8_ASTC_8x8_Format:()=>va,Scene:()=>am,SceneUtils:()=>uM,ShaderChunk:()=>Un,ShaderLib:()=>Yo,ShaderMaterial:()=>Yn,ShadowMaterial:()=>Sc,Shape:()=>Aa,ShapeBufferGeometry:()=>nd,ShapeGeometry:()=>nd,ShapePath:()=>O1,ShapeUtils:()=>sl,ShortType:()=>K_,Skeleton:()=>Wh,SkeletonHelper:()=>Wv,SkinnedMesh:()=>_c,SmoothShading:()=>Kr,Sphere:()=>wl,SphereBufferGeometry:()=>bc,SphereGeometry:()=>bc,Spherical:()=>Xw,SphericalHarmonics3:()=>ld,SplineCurve:()=>gf,SpotLight:()=>Gm,SpotLightHelper:()=>Jw,Sprite:()=>tv,SpriteMaterial:()=>lm,SrcAlphaFactor:()=>Ci,SrcAlphaSaturateFactor:()=>G_,SrcColorFactor:()=>Fx,StaticCopyUsage:()=>QC,StaticDrawUsage:()=>si,StaticReadUsage:()=>tb,StereoCamera:()=>FP,StreamCopyUsage:()=>st,StreamDrawUsage:()=>eb,StreamReadUsage:()=>Xn,StringKeyframeTrack:()=>Tc,SubtractEquation:()=>eh,SubtractiveBlending:()=>U_,TOUCH:()=>Yr,TangentSpaceNormalMap:()=>mu,TetrahedronBufferGeometry:()=>Qh,TetrahedronGeometry:()=>Qh,TextBufferGeometry:()=>wc,TextGeometry:()=>wc,Texture:()=>Rr,TextureLoader:()=>lf,TorusBufferGeometry:()=>Mc,TorusGeometry:()=>Mc,TorusKnotBufferGeometry:()=>ef,TorusKnotGeometry:()=>ef,Triangle:()=>xr,TriangleFanDrawMode:()=>JC,TriangleStripDrawMode:()=>YC,TrianglesDrawMode:()=>dy,TubeBufferGeometry:()=>id,TubeGeometry:()=>id,UVMapping:()=>mp,Uint16Attribute:()=>gg,Uint16BufferAttribute:()=>hc,Uint32Attribute:()=>gs,Uint32BufferAttribute:()=>fc,Uint8Attribute:()=>Mf,Uint8BufferAttribute:()=>Fp,Uint8ClampedAttribute:()=>ms,Uint8ClampedBufferAttribute:()=>ph,Uniform:()=>dd,UniformsLib:()=>mt,UniformsUtils:()=>hb,UnsignedByteType:()=>au,UnsignedInt248Type:()=>cu,UnsignedIntType:()=>Br,UnsignedShort4444Type:()=>zx,UnsignedShort5551Type:()=>Hx,UnsignedShort565Type:()=>ey,UnsignedShortType:()=>lu,VSMShadowMap:()=>Nn,Vector2:()=>qe,Vector3:()=>W,Vector4:()=>$e,VectorKeyframeTrack:()=>rf,Vertex:()=>n0,VertexColors:()=>lA,VideoTexture:()=>lv,WebGL1Renderer:()=>cw,WebGLCubeRenderTarget:()=>pc,WebGLMultisampleRenderTarget:()=>qi,WebGLRenderTarget:()=>rn,WebGLRenderTargetCube:()=>Md,WebGLRenderer:()=>hi,WebGLUtils:()=>sm,WireframeGeometry:()=>Cm,WireframeHelper:()=>xd,WrapAroundEnding:()=>Rp,XHRLoader:()=>bd,ZeroCurvatureEnding:()=>fu,ZeroFactor:()=>up,ZeroSlopeEnding:()=>yt,ZeroStencilOp:()=>Ho,sRGBEncoding:()=>yl});var Mn=xs(861);const Vn="126",ei={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Yr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Ei=0,Or=1,rr=2,bo=3,Wi=0,Mt=1,ht=2,Nn=3,hn=0,X=1,Nt=2,Jr=1,Kr=2,yr=0,wo=1,Uo=2,U_=3,Qd=4,Lx=5,zo=100,eh=101,Px=102,th=103,z_=104,up=200,Ga=201,Fx=202,H_=203,Ci=204,dp=205,Nx=206,Ox=207,kx=208,ri=209,G_=210,W_=0,Zi=1,ji=2,hp=3,an=4,fp=5,NC=6,j_=7,pp=0,OC=1,kC=2,su=0,Bx=1,BC=2,q_=3,VC=4,$_=5,mp=300,gp=301,_p=302,X_=303,_a=304,ou=306,yp=307,nh=1e3,Rs=1001,ih=1002,kr=1003,Z_=1004,$L=1004,Y_=1005,XL=1005,fr=1006,vp=1007,Vx=1007,oc=1008,Ux=1008,au=1009,J_=1010,K_=1011,lu=1012,Q_=1013,Br=1014,Wa=1015,rh=1016,zx=1017,Hx=1018,ey=1019,cu=1020,Gx=1021,ss=1022,Xs=1023,Dr=1024,ac=1025,ya=Xs,uu=1026,du=1027,ty=1028,xp=1029,ny=1030,hu=1031,Wx=1032,iy=1033,bp=33776,ry=33777,sy=33778,oy=33779,ay=35840,wp=35841,ly=35842,cy=35843,sr=36196,Mp=37492,Sp=37496,Ep=37808,Ti=37809,Cp=37810,Ai=37811,Tp=37812,jx=37813,ci=37814,sn=37815,Ap=37816,UC=37817,ke=37818,sh=37819,mn=37820,ui=37821,qx=36492,zC=37840,$x=37841,oh=37842,Is=37843,HC=37844,Xx=37845,GC=37846,va=37847,WC=37848,jC=37849,qC=37850,$C=37851,Zx=37852,XC=37853,Yx=2200,ZC=2201,Ls=2202,ti=2300,Dp=2301,uy=2302,fu=2400,yt=2401,Rp=2402,Rn=2500,ah=2501,dy=0,YC=1,JC=2,os=3e3,yl=3001,pu=3007,lh=3002,Jx=3003,Yt=3004,ch=3005,hy=3006,Zs=3200,fy=3201,mu=0,ja=1,Ho=0,py=7680,ZL=7681,Go=7682,Di=7683,YL=34055,JL=34056,gu=5386,mi=512,Ip=513,my=514,gy=515,Kx=516,qa=517,uh=518,Qx=519,si=35044,lc=35048,eb=35040,tb=35045,KC=35049,Xn=35041,QC=35046,nb=35050,st=35042,Ps="100",gi="300 es";function Yi(){}Object.assign(Yi.prototype,{addEventListener:function(u,s){void 0===this._listeners&&(this._listeners={});const a=this._listeners;void 0===a[u]&&(a[u]=[]),-1===a[u].indexOf(s)&&a[u].push(s)},hasEventListener:function(u,s){if(void 0===this._listeners)return!1;const a=this._listeners;return void 0!==a[u]&&-1!==a[u].indexOf(s)},removeEventListener:function(u,s){if(void 0===this._listeners)return;const d=this._listeners[u];if(void 0!==d){const f=d.indexOf(s);-1!==f&&d.splice(f,1)}},dispatchEvent:function(u){if(void 0===this._listeners)return;const a=this._listeners[u.type];if(void 0!==a){u.target=this;const d=a.slice(0);for(let f=0,m=d.length;f<m;f++)d[f].call(this,u)}}});const _i=[];for(let u=0;u<256;u++)_i[u]=(u<16?"0":"")+u.toString(16);let as=1234567;const Jt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const u=4294967295*Math.random()|0,s=4294967295*Math.random()|0,a=4294967295*Math.random()|0,d=4294967295*Math.random()|0;return(_i[255&u]+_i[u>>8&255]+_i[u>>16&255]+_i[u>>24&255]+"-"+_i[255&s]+_i[s>>8&255]+"-"+_i[s>>16&15|64]+_i[s>>24&255]+"-"+_i[63&a|128]+_i[a>>8&255]+"-"+_i[a>>16&255]+_i[a>>24&255]+_i[255&d]+_i[d>>8&255]+_i[d>>16&255]+_i[d>>24&255]).toUpperCase()},clamp:function(u,s,a){return Math.max(s,Math.min(a,u))},euclideanModulo:function(u,s){return(u%s+s)%s},mapLinear:function(u,s,a,d,f){return d+(u-s)*(f-d)/(a-s)},lerp:function(u,s,a){return(1-a)*u+a*s},damp:function(u,s,a,d){return Jt.lerp(u,s,1-Math.exp(-a*d))},pingpong:function(u,s=1){return s-Math.abs(Jt.euclideanModulo(u,2*s)-s)},smoothstep:function(u,s,a){return u<=s?0:u>=a?1:(u=(u-s)/(a-s))*u*(3-2*u)},smootherstep:function(u,s,a){return u<=s?0:u>=a?1:(u=(u-s)/(a-s))*u*u*(u*(6*u-15)+10)},randInt:function(u,s){return u+Math.floor(Math.random()*(s-u+1))},randFloat:function(u,s){return u+Math.random()*(s-u)},randFloatSpread:function(u){return u*(.5-Math.random())},seededRandom:function(u){return void 0!==u&&(as=u%2147483647),as=16807*as%2147483647,(as-1)/2147483646},degToRad:function(u){return u*Jt.DEG2RAD},radToDeg:function(u){return u*Jt.RAD2DEG},isPowerOfTwo:function(u){return 0==(u&u-1)&&0!==u},ceilPowerOfTwo:function(u){return Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},floorPowerOfTwo:function(u){return Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},setQuaternionFromProperEuler:function(u,s,a,d,f){const m=Math.cos,_=Math.sin,v=m(a/2),b=_(a/2),w=m((s+d)/2),A=_((s+d)/2),E=m((s-d)/2),D=_((s-d)/2),R=m((d-s)/2),I=_((d-s)/2);switch(f){case"XYX":u.set(v*A,b*E,b*D,v*w);break;case"YZY":u.set(b*D,v*A,b*E,v*w);break;case"ZXZ":u.set(b*E,b*D,v*A,v*w);break;case"XZX":u.set(v*A,b*I,b*R,v*w);break;case"YXY":u.set(b*R,v*A,b*I,v*w);break;case"ZYZ":u.set(b*I,b*R,v*A,v*w);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+f)}}};class qe{constructor(s=0,a=0){this.x=s,this.y=a}get width(){return this.x}set width(s){this.x=s}get height(){return this.y}set height(s){this.y=s}set(s,a){return this.x=s,this.y=a,this}setScalar(s){return this.x=s,this.y=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setComponent(s,a){switch(s){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y)}copy(s){return this.x=s.x,this.y=s.y,this}add(s,a){return void 0!==a?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(s,a)):(this.x+=s.x,this.y+=s.y,this)}addScalar(s){return this.x+=s,this.y+=s,this}addVectors(s,a){return this.x=s.x+a.x,this.y=s.y+a.y,this}addScaledVector(s,a){return this.x+=s.x*a,this.y+=s.y*a,this}sub(s,a){return void 0!==a?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(s,a)):(this.x-=s.x,this.y-=s.y,this)}subScalar(s){return this.x-=s,this.y-=s,this}subVectors(s,a){return this.x=s.x-a.x,this.y=s.y-a.y,this}multiply(s){return this.x*=s.x,this.y*=s.y,this}multiplyScalar(s){return this.x*=s,this.y*=s,this}divide(s){return this.x/=s.x,this.y/=s.y,this}divideScalar(s){return this.multiplyScalar(1/s)}applyMatrix3(s){const a=this.x,d=this.y,f=s.elements;return this.x=f[0]*a+f[3]*d+f[6],this.y=f[1]*a+f[4]*d+f[7],this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this}clamp(s,a){return this.x=Math.max(s.x,Math.min(a.x,this.x)),this.y=Math.max(s.y,Math.min(a.y,this.y)),this}clampScalar(s,a){return this.x=Math.max(s,Math.min(a,this.x)),this.y=Math.max(s,Math.min(a,this.y)),this}clampLength(s,a){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(s,Math.min(a,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(s){return this.x*s.x+this.y*s.y}cross(s){return this.x*s.y-this.y*s.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const a=this.x-s.x,d=this.y-s.y;return a*a+d*d}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,a){return this.x+=(s.x-this.x)*a,this.y+=(s.y-this.y)*a,this}lerpVectors(s,a,d){return this.x=s.x+(a.x-s.x)*d,this.y=s.y+(a.y-s.y)*d,this}equals(s){return s.x===this.x&&s.y===this.y}fromArray(s,a=0){return this.x=s[a],this.y=s[a+1],this}toArray(s=[],a=0){return s[a]=this.x,s[a+1]=this.y,s}fromBufferAttribute(s,a,d){return void 0!==d&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=s.getX(a),this.y=s.getY(a),this}rotateAround(s,a){const d=Math.cos(a),f=Math.sin(a),m=this.x-s.x,_=this.y-s.y;return this.x=m*d-_*f+s.x,this.y=m*f+_*d+s.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}qe.prototype.isVector2=!0;class Ji{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(s,a,d,f,m,_,v,b,w){const A=this.elements;return A[0]=s,A[1]=f,A[2]=v,A[3]=a,A[4]=m,A[5]=b,A[6]=d,A[7]=_,A[8]=w,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(s){const a=this.elements,d=s.elements;return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],this}extractBasis(s,a,d){return s.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(s){const a=s.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this}multiply(s){return this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,a){const d=s.elements,f=a.elements,m=this.elements,_=d[0],v=d[3],b=d[6],w=d[1],A=d[4],E=d[7],D=d[2],R=d[5],I=d[8],F=f[0],V=f[3],N=f[6],L=f[1],j=f[4],G=f[7],K=f[2],H=f[5],re=f[8];return m[0]=_*F+v*L+b*K,m[3]=_*V+v*j+b*H,m[6]=_*N+v*G+b*re,m[1]=w*F+A*L+E*K,m[4]=w*V+A*j+E*H,m[7]=w*N+A*G+E*re,m[2]=D*F+R*L+I*K,m[5]=D*V+R*j+I*H,m[8]=D*N+R*G+I*re,this}multiplyScalar(s){const a=this.elements;return a[0]*=s,a[3]*=s,a[6]*=s,a[1]*=s,a[4]*=s,a[7]*=s,a[2]*=s,a[5]*=s,a[8]*=s,this}determinant(){const s=this.elements,a=s[0],d=s[1],f=s[2],m=s[3],_=s[4],v=s[5],b=s[6],w=s[7],A=s[8];return a*_*A-a*v*w-d*m*A+d*v*b+f*m*w-f*_*b}invert(){const s=this.elements,a=s[0],d=s[1],f=s[2],m=s[3],_=s[4],v=s[5],b=s[6],w=s[7],A=s[8],E=A*_-v*w,D=v*b-A*m,R=w*m-_*b,I=a*E+d*D+f*R;if(0===I)return this.set(0,0,0,0,0,0,0,0,0);const F=1/I;return s[0]=E*F,s[1]=(f*w-A*d)*F,s[2]=(v*d-f*_)*F,s[3]=D*F,s[4]=(A*a-f*b)*F,s[5]=(f*m-v*a)*F,s[6]=R*F,s[7]=(d*b-w*a)*F,s[8]=(_*a-d*m)*F,this}transpose(){let s;const a=this.elements;return s=a[1],a[1]=a[3],a[3]=s,s=a[2],a[2]=a[6],a[6]=s,s=a[5],a[5]=a[7],a[7]=s,this}getNormalMatrix(s){return this.setFromMatrix4(s).invert().transpose()}transposeIntoArray(s){const a=this.elements;return s[0]=a[0],s[1]=a[3],s[2]=a[6],s[3]=a[1],s[4]=a[4],s[5]=a[7],s[6]=a[2],s[7]=a[5],s[8]=a[8],this}setUvTransform(s,a,d,f,m,_,v){const b=Math.cos(m),w=Math.sin(m);return this.set(d*b,d*w,-d*(b*_+w*v)+_+s,-f*w,f*b,-f*(-w*_+b*v)+v+a,0,0,1),this}scale(s,a){const d=this.elements;return d[0]*=s,d[3]*=s,d[6]*=s,d[1]*=a,d[4]*=a,d[7]*=a,this}rotate(s){const a=Math.cos(s),d=Math.sin(s),f=this.elements,m=f[0],_=f[3],v=f[6],b=f[1],w=f[4],A=f[7];return f[0]=a*m+d*b,f[3]=a*_+d*w,f[6]=a*v+d*A,f[1]=-d*m+a*b,f[4]=-d*_+a*w,f[7]=-d*v+a*A,this}translate(s,a){const d=this.elements;return d[0]+=s*d[2],d[3]+=s*d[5],d[6]+=s*d[8],d[1]+=a*d[2],d[4]+=a*d[5],d[7]+=a*d[8],this}equals(s){const a=this.elements,d=s.elements;for(let f=0;f<9;f++)if(a[f]!==d[f])return!1;return!0}fromArray(s,a=0){for(let d=0;d<9;d++)this.elements[d]=s[d+a];return this}toArray(s=[],a=0){const d=this.elements;return s[a]=d[0],s[a+1]=d[1],s[a+2]=d[2],s[a+3]=d[3],s[a+4]=d[4],s[a+5]=d[5],s[a+6]=d[6],s[a+7]=d[7],s[a+8]=d[8],s}clone(){return(new this.constructor).fromArray(this.elements)}}let $a;Ji.prototype.isMatrix3=!0;const Ys={getDataURL:function(u){if(/^data:/i.test(u.src)||"undefined"==typeof HTMLCanvasElement)return u.src;let s;if(u instanceof HTMLCanvasElement)s=u;else{void 0===$a&&($a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),$a.width=u.width,$a.height=u.height;const a=$a.getContext("2d");u instanceof ImageData?a.putImageData(u,0,0):a.drawImage(u,0,0,u.width,u.height),s=$a}return s.width>2048||s.height>2048?s.toDataURL("image/jpeg",.6):s.toDataURL("image/png")}};let ls=0;class Rr extends Yi{constructor(s=Rr.DEFAULT_IMAGE,a=Rr.DEFAULT_MAPPING,d=Rs,f=Rs,m=fr,_=oc,v=Xs,b=au,w=1,A=os){super(),Object.defineProperty(this,"id",{value:ls++}),this.uuid=Jt.generateUUID(),this.name="",this.image=s,this.mipmaps=[],this.mapping=a,this.wrapS=d,this.wrapT=f,this.magFilter=m,this.minFilter=_,this.anisotropy=w,this.format=v,this.internalFormat=null,this.type=b,this.offset=new qe(0,0),this.repeat=new qe(1,1),this.center=new qe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ji,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=A,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(s){return this.name=s.name,this.image=s.image,this.mipmaps=s.mipmaps.slice(0),this.mapping=s.mapping,this.wrapS=s.wrapS,this.wrapT=s.wrapT,this.magFilter=s.magFilter,this.minFilter=s.minFilter,this.anisotropy=s.anisotropy,this.format=s.format,this.internalFormat=s.internalFormat,this.type=s.type,this.offset.copy(s.offset),this.repeat.copy(s.repeat),this.center.copy(s.center),this.rotation=s.rotation,this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrix.copy(s.matrix),this.generateMipmaps=s.generateMipmaps,this.premultiplyAlpha=s.premultiplyAlpha,this.flipY=s.flipY,this.unpackAlignment=s.unpackAlignment,this.encoding=s.encoding,this}toJSON(s){const a=void 0===s||"string"==typeof s;if(!a&&void 0!==s.textures[this.uuid])return s.textures[this.uuid];const d={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const f=this.image;if(void 0===f.uuid&&(f.uuid=Jt.generateUUID()),!a&&void 0===s.images[f.uuid]){let m;if(Array.isArray(f)){m=[];for(let _=0,v=f.length;_<v;_++)m.push(Fs(f[_].isDataTexture?f[_].image:f[_]))}else m=Fs(f);s.images[f.uuid]={uuid:f.uuid,url:m}}d.image=f.uuid}return a||(s.textures[this.uuid]=d),d}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(s){if(this.mapping!==mp)return s;if(s.applyMatrix3(this.matrix),s.x<0||s.x>1)switch(this.wrapS){case nh:s.x=s.x-Math.floor(s.x);break;case Rs:s.x=s.x<0?0:1;break;case ih:s.x=1===Math.abs(Math.floor(s.x)%2)?Math.ceil(s.x)-s.x:s.x-Math.floor(s.x)}if(s.y<0||s.y>1)switch(this.wrapT){case nh:s.y=s.y-Math.floor(s.y);break;case Rs:s.y=s.y<0?0:1;break;case ih:s.y=1===Math.abs(Math.floor(s.y)%2)?Math.ceil(s.y)-s.y:s.y-Math.floor(s.y)}return this.flipY&&(s.y=1-s.y),s}set needsUpdate(s){!0===s&&this.version++}}function Fs(u){return"undefined"!=typeof HTMLImageElement&&u instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&u instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&u instanceof ImageBitmap?Ys.getDataURL(u):u.data?{data:Array.prototype.slice.call(u.data),width:u.width,height:u.height,type:u.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Rr.DEFAULT_IMAGE=void 0,Rr.DEFAULT_MAPPING=mp,Rr.prototype.isTexture=!0;class $e{constructor(s=0,a=0,d=0,f=1){this.x=s,this.y=a,this.z=d,this.w=f}get width(){return this.z}set width(s){this.z=s}get height(){return this.w}set height(s){this.w=s}set(s,a,d,f){return this.x=s,this.y=a,this.z=d,this.w=f,this}setScalar(s){return this.x=s,this.y=s,this.z=s,this.w=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setZ(s){return this.z=s,this}setW(s){return this.w=s,this}setComponent(s,a){switch(s){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=void 0!==s.w?s.w:1,this}add(s,a){return void 0!==a?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(s,a)):(this.x+=s.x,this.y+=s.y,this.z+=s.z,this.w+=s.w,this)}addScalar(s){return this.x+=s,this.y+=s,this.z+=s,this.w+=s,this}addVectors(s,a){return this.x=s.x+a.x,this.y=s.y+a.y,this.z=s.z+a.z,this.w=s.w+a.w,this}addScaledVector(s,a){return this.x+=s.x*a,this.y+=s.y*a,this.z+=s.z*a,this.w+=s.w*a,this}sub(s,a){return void 0!==a?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(s,a)):(this.x-=s.x,this.y-=s.y,this.z-=s.z,this.w-=s.w,this)}subScalar(s){return this.x-=s,this.y-=s,this.z-=s,this.w-=s,this}subVectors(s,a){return this.x=s.x-a.x,this.y=s.y-a.y,this.z=s.z-a.z,this.w=s.w-a.w,this}multiply(s){return this.x*=s.x,this.y*=s.y,this.z*=s.z,this.w*=s.w,this}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this}applyMatrix4(s){const a=this.x,d=this.y,f=this.z,m=this.w,_=s.elements;return this.x=_[0]*a+_[4]*d+_[8]*f+_[12]*m,this.y=_[1]*a+_[5]*d+_[9]*f+_[13]*m,this.z=_[2]*a+_[6]*d+_[10]*f+_[14]*m,this.w=_[3]*a+_[7]*d+_[11]*f+_[15]*m,this}divideScalar(s){return this.multiplyScalar(1/s)}setAxisAngleFromQuaternion(s){this.w=2*Math.acos(s.w);const a=Math.sqrt(1-s.w*s.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=s.x/a,this.y=s.y/a,this.z=s.z/a),this}setAxisAngleFromRotationMatrix(s){let a,d,f,m;const b=s.elements,w=b[0],A=b[4],E=b[8],D=b[1],R=b[5],I=b[9],F=b[2],V=b[6],N=b[10];if(Math.abs(A-D)<.01&&Math.abs(E-F)<.01&&Math.abs(I-V)<.01){if(Math.abs(A+D)<.1&&Math.abs(E+F)<.1&&Math.abs(I+V)<.1&&Math.abs(w+R+N-3)<.1)return this.set(1,0,0,0),this;a=Math.PI;const j=(w+1)/2,G=(R+1)/2,K=(N+1)/2,H=(A+D)/4,re=(E+F)/4,he=(I+V)/4;return j>G&&j>K?j<.01?(d=0,f=.707106781,m=.707106781):(d=Math.sqrt(j),f=H/d,m=re/d):G>K?G<.01?(d=.707106781,f=0,m=.707106781):(f=Math.sqrt(G),d=H/f,m=he/f):K<.01?(d=.707106781,f=.707106781,m=0):(m=Math.sqrt(K),d=re/m,f=he/m),this.set(d,f,m,a),this}let L=Math.sqrt((V-I)*(V-I)+(E-F)*(E-F)+(D-A)*(D-A));return Math.abs(L)<.001&&(L=1),this.x=(V-I)/L,this.y=(E-F)/L,this.z=(D-A)/L,this.w=Math.acos((w+R+N-1)/2),this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this.w=Math.min(this.w,s.w),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this.w=Math.max(this.w,s.w),this}clamp(s,a){return this.x=Math.max(s.x,Math.min(a.x,this.x)),this.y=Math.max(s.y,Math.min(a.y,this.y)),this.z=Math.max(s.z,Math.min(a.z,this.z)),this.w=Math.max(s.w,Math.min(a.w,this.w)),this}clampScalar(s,a){return this.x=Math.max(s,Math.min(a,this.x)),this.y=Math.max(s,Math.min(a,this.y)),this.z=Math.max(s,Math.min(a,this.z)),this.w=Math.max(s,Math.min(a,this.w)),this}clampLength(s,a){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(s,Math.min(a,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z+this.w*s.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,a){return this.x+=(s.x-this.x)*a,this.y+=(s.y-this.y)*a,this.z+=(s.z-this.z)*a,this.w+=(s.w-this.w)*a,this}lerpVectors(s,a,d){return this.x=s.x+(a.x-s.x)*d,this.y=s.y+(a.y-s.y)*d,this.z=s.z+(a.z-s.z)*d,this.w=s.w+(a.w-s.w)*d,this}equals(s){return s.x===this.x&&s.y===this.y&&s.z===this.z&&s.w===this.w}fromArray(s,a=0){return this.x=s[a],this.y=s[a+1],this.z=s[a+2],this.w=s[a+3],this}toArray(s=[],a=0){return s[a]=this.x,s[a+1]=this.y,s[a+2]=this.z,s[a+3]=this.w,s}fromBufferAttribute(s,a,d){return void 0!==d&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=s.getX(a),this.y=s.getY(a),this.z=s.getZ(a),this.w=s.getW(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}$e.prototype.isVector4=!0;class rn extends Yi{constructor(s,a,d){super(),this.width=s,this.height=a,this.depth=1,this.scissor=new $e(0,0,s,a),this.scissorTest=!1,this.viewport=new $e(0,0,s,a),this.texture=new Rr(void 0,(d=d||{}).mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding),this.texture.image={},this.texture.image.width=s,this.texture.image.height=a,this.texture.image.depth=1,this.texture.generateMipmaps=void 0!==d.generateMipmaps&&d.generateMipmaps,this.texture.minFilter=void 0!==d.minFilter?d.minFilter:fr,this.depthBuffer=void 0===d.depthBuffer||d.depthBuffer,this.stencilBuffer=void 0!==d.stencilBuffer&&d.stencilBuffer,this.depthTexture=void 0!==d.depthTexture?d.depthTexture:null}setTexture(s){s.image={width:this.width,height:this.height,depth:this.depth},this.texture=s}setSize(s,a,d=1){(this.width!==s||this.height!==a||this.depth!==d)&&(this.width=s,this.height=a,this.depth=d,this.texture.image.width=s,this.texture.image.height=a,this.texture.image.depth=d,this.dispose()),this.viewport.set(0,0,s,a),this.scissor.set(0,0,s,a)}clone(){return(new this.constructor).copy(this)}copy(s){return this.width=s.width,this.height=s.height,this.depth=s.depth,this.viewport.copy(s.viewport),this.texture=s.texture.clone(),this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,this.depthTexture=s.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}rn.prototype.isWebGLRenderTarget=!0;class qi extends rn{constructor(s,a,d){super(s,a,d),this.samples=4}copy(s){return super.copy.call(this,s),this.samples=s.samples,this}}qi.prototype.isWebGLMultisampleRenderTarget=!0;class wi{constructor(s=0,a=0,d=0,f=1){this._x=s,this._y=a,this._z=d,this._w=f}static slerp(s,a,d,f){return d.copy(s).slerp(a,f)}static slerpFlat(s,a,d,f,m,_,v){let b=d[f+0],w=d[f+1],A=d[f+2],E=d[f+3];const D=m[_+0],R=m[_+1],I=m[_+2],F=m[_+3];if(0===v)return s[a+0]=b,s[a+1]=w,s[a+2]=A,void(s[a+3]=E);if(1===v)return s[a+0]=D,s[a+1]=R,s[a+2]=I,void(s[a+3]=F);if(E!==F||b!==D||w!==R||A!==I){let V=1-v;const N=b*D+w*R+A*I+E*F,L=N>=0?1:-1,j=1-N*N;if(j>Number.EPSILON){const K=Math.sqrt(j),H=Math.atan2(K,N*L);V=Math.sin(V*H)/K,v=Math.sin(v*H)/K}const G=v*L;if(b=b*V+D*G,w=w*V+R*G,A=A*V+I*G,E=E*V+F*G,V===1-v){const K=1/Math.sqrt(b*b+w*w+A*A+E*E);b*=K,w*=K,A*=K,E*=K}}s[a]=b,s[a+1]=w,s[a+2]=A,s[a+3]=E}static multiplyQuaternionsFlat(s,a,d,f,m,_){const v=d[f],b=d[f+1],w=d[f+2],A=d[f+3],E=m[_],D=m[_+1],R=m[_+2],I=m[_+3];return s[a]=v*I+A*E+b*R-w*D,s[a+1]=b*I+A*D+w*E-v*R,s[a+2]=w*I+A*R+v*D-b*E,s[a+3]=A*I-v*E-b*D-w*R,s}get x(){return this._x}set x(s){this._x=s,this._onChangeCallback()}get y(){return this._y}set y(s){this._y=s,this._onChangeCallback()}get z(){return this._z}set z(s){this._z=s,this._onChangeCallback()}get w(){return this._w}set w(s){this._w=s,this._onChangeCallback()}set(s,a,d,f){return this._x=s,this._y=a,this._z=d,this._w=f,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(s){return this._x=s.x,this._y=s.y,this._z=s.z,this._w=s.w,this._onChangeCallback(),this}setFromEuler(s,a){if(!s||!s.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const d=s._x,f=s._y,m=s._z,_=s._order,v=Math.cos,b=Math.sin,w=v(d/2),A=v(f/2),E=v(m/2),D=b(d/2),R=b(f/2),I=b(m/2);switch(_){case"XYZ":this._x=D*A*E+w*R*I,this._y=w*R*E-D*A*I,this._z=w*A*I+D*R*E,this._w=w*A*E-D*R*I;break;case"YXZ":this._x=D*A*E+w*R*I,this._y=w*R*E-D*A*I,this._z=w*A*I-D*R*E,this._w=w*A*E+D*R*I;break;case"ZXY":this._x=D*A*E-w*R*I,this._y=w*R*E+D*A*I,this._z=w*A*I+D*R*E,this._w=w*A*E-D*R*I;break;case"ZYX":this._x=D*A*E-w*R*I,this._y=w*R*E+D*A*I,this._z=w*A*I-D*R*E,this._w=w*A*E+D*R*I;break;case"YZX":this._x=D*A*E+w*R*I,this._y=w*R*E+D*A*I,this._z=w*A*I-D*R*E,this._w=w*A*E-D*R*I;break;case"XZY":this._x=D*A*E-w*R*I,this._y=w*R*E-D*A*I,this._z=w*A*I+D*R*E,this._w=w*A*E+D*R*I;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+_)}return!1!==a&&this._onChangeCallback(),this}setFromAxisAngle(s,a){const d=a/2,f=Math.sin(d);return this._x=s.x*f,this._y=s.y*f,this._z=s.z*f,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(s){const a=s.elements,d=a[0],f=a[4],m=a[8],_=a[1],v=a[5],b=a[9],w=a[2],A=a[6],E=a[10],D=d+v+E;if(D>0){const R=.5/Math.sqrt(D+1);this._w=.25/R,this._x=(A-b)*R,this._y=(m-w)*R,this._z=(_-f)*R}else if(d>v&&d>E){const R=2*Math.sqrt(1+d-v-E);this._w=(A-b)/R,this._x=.25*R,this._y=(f+_)/R,this._z=(m+w)/R}else if(v>E){const R=2*Math.sqrt(1+v-d-E);this._w=(m-w)/R,this._x=(f+_)/R,this._y=.25*R,this._z=(b+A)/R}else{const R=2*Math.sqrt(1+E-d-v);this._w=(_-f)/R,this._x=(m+w)/R,this._y=(b+A)/R,this._z=.25*R}return this._onChangeCallback(),this}setFromUnitVectors(s,a){let f=s.dot(a)+1;return f<1e-6?(f=0,Math.abs(s.x)>Math.abs(s.z)?(this._x=-s.y,this._y=s.x,this._z=0,this._w=f):(this._x=0,this._y=-s.z,this._z=s.y,this._w=f)):(this._x=s.y*a.z-s.z*a.y,this._y=s.z*a.x-s.x*a.z,this._z=s.x*a.y-s.y*a.x,this._w=f),this.normalize()}angleTo(s){return 2*Math.acos(Math.abs(Jt.clamp(this.dot(s),-1,1)))}rotateTowards(s,a){const d=this.angleTo(s);if(0===d)return this;const f=Math.min(1,a/d);return this.slerp(s,f),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(s){return this._x*s._x+this._y*s._y+this._z*s._z+this._w*s._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let s=this.length();return 0===s?(this._x=0,this._y=0,this._z=0,this._w=1):(s=1/s,this._x=this._x*s,this._y=this._y*s,this._z=this._z*s,this._w=this._w*s),this._onChangeCallback(),this}multiply(s,a){return void 0!==a?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(s,a)):this.multiplyQuaternions(this,s)}premultiply(s){return this.multiplyQuaternions(s,this)}multiplyQuaternions(s,a){const d=s._x,f=s._y,m=s._z,_=s._w,v=a._x,b=a._y,w=a._z,A=a._w;return this._x=d*A+_*v+f*w-m*b,this._y=f*A+_*b+m*v-d*w,this._z=m*A+_*w+d*b-f*v,this._w=_*A-d*v-f*b-m*w,this._onChangeCallback(),this}slerp(s,a){if(0===a)return this;if(1===a)return this.copy(s);const d=this._x,f=this._y,m=this._z,_=this._w;let v=_*s._w+d*s._x+f*s._y+m*s._z;if(v<0?(this._w=-s._w,this._x=-s._x,this._y=-s._y,this._z=-s._z,v=-v):this.copy(s),v>=1)return this._w=_,this._x=d,this._y=f,this._z=m,this;const b=1-v*v;if(b<=Number.EPSILON){const R=1-a;return this._w=R*_+a*this._w,this._x=R*d+a*this._x,this._y=R*f+a*this._y,this._z=R*m+a*this._z,this.normalize(),this._onChangeCallback(),this}const w=Math.sqrt(b),A=Math.atan2(w,v),E=Math.sin((1-a)*A)/w,D=Math.sin(a*A)/w;return this._w=_*E+this._w*D,this._x=d*E+this._x*D,this._y=f*E+this._y*D,this._z=m*E+this._z*D,this._onChangeCallback(),this}equals(s){return s._x===this._x&&s._y===this._y&&s._z===this._z&&s._w===this._w}fromArray(s,a=0){return this._x=s[a],this._y=s[a+1],this._z=s[a+2],this._w=s[a+3],this._onChangeCallback(),this}toArray(s=[],a=0){return s[a]=this._x,s[a+1]=this._y,s[a+2]=this._z,s[a+3]=this._w,s}fromBufferAttribute(s,a){return this._x=s.getX(a),this._y=s.getY(a),this._z=s.getZ(a),this._w=s.getW(a),this}_onChange(s){return this._onChangeCallback=s,this}_onChangeCallback(){}}wi.prototype.isQuaternion=!0;class W{constructor(s=0,a=0,d=0){this.x=s,this.y=a,this.z=d}set(s,a,d){return void 0===d&&(d=this.z),this.x=s,this.y=a,this.z=d,this}setScalar(s){return this.x=s,this.y=s,this.z=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setZ(s){return this.z=s,this}setComponent(s,a){switch(s){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this}add(s,a){return void 0!==a?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(s,a)):(this.x+=s.x,this.y+=s.y,this.z+=s.z,this)}addScalar(s){return this.x+=s,this.y+=s,this.z+=s,this}addVectors(s,a){return this.x=s.x+a.x,this.y=s.y+a.y,this.z=s.z+a.z,this}addScaledVector(s,a){return this.x+=s.x*a,this.y+=s.y*a,this.z+=s.z*a,this}sub(s,a){return void 0!==a?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(s,a)):(this.x-=s.x,this.y-=s.y,this.z-=s.z,this)}subScalar(s){return this.x-=s,this.y-=s,this.z-=s,this}subVectors(s,a){return this.x=s.x-a.x,this.y=s.y-a.y,this.z=s.z-a.z,this}multiply(s,a){return void 0!==a?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(s,a)):(this.x*=s.x,this.y*=s.y,this.z*=s.z,this)}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this}multiplyVectors(s,a){return this.x=s.x*a.x,this.y=s.y*a.y,this.z=s.z*a.z,this}applyEuler(s){return s&&s.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(vl.setFromEuler(s))}applyAxisAngle(s,a){return this.applyQuaternion(vl.setFromAxisAngle(s,a))}applyMatrix3(s){const a=this.x,d=this.y,f=this.z,m=s.elements;return this.x=m[0]*a+m[3]*d+m[6]*f,this.y=m[1]*a+m[4]*d+m[7]*f,this.z=m[2]*a+m[5]*d+m[8]*f,this}applyNormalMatrix(s){return this.applyMatrix3(s).normalize()}applyMatrix4(s){const a=this.x,d=this.y,f=this.z,m=s.elements,_=1/(m[3]*a+m[7]*d+m[11]*f+m[15]);return this.x=(m[0]*a+m[4]*d+m[8]*f+m[12])*_,this.y=(m[1]*a+m[5]*d+m[9]*f+m[13])*_,this.z=(m[2]*a+m[6]*d+m[10]*f+m[14])*_,this}applyQuaternion(s){const a=this.x,d=this.y,f=this.z,m=s.x,_=s.y,v=s.z,b=s.w,w=b*a+_*f-v*d,A=b*d+v*a-m*f,E=b*f+m*d-_*a,D=-m*a-_*d-v*f;return this.x=w*b+D*-m+A*-v-E*-_,this.y=A*b+D*-_+E*-m-w*-v,this.z=E*b+D*-v+w*-_-A*-m,this}project(s){return this.applyMatrix4(s.matrixWorldInverse).applyMatrix4(s.projectionMatrix)}unproject(s){return this.applyMatrix4(s.projectionMatrixInverse).applyMatrix4(s.matrixWorld)}transformDirection(s){const a=this.x,d=this.y,f=this.z,m=s.elements;return this.x=m[0]*a+m[4]*d+m[8]*f,this.y=m[1]*a+m[5]*d+m[9]*f,this.z=m[2]*a+m[6]*d+m[10]*f,this.normalize()}divide(s){return this.x/=s.x,this.y/=s.y,this.z/=s.z,this}divideScalar(s){return this.multiplyScalar(1/s)}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this}clamp(s,a){return this.x=Math.max(s.x,Math.min(a.x,this.x)),this.y=Math.max(s.y,Math.min(a.y,this.y)),this.z=Math.max(s.z,Math.min(a.z,this.z)),this}clampScalar(s,a){return this.x=Math.max(s,Math.min(a,this.x)),this.y=Math.max(s,Math.min(a,this.y)),this.z=Math.max(s,Math.min(a,this.z)),this}clampLength(s,a){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(s,Math.min(a,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,a){return this.x+=(s.x-this.x)*a,this.y+=(s.y-this.y)*a,this.z+=(s.z-this.z)*a,this}lerpVectors(s,a,d){return this.x=s.x+(a.x-s.x)*d,this.y=s.y+(a.y-s.y)*d,this.z=s.z+(a.z-s.z)*d,this}cross(s,a){return void 0!==a?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(s,a)):this.crossVectors(this,s)}crossVectors(s,a){const d=s.x,f=s.y,m=s.z,_=a.x,v=a.y,b=a.z;return this.x=f*b-m*v,this.y=m*_-d*b,this.z=d*v-f*_,this}projectOnVector(s){const a=s.lengthSq();if(0===a)return this.set(0,0,0);const d=s.dot(this)/a;return this.copy(s).multiplyScalar(d)}projectOnPlane(s){return vr.copy(this).projectOnVector(s),this.sub(vr)}reflect(s){return this.sub(vr.copy(s).multiplyScalar(2*this.dot(s)))}angleTo(s){const a=Math.sqrt(this.lengthSq()*s.lengthSq());if(0===a)return Math.PI/2;const d=this.dot(s)/a;return Math.acos(Jt.clamp(d,-1,1))}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const a=this.x-s.x,d=this.y-s.y,f=this.z-s.z;return a*a+d*d+f*f}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)+Math.abs(this.z-s.z)}setFromSpherical(s){return this.setFromSphericalCoords(s.radius,s.phi,s.theta)}setFromSphericalCoords(s,a,d){const f=Math.sin(a)*s;return this.x=f*Math.sin(d),this.y=Math.cos(a)*s,this.z=f*Math.cos(d),this}setFromCylindrical(s){return this.setFromCylindricalCoords(s.radius,s.theta,s.y)}setFromCylindricalCoords(s,a,d){return this.x=s*Math.sin(a),this.y=d,this.z=s*Math.cos(a),this}setFromMatrixPosition(s){const a=s.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this}setFromMatrixScale(s){const a=this.setFromMatrixColumn(s,0).length(),d=this.setFromMatrixColumn(s,1).length(),f=this.setFromMatrixColumn(s,2).length();return this.x=a,this.y=d,this.z=f,this}setFromMatrixColumn(s,a){return this.fromArray(s.elements,4*a)}setFromMatrix3Column(s,a){return this.fromArray(s.elements,3*a)}equals(s){return s.x===this.x&&s.y===this.y&&s.z===this.z}fromArray(s,a=0){return this.x=s[a],this.y=s[a+1],this.z=s[a+2],this}toArray(s=[],a=0){return s[a]=this.x,s[a+1]=this.y,s[a+2]=this.z,s}fromBufferAttribute(s,a,d){return void 0!==d&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=s.getX(a),this.y=s.getY(a),this.z=s.getZ(a),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}W.prototype.isVector3=!0;const vr=new W,vl=new wi;class Zn{constructor(s=new W(1/0,1/0,1/0),a=new W(-1/0,-1/0,-1/0)){this.min=s,this.max=a}set(s,a){return this.min.copy(s),this.max.copy(a),this}setFromArray(s){let a=1/0,d=1/0,f=1/0,m=-1/0,_=-1/0,v=-1/0;for(let b=0,w=s.length;b<w;b+=3){const A=s[b],E=s[b+1],D=s[b+2];A<a&&(a=A),E<d&&(d=E),D<f&&(f=D),A>m&&(m=A),E>_&&(_=E),D>v&&(v=D)}return this.min.set(a,d,f),this.max.set(m,_,v),this}setFromBufferAttribute(s){let a=1/0,d=1/0,f=1/0,m=-1/0,_=-1/0,v=-1/0;for(let b=0,w=s.count;b<w;b++){const A=s.getX(b),E=s.getY(b),D=s.getZ(b);A<a&&(a=A),E<d&&(d=E),D<f&&(f=D),A>m&&(m=A),E>_&&(_=E),D>v&&(v=D)}return this.min.set(a,d,f),this.max.set(m,_,v),this}setFromPoints(s){this.makeEmpty();for(let a=0,d=s.length;a<d;a++)this.expandByPoint(s[a]);return this}setFromCenterAndSize(s,a){const d=xa.copy(a).multiplyScalar(.5);return this.min.copy(s).sub(d),this.max.copy(s).add(d),this}setFromObject(s){return this.makeEmpty(),this.expandByObject(s)}clone(){return(new this.constructor).copy(this)}copy(s){return this.min.copy(s.min),this.max.copy(s.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(s){return void 0===s&&(console.warn("THREE.Box3: .getCenter() target is now required"),s=new W),this.isEmpty()?s.set(0,0,0):s.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(s){return void 0===s&&(console.warn("THREE.Box3: .getSize() target is now required"),s=new W),this.isEmpty()?s.set(0,0,0):s.subVectors(this.max,this.min)}expandByPoint(s){return this.min.min(s),this.max.max(s),this}expandByVector(s){return this.min.sub(s),this.max.add(s),this}expandByScalar(s){return this.min.addScalar(-s),this.max.addScalar(s),this}expandByObject(s){s.updateWorldMatrix(!1,!1);const a=s.geometry;void 0!==a&&(null===a.boundingBox&&a.computeBoundingBox(),Sn.copy(a.boundingBox),Sn.applyMatrix4(s.matrixWorld),this.union(Sn));const d=s.children;for(let f=0,m=d.length;f<m;f++)this.expandByObject(d[f]);return this}containsPoint(s){return!(s.x<this.min.x||s.x>this.max.x||s.y<this.min.y||s.y>this.max.y||s.z<this.min.z||s.z>this.max.z)}containsBox(s){return this.min.x<=s.min.x&&s.max.x<=this.max.x&&this.min.y<=s.min.y&&s.max.y<=this.max.y&&this.min.z<=s.min.z&&s.max.z<=this.max.z}getParameter(s,a){return void 0===a&&(console.warn("THREE.Box3: .getParameter() target is now required"),a=new W),a.set((s.x-this.min.x)/(this.max.x-this.min.x),(s.y-this.min.y)/(this.max.y-this.min.y),(s.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(s){return!(s.max.x<this.min.x||s.min.x>this.max.x||s.max.y<this.min.y||s.min.y>this.max.y||s.max.z<this.min.z||s.min.z>this.max.z)}intersectsSphere(s){return this.clampPoint(s.center,xa),xa.distanceToSquared(s.center)<=s.radius*s.radius}intersectsPlane(s){let a,d;return s.normal.x>0?(a=s.normal.x*this.min.x,d=s.normal.x*this.max.x):(a=s.normal.x*this.max.x,d=s.normal.x*this.min.x),s.normal.y>0?(a+=s.normal.y*this.min.y,d+=s.normal.y*this.max.y):(a+=s.normal.y*this.max.y,d+=s.normal.y*this.min.y),s.normal.z>0?(a+=s.normal.z*this.min.z,d+=s.normal.z*this.max.z):(a+=s.normal.z*this.max.z,d+=s.normal.z*this.min.z),a<=-s.constant&&d>=-s.constant}intersectsTriangle(s){if(this.isEmpty())return!1;this.getCenter(ba),Os.subVectors(this.max,ba),Xa.subVectors(s.a,ba),Wo.subVectors(s.b,ba),xl.subVectors(s.c,ba),Ns.subVectors(Wo,Xa),Ki.subVectors(xl,Wo),jo.subVectors(Xa,xl);let a=[0,-Ns.z,Ns.y,0,-Ki.z,Ki.y,0,-jo.z,jo.y,Ns.z,0,-Ns.x,Ki.z,0,-Ki.x,jo.z,0,-jo.x,-Ns.y,Ns.x,0,-Ki.y,Ki.x,0,-jo.y,jo.x,0];return!(!Ri(a,Xa,Wo,xl,Os)||(a=[1,0,0,0,1,0,0,0,1],!Ri(a,Xa,Wo,xl,Os)))&&(Za.crossVectors(Ns,Ki),a=[Za.x,Za.y,Za.z],Ri(a,Xa,Wo,xl,Os))}clampPoint(s,a){return void 0===a&&(console.warn("THREE.Box3: .clampPoint() target is now required"),a=new W),a.copy(s).clamp(this.min,this.max)}distanceToPoint(s){return xa.copy(s).clamp(this.min,this.max).sub(s).length()}getBoundingSphere(s){return void 0===s&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(s.center),s.radius=.5*this.getSize(xa).length(),s}intersect(s){return this.min.max(s.min),this.max.min(s.max),this.isEmpty()&&this.makeEmpty(),this}union(s){return this.min.min(s.min),this.max.max(s.max),this}applyMatrix4(s){return this.isEmpty()||(Js[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(s),Js[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(s),Js[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(s),Js[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(s),Js[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(s),Js[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(s),Js[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(s),Js[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(s),this.setFromPoints(Js)),this}translate(s){return this.min.add(s),this.max.add(s),this}equals(s){return s.min.equals(this.min)&&s.max.equals(this.max)}}Zn.prototype.isBox3=!0;const Js=[new W,new W,new W,new W,new W,new W,new W,new W],xa=new W,Sn=new Zn,Xa=new W,Wo=new W,xl=new W,Ns=new W,Ki=new W,jo=new W,ba=new W,Os=new W,Za=new W,bl=new W;function Ri(u,s,a,d,f){for(let m=0,_=u.length-3;m<=_;m+=3){bl.fromArray(u,m);const v=f.x*Math.abs(bl.x)+f.y*Math.abs(bl.y)+f.z*Math.abs(bl.z),b=s.dot(bl),w=a.dot(bl),A=d.dot(bl);if(Math.max(-Math.max(b,w,A),Math.min(b,w,A))>v)return!1}return!0}const eT=new Zn;class wl{constructor(s=new W,a=-1){this.center=s,this.radius=a}set(s,a){return this.center.copy(s),this.radius=a,this}setFromPoints(s,a){const d=this.center;void 0!==a?d.copy(a):eT.setFromPoints(s).getCenter(d);let f=0;for(let m=0,_=s.length;m<_;m++)f=Math.max(f,d.distanceToSquared(s[m]));return this.radius=Math.sqrt(f),this}copy(s){return this.center.copy(s.center),this.radius=s.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(s){return s.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(s){return s.distanceTo(this.center)-this.radius}intersectsSphere(s){const a=this.radius+s.radius;return s.center.distanceToSquared(this.center)<=a*a}intersectsBox(s){return s.intersectsSphere(this)}intersectsPlane(s){return Math.abs(s.distanceToPoint(this.center))<=this.radius}clampPoint(s,a){const d=this.center.distanceToSquared(s);return void 0===a&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),a=new W),a.copy(s),d>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a}getBoundingBox(s){return void 0===s&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),s=new Zn),this.isEmpty()?(s.makeEmpty(),s):(s.set(this.center,this.center),s.expandByScalar(this.radius),s)}applyMatrix4(s){return this.center.applyMatrix4(s),this.radius=this.radius*s.getMaxScaleOnAxis(),this}translate(s){return this.center.add(s),this}equals(s){return s.center.equals(this.center)&&s.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const or=new W,Ks=new W,_u=new W,qo=new W,yu=new W,ks=new W,_y=new W;class cc{constructor(s=new W,a=new W(0,0,-1)){this.origin=s,this.direction=a}set(s,a){return this.origin.copy(s),this.direction.copy(a),this}copy(s){return this.origin.copy(s.origin),this.direction.copy(s.direction),this}at(s,a){return void 0===a&&(console.warn("THREE.Ray: .at() target is now required"),a=new W),a.copy(this.direction).multiplyScalar(s).add(this.origin)}lookAt(s){return this.direction.copy(s).sub(this.origin).normalize(),this}recast(s){return this.origin.copy(this.at(s,or)),this}closestPointToPoint(s,a){void 0===a&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),a=new W),a.subVectors(s,this.origin);const d=a.dot(this.direction);return d<0?a.copy(this.origin):a.copy(this.direction).multiplyScalar(d).add(this.origin)}distanceToPoint(s){return Math.sqrt(this.distanceSqToPoint(s))}distanceSqToPoint(s){const a=or.subVectors(s,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(s):(or.copy(this.direction).multiplyScalar(a).add(this.origin),or.distanceToSquared(s))}distanceSqToSegment(s,a,d,f){Ks.copy(s).add(a).multiplyScalar(.5),_u.copy(a).sub(s).normalize(),qo.copy(this.origin).sub(Ks);const m=.5*s.distanceTo(a),_=-this.direction.dot(_u),v=qo.dot(this.direction),b=-qo.dot(_u),w=qo.lengthSq(),A=Math.abs(1-_*_);let E,D,R,I;if(A>0)if(E=_*b-v,D=_*v-b,I=m*A,E>=0)if(D>=-I)if(D<=I){const F=1/A;E*=F,D*=F,R=E*(E+_*D+2*v)+D*(_*E+D+2*b)+w}else D=m,E=Math.max(0,-(_*D+v)),R=-E*E+D*(D+2*b)+w;else D=-m,E=Math.max(0,-(_*D+v)),R=-E*E+D*(D+2*b)+w;else D<=-I?(E=Math.max(0,-(-_*m+v)),D=E>0?-m:Math.min(Math.max(-m,-b),m),R=-E*E+D*(D+2*b)+w):D<=I?(E=0,D=Math.min(Math.max(-m,-b),m),R=D*(D+2*b)+w):(E=Math.max(0,-(_*m+v)),D=E>0?m:Math.min(Math.max(-m,-b),m),R=-E*E+D*(D+2*b)+w);else D=_>0?-m:m,E=Math.max(0,-(_*D+v)),R=-E*E+D*(D+2*b)+w;return d&&d.copy(this.direction).multiplyScalar(E).add(this.origin),f&&f.copy(_u).multiplyScalar(D).add(Ks),R}intersectSphere(s,a){or.subVectors(s.center,this.origin);const d=or.dot(this.direction),f=or.dot(or)-d*d,m=s.radius*s.radius;if(f>m)return null;const _=Math.sqrt(m-f),v=d-_,b=d+_;return v<0&&b<0?null:this.at(v<0?b:v,a)}intersectsSphere(s){return this.distanceSqToPoint(s.center)<=s.radius*s.radius}distanceToPlane(s){const a=s.normal.dot(this.direction);if(0===a)return 0===s.distanceToPoint(this.origin)?0:null;const d=-(this.origin.dot(s.normal)+s.constant)/a;return d>=0?d:null}intersectPlane(s,a){const d=this.distanceToPlane(s);return null===d?null:this.at(d,a)}intersectsPlane(s){const a=s.distanceToPoint(this.origin);return 0===a||s.normal.dot(this.direction)*a<0}intersectBox(s,a){let d,f,m,_,v,b;const w=1/this.direction.x,A=1/this.direction.y,E=1/this.direction.z,D=this.origin;return w>=0?(d=(s.min.x-D.x)*w,f=(s.max.x-D.x)*w):(d=(s.max.x-D.x)*w,f=(s.min.x-D.x)*w),A>=0?(m=(s.min.y-D.y)*A,_=(s.max.y-D.y)*A):(m=(s.max.y-D.y)*A,_=(s.min.y-D.y)*A),d>_||m>f||((m>d||d!=d)&&(d=m),(_<f||f!=f)&&(f=_),E>=0?(v=(s.min.z-D.z)*E,b=(s.max.z-D.z)*E):(v=(s.max.z-D.z)*E,b=(s.min.z-D.z)*E),d>b||v>f)||((v>d||d!=d)&&(d=v),(b<f||f!=f)&&(f=b),f<0)?null:this.at(d>=0?d:f,a)}intersectsBox(s){return null!==this.intersectBox(s,or)}intersectTriangle(s,a,d,f,m){yu.subVectors(a,s),ks.subVectors(d,s),_y.crossVectors(yu,ks);let v,_=this.direction.dot(_y);if(_>0){if(f)return null;v=1}else{if(!(_<0))return null;v=-1,_=-_}qo.subVectors(this.origin,s);const b=v*this.direction.dot(ks.crossVectors(qo,ks));if(b<0)return null;const w=v*this.direction.dot(yu.cross(qo));if(w<0||b+w>_)return null;const A=-v*qo.dot(_y);return A<0?null:this.at(A/_,m)}applyMatrix4(s){return this.origin.applyMatrix4(s),this.direction.transformDirection(s),this}equals(s){return s.origin.equals(this.origin)&&s.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Ht{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(s,a,d,f,m,_,v,b,w,A,E,D,R,I,F,V){const N=this.elements;return N[0]=s,N[4]=a,N[8]=d,N[12]=f,N[1]=m,N[5]=_,N[9]=v,N[13]=b,N[2]=w,N[6]=A,N[10]=E,N[14]=D,N[3]=R,N[7]=I,N[11]=F,N[15]=V,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Ht).fromArray(this.elements)}copy(s){const a=this.elements,d=s.elements;return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],this}copyPosition(s){const a=this.elements,d=s.elements;return a[12]=d[12],a[13]=d[13],a[14]=d[14],this}setFromMatrix3(s){const a=s.elements;return this.set(a[0],a[3],a[6],0,a[1],a[4],a[7],0,a[2],a[5],a[8],0,0,0,0,1),this}extractBasis(s,a,d){return s.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(s,a,d){return this.set(s.x,a.x,d.x,0,s.y,a.y,d.y,0,s.z,a.z,d.z,0,0,0,0,1),this}extractRotation(s){const a=this.elements,d=s.elements,f=1/vu.setFromMatrixColumn(s,0).length(),m=1/vu.setFromMatrixColumn(s,1).length(),_=1/vu.setFromMatrixColumn(s,2).length();return a[0]=d[0]*f,a[1]=d[1]*f,a[2]=d[2]*f,a[3]=0,a[4]=d[4]*m,a[5]=d[5]*m,a[6]=d[6]*m,a[7]=0,a[8]=d[8]*_,a[9]=d[9]*_,a[10]=d[10]*_,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromEuler(s){s&&s.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const a=this.elements,d=s.x,f=s.y,m=s.z,_=Math.cos(d),v=Math.sin(d),b=Math.cos(f),w=Math.sin(f),A=Math.cos(m),E=Math.sin(m);if("XYZ"===s.order){const D=_*A,R=_*E,I=v*A,F=v*E;a[0]=b*A,a[4]=-b*E,a[8]=w,a[1]=R+I*w,a[5]=D-F*w,a[9]=-v*b,a[2]=F-D*w,a[6]=I+R*w,a[10]=_*b}else if("YXZ"===s.order){const D=b*A,R=b*E,I=w*A,F=w*E;a[0]=D+F*v,a[4]=I*v-R,a[8]=_*w,a[1]=_*E,a[5]=_*A,a[9]=-v,a[2]=R*v-I,a[6]=F+D*v,a[10]=_*b}else if("ZXY"===s.order){const D=b*A,R=b*E,I=w*A,F=w*E;a[0]=D-F*v,a[4]=-_*E,a[8]=I+R*v,a[1]=R+I*v,a[5]=_*A,a[9]=F-D*v,a[2]=-_*w,a[6]=v,a[10]=_*b}else if("ZYX"===s.order){const D=_*A,R=_*E,I=v*A,F=v*E;a[0]=b*A,a[4]=I*w-R,a[8]=D*w+F,a[1]=b*E,a[5]=F*w+D,a[9]=R*w-I,a[2]=-w,a[6]=v*b,a[10]=_*b}else if("YZX"===s.order){const D=_*b,R=_*w,I=v*b,F=v*w;a[0]=b*A,a[4]=F-D*E,a[8]=I*E+R,a[1]=E,a[5]=_*A,a[9]=-v*A,a[2]=-w*A,a[6]=R*E+I,a[10]=D-F*E}else if("XZY"===s.order){const D=_*b,R=_*w,I=v*b,F=v*w;a[0]=b*A,a[4]=-E,a[8]=w*A,a[1]=D*E+F,a[5]=_*A,a[9]=R*E-I,a[2]=I*E-R,a[6]=v*A,a[10]=F*E+D}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this}makeRotationFromQuaternion(s){return this.compose(KL,s,QL)}lookAt(s,a,d){const f=this.elements;return Mo.subVectors(s,a),0===Mo.lengthSq()&&(Mo.z=1),Mo.normalize(),uc.crossVectors(d,Mo),0===uc.lengthSq()&&(1===Math.abs(d.z)?Mo.x+=1e-4:Mo.z+=1e-4,Mo.normalize(),uc.crossVectors(d,Mo)),uc.normalize(),yy.crossVectors(Mo,uc),f[0]=uc.x,f[4]=yy.x,f[8]=Mo.x,f[1]=uc.y,f[5]=yy.y,f[9]=Mo.y,f[2]=uc.z,f[6]=yy.z,f[10]=Mo.z,this}multiply(s,a){return void 0!==a?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(s,a)):this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,a){const d=s.elements,f=a.elements,m=this.elements,_=d[0],v=d[4],b=d[8],w=d[12],A=d[1],E=d[5],D=d[9],R=d[13],I=d[2],F=d[6],V=d[10],N=d[14],L=d[3],j=d[7],G=d[11],K=d[15],H=f[0],re=f[4],he=f[8],se=f[12],fe=f[1],we=f[5],Ce=f[9],be=f[13],de=f[2],ve=f[6],Ae=f[10],He=f[14],Ze=f[3],bt=f[7],Ot=f[11],It=f[15];return m[0]=_*H+v*fe+b*de+w*Ze,m[4]=_*re+v*we+b*ve+w*bt,m[8]=_*he+v*Ce+b*Ae+w*Ot,m[12]=_*se+v*be+b*He+w*It,m[1]=A*H+E*fe+D*de+R*Ze,m[5]=A*re+E*we+D*ve+R*bt,m[9]=A*he+E*Ce+D*Ae+R*Ot,m[13]=A*se+E*be+D*He+R*It,m[2]=I*H+F*fe+V*de+N*Ze,m[6]=I*re+F*we+V*ve+N*bt,m[10]=I*he+F*Ce+V*Ae+N*Ot,m[14]=I*se+F*be+V*He+N*It,m[3]=L*H+j*fe+G*de+K*Ze,m[7]=L*re+j*we+G*ve+K*bt,m[11]=L*he+j*Ce+G*Ae+K*Ot,m[15]=L*se+j*be+G*He+K*It,this}multiplyScalar(s){const a=this.elements;return a[0]*=s,a[4]*=s,a[8]*=s,a[12]*=s,a[1]*=s,a[5]*=s,a[9]*=s,a[13]*=s,a[2]*=s,a[6]*=s,a[10]*=s,a[14]*=s,a[3]*=s,a[7]*=s,a[11]*=s,a[15]*=s,this}determinant(){const s=this.elements,a=s[0],d=s[4],f=s[8],m=s[12],_=s[1],v=s[5],b=s[9],w=s[13],A=s[2],E=s[6],D=s[10],R=s[14];return s[3]*(+m*b*E-f*w*E-m*v*D+d*w*D+f*v*R-d*b*R)+s[7]*(+a*b*R-a*w*D+m*_*D-f*_*R+f*w*A-m*b*A)+s[11]*(+a*w*E-a*v*R-m*_*E+d*_*R+m*v*A-d*w*A)+s[15]*(-f*v*A-a*b*E+a*v*D+f*_*E-d*_*D+d*b*A)}transpose(){const s=this.elements;let a;return a=s[1],s[1]=s[4],s[4]=a,a=s[2],s[2]=s[8],s[8]=a,a=s[6],s[6]=s[9],s[9]=a,a=s[3],s[3]=s[12],s[12]=a,a=s[7],s[7]=s[13],s[13]=a,a=s[11],s[11]=s[14],s[14]=a,this}setPosition(s,a,d){const f=this.elements;return s.isVector3?(f[12]=s.x,f[13]=s.y,f[14]=s.z):(f[12]=s,f[13]=a,f[14]=d),this}invert(){const s=this.elements,a=s[0],d=s[1],f=s[2],m=s[3],_=s[4],v=s[5],b=s[6],w=s[7],A=s[8],E=s[9],D=s[10],R=s[11],I=s[12],F=s[13],V=s[14],N=s[15],L=E*V*w-F*D*w+F*b*R-v*V*R-E*b*N+v*D*N,j=I*D*w-A*V*w-I*b*R+_*V*R+A*b*N-_*D*N,G=A*F*w-I*E*w+I*v*R-_*F*R-A*v*N+_*E*N,K=I*E*b-A*F*b-I*v*D+_*F*D+A*v*V-_*E*V,H=a*L+d*j+f*G+m*K;if(0===H)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const re=1/H;return s[0]=L*re,s[1]=(F*D*m-E*V*m-F*f*R+d*V*R+E*f*N-d*D*N)*re,s[2]=(v*V*m-F*b*m+F*f*w-d*V*w-v*f*N+d*b*N)*re,s[3]=(E*b*m-v*D*m-E*f*w+d*D*w+v*f*R-d*b*R)*re,s[4]=j*re,s[5]=(A*V*m-I*D*m+I*f*R-a*V*R-A*f*N+a*D*N)*re,s[6]=(I*b*m-_*V*m-I*f*w+a*V*w+_*f*N-a*b*N)*re,s[7]=(_*D*m-A*b*m+A*f*w-a*D*w-_*f*R+a*b*R)*re,s[8]=G*re,s[9]=(I*E*m-A*F*m-I*d*R+a*F*R+A*d*N-a*E*N)*re,s[10]=(_*F*m-I*v*m+I*d*w-a*F*w-_*d*N+a*v*N)*re,s[11]=(A*v*m-_*E*m-A*d*w+a*E*w+_*d*R-a*v*R)*re,s[12]=K*re,s[13]=(A*F*f-I*E*f+I*d*D-a*F*D-A*d*V+a*E*V)*re,s[14]=(I*v*f-_*F*f-I*d*b+a*F*b+_*d*V-a*v*V)*re,s[15]=(_*E*f-A*v*f+A*d*b-a*E*b-_*d*D+a*v*D)*re,this}scale(s){const a=this.elements,d=s.x,f=s.y,m=s.z;return a[0]*=d,a[4]*=f,a[8]*=m,a[1]*=d,a[5]*=f,a[9]*=m,a[2]*=d,a[6]*=f,a[10]*=m,a[3]*=d,a[7]*=f,a[11]*=m,this}getMaxScaleOnAxis(){const s=this.elements;return Math.sqrt(Math.max(s[0]*s[0]+s[1]*s[1]+s[2]*s[2],s[4]*s[4]+s[5]*s[5]+s[6]*s[6],s[8]*s[8]+s[9]*s[9]+s[10]*s[10]))}makeTranslation(s,a,d){return this.set(1,0,0,s,0,1,0,a,0,0,1,d,0,0,0,1),this}makeRotationX(s){const a=Math.cos(s),d=Math.sin(s);return this.set(1,0,0,0,0,a,-d,0,0,d,a,0,0,0,0,1),this}makeRotationY(s){const a=Math.cos(s),d=Math.sin(s);return this.set(a,0,d,0,0,1,0,0,-d,0,a,0,0,0,0,1),this}makeRotationZ(s){const a=Math.cos(s),d=Math.sin(s);return this.set(a,-d,0,0,d,a,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(s,a){const d=Math.cos(a),f=Math.sin(a),m=1-d,_=s.x,v=s.y,b=s.z,w=m*_,A=m*v;return this.set(w*_+d,w*v-f*b,w*b+f*v,0,w*v+f*b,A*v+d,A*b-f*_,0,w*b-f*v,A*b+f*_,m*b*b+d,0,0,0,0,1),this}makeScale(s,a,d){return this.set(s,0,0,0,0,a,0,0,0,0,d,0,0,0,0,1),this}makeShear(s,a,d){return this.set(1,a,d,0,s,1,d,0,s,a,1,0,0,0,0,1),this}compose(s,a,d){const f=this.elements,m=a._x,_=a._y,v=a._z,b=a._w,w=m+m,A=_+_,E=v+v,D=m*w,R=m*A,I=m*E,F=_*A,V=_*E,N=v*E,L=b*w,j=b*A,G=b*E,K=d.x,H=d.y,re=d.z;return f[0]=(1-(F+N))*K,f[1]=(R+G)*K,f[2]=(I-j)*K,f[3]=0,f[4]=(R-G)*H,f[5]=(1-(D+N))*H,f[6]=(V+L)*H,f[7]=0,f[8]=(I+j)*re,f[9]=(V-L)*re,f[10]=(1-(D+F))*re,f[11]=0,f[12]=s.x,f[13]=s.y,f[14]=s.z,f[15]=1,this}decompose(s,a,d){const f=this.elements;let m=vu.set(f[0],f[1],f[2]).length();const _=vu.set(f[4],f[5],f[6]).length(),v=vu.set(f[8],f[9],f[10]).length();this.determinant()<0&&(m=-m),s.x=f[12],s.y=f[13],s.z=f[14],wa.copy(this);const w=1/m,A=1/_,E=1/v;return wa.elements[0]*=w,wa.elements[1]*=w,wa.elements[2]*=w,wa.elements[4]*=A,wa.elements[5]*=A,wa.elements[6]*=A,wa.elements[8]*=E,wa.elements[9]*=E,wa.elements[10]*=E,a.setFromRotationMatrix(wa),d.x=m,d.y=_,d.z=v,this}makePerspective(s,a,d,f,m,_){void 0===_&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const v=this.elements,w=2*m/(d-f),A=(a+s)/(a-s),E=(d+f)/(d-f),D=-(_+m)/(_-m),R=-2*_*m/(_-m);return v[0]=2*m/(a-s),v[4]=0,v[8]=A,v[12]=0,v[1]=0,v[5]=w,v[9]=E,v[13]=0,v[2]=0,v[6]=0,v[10]=D,v[14]=R,v[3]=0,v[7]=0,v[11]=-1,v[15]=0,this}makeOrthographic(s,a,d,f,m,_){const v=this.elements,b=1/(a-s),w=1/(d-f),A=1/(_-m),E=(a+s)*b,D=(d+f)*w,R=(_+m)*A;return v[0]=2*b,v[4]=0,v[8]=0,v[12]=-E,v[1]=0,v[5]=2*w,v[9]=0,v[13]=-D,v[2]=0,v[6]=0,v[10]=-2*A,v[14]=-R,v[3]=0,v[7]=0,v[11]=0,v[15]=1,this}equals(s){const a=this.elements,d=s.elements;for(let f=0;f<16;f++)if(a[f]!==d[f])return!1;return!0}fromArray(s,a=0){for(let d=0;d<16;d++)this.elements[d]=s[d+a];return this}toArray(s=[],a=0){const d=this.elements;return s[a]=d[0],s[a+1]=d[1],s[a+2]=d[2],s[a+3]=d[3],s[a+4]=d[4],s[a+5]=d[5],s[a+6]=d[6],s[a+7]=d[7],s[a+8]=d[8],s[a+9]=d[9],s[a+10]=d[10],s[a+11]=d[11],s[a+12]=d[12],s[a+13]=d[13],s[a+14]=d[14],s[a+15]=d[15],s}}Ht.prototype.isMatrix4=!0;const vu=new W,wa=new Ht,KL=new W(0,0,0),QL=new W(1,1,1),uc=new W,yy=new W,Mo=new W,tT=new Ht,nT=new wi;class xu{constructor(s=0,a=0,d=0,f=xu.DefaultOrder){this._x=s,this._y=a,this._z=d,this._order=f}get x(){return this._x}set x(s){this._x=s,this._onChangeCallback()}get y(){return this._y}set y(s){this._y=s,this._onChangeCallback()}get z(){return this._z}set z(s){this._z=s,this._onChangeCallback()}get order(){return this._order}set order(s){this._order=s,this._onChangeCallback()}set(s,a,d,f){return this._x=s,this._y=a,this._z=d,this._order=f||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(s){return this._x=s._x,this._y=s._y,this._z=s._z,this._order=s._order,this._onChangeCallback(),this}setFromRotationMatrix(s,a,d){const f=Jt.clamp,m=s.elements,_=m[0],v=m[4],b=m[8],w=m[1],A=m[5],E=m[9],D=m[2],R=m[6],I=m[10];switch(a=a||this._order){case"XYZ":this._y=Math.asin(f(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(-E,I),this._z=Math.atan2(-v,_)):(this._x=Math.atan2(R,A),this._z=0);break;case"YXZ":this._x=Math.asin(-f(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(b,I),this._z=Math.atan2(w,A)):(this._y=Math.atan2(-D,_),this._z=0);break;case"ZXY":this._x=Math.asin(f(R,-1,1)),Math.abs(R)<.9999999?(this._y=Math.atan2(-D,I),this._z=Math.atan2(-v,A)):(this._y=0,this._z=Math.atan2(w,_));break;case"ZYX":this._y=Math.asin(-f(D,-1,1)),Math.abs(D)<.9999999?(this._x=Math.atan2(R,I),this._z=Math.atan2(w,_)):(this._x=0,this._z=Math.atan2(-v,A));break;case"YZX":this._z=Math.asin(f(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(-E,A),this._y=Math.atan2(-D,_)):(this._x=0,this._y=Math.atan2(b,I));break;case"XZY":this._z=Math.asin(-f(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(R,A),this._y=Math.atan2(b,_)):(this._x=Math.atan2(-E,I),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+a)}return this._order=a,!1!==d&&this._onChangeCallback(),this}setFromQuaternion(s,a,d){return tT.makeRotationFromQuaternion(s),this.setFromRotationMatrix(tT,a,d)}setFromVector3(s,a){return this.set(s.x,s.y,s.z,a||this._order)}reorder(s){return nT.setFromEuler(this),this.setFromQuaternion(nT,s)}equals(s){return s._x===this._x&&s._y===this._y&&s._z===this._z&&s._order===this._order}fromArray(s){return this._x=s[0],this._y=s[1],this._z=s[2],void 0!==s[3]&&(this._order=s[3]),this._onChangeCallback(),this}toArray(s=[],a=0){return s[a]=this._x,s[a+1]=this._y,s[a+2]=this._z,s[a+3]=this._order,s}toVector3(s){return s?s.set(this._x,this._y,this._z):new W(this._x,this._y,this._z)}_onChange(s){return this._onChangeCallback=s,this}_onChangeCallback(){}}xu.prototype.isEuler=!0,xu.DefaultOrder="XYZ",xu.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class ib{constructor(){this.mask=1}set(s){this.mask=1<<s|0}enable(s){this.mask|=1<<s|0}enableAll(){this.mask=-1}toggle(s){this.mask^=1<<s|0}disable(s){this.mask&=~(1<<s|0)}disableAll(){this.mask=0}test(s){return 0!=(this.mask&s.mask)}}let eP=0;const iT=new W,dh=new wi,Ml=new Ht,hh=new W,dc=new W,tP=new W,nP=new wi,rT=new W(1,0,0),Sl=new W(0,1,0),rb=new W(0,0,1),Qr={type:"added"},vy={type:"removed"};function en(){Object.defineProperty(this,"id",{value:eP++}),this.uuid=Jt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=en.DefaultUp.clone();const u=new W,s=new xu,a=new wi,d=new W(1,1,1);s._onChange(function f(){a.setFromEuler(s,!1)}),a._onChange(function m(){s.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:u},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new Ht},normalMatrix:{value:new Ji}}),this.matrix=new Ht,this.matrixWorld=new Ht,this.matrixAutoUpdate=en.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ib,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}en.DefaultUp=new W(0,1,0),en.DefaultMatrixAutoUpdate=!0,en.prototype=Object.assign(Object.create(Yi.prototype),{constructor:en,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(u){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(u),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(u){return this.quaternion.premultiply(u),this},setRotationFromAxisAngle:function(u,s){this.quaternion.setFromAxisAngle(u,s)},setRotationFromEuler:function(u){this.quaternion.setFromEuler(u,!0)},setRotationFromMatrix:function(u){this.quaternion.setFromRotationMatrix(u)},setRotationFromQuaternion:function(u){this.quaternion.copy(u)},rotateOnAxis:function(u,s){return dh.setFromAxisAngle(u,s),this.quaternion.multiply(dh),this},rotateOnWorldAxis:function(u,s){return dh.setFromAxisAngle(u,s),this.quaternion.premultiply(dh),this},rotateX:function(u){return this.rotateOnAxis(rT,u)},rotateY:function(u){return this.rotateOnAxis(Sl,u)},rotateZ:function(u){return this.rotateOnAxis(rb,u)},translateOnAxis:function(u,s){return iT.copy(u).applyQuaternion(this.quaternion),this.position.add(iT.multiplyScalar(s)),this},translateX:function(u){return this.translateOnAxis(rT,u)},translateY:function(u){return this.translateOnAxis(Sl,u)},translateZ:function(u){return this.translateOnAxis(rb,u)},localToWorld:function(u){return u.applyMatrix4(this.matrixWorld)},worldToLocal:function(u){return u.applyMatrix4(Ml.copy(this.matrixWorld).invert())},lookAt:function(u,s,a){u.isVector3?hh.copy(u):hh.set(u,s,a);const d=this.parent;this.updateWorldMatrix(!0,!1),dc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ml.lookAt(dc,hh,this.up):Ml.lookAt(hh,dc,this.up),this.quaternion.setFromRotationMatrix(Ml),d&&(Ml.extractRotation(d.matrixWorld),dh.setFromRotationMatrix(Ml),this.quaternion.premultiply(dh.invert()))},add:function(u){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return u===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",u),this):(u&&u.isObject3D?(null!==u.parent&&u.parent.remove(u),u.parent=this,this.children.push(u),u.dispatchEvent(Qr)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",u),this)},remove:function(u){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const s=this.children.indexOf(u);return-1!==s&&(u.parent=null,this.children.splice(s,1),u.dispatchEvent(vy)),this},clear:function(){for(let u=0;u<this.children.length;u++){const s=this.children[u];s.parent=null,s.dispatchEvent(vy)}return this.children.length=0,this},attach:function(u){return this.updateWorldMatrix(!0,!1),Ml.copy(this.matrixWorld).invert(),null!==u.parent&&(u.parent.updateWorldMatrix(!0,!1),Ml.multiply(u.parent.matrixWorld)),u.applyMatrix4(Ml),this.add(u),u.updateWorldMatrix(!1,!0),this},getObjectById:function(u){return this.getObjectByProperty("id",u)},getObjectByName:function(u){return this.getObjectByProperty("name",u)},getObjectByProperty:function(u,s){if(this[u]===s)return this;for(let a=0,d=this.children.length;a<d;a++){const m=this.children[a].getObjectByProperty(u,s);if(void 0!==m)return m}},getWorldPosition:function(u){return void 0===u&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),u=new W),this.updateWorldMatrix(!0,!1),u.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(u){return void 0===u&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),u=new wi),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dc,u,tP),u},getWorldScale:function(u){return void 0===u&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),u=new W),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(dc,nP,u),u},getWorldDirection:function(u){void 0===u&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),u=new W),this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return u.set(s[8],s[9],s[10]).normalize()},raycast:function(){},traverse:function(u){u(this);const s=this.children;for(let a=0,d=s.length;a<d;a++)s[a].traverse(u)},traverseVisible:function(u){if(!1===this.visible)return;u(this);const s=this.children;for(let a=0,d=s.length;a<d;a++)s[a].traverseVisible(u)},traverseAncestors:function(u){const s=this.parent;null!==s&&(u(s),s.traverseAncestors(u))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(u){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||u)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,u=!0);const s=this.children;for(let a=0,d=s.length;a<d;a++)s[a].updateMatrixWorld(u)},updateWorldMatrix:function(u,s){const a=this.parent;if(!0===u&&null!==a&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===s){const d=this.children;for(let f=0,m=d.length;f<m;f++)d[f].updateWorldMatrix(!1,!0)}},toJSON:function(u){const s=void 0===u||"string"==typeof u,a={};s&&(u={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},a.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const d={};function f(_,v){return void 0===_[v.uuid]&&(_[v.uuid]=v.toJSON(u)),v.uuid}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),!0===this.castShadow&&(d.castShadow=!0),!0===this.receiveShadow&&(d.receiveShadow=!0),!1===this.visible&&(d.visible=!1),!1===this.frustumCulled&&(d.frustumCulled=!1),0!==this.renderOrder&&(d.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),d.layers=this.layers.mask,d.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(d.matrixAutoUpdate=!1),this.isInstancedMesh&&(d.type="InstancedMesh",d.count=this.count,d.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){d.geometry=f(u.geometries,this.geometry);const _=this.geometry.parameters;if(void 0!==_&&void 0!==_.shapes){const v=_.shapes;if(Array.isArray(v))for(let b=0,w=v.length;b<w;b++)f(u.shapes,v[b]);else f(u.shapes,v)}}if(this.isSkinnedMesh&&(d.bindMode=this.bindMode,d.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(f(u.skeletons,this.skeleton),d.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const _=[];for(let v=0,b=this.material.length;v<b;v++)_.push(f(u.materials,this.material[v]));d.material=_}else d.material=f(u.materials,this.material);if(this.children.length>0){d.children=[];for(let _=0;_<this.children.length;_++)d.children.push(this.children[_].toJSON(u).object)}if(this.animations.length>0){d.animations=[];for(let _=0;_<this.animations.length;_++)d.animations.push(f(u.animations,this.animations[_]))}if(s){const _=m(u.geometries),v=m(u.materials),b=m(u.textures),w=m(u.images),A=m(u.shapes),E=m(u.skeletons),D=m(u.animations);_.length>0&&(a.geometries=_),v.length>0&&(a.materials=v),b.length>0&&(a.textures=b),w.length>0&&(a.images=w),A.length>0&&(a.shapes=A),E.length>0&&(a.skeletons=E),D.length>0&&(a.animations=D)}return a.object=d,a;function m(_){const v=[];for(const b in _){const w=_[b];delete w.metadata,v.push(w)}return v}},clone:function(u){return(new this.constructor).copy(this,u)},copy:function(u,s=!0){if(this.name=u.name,this.up.copy(u.up),this.position.copy(u.position),this.rotation.order=u.rotation.order,this.quaternion.copy(u.quaternion),this.scale.copy(u.scale),this.matrix.copy(u.matrix),this.matrixWorld.copy(u.matrixWorld),this.matrixAutoUpdate=u.matrixAutoUpdate,this.matrixWorldNeedsUpdate=u.matrixWorldNeedsUpdate,this.layers.mask=u.layers.mask,this.visible=u.visible,this.castShadow=u.castShadow,this.receiveShadow=u.receiveShadow,this.frustumCulled=u.frustumCulled,this.renderOrder=u.renderOrder,this.userData=JSON.parse(JSON.stringify(u.userData)),!0===s)for(let a=0;a<u.children.length;a++)this.add(u.children[a].clone());return this}});const xy=new W,sb=new W,ob=new Ji;class $o{constructor(s=new W(1,0,0),a=0){this.normal=s,this.constant=a}set(s,a){return this.normal.copy(s),this.constant=a,this}setComponents(s,a,d,f){return this.normal.set(s,a,d),this.constant=f,this}setFromNormalAndCoplanarPoint(s,a){return this.normal.copy(s),this.constant=-a.dot(this.normal),this}setFromCoplanarPoints(s,a,d){const f=xy.subVectors(d,a).cross(sb.subVectors(s,a)).normalize();return this.setFromNormalAndCoplanarPoint(f,s),this}copy(s){return this.normal.copy(s.normal),this.constant=s.constant,this}normalize(){const s=1/this.normal.length();return this.normal.multiplyScalar(s),this.constant*=s,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(s){return this.normal.dot(s)+this.constant}distanceToSphere(s){return this.distanceToPoint(s.center)-s.radius}projectPoint(s,a){return void 0===a&&(console.warn("THREE.Plane: .projectPoint() target is now required"),a=new W),a.copy(this.normal).multiplyScalar(-this.distanceToPoint(s)).add(s)}intersectLine(s,a){void 0===a&&(console.warn("THREE.Plane: .intersectLine() target is now required"),a=new W);const d=s.delta(xy),f=this.normal.dot(d);if(0===f)return 0===this.distanceToPoint(s.start)?a.copy(s.start):void 0;const m=-(s.start.dot(this.normal)+this.constant)/f;return m<0||m>1?void 0:a.copy(d).multiplyScalar(m).add(s.start)}intersectsLine(s){const a=this.distanceToPoint(s.start),d=this.distanceToPoint(s.end);return a<0&&d>0||d<0&&a>0}intersectsBox(s){return s.intersectsPlane(this)}intersectsSphere(s){return s.intersectsPlane(this)}coplanarPoint(s){return void 0===s&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),s=new W),s.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(s,a){const d=a||ob.getNormalMatrix(s),f=this.coplanarPoint(xy).applyMatrix4(s),m=this.normal.applyMatrix3(d).normalize();return this.constant=-f.dot(m),this}translate(s){return this.constant-=s.dot(this.normal),this}equals(s){return s.normal.equals(this.normal)&&s.constant===this.constant}clone(){return(new this.constructor).copy(this)}}$o.prototype.isPlane=!0;const Qs=new W,Ya=new W,Bs=new W,Xo=new W,bu=new W,El=new W,ab=new W,lb=new W,ar=new W,by=new W;class xr{constructor(s=new W,a=new W,d=new W){this.a=s,this.b=a,this.c=d}static getNormal(s,a,d,f){void 0===f&&(console.warn("THREE.Triangle: .getNormal() target is now required"),f=new W),f.subVectors(d,a),Qs.subVectors(s,a),f.cross(Qs);const m=f.lengthSq();return m>0?f.multiplyScalar(1/Math.sqrt(m)):f.set(0,0,0)}static getBarycoord(s,a,d,f,m){Qs.subVectors(f,a),Ya.subVectors(d,a),Bs.subVectors(s,a);const _=Qs.dot(Qs),v=Qs.dot(Ya),b=Qs.dot(Bs),w=Ya.dot(Ya),A=Ya.dot(Bs),E=_*w-v*v;if(void 0===m&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),m=new W),0===E)return m.set(-2,-1,-1);const D=1/E,R=(w*b-v*A)*D,I=(_*A-v*b)*D;return m.set(1-R-I,I,R)}static containsPoint(s,a,d,f){return this.getBarycoord(s,a,d,f,Xo),Xo.x>=0&&Xo.y>=0&&Xo.x+Xo.y<=1}static getUV(s,a,d,f,m,_,v,b){return this.getBarycoord(s,a,d,f,Xo),b.set(0,0),b.addScaledVector(m,Xo.x),b.addScaledVector(_,Xo.y),b.addScaledVector(v,Xo.z),b}static isFrontFacing(s,a,d,f){return Qs.subVectors(d,a),Ya.subVectors(s,a),Qs.cross(Ya).dot(f)<0}set(s,a,d){return this.a.copy(s),this.b.copy(a),this.c.copy(d),this}setFromPointsAndIndices(s,a,d,f){return this.a.copy(s[a]),this.b.copy(s[d]),this.c.copy(s[f]),this}clone(){return(new this.constructor).copy(this)}copy(s){return this.a.copy(s.a),this.b.copy(s.b),this.c.copy(s.c),this}getArea(){return Qs.subVectors(this.c,this.b),Ya.subVectors(this.a,this.b),.5*Qs.cross(Ya).length()}getMidpoint(s){return void 0===s&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),s=new W),s.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(s){return xr.getNormal(this.a,this.b,this.c,s)}getPlane(s){return void 0===s&&(console.warn("THREE.Triangle: .getPlane() target is now required"),s=new $o),s.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(s,a){return xr.getBarycoord(s,this.a,this.b,this.c,a)}getUV(s,a,d,f,m){return xr.getUV(s,this.a,this.b,this.c,a,d,f,m)}containsPoint(s){return xr.containsPoint(s,this.a,this.b,this.c)}isFrontFacing(s){return xr.isFrontFacing(this.a,this.b,this.c,s)}intersectsBox(s){return s.intersectsTriangle(this)}closestPointToPoint(s,a){void 0===a&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),a=new W);const d=this.a,f=this.b,m=this.c;let _,v;bu.subVectors(f,d),El.subVectors(m,d),lb.subVectors(s,d);const b=bu.dot(lb),w=El.dot(lb);if(b<=0&&w<=0)return a.copy(d);ar.subVectors(s,f);const A=bu.dot(ar),E=El.dot(ar);if(A>=0&&E<=A)return a.copy(f);const D=b*E-A*w;if(D<=0&&b>=0&&A<=0)return _=b/(b-A),a.copy(d).addScaledVector(bu,_);by.subVectors(s,m);const R=bu.dot(by),I=El.dot(by);if(I>=0&&R<=I)return a.copy(m);const F=R*w-b*I;if(F<=0&&w>=0&&I<=0)return v=w/(w-I),a.copy(d).addScaledVector(El,v);const V=A*I-R*E;if(V<=0&&E-A>=0&&R-I>=0)return ab.subVectors(m,f),v=(E-A)/(E-A+(R-I)),a.copy(f).addScaledVector(ab,v);const N=1/(V+F+D);return _=F*N,v=D*N,a.copy(d).addScaledVector(bu,_).addScaledVector(El,v)}equals(s){return s.a.equals(this.a)&&s.b.equals(this.b)&&s.c.equals(this.c)}}let Lp=0;function Wn(){Object.defineProperty(this,"id",{value:Lp++}),this.uuid=Jt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=wo,this.side=hn,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ci,this.blendDst=dp,this.blendEquation=zo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=hp,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Qx,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=py,this.stencilZFail=py,this.stencilZPass=py,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Wn.prototype=Object.assign(Object.create(Yi.prototype),{constructor:Wn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(u){if(void 0!==u)for(const s in u){const a=u[s];if(void 0===a){console.warn("THREE.Material: '"+s+"' parameter is undefined.");continue}if("shading"===s){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=a===Jr;continue}const d=this[s];void 0!==d?d&&d.isColor?d.set(a):d&&d.isVector3&&a&&a.isVector3?d.copy(a):this[s]=a:console.warn("THREE."+this.type+": '"+s+"' is not a property of this material.")}},toJSON:function(u){const s=void 0===u||"string"==typeof u;s&&(u={textures:{},images:{}});const a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function d(f){const m=[];for(const _ in f){const v=f[_];delete v.metadata,m.push(v)}return m}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),void 0!==this.roughness&&(a.roughness=this.roughness),void 0!==this.metalness&&(a.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(a.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),void 0!==this.shininess&&(a.shininess=this.shininess),void 0!==this.clearcoat&&(a.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(u).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(u).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(u).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(u).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(u).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(u).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(u).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(u).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(u).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(u).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(u).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(u).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(u).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(u).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(u).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(u).uuid,a.reflectivity=this.reflectivity,a.refractionRatio=this.refractionRatio,void 0!==this.combine&&(a.combine=this.combine),void 0!==this.envMapIntensity&&(a.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(u).uuid),void 0!==this.size&&(a.size=this.size),void 0!==this.sizeAttenuation&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==wo&&(a.blending=this.blending),this.side!==hn&&(a.side=this.side),this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),!0===this.transparent&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,a.stencilWrite=this.stencilWrite,a.stencilWriteMask=this.stencilWriteMask,a.stencilFunc=this.stencilFunc,a.stencilRef=this.stencilRef,a.stencilFuncMask=this.stencilFuncMask,a.stencilFail=this.stencilFail,a.stencilZFail=this.stencilZFail,a.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(a.rotation=this.rotation),!0===this.polygonOffset&&(a.polygonOffset=!0),0!==this.polygonOffsetFactor&&(a.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(a.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(a.linewidth=this.linewidth),void 0!==this.dashSize&&(a.dashSize=this.dashSize),void 0!==this.gapSize&&(a.gapSize=this.gapSize),void 0!==this.scale&&(a.scale=this.scale),!0===this.dithering&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(a.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(a.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(a.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(a.morphTargets=!0),!0===this.morphNormals&&(a.morphNormals=!0),!0===this.skinning&&(a.skinning=!0),!0===this.flatShading&&(a.flatShading=this.flatShading),!1===this.visible&&(a.visible=!1),!1===this.toneMapped&&(a.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),s){const f=d(u.textures),m=d(u.images);f.length>0&&(a.textures=f),m.length>0&&(a.images=m)}return a},clone:function(){return(new this.constructor).copy(this)},copy:function(u){this.name=u.name,this.fog=u.fog,this.blending=u.blending,this.side=u.side,this.vertexColors=u.vertexColors,this.opacity=u.opacity,this.transparent=u.transparent,this.blendSrc=u.blendSrc,this.blendDst=u.blendDst,this.blendEquation=u.blendEquation,this.blendSrcAlpha=u.blendSrcAlpha,this.blendDstAlpha=u.blendDstAlpha,this.blendEquationAlpha=u.blendEquationAlpha,this.depthFunc=u.depthFunc,this.depthTest=u.depthTest,this.depthWrite=u.depthWrite,this.stencilWriteMask=u.stencilWriteMask,this.stencilFunc=u.stencilFunc,this.stencilRef=u.stencilRef,this.stencilFuncMask=u.stencilFuncMask,this.stencilFail=u.stencilFail,this.stencilZFail=u.stencilZFail,this.stencilZPass=u.stencilZPass,this.stencilWrite=u.stencilWrite;const s=u.clippingPlanes;let a=null;if(null!==s){const d=s.length;a=new Array(d);for(let f=0;f!==d;++f)a[f]=s[f].clone()}return this.clippingPlanes=a,this.clipIntersection=u.clipIntersection,this.clipShadows=u.clipShadows,this.shadowSide=u.shadowSide,this.colorWrite=u.colorWrite,this.precision=u.precision,this.polygonOffset=u.polygonOffset,this.polygonOffsetFactor=u.polygonOffsetFactor,this.polygonOffsetUnits=u.polygonOffsetUnits,this.dithering=u.dithering,this.alphaTest=u.alphaTest,this.premultipliedAlpha=u.premultipliedAlpha,this.visible=u.visible,this.toneMapped=u.toneMapped,this.userData=JSON.parse(JSON.stringify(u.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Wn.prototype,"needsUpdate",{set:function(u){!0===u&&this.version++}});const cb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},eo={h:0,s:0,l:0},Ja={h:0,s:0,l:0};function bs(u,s,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?u+6*(s-u)*a:a<.5?s:a<2/3?u+6*(s-u)*(2/3-a):u}function Pp(u){return u<.04045?.0773993808*u:Math.pow(.9478672986*u+.0521327014,2.4)}function fh(u){return u<.0031308?12.92*u:1.055*Math.pow(u,.41666)-.055}let At=(()=>{class u{constructor(a,d,f){return void 0===d&&void 0===f?this.set(a):this.setRGB(a,d,f)}set(a){return a&&a.isColor?this.copy(a):"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a),this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,this}setRGB(a,d,f){return this.r=a,this.g=d,this.b=f,this}setHSL(a,d,f){if(a=Jt.euclideanModulo(a,1),d=Jt.clamp(d,0,1),f=Jt.clamp(f,0,1),0===d)this.r=this.g=this.b=f;else{const m=f<=.5?f*(1+d):f+d-f*d,_=2*f-m;this.r=bs(_,m,a+1/3),this.g=bs(_,m,a),this.b=bs(_,m,a-1/3)}return this}setStyle(a){function d(m){void 0!==m&&parseFloat(m)<1&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}let f;if(f=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(a)){let m;const v=f[2];switch(f[1]){case"rgb":case"rgba":if(m=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(v))return this.r=Math.min(255,parseInt(m[1],10))/255,this.g=Math.min(255,parseInt(m[2],10))/255,this.b=Math.min(255,parseInt(m[3],10))/255,d(m[4]),this;if(m=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(v))return this.r=Math.min(100,parseInt(m[1],10))/100,this.g=Math.min(100,parseInt(m[2],10))/100,this.b=Math.min(100,parseInt(m[3],10))/100,d(m[4]),this;break;case"hsl":case"hsla":if(m=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(v)){const b=parseFloat(m[1])/360,w=parseInt(m[2],10)/100,A=parseInt(m[3],10)/100;return d(m[4]),this.setHSL(b,w,A)}}}else if(f=/^\#([A-Fa-f\d]+)$/.exec(a)){const m=f[1],_=m.length;if(3===_)return this.r=parseInt(m.charAt(0)+m.charAt(0),16)/255,this.g=parseInt(m.charAt(1)+m.charAt(1),16)/255,this.b=parseInt(m.charAt(2)+m.charAt(2),16)/255,this;if(6===_)return this.r=parseInt(m.charAt(0)+m.charAt(1),16)/255,this.g=parseInt(m.charAt(2)+m.charAt(3),16)/255,this.b=parseInt(m.charAt(4)+m.charAt(5),16)/255,this}return a&&a.length>0?this.setColorName(a):this}setColorName(a){const d=cb[a];return void 0!==d?this.setHex(d):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copyGammaToLinear(a,d=2){return this.r=Math.pow(a.r,d),this.g=Math.pow(a.g,d),this.b=Math.pow(a.b,d),this}copyLinearToGamma(a,d=2){const f=d>0?1/d:1;return this.r=Math.pow(a.r,f),this.g=Math.pow(a.g,f),this.b=Math.pow(a.b,f),this}convertGammaToLinear(a){return this.copyGammaToLinear(this,a),this}convertLinearToGamma(a){return this.copyLinearToGamma(this,a),this}copySRGBToLinear(a){return this.r=Pp(a.r),this.g=Pp(a.g),this.b=Pp(a.b),this}copyLinearToSRGB(a){return this.r=fh(a.r),this.g=fh(a.g),this.b=fh(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(a){void 0===a&&(console.warn("THREE.Color: .getHSL() target is now required"),a={h:0,s:0,l:0});const d=this.r,f=this.g,m=this.b,_=Math.max(d,f,m),v=Math.min(d,f,m);let b,w;const A=(v+_)/2;if(v===_)b=0,w=0;else{const E=_-v;switch(w=A<=.5?E/(_+v):E/(2-_-v),_){case d:b=(f-m)/E+(f<m?6:0);break;case f:b=(m-d)/E+2;break;case m:b=(d-f)/E+4}b/=6}return a.h=b,a.s=w,a.l=A,a}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(a,d,f){return this.getHSL(eo),eo.h+=a,eo.s+=d,eo.l+=f,this.setHSL(eo.h,eo.s,eo.l),this}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,d){return this.r=a.r+d.r,this.g=a.g+d.g,this.b=a.b+d.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,d){return this.r+=(a.r-this.r)*d,this.g+=(a.g-this.g)*d,this.b+=(a.b-this.b)*d,this}lerpColors(a,d,f){return this.r=a.r+(d.r-a.r)*f,this.g=a.g+(d.g-a.g)*f,this.b=a.b+(d.b-a.b)*f,this}lerpHSL(a,d){this.getHSL(eo),a.getHSL(Ja);const f=Jt.lerp(eo.h,Ja.h,d),m=Jt.lerp(eo.s,Ja.s,d),_=Jt.lerp(eo.l,Ja.l,d);return this.setHSL(f,m,_),this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,d=0){return this.r=a[d],this.g=a[d+1],this.b=a[d+2],this}toArray(a=[],d=0){return a[d]=this.r,a[d+1]=this.g,a[d+2]=this.b,a}fromBufferAttribute(a,d){return this.r=a.getX(d),this.g=a.getY(d),this.b=a.getZ(d),!0===a.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return u.NAMES=cb,u})();At.prototype.isColor=!0,At.prototype.r=1,At.prototype.g=1,At.prototype.b=1;class cs extends Wn{constructor(s){super(),this.type="MeshBasicMaterial",this.color=new At(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this}}cs.prototype.isMeshBasicMaterial=!0;const Fi=new W,wu=new qe;function Ke(u,s,a){if(Array.isArray(u))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=u,this.itemSize=s,this.count=void 0!==u?u.length/s:0,this.normalized=!0===a,this.usage=si,this.updateRange={offset:0,count:-1},this.version=0}function Mu(u,s,a){Ke.call(this,new Int8Array(u),s,a)}function Fp(u,s,a){Ke.call(this,new Uint8Array(u),s,a)}function ph(u,s,a){Ke.call(this,new Uint8ClampedArray(u),s,a)}function mh(u,s,a){Ke.call(this,new Int16Array(u),s,a)}function hc(u,s,a){Ke.call(this,new Uint16Array(u),s,a)}function Su(u,s,a){Ke.call(this,new Int32Array(u),s,a)}function fc(u,s,a){Ke.call(this,new Uint32Array(u),s,a)}function gh(u,s,a){Ke.call(this,new Uint16Array(u),s,a)}function pe(u,s,a){Ke.call(this,new Float32Array(u),s,a)}function On(u,s,a){Ke.call(this,new Float64Array(u),s,a)}function _h(u){if(0===u.length)return-1/0;let s=u[0];for(let a=1,d=u.length;a<d;++a)u[a]>s&&(s=u[a]);return s}Object.defineProperty(Ke.prototype,"needsUpdate",{set:function(u){!0===u&&this.version++}}),Object.assign(Ke.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(u){return this.usage=u,this},copy:function(u){return this.name=u.name,this.array=new u.array.constructor(u.array),this.itemSize=u.itemSize,this.count=u.count,this.normalized=u.normalized,this.usage=u.usage,this},copyAt:function(u,s,a){u*=this.itemSize,a*=s.itemSize;for(let d=0,f=this.itemSize;d<f;d++)this.array[u+d]=s.array[a+d];return this},copyArray:function(u){return this.array.set(u),this},copyColorsArray:function(u){const s=this.array;let a=0;for(let d=0,f=u.length;d<f;d++){let m=u[d];void 0===m&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",d),m=new At),s[a++]=m.r,s[a++]=m.g,s[a++]=m.b}return this},copyVector2sArray:function(u){const s=this.array;let a=0;for(let d=0,f=u.length;d<f;d++){let m=u[d];void 0===m&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",d),m=new qe),s[a++]=m.x,s[a++]=m.y}return this},copyVector3sArray:function(u){const s=this.array;let a=0;for(let d=0,f=u.length;d<f;d++){let m=u[d];void 0===m&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",d),m=new W),s[a++]=m.x,s[a++]=m.y,s[a++]=m.z}return this},copyVector4sArray:function(u){const s=this.array;let a=0;for(let d=0,f=u.length;d<f;d++){let m=u[d];void 0===m&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",d),m=new $e),s[a++]=m.x,s[a++]=m.y,s[a++]=m.z,s[a++]=m.w}return this},applyMatrix3:function(u){if(2===this.itemSize)for(let s=0,a=this.count;s<a;s++)wu.fromBufferAttribute(this,s),wu.applyMatrix3(u),this.setXY(s,wu.x,wu.y);else if(3===this.itemSize)for(let s=0,a=this.count;s<a;s++)Fi.fromBufferAttribute(this,s),Fi.applyMatrix3(u),this.setXYZ(s,Fi.x,Fi.y,Fi.z);return this},applyMatrix4:function(u){for(let s=0,a=this.count;s<a;s++)Fi.x=this.getX(s),Fi.y=this.getY(s),Fi.z=this.getZ(s),Fi.applyMatrix4(u),this.setXYZ(s,Fi.x,Fi.y,Fi.z);return this},applyNormalMatrix:function(u){for(let s=0,a=this.count;s<a;s++)Fi.x=this.getX(s),Fi.y=this.getY(s),Fi.z=this.getZ(s),Fi.applyNormalMatrix(u),this.setXYZ(s,Fi.x,Fi.y,Fi.z);return this},transformDirection:function(u){for(let s=0,a=this.count;s<a;s++)Fi.x=this.getX(s),Fi.y=this.getY(s),Fi.z=this.getZ(s),Fi.transformDirection(u),this.setXYZ(s,Fi.x,Fi.y,Fi.z);return this},set:function(u,s=0){return this.array.set(u,s),this},getX:function(u){return this.array[u*this.itemSize]},setX:function(u,s){return this.array[u*this.itemSize]=s,this},getY:function(u){return this.array[u*this.itemSize+1]},setY:function(u,s){return this.array[u*this.itemSize+1]=s,this},getZ:function(u){return this.array[u*this.itemSize+2]},setZ:function(u,s){return this.array[u*this.itemSize+2]=s,this},getW:function(u){return this.array[u*this.itemSize+3]},setW:function(u,s){return this.array[u*this.itemSize+3]=s,this},setXY:function(u,s,a){return this.array[0+(u*=this.itemSize)]=s,this.array[u+1]=a,this},setXYZ:function(u,s,a,d){return this.array[0+(u*=this.itemSize)]=s,this.array[u+1]=a,this.array[u+2]=d,this},setXYZW:function(u,s,a,d,f){return this.array[0+(u*=this.itemSize)]=s,this.array[u+1]=a,this.array[u+2]=d,this.array[u+3]=f,this},onUpload:function(u){return this.onUploadCallback=u,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(Mu.prototype=Object.create(Ke.prototype)).constructor=Mu,(Fp.prototype=Object.create(Ke.prototype)).constructor=Fp,(ph.prototype=Object.create(Ke.prototype)).constructor=ph,(mh.prototype=Object.create(Ke.prototype)).constructor=mh,(hc.prototype=Object.create(Ke.prototype)).constructor=hc,(Su.prototype=Object.create(Ke.prototype)).constructor=Su,(fc.prototype=Object.create(Ke.prototype)).constructor=fc,(gh.prototype=Object.create(Ke.prototype)).constructor=gh,gh.prototype.isFloat16BufferAttribute=!0,(pe.prototype=Object.create(Ke.prototype)).constructor=pe,(On.prototype=Object.create(Ke.prototype)).constructor=On;const Np={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Qi(u,s){return new Np[u](s)}let ub=0;const Vs=new Ht,So=new en,Cl=new W,ws=new Zn,Op=new Zn,Vr=new W;function jt(){Object.defineProperty(this,"id",{value:ub++}),this.uuid=Jt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}jt.prototype=Object.assign(Object.create(Yi.prototype),{constructor:jt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(u){return this.index=Array.isArray(u)?new(_h(u)>65535?fc:hc)(u,1):u,this},getAttribute:function(u){return this.attributes[u]},setAttribute:function(u,s){return this.attributes[u]=s,this},deleteAttribute:function(u){return delete this.attributes[u],this},hasAttribute:function(u){return void 0!==this.attributes[u]},addGroup:function(u,s,a=0){this.groups.push({start:u,count:s,materialIndex:a})},clearGroups:function(){this.groups=[]},setDrawRange:function(u,s){this.drawRange.start=u,this.drawRange.count=s},applyMatrix4:function(u){const s=this.attributes.position;void 0!==s&&(s.applyMatrix4(u),s.needsUpdate=!0);const a=this.attributes.normal;if(void 0!==a){const f=(new Ji).getNormalMatrix(u);a.applyNormalMatrix(f),a.needsUpdate=!0}const d=this.attributes.tangent;return void 0!==d&&(d.transformDirection(u),d.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(u){return Vs.makeRotationX(u),this.applyMatrix4(Vs),this},rotateY:function(u){return Vs.makeRotationY(u),this.applyMatrix4(Vs),this},rotateZ:function(u){return Vs.makeRotationZ(u),this.applyMatrix4(Vs),this},translate:function(u,s,a){return Vs.makeTranslation(u,s,a),this.applyMatrix4(Vs),this},scale:function(u,s,a){return Vs.makeScale(u,s,a),this.applyMatrix4(Vs),this},lookAt:function(u){return So.lookAt(u),So.updateMatrix(),this.applyMatrix4(So.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Cl).negate(),this.translate(Cl.x,Cl.y,Cl.z),this},setFromPoints:function(u){const s=[];for(let a=0,d=u.length;a<d;a++){const f=u[a];s.push(f.x,f.y,f.z||0)}return this.setAttribute("position",new pe(s,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Zn);const u=this.attributes.position,s=this.morphAttributes.position;if(u&&u.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new W(-1/0,-1/0,-1/0),new W(1/0,1/0,1/0));if(void 0!==u){if(this.boundingBox.setFromBufferAttribute(u),s)for(let a=0,d=s.length;a<d;a++)ws.setFromBufferAttribute(s[a]),this.morphTargetsRelative?(Vr.addVectors(this.boundingBox.min,ws.min),this.boundingBox.expandByPoint(Vr),Vr.addVectors(this.boundingBox.max,ws.max),this.boundingBox.expandByPoint(Vr)):(this.boundingBox.expandByPoint(ws.min),this.boundingBox.expandByPoint(ws.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new wl);const u=this.attributes.position,s=this.morphAttributes.position;if(u&&u.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new W,1/0);if(u){const a=this.boundingSphere.center;if(ws.setFromBufferAttribute(u),s)for(let f=0,m=s.length;f<m;f++)Op.setFromBufferAttribute(s[f]),this.morphTargetsRelative?(Vr.addVectors(ws.min,Op.min),ws.expandByPoint(Vr),Vr.addVectors(ws.max,Op.max),ws.expandByPoint(Vr)):(ws.expandByPoint(Op.min),ws.expandByPoint(Op.max));ws.getCenter(a);let d=0;for(let f=0,m=u.count;f<m;f++)Vr.fromBufferAttribute(u,f),d=Math.max(d,a.distanceToSquared(Vr));if(s)for(let f=0,m=s.length;f<m;f++){const _=s[f],v=this.morphTargetsRelative;for(let b=0,w=_.count;b<w;b++)Vr.fromBufferAttribute(_,b),v&&(Cl.fromBufferAttribute(u,b),Vr.add(Cl)),d=Math.max(d,a.distanceToSquared(Vr))}this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){const u=this.index,s=this.attributes;if(null===u||void 0===s.position||void 0===s.normal||void 0===s.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const a=u.array,d=s.position.array,f=s.normal.array,m=s.uv.array,_=d.length/3;void 0===s.tangent&&this.setAttribute("tangent",new Ke(new Float32Array(4*_),4));const v=s.tangent.array,b=[],w=[];for(let se=0;se<_;se++)b[se]=new W,w[se]=new W;const A=new W,E=new W,D=new W,R=new qe,I=new qe,F=new qe,V=new W,N=new W;function L(se,fe,we){A.fromArray(d,3*se),E.fromArray(d,3*fe),D.fromArray(d,3*we),R.fromArray(m,2*se),I.fromArray(m,2*fe),F.fromArray(m,2*we),E.sub(A),D.sub(A),I.sub(R),F.sub(R);const Ce=1/(I.x*F.y-F.x*I.y);!isFinite(Ce)||(V.copy(E).multiplyScalar(F.y).addScaledVector(D,-I.y).multiplyScalar(Ce),N.copy(D).multiplyScalar(I.x).addScaledVector(E,-F.x).multiplyScalar(Ce),b[se].add(V),b[fe].add(V),b[we].add(V),w[se].add(N),w[fe].add(N),w[we].add(N))}let j=this.groups;0===j.length&&(j=[{start:0,count:a.length}]);for(let se=0,fe=j.length;se<fe;++se){const we=j[se],Ce=we.start;for(let de=Ce,ve=Ce+we.count;de<ve;de+=3)L(a[de+0],a[de+1],a[de+2])}const G=new W,K=new W,H=new W,re=new W;function he(se){H.fromArray(f,3*se),re.copy(H);const fe=b[se];G.copy(fe),G.sub(H.multiplyScalar(H.dot(fe))).normalize(),K.crossVectors(re,fe);const Ce=K.dot(w[se])<0?-1:1;v[4*se]=G.x,v[4*se+1]=G.y,v[4*se+2]=G.z,v[4*se+3]=Ce}for(let se=0,fe=j.length;se<fe;++se){const we=j[se],Ce=we.start;for(let de=Ce,ve=Ce+we.count;de<ve;de+=3)he(a[de+0]),he(a[de+1]),he(a[de+2])}},computeVertexNormals:function(){const u=this.index,s=this.getAttribute("position");if(void 0!==s){let a=this.getAttribute("normal");if(void 0===a)a=new Ke(new Float32Array(3*s.count),3),this.setAttribute("normal",a);else for(let E=0,D=a.count;E<D;E++)a.setXYZ(E,0,0,0);const d=new W,f=new W,m=new W,_=new W,v=new W,b=new W,w=new W,A=new W;if(u)for(let E=0,D=u.count;E<D;E+=3){const R=u.getX(E+0),I=u.getX(E+1),F=u.getX(E+2);d.fromBufferAttribute(s,R),f.fromBufferAttribute(s,I),m.fromBufferAttribute(s,F),w.subVectors(m,f),A.subVectors(d,f),w.cross(A),_.fromBufferAttribute(a,R),v.fromBufferAttribute(a,I),b.fromBufferAttribute(a,F),_.add(w),v.add(w),b.add(w),a.setXYZ(R,_.x,_.y,_.z),a.setXYZ(I,v.x,v.y,v.z),a.setXYZ(F,b.x,b.y,b.z)}else for(let E=0,D=s.count;E<D;E+=3)d.fromBufferAttribute(s,E+0),f.fromBufferAttribute(s,E+1),m.fromBufferAttribute(s,E+2),w.subVectors(m,f),A.subVectors(d,f),w.cross(A),a.setXYZ(E+0,w.x,w.y,w.z),a.setXYZ(E+1,w.x,w.y,w.z),a.setXYZ(E+2,w.x,w.y,w.z);this.normalizeNormals(),a.needsUpdate=!0}},merge:function(u,s){if(!u||!u.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",u);void 0===s&&(s=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const a=this.attributes;for(const d in a){if(void 0===u.attributes[d])continue;const m=a[d].array,_=u.attributes[d],v=_.array,b=_.itemSize*s,w=Math.min(v.length,m.length-b);for(let A=0,E=b;A<w;A++,E++)m[E]=v[A]}return this},normalizeNormals:function(){const u=this.attributes.normal;for(let s=0,a=u.count;s<a;s++)Vr.fromBufferAttribute(u,s),Vr.normalize(),u.setXYZ(s,Vr.x,Vr.y,Vr.z)},toNonIndexed:function(){function u(_,v){const b=_.array,w=_.itemSize,A=_.normalized,E=new b.constructor(v.length*w);let D=0,R=0;for(let I=0,F=v.length;I<F;I++){D=v[I]*w;for(let V=0;V<w;V++)E[R++]=b[D++]}return new Ke(E,w,A)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const s=new jt,a=this.index.array,d=this.attributes;for(const _ in d){const b=u(d[_],a);s.setAttribute(_,b)}const f=this.morphAttributes;for(const _ in f){const v=[],b=f[_];for(let w=0,A=b.length;w<A;w++){const D=u(b[w],a);v.push(D)}s.morphAttributes[_]=v}s.morphTargetsRelative=this.morphTargetsRelative;const m=this.groups;for(let _=0,v=m.length;_<v;_++){const b=m[_];s.addGroup(b.start,b.count,b.materialIndex)}return s},toJSON:function(){const u={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(u.uuid=this.uuid,u.type=this.type,""!==this.name&&(u.name=this.name),Object.keys(this.userData).length>0&&(u.userData=this.userData),void 0!==this.parameters){const v=this.parameters;for(const b in v)void 0!==v[b]&&(u[b]=v[b]);return u}u.data={attributes:{}};const s=this.index;null!==s&&(u.data.index={type:s.array.constructor.name,array:Array.prototype.slice.call(s.array)});const a=this.attributes;for(const v in a){const b=a[v],w=b.toJSON(u.data);""!==b.name&&(w.name=b.name),u.data.attributes[v]=w}const d={};let f=!1;for(const v in this.morphAttributes){const b=this.morphAttributes[v],w=[];for(let A=0,E=b.length;A<E;A++){const D=b[A],R=D.toJSON(u.data);""!==D.name&&(R.name=D.name),w.push(R)}w.length>0&&(d[v]=w,f=!0)}f&&(u.data.morphAttributes=d,u.data.morphTargetsRelative=this.morphTargetsRelative);const m=this.groups;m.length>0&&(u.data.groups=JSON.parse(JSON.stringify(m)));const _=this.boundingSphere;return null!==_&&(u.data.boundingSphere={center:_.center.toArray(),radius:_.radius}),u},clone:function(){return(new jt).copy(this)},copy:function(u){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const s={};this.name=u.name;const a=u.index;null!==a&&this.setIndex(a.clone(s));const d=u.attributes;for(const b in d)this.setAttribute(b,d[b].clone(s));const f=u.morphAttributes;for(const b in f){const w=[],A=f[b];for(let E=0,D=A.length;E<D;E++)w.push(A[E].clone(s));this.morphAttributes[b]=w}this.morphTargetsRelative=u.morphTargetsRelative;const m=u.groups;for(let b=0,w=m.length;b<w;b++){const A=m[b];this.addGroup(A.start,A.count,A.materialIndex)}const _=u.boundingBox;null!==_&&(this.boundingBox=_.clone());const v=u.boundingSphere;return null!==v&&(this.boundingSphere=v.clone()),this.drawRange.start=u.drawRange.start,this.drawRange.count=u.drawRange.count,this.userData=u.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const yh=new Ht,br=new cc,Zo=new wl,Ka=new W,to=new W,us=new W,wy=new W,kp=new W,My=new W,Bp=new W,Eu=new W,Cu=new W,vh=new qe,Tu=new qe,Vp=new qe,Up=new W,Au=new W;function Ni(u=new jt,s=new cs){en.call(this),this.type="Mesh",this.geometry=u,this.material=s,this.updateMorphTargets()}function xh(u,s,a,d,f,m,_,v,b,w,A,E){Ka.fromBufferAttribute(f,w),to.fromBufferAttribute(f,A),us.fromBufferAttribute(f,E);const D=u.morphTargetInfluences;if(s.morphTargets&&m&&D){Bp.set(0,0,0),Eu.set(0,0,0),Cu.set(0,0,0);for(let I=0,F=m.length;I<F;I++){const V=D[I],N=m[I];0!==V&&(wy.fromBufferAttribute(N,w),kp.fromBufferAttribute(N,A),My.fromBufferAttribute(N,E),_?(Bp.addScaledVector(wy,V),Eu.addScaledVector(kp,V),Cu.addScaledVector(My,V)):(Bp.addScaledVector(wy.sub(Ka),V),Eu.addScaledVector(kp.sub(to),V),Cu.addScaledVector(My.sub(us),V)))}Ka.add(Bp),to.add(Eu),us.add(Cu)}u.isSkinnedMesh&&s.skinning&&(u.boneTransform(w,Ka),u.boneTransform(A,to),u.boneTransform(E,us));const R=function db(u,s,a,d,f,m,_,v){let b;if(b=s.side===X?d.intersectTriangle(_,m,f,!0,v):d.intersectTriangle(f,m,_,s.side!==Nt,v),null===b)return null;Au.copy(v),Au.applyMatrix4(u.matrixWorld);const w=a.ray.origin.distanceTo(Au);return w<a.near||w>a.far?null:{distance:w,point:Au.clone(),object:u}}(u,s,a,d,Ka,to,us,Up);if(R){v&&(vh.fromBufferAttribute(v,w),Tu.fromBufferAttribute(v,A),Vp.fromBufferAttribute(v,E),R.uv=xr.getUV(Up,Ka,to,us,vh,Tu,Vp,new qe)),b&&(vh.fromBufferAttribute(b,w),Tu.fromBufferAttribute(b,A),Vp.fromBufferAttribute(b,E),R.uv2=xr.getUV(Up,Ka,to,us,vh,Tu,Vp,new qe));const I={a:w,b:A,c:E,normal:new W,materialIndex:0};xr.getNormal(Ka,to,us,I.normal),R.face=I}return R}Ni.prototype=Object.assign(Object.create(en.prototype),{constructor:Ni,isMesh:!0,copy:function(u){return en.prototype.copy.call(this,u),void 0!==u.morphTargetInfluences&&(this.morphTargetInfluences=u.morphTargetInfluences.slice()),void 0!==u.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},u.morphTargetDictionary)),this.material=u.material,this.geometry=u.geometry,this},updateMorphTargets:function(){const u=this.geometry;if(u.isBufferGeometry){const s=u.morphAttributes,a=Object.keys(s);if(a.length>0){const d=s[a[0]];if(void 0!==d){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let f=0,m=d.length;f<m;f++){const _=d[f].name||String(f);this.morphTargetInfluences.push(0),this.morphTargetDictionary[_]=f}}}}else{const s=u.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(u,s){const a=this.geometry,d=this.material,f=this.matrixWorld;if(void 0===d||(null===a.boundingSphere&&a.computeBoundingSphere(),Zo.copy(a.boundingSphere),Zo.applyMatrix4(f),!1===u.ray.intersectsSphere(Zo))||(yh.copy(f).invert(),br.copy(u.ray).applyMatrix4(yh),null!==a.boundingBox&&!1===br.intersectsBox(a.boundingBox)))return;let m;if(a.isBufferGeometry){const _=a.index,v=a.attributes.position,b=a.morphAttributes.position,w=a.morphTargetsRelative,A=a.attributes.uv,E=a.attributes.uv2,D=a.groups,R=a.drawRange;if(null!==_)if(Array.isArray(d))for(let I=0,F=D.length;I<F;I++){const V=D[I],N=d[V.materialIndex];for(let G=Math.max(V.start,R.start),K=Math.min(V.start+V.count,R.start+R.count);G<K;G+=3){const H=_.getX(G),re=_.getX(G+1),he=_.getX(G+2);m=xh(this,N,u,br,v,b,w,A,E,H,re,he),m&&(m.faceIndex=Math.floor(G/3),m.face.materialIndex=V.materialIndex,s.push(m))}}else for(let V=Math.max(0,R.start),N=Math.min(_.count,R.start+R.count);V<N;V+=3){const L=_.getX(V),j=_.getX(V+1),G=_.getX(V+2);m=xh(this,d,u,br,v,b,w,A,E,L,j,G),m&&(m.faceIndex=Math.floor(V/3),s.push(m))}else if(void 0!==v)if(Array.isArray(d))for(let I=0,F=D.length;I<F;I++){const V=D[I],N=d[V.materialIndex];for(let G=Math.max(V.start,R.start),K=Math.min(V.start+V.count,R.start+R.count);G<K;G+=3)m=xh(this,N,u,br,v,b,w,A,E,G,G+1,G+2),m&&(m.faceIndex=Math.floor(G/3),m.face.materialIndex=V.materialIndex,s.push(m))}else for(let V=Math.max(0,R.start),N=Math.min(v.count,R.start+R.count);V<N;V+=3)m=xh(this,d,u,br,v,b,w,A,E,V,V+1,V+2),m&&(m.faceIndex=Math.floor(V/3),s.push(m))}else a.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});class Tl extends jt{constructor(s=1,a=1,d=1,f=1,m=1,_=1){super(),this.type="BoxGeometry",this.parameters={width:s,height:a,depth:d,widthSegments:f,heightSegments:m,depthSegments:_};const v=this;f=Math.floor(f),m=Math.floor(m),_=Math.floor(_);const b=[],w=[],A=[],E=[];let D=0,R=0;function I(F,V,N,L,j,G,K,H,re,he,se){const fe=G/re,we=K/he,Ce=G/2,be=K/2,de=H/2,ve=re+1,Ae=he+1;let He=0,Ze=0;const bt=new W;for(let Ot=0;Ot<Ae;Ot++){const It=Ot*we-be;for(let kn=0;kn<ve;kn++)bt[F]=(kn*fe-Ce)*L,bt[V]=It*j,bt[N]=de,w.push(bt.x,bt.y,bt.z),bt[F]=0,bt[V]=0,bt[N]=H>0?1:-1,A.push(bt.x,bt.y,bt.z),E.push(kn/re),E.push(1-Ot/he),He+=1}for(let Ot=0;Ot<he;Ot++)for(let It=0;It<re;It++){const fn=D+It+ve*(Ot+1),Li=D+(It+1)+ve*(Ot+1),oi=D+(It+1)+ve*Ot;b.push(D+It+ve*Ot,fn,oi),b.push(fn,Li,oi),Ze+=6}v.addGroup(R,Ze,se),R+=Ze,D+=He}I("z","y","x",-1,-1,d,a,s,_,m,0),I("z","y","x",1,-1,d,a,-s,_,m,1),I("x","z","y",1,1,s,d,a,f,_,2),I("x","z","y",1,-1,s,d,-a,f,_,3),I("x","y","z",1,-1,s,a,d,f,m,4),I("x","y","z",-1,-1,s,a,-d,f,m,5),this.setIndex(b),this.setAttribute("position",new pe(w,3)),this.setAttribute("normal",new pe(A,3)),this.setAttribute("uv",new pe(E,2))}}function Al(u){const s={};for(const a in u){s[a]={};for(const d in u[a]){const f=u[a][d];s[a][d]=f&&(f.isColor||f.isMatrix3||f.isMatrix4||f.isVector2||f.isVector3||f.isVector4||f.isTexture||f.isQuaternion)?f.clone():Array.isArray(f)?f.slice():f}}return s}function ds(u){const s={};for(let a=0;a<u.length;a++){const d=Al(u[a]);for(const f in d)s[f]=d[f]}return s}const hb={clone:Al,merge:ds};function Yn(u){Wn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==u&&(void 0!==u.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(u))}function Rl(){en.call(this),this.type="Camera",this.matrixWorldInverse=new Ht,this.projectionMatrix=new Ht,this.projectionMatrixInverse=new Ht}function wr(u=50,s=1,a=.1,d=2e3){Rl.call(this),this.type="PerspectiveCamera",this.fov=u,this.zoom=1,this.near=a,this.far=d,this.focus=10,this.aspect=s,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}(Yn.prototype=Object.create(Wn.prototype)).constructor=Yn,Yn.prototype.isShaderMaterial=!0,Yn.prototype.copy=function(u){return Wn.prototype.copy.call(this,u),this.fragmentShader=u.fragmentShader,this.vertexShader=u.vertexShader,this.uniforms=Al(u.uniforms),this.defines=Object.assign({},u.defines),this.wireframe=u.wireframe,this.wireframeLinewidth=u.wireframeLinewidth,this.lights=u.lights,this.clipping=u.clipping,this.skinning=u.skinning,this.morphTargets=u.morphTargets,this.morphNormals=u.morphNormals,this.extensions=Object.assign({},u.extensions),this.glslVersion=u.glslVersion,this},Yn.prototype.toJSON=function(u){const s=Wn.prototype.toJSON.call(this,u);s.glslVersion=this.glslVersion,s.uniforms={};for(const d in this.uniforms){const m=this.uniforms[d].value;s.uniforms[d]=m&&m.isTexture?{type:"t",value:m.toJSON(u).uuid}:m&&m.isColor?{type:"c",value:m.getHex()}:m&&m.isVector2?{type:"v2",value:m.toArray()}:m&&m.isVector3?{type:"v3",value:m.toArray()}:m&&m.isVector4?{type:"v4",value:m.toArray()}:m&&m.isMatrix3?{type:"m3",value:m.toArray()}:m&&m.isMatrix4?{type:"m4",value:m.toArray()}:{value:m}}Object.keys(this.defines).length>0&&(s.defines=this.defines),s.vertexShader=this.vertexShader,s.fragmentShader=this.fragmentShader;const a={};for(const d in this.extensions)!0===this.extensions[d]&&(a[d]=!0);return Object.keys(a).length>0&&(s.extensions=a),s},Rl.prototype=Object.assign(Object.create(en.prototype),{constructor:Rl,isCamera:!0,copy:function(u,s){return en.prototype.copy.call(this,u,s),this.matrixWorldInverse.copy(u.matrixWorldInverse),this.projectionMatrix.copy(u.projectionMatrix),this.projectionMatrixInverse.copy(u.projectionMatrixInverse),this},getWorldDirection:function(u){void 0===u&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),u=new W),this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return u.set(-s[8],-s[9],-s[10]).normalize()},updateMatrixWorld:function(u){en.prototype.updateMatrixWorld.call(this,u),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(u,s){en.prototype.updateWorldMatrix.call(this,u,s),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),wr.prototype=Object.assign(Object.create(Rl.prototype),{constructor:wr,isPerspectiveCamera:!0,copy:function(u,s){return Rl.prototype.copy.call(this,u,s),this.fov=u.fov,this.zoom=u.zoom,this.near=u.near,this.far=u.far,this.focus=u.focus,this.aspect=u.aspect,this.view=null===u.view?null:Object.assign({},u.view),this.filmGauge=u.filmGauge,this.filmOffset=u.filmOffset,this},setFocalLength:function(u){const s=.5*this.getFilmHeight()/u;this.fov=2*Jt.RAD2DEG*Math.atan(s),this.updateProjectionMatrix()},getFocalLength:function(){const u=Math.tan(.5*Jt.DEG2RAD*this.fov);return.5*this.getFilmHeight()/u},getEffectiveFOV:function(){return 2*Jt.RAD2DEG*Math.atan(Math.tan(.5*Jt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(u,s,a,d,f,m){this.aspect=u/s,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=u,this.view.fullHeight=s,this.view.offsetX=a,this.view.offsetY=d,this.view.width=f,this.view.height=m,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const u=this.near;let s=u*Math.tan(.5*Jt.DEG2RAD*this.fov)/this.zoom,a=2*s,d=this.aspect*a,f=-.5*d;const m=this.view;if(null!==this.view&&this.view.enabled){const v=m.fullWidth,b=m.fullHeight;f+=m.offsetX*d/v,s-=m.offsetY*a/b,d*=m.width/v,a*=m.height/b}const _=this.filmOffset;0!==_&&(f+=u*_/this.getFilmWidth()),this.projectionMatrix.makePerspective(f,f+d,s,s-a,u,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(u){const s=en.prototype.toJSON.call(this,u);return s.object.fov=this.fov,s.object.zoom=this.zoom,s.object.near=this.near,s.object.far=this.far,s.object.focus=this.focus,s.object.aspect=this.aspect,null!==this.view&&(s.object.view=Object.assign({},this.view)),s.object.filmGauge=this.filmGauge,s.object.filmOffset=this.filmOffset,s}});class zp extends en{constructor(s,a,d){if(super(),this.type="CubeCamera",!0!==d.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=d;const f=new wr(90,1,s,a);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new W(1,0,0)),this.add(f);const m=new wr(90,1,s,a);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new W(-1,0,0)),this.add(m);const _=new wr(90,1,s,a);_.layers=this.layers,_.up.set(0,0,1),_.lookAt(new W(0,1,0)),this.add(_);const v=new wr(90,1,s,a);v.layers=this.layers,v.up.set(0,0,-1),v.lookAt(new W(0,-1,0)),this.add(v);const b=new wr(90,1,s,a);b.layers=this.layers,b.up.set(0,-1,0),b.lookAt(new W(0,0,1)),this.add(b);const w=new wr(90,1,s,a);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new W(0,0,-1)),this.add(w)}update(s,a){null===this.parent&&this.updateMatrixWorld();const d=this.renderTarget,[f,m,_,v,b,w]=this.children,A=s.xr.enabled,E=s.getRenderTarget();s.xr.enabled=!1;const D=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,s.setRenderTarget(d,0),s.render(a,f),s.setRenderTarget(d,1),s.render(a,m),s.setRenderTarget(d,2),s.render(a,_),s.setRenderTarget(d,3),s.render(a,v),s.setRenderTarget(d,4),s.render(a,b),d.texture.generateMipmaps=D,s.setRenderTarget(d,5),s.render(a,w),s.setRenderTarget(E),s.xr.enabled=A}}class Iu extends Rr{constructor(s,a,d,f,m,_,v,b,w,A){super(s=void 0!==s?s:[],a=void 0!==a?a:gp,d,f,m,_,v=void 0!==v?v:ss,b,w,A),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(s){this.image=s}}Iu.prototype.isCubeTexture=!0;class pc extends rn{constructor(s,a,d){Number.isInteger(a)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),a=d),super(s,s,a),this.texture=new Iu(void 0,(a=a||{}).mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,this.texture.minFilter=void 0!==a.minFilter?a.minFilter:fr,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(s,a){this.texture.type=a.type,this.texture.format=Xs,this.texture.encoding=a.encoding,this.texture.generateMipmaps=a.generateMipmaps,this.texture.minFilter=a.minFilter,this.texture.magFilter=a.magFilter;const d_uniforms={tEquirect:{value:null}},d_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",d_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",f=new Tl(5,5,5),m=new Yn({name:"CubemapFromEquirect",uniforms:Al(d_uniforms),vertexShader:d_vertexShader,fragmentShader:d_fragmentShader,side:X,blending:yr});m.uniforms.tEquirect.value=a;const _=new Ni(f,m),v=a.minFilter;return a.minFilter===oc&&(a.minFilter=fr),new zp(1,10,this).update(s,_),a.minFilter=v,_.geometry.dispose(),_.material.dispose(),this}clear(s,a,d,f){const m=s.getRenderTarget();for(let _=0;_<6;_++)s.setRenderTarget(this,_),s.clear(a,d,f);s.setRenderTarget(m)}}pc.prototype.isWebGLCubeRenderTarget=!0;class Qa extends Rr{constructor(s,a,d,f,m,_,v,b,w,A,E,D){super(null,_,v,b,w,A,f,m,E,D),this.image={data:s||null,width:a||1,height:d||1},this.magFilter=void 0!==w?w:kr,this.minFilter=void 0!==A?A:kr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Qa.prototype.isDataTexture=!0;const el=new wl,Lu=new W;class Pu{constructor(s=new $o,a=new $o,d=new $o,f=new $o,m=new $o,_=new $o){this.planes=[s,a,d,f,m,_]}set(s,a,d,f,m,_){const v=this.planes;return v[0].copy(s),v[1].copy(a),v[2].copy(d),v[3].copy(f),v[4].copy(m),v[5].copy(_),this}copy(s){const a=this.planes;for(let d=0;d<6;d++)a[d].copy(s.planes[d]);return this}setFromProjectionMatrix(s){const a=this.planes,d=s.elements,f=d[0],m=d[1],_=d[2],v=d[3],b=d[4],w=d[5],A=d[6],E=d[7],D=d[8],R=d[9],I=d[10],F=d[11],V=d[12],N=d[13],L=d[14],j=d[15];return a[0].setComponents(v-f,E-b,F-D,j-V).normalize(),a[1].setComponents(v+f,E+b,F+D,j+V).normalize(),a[2].setComponents(v+m,E+w,F+R,j+N).normalize(),a[3].setComponents(v-m,E-w,F-R,j-N).normalize(),a[4].setComponents(v-_,E-A,F-I,j-L).normalize(),a[5].setComponents(v+_,E+A,F+I,j+L).normalize(),this}intersectsObject(s){const a=s.geometry;return null===a.boundingSphere&&a.computeBoundingSphere(),el.copy(a.boundingSphere).applyMatrix4(s.matrixWorld),this.intersectsSphere(el)}intersectsSprite(s){return el.center.set(0,0,0),el.radius=.7071067811865476,el.applyMatrix4(s.matrixWorld),this.intersectsSphere(el)}intersectsSphere(s){const a=this.planes,d=s.center,f=-s.radius;for(let m=0;m<6;m++)if(a[m].distanceToPoint(d)<f)return!1;return!0}intersectsBox(s){const a=this.planes;for(let d=0;d<6;d++){const f=a[d];if(Lu.x=f.normal.x>0?s.max.x:s.min.x,Lu.y=f.normal.y>0?s.max.y:s.min.y,Lu.z=f.normal.z>0?s.max.z:s.min.z,f.distanceToPoint(Lu)<0)return!1}return!0}containsPoint(s){const a=this.planes;for(let d=0;d<6;d++)if(a[d].distanceToPoint(s)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function fb(){let u=null,s=!1,a=null,d=null;function f(m,_){a(m,_),d=u.requestAnimationFrame(f)}return{start:function(){!0!==s&&null!==a&&(d=u.requestAnimationFrame(f),s=!0)},stop:function(){u.cancelAnimationFrame(d),s=!1},setAnimationLoop:function(m){a=m},setContext:function(m){u=m}}}function Il(u,s){const a=s.isWebGL2,d=new WeakMap;return{get:function _(w){return w.isInterleavedBufferAttribute&&(w=w.data),d.get(w)},remove:function v(w){w.isInterleavedBufferAttribute&&(w=w.data);const A=d.get(w);A&&(u.deleteBuffer(A.buffer),d.delete(w))},update:function b(w,A){if(w.isGLBufferAttribute){const D=d.get(w);return void((!D||D.version<w.version)&&d.set(w,{buffer:w.buffer,type:w.type,bytesPerElement:w.elementSize,version:w.version}))}w.isInterleavedBufferAttribute&&(w=w.data);const E=d.get(w);void 0===E?d.set(w,function f(w,A){const E=w.array,D=w.usage,R=u.createBuffer();u.bindBuffer(A,R),u.bufferData(A,E,D),w.onUploadCallback();let I=5126;return E instanceof Float32Array?I=5126:E instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):E instanceof Uint16Array?w.isFloat16BufferAttribute?a?I=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):I=5123:E instanceof Int16Array?I=5122:E instanceof Uint32Array?I=5125:E instanceof Int32Array?I=5124:E instanceof Int8Array?I=5120:E instanceof Uint8Array&&(I=5121),{buffer:R,type:I,bytesPerElement:E.BYTES_PER_ELEMENT,version:w.version}}(w,A)):E.version<w.version&&(function m(w,A,E){const D=A.array,R=A.updateRange;u.bindBuffer(E,w),-1===R.count?u.bufferSubData(E,0,D):(a?u.bufferSubData(E,R.offset*D.BYTES_PER_ELEMENT,D,R.offset,R.count):u.bufferSubData(E,R.offset*D.BYTES_PER_ELEMENT,D.subarray(R.offset,R.offset+R.count)),R.count=-1)}(E.buffer,w,A),E.version=w.version)}}}class tl extends jt{constructor(s=1,a=1,d=1,f=1){super(),this.type="PlaneGeometry",this.parameters={width:s,height:a,widthSegments:d,heightSegments:f};const m=s/2,_=a/2,v=Math.floor(d),b=Math.floor(f),w=v+1,A=b+1,E=s/v,D=a/b,R=[],I=[],F=[],V=[];for(let N=0;N<A;N++){const L=N*D-_;for(let j=0;j<w;j++)I.push(j*E-m,-L,0),F.push(0,0,1),V.push(j/v),V.push(1-N/b)}for(let N=0;N<b;N++)for(let L=0;L<v;L++){const G=L+w*(N+1),K=L+1+w*(N+1),H=L+1+w*N;R.push(L+w*N,G,H),R.push(G,K,H)}this.setIndex(R),this.setAttribute("position",new pe(I,3)),this.setAttribute("normal",new pe(F,3)),this.setAttribute("uv",new pe(V,2))}}const Un={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor.xyz *= color.xyz;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},mt={common:{diffuse:{value:new At(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ji},uv2Transform:{value:new Ji},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new qe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new At(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new At(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ji}},sprite:{diffuse:{value:new At(15658734)},opacity:{value:1},center:{value:new qe(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ji}}},Yo={basic:{uniforms:ds([mt.common,mt.specularmap,mt.envmap,mt.aomap,mt.lightmap,mt.fog]),vertexShader:Un.meshbasic_vert,fragmentShader:Un.meshbasic_frag},lambert:{uniforms:ds([mt.common,mt.specularmap,mt.envmap,mt.aomap,mt.lightmap,mt.emissivemap,mt.fog,mt.lights,{emissive:{value:new At(0)}}]),vertexShader:Un.meshlambert_vert,fragmentShader:Un.meshlambert_frag},phong:{uniforms:ds([mt.common,mt.specularmap,mt.envmap,mt.aomap,mt.lightmap,mt.emissivemap,mt.bumpmap,mt.normalmap,mt.displacementmap,mt.fog,mt.lights,{emissive:{value:new At(0)},specular:{value:new At(1118481)},shininess:{value:30}}]),vertexShader:Un.meshphong_vert,fragmentShader:Un.meshphong_frag},standard:{uniforms:ds([mt.common,mt.envmap,mt.aomap,mt.lightmap,mt.emissivemap,mt.bumpmap,mt.normalmap,mt.displacementmap,mt.roughnessmap,mt.metalnessmap,mt.fog,mt.lights,{emissive:{value:new At(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Un.meshphysical_vert,fragmentShader:Un.meshphysical_frag},toon:{uniforms:ds([mt.common,mt.aomap,mt.lightmap,mt.emissivemap,mt.bumpmap,mt.normalmap,mt.displacementmap,mt.gradientmap,mt.fog,mt.lights,{emissive:{value:new At(0)}}]),vertexShader:Un.meshtoon_vert,fragmentShader:Un.meshtoon_frag},matcap:{uniforms:ds([mt.common,mt.bumpmap,mt.normalmap,mt.displacementmap,mt.fog,{matcap:{value:null}}]),vertexShader:Un.meshmatcap_vert,fragmentShader:Un.meshmatcap_frag},points:{uniforms:ds([mt.points,mt.fog]),vertexShader:Un.points_vert,fragmentShader:Un.points_frag},dashed:{uniforms:ds([mt.common,mt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Un.linedashed_vert,fragmentShader:Un.linedashed_frag},depth:{uniforms:ds([mt.common,mt.displacementmap]),vertexShader:Un.depth_vert,fragmentShader:Un.depth_frag},normal:{uniforms:ds([mt.common,mt.bumpmap,mt.normalmap,mt.displacementmap,{opacity:{value:1}}]),vertexShader:Un.normal_vert,fragmentShader:Un.normal_frag},sprite:{uniforms:ds([mt.sprite,mt.fog]),vertexShader:Un.sprite_vert,fragmentShader:Un.sprite_frag},background:{uniforms:{uvTransform:{value:new Ji},t2D:{value:null}},vertexShader:Un.background_vert,fragmentShader:Un.background_frag},cube:{uniforms:ds([mt.envmap,{opacity:{value:1}}]),vertexShader:Un.cube_vert,fragmentShader:Un.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Un.equirect_vert,fragmentShader:Un.equirect_frag},distanceRGBA:{uniforms:ds([mt.common,mt.displacementmap,{referencePosition:{value:new W},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Un.distanceRGBA_vert,fragmentShader:Un.distanceRGBA_frag},shadow:{uniforms:ds([mt.lights,mt.fog,{color:{value:new At(0)},opacity:{value:1}}]),vertexShader:Un.shadow_vert,fragmentShader:Un.shadow_frag}};function xP(u,s,a,d,f){const m=new At(0);let v,b,_=0,w=null,A=0,E=null;function R(I,F){a.buffers.color.setClear(I.r,I.g,I.b,F,f)}return{getClearColor:function(){return m},setClearColor:function(I,F=1){m.set(I),_=F,R(m,_)},getClearAlpha:function(){return _},setClearAlpha:function(I){_=I,R(m,_)},render:function D(I,F,V,N){let L=!0===F.isScene?F.background:null;L&&L.isTexture&&(L=s.get(L));const j=u.xr,G=j.getSession&&j.getSession();G&&"additive"===G.environmentBlendMode&&(L=null),null===L?R(m,_):L&&L.isColor&&(R(L,1),N=!0),(u.autoClear||N)&&u.clear(u.autoClearColor,u.autoClearDepth,u.autoClearStencil),L&&(L.isCubeTexture||L.isWebGLCubeRenderTarget||L.mapping===ou)?(void 0===b&&(b=new Ni(new Tl(1,1,1),new Yn({name:"BackgroundCubeMaterial",uniforms:Al(Yo.cube.uniforms),vertexShader:Yo.cube.vertexShader,fragmentShader:Yo.cube.fragmentShader,side:X,depthTest:!1,depthWrite:!1,fog:!1})),b.geometry.deleteAttribute("normal"),b.geometry.deleteAttribute("uv"),b.onBeforeRender=function(K,H,re){this.matrixWorld.copyPosition(re.matrixWorld)},Object.defineProperty(b.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),d.update(b)),L.isWebGLCubeRenderTarget&&(L=L.texture),b.material.uniforms.envMap.value=L,b.material.uniforms.flipEnvMap.value=L.isCubeTexture&&L._needsFlipEnvMap?-1:1,(w!==L||A!==L.version||E!==u.toneMapping)&&(b.material.needsUpdate=!0,w=L,A=L.version,E=u.toneMapping),I.unshift(b,b.geometry,b.material,0,0,null)):L&&L.isTexture&&(void 0===v&&(v=new Ni(new tl(2,2),new Yn({name:"BackgroundMaterial",uniforms:Al(Yo.background.uniforms),vertexShader:Yo.background.vertexShader,fragmentShader:Yo.background.fragmentShader,side:hn,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),Object.defineProperty(v.material,"map",{get:function(){return this.uniforms.t2D.value}}),d.update(v)),v.material.uniforms.t2D.value=L,!0===L.matrixAutoUpdate&&L.updateMatrix(),v.material.uniforms.uvTransform.value.copy(L.matrix),(w!==L||A!==L.version||E!==u.toneMapping)&&(v.material.needsUpdate=!0,w=L,A=L.version,E=u.toneMapping),I.unshift(v,v.geometry,v.material,0,0,null))}}}function VT(u,s,a,d){const f=u.getParameter(34921),m=d.isWebGL2?null:s.get("OES_vertex_array_object"),_=d.isWebGL2||null!==m,v={},b=F(null);let w=b;function D(be){return d.isWebGL2?u.bindVertexArray(be):m.bindVertexArrayOES(be)}function R(be){return d.isWebGL2?u.deleteVertexArray(be):m.deleteVertexArrayOES(be)}function F(be){const de=[],ve=[],Ae=[];for(let He=0;He<f;He++)de[He]=0,ve[He]=0,Ae[He]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:de,enabledAttributes:ve,attributeDivisors:Ae,object:be,attributes:{},index:null}}function L(){const be=w.newAttributes;for(let de=0,ve=be.length;de<ve;de++)be[de]=0}function j(be){G(be,0)}function G(be,de){const Ae=w.enabledAttributes,He=w.attributeDivisors;w.newAttributes[be]=1,0===Ae[be]&&(u.enableVertexAttribArray(be),Ae[be]=1),He[be]!==de&&((d.isWebGL2?u:s.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](be,de),He[be]=de)}function K(){const be=w.newAttributes,de=w.enabledAttributes;for(let ve=0,Ae=de.length;ve<Ae;ve++)de[ve]!==be[ve]&&(u.disableVertexAttribArray(ve),de[ve]=0)}function H(be,de,ve,Ae,He,Ze){!0!==d.isWebGL2||5124!==ve&&5125!==ve?u.vertexAttribPointer(be,de,ve,Ae,He,Ze):u.vertexAttribIPointer(be,de,ve,He,Ze)}function we(){Ce(),w!==b&&(w=b,D(w.object))}function Ce(){b.geometry=null,b.program=null,b.wireframe=!1}return{setup:function A(be,de,ve,Ae,He){let Ze=!1;if(_){const bt=function I(be,de,ve){const Ae=!0===ve.wireframe;let He=v[be.id];void 0===He&&(He={},v[be.id]=He);let Ze=He[de.id];void 0===Ze&&(Ze={},He[de.id]=Ze);let bt=Ze[Ae];return void 0===bt&&(bt=F(function E(){return d.isWebGL2?u.createVertexArray():m.createVertexArrayOES()}()),Ze[Ae]=bt),bt}(Ae,ve,de);w!==bt&&(w=bt,D(w.object)),Ze=function V(be,de){const ve=w.attributes,Ae=be.attributes;let He=0;for(const Ze in Ae){const bt=ve[Ze],Ot=Ae[Ze];if(void 0===bt||bt.attribute!==Ot||bt.data!==Ot.data)return!0;He++}return w.attributesNum!==He||w.index!==de}(Ae,He),Ze&&function N(be,de){const ve={},Ae=be.attributes;let He=0;for(const Ze in Ae){const bt=Ae[Ze],Ot={};Ot.attribute=bt,bt.data&&(Ot.data=bt.data),ve[Ze]=Ot,He++}w.attributes=ve,w.attributesNum=He,w.index=de}(Ae,He)}else{const bt=!0===de.wireframe;(w.geometry!==Ae.id||w.program!==ve.id||w.wireframe!==bt)&&(w.geometry=Ae.id,w.program=ve.id,w.wireframe=bt,Ze=!0)}!0===be.isInstancedMesh&&(Ze=!0),null!==He&&a.update(He,34963),Ze&&(function re(be,de,ve,Ae){if(!1===d.isWebGL2&&(be.isInstancedMesh||Ae.isInstancedBufferGeometry)&&null===s.get("ANGLE_instanced_arrays"))return;L();const He=Ae.attributes,Ze=ve.getAttributes(),bt=de.defaultAttributeValues;for(const Ot in Ze){const It=Ze[Ot];if(It>=0){const kn=He[Ot];if(void 0!==kn){const fn=kn.normalized,Li=kn.itemSize,oi=a.get(kn);if(void 0===oi)continue;const Ue=oi.buffer,Gi=oi.type,ii=oi.bytesPerElement;if(kn.isInterleavedBufferAttribute){const yi=kn.data,pn=yi.stride,vi=kn.offset;yi&&yi.isInstancedInterleavedBuffer?(G(It,yi.meshPerAttribute),void 0===Ae._maxInstanceCount&&(Ae._maxInstanceCount=yi.meshPerAttribute*yi.count)):j(It),u.bindBuffer(34962,Ue),H(It,Li,Gi,fn,pn*ii,vi*ii)}else kn.isInstancedBufferAttribute?(G(It,kn.meshPerAttribute),void 0===Ae._maxInstanceCount&&(Ae._maxInstanceCount=kn.meshPerAttribute*kn.count)):j(It),u.bindBuffer(34962,Ue),H(It,Li,Gi,fn,0,0)}else if("instanceMatrix"===Ot){const fn=a.get(be.instanceMatrix);if(void 0===fn)continue;const Li=fn.buffer,oi=fn.type;G(It+0,1),G(It+1,1),G(It+2,1),G(It+3,1),u.bindBuffer(34962,Li),u.vertexAttribPointer(It+0,4,oi,!1,64,0),u.vertexAttribPointer(It+1,4,oi,!1,64,16),u.vertexAttribPointer(It+2,4,oi,!1,64,32),u.vertexAttribPointer(It+3,4,oi,!1,64,48)}else if("instanceColor"===Ot){const fn=a.get(be.instanceColor);if(void 0===fn)continue;const Li=fn.buffer,oi=fn.type;G(It,1),u.bindBuffer(34962,Li),u.vertexAttribPointer(It,3,oi,!1,12,0)}else if(void 0!==bt){const fn=bt[Ot];if(void 0!==fn)switch(fn.length){case 2:u.vertexAttrib2fv(It,fn);break;case 3:u.vertexAttrib3fv(It,fn);break;case 4:u.vertexAttrib4fv(It,fn);break;default:u.vertexAttrib1fv(It,fn)}}}}K()}(be,de,ve,Ae),null!==He&&u.bindBuffer(34963,a.get(He).buffer))},reset:we,resetDefaultState:Ce,dispose:function he(){we();for(const be in v){const de=v[be];for(const ve in de){const Ae=de[ve];for(const He in Ae)R(Ae[He].object),delete Ae[He];delete de[ve]}delete v[be]}},releaseStatesOfGeometry:function se(be){if(void 0===v[be.id])return;const de=v[be.id];for(const ve in de){const Ae=de[ve];for(const He in Ae)R(Ae[He].object),delete Ae[He];delete de[ve]}delete v[be.id]},releaseStatesOfProgram:function fe(be){for(const de in v){const ve=v[de];if(void 0===ve[be.id])continue;const Ae=ve[be.id];for(const He in Ae)R(Ae[He].object),delete Ae[He];delete ve[be.id]}},initAttributes:L,enableAttribute:j,disableUnusedAttributes:K}}function UT(u,s,a,d){const f=d.isWebGL2;let m;this.setMode=function _(w){m=w},this.render=function v(w,A){u.drawArrays(m,w,A),a.update(A,m,1)},this.renderInstances=function b(w,A,E){if(0===E)return;let D,R;if(f)D=u,R="drawArraysInstanced";else if(D=s.get("ANGLE_instanced_arrays"),R="drawArraysInstancedANGLE",null===D)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");D[R](m,w,A,E),a.update(A,m,E)}}function zT(u,s,a){let d;function m(H){if("highp"===H){if(u.getShaderPrecisionFormat(35633,36338).precision>0&&u.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";H="mediump"}return"mediump"===H&&u.getShaderPrecisionFormat(35633,36337).precision>0&&u.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const _="undefined"!=typeof WebGL2RenderingContext&&u instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&u instanceof WebGL2ComputeRenderingContext;let v=void 0!==a.precision?a.precision:"highp";const b=m(v);b!==v&&(console.warn("THREE.WebGLRenderer:",v,"not supported, using",b,"instead."),v=b);const w=!0===a.logarithmicDepthBuffer,A=u.getParameter(34930),E=u.getParameter(35660),D=u.getParameter(3379),R=u.getParameter(34076),I=u.getParameter(34921),F=u.getParameter(36347),V=u.getParameter(36348),N=u.getParameter(36349),L=E>0,j=_||s.has("OES_texture_float");return{isWebGL2:_,getMaxAnisotropy:function f(){if(void 0!==d)return d;if(!0===s.has("EXT_texture_filter_anisotropic")){const H=s.get("EXT_texture_filter_anisotropic");d=u.getParameter(H.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d},getMaxPrecision:m,precision:v,logarithmicDepthBuffer:w,maxTextures:A,maxVertexTextures:E,maxTextureSize:D,maxCubemapSize:R,maxAttributes:I,maxVertexUniforms:F,maxVaryings:V,maxFragmentUniforms:N,vertexTextures:L,floatFragmentTextures:j,floatVertexTextures:L&&j,maxSamples:_?u.getParameter(36183):0}}function Kp(u){const s=this;let a=null,d=0,f=!1,m=!1;const _=new $o,v=new Ji,b={value:null,needsUpdate:!1};function w(){b.value!==a&&(b.value=a,b.needsUpdate=d>0),s.numPlanes=d,s.numIntersection=0}function A(E,D,R,I){const F=null!==E?E.length:0;let V=null;if(0!==F){if(V=b.value,!0!==I||null===V){const N=R+4*F,L=D.matrixWorldInverse;v.getNormalMatrix(L),(null===V||V.length<N)&&(V=new Float32Array(N));for(let j=0,G=R;j!==F;++j,G+=4)_.copy(E[j]).applyMatrix4(L,v),_.normal.toArray(V,G),V[G+3]=_.constant}b.value=V,b.needsUpdate=!0}return s.numPlanes=F,s.numIntersection=0,V}this.uniform=b,this.numPlanes=0,this.numIntersection=0,this.init=function(E,D,R){const I=0!==E.length||D||0!==d||f;return f=D,a=A(E,R,0),d=E.length,I},this.beginShadows=function(){m=!0,A(null)},this.endShadows=function(){m=!1,w()},this.setState=function(E,D,R){const I=E.clippingPlanes,F=E.clipIntersection,V=E.clipShadows,N=u.get(E);if(!f||null===I||0===I.length||m&&!V)m?A(null):w();else{const L=m?0:d,j=4*L;let G=N.clippingState||null;b.value=G,G=A(I,D,j,R);for(let K=0;K!==j;++K)G[K]=a[K];N.clippingState=G,this.numIntersection=F?this.numPlanes:0,this.numPlanes+=L}}}function kb(u){let s=new WeakMap;function a(_,v){return v===X_?_.mapping=gp:v===_a&&(_.mapping=_p),_}function f(_){const v=_.target;v.removeEventListener("dispose",f);const b=s.get(v);void 0!==b&&(s.delete(v),b.dispose())}return{get:function d(_){if(_&&_.isTexture){const v=_.mapping;if(v===X_||v===_a){if(s.has(_))return a(s.get(_).texture,_.mapping);{const b=_.image;if(b&&b.height>0){const w=u.getRenderTarget(),A=new pc(b.height/2);return A.fromEquirectangularTexture(u,_),s.set(_,A),u.setRenderTarget(w),_.addEventListener("dispose",f),a(A.texture,_.mapping)}return null}}}return _},dispose:function m(){s=new WeakMap}}}function HT(u){const s={};function a(d){if(void 0!==s[d])return s[d];let f;switch(d){case"WEBGL_depth_texture":f=u.getExtension("WEBGL_depth_texture")||u.getExtension("MOZ_WEBGL_depth_texture")||u.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":f=u.getExtension("EXT_texture_filter_anisotropic")||u.getExtension("MOZ_EXT_texture_filter_anisotropic")||u.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":f=u.getExtension("WEBGL_compressed_texture_s3tc")||u.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||u.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":f=u.getExtension("WEBGL_compressed_texture_pvrtc")||u.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:f=u.getExtension(d)}return s[d]=f,f}return{has:function(d){return null!==a(d)},init:function(d){d.isWebGL2?a("EXT_color_buffer_float"):(a("WEBGL_depth_texture"),a("OES_texture_float"),a("OES_texture_half_float"),a("OES_texture_half_float_linear"),a("OES_standard_derivatives"),a("OES_element_index_uint"),a("OES_vertex_array_object"),a("ANGLE_instanced_arrays")),a("OES_texture_float_linear"),a("EXT_color_buffer_half_float")},get:function(d){const f=a(d);return null===f&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),f}}}function Bb(u,s,a,d){const f={},m=new WeakMap;function _(E){const D=E.target;null!==D.index&&s.remove(D.index);for(const I in D.attributes)s.remove(D.attributes[I]);D.removeEventListener("dispose",_),delete f[D.id];const R=m.get(D);R&&(s.remove(R),m.delete(D)),d.releaseStatesOfGeometry(D),!0===D.isInstancedBufferGeometry&&delete D._maxInstanceCount,a.memory.geometries--}function w(E){const D=[],R=E.index,I=E.attributes.position;let F=0;if(null!==R){const L=R.array;F=R.version;for(let j=0,G=L.length;j<G;j+=3){const K=L[j+0],H=L[j+1],re=L[j+2];D.push(K,H,H,re,re,K)}}else{F=I.version;for(let j=0,G=I.array.length/3-1;j<G;j+=3){const K=j+0,H=j+1,re=j+2;D.push(K,H,H,re,re,K)}}const V=new(_h(D)>65535?fc:hc)(D,1);V.version=F;const N=m.get(E);N&&s.remove(N),m.set(E,V)}return{get:function v(E,D){return!0===f[D.id]||(D.addEventListener("dispose",_),f[D.id]=!0,a.memory.geometries++),D},update:function b(E){const D=E.attributes;for(const I in D)s.update(D[I],34962);const R=E.morphAttributes;for(const I in R){const F=R[I];for(let V=0,N=F.length;V<N;V++)s.update(F[V],34962)}},getWireframeAttribute:function A(E){const D=m.get(E);if(D){const R=E.index;null!==R&&D.version<R.version&&w(E)}else w(E);return m.get(E)}}}function bP(u,s,a,d){const f=d.isWebGL2;let m,v,b;this.setMode=function _(D){m=D},this.setIndex=function w(D){v=D.type,b=D.bytesPerElement},this.render=function A(D,R){u.drawElements(m,R,v,D*b),a.update(R,m,1)},this.renderInstances=function E(D,R,I){if(0===I)return;let F,V;if(f)F=u,V="drawElementsInstanced";else if(F=s.get("ANGLE_instanced_arrays"),V="drawElementsInstancedANGLE",null===F)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");F[V](m,R,v,D*b,I),a.update(R,m,I)}}function Vb(u){const a={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:a,programs:null,autoReset:!0,reset:function f(){a.frame++,a.calls=0,a.triangles=0,a.points=0,a.lines=0},update:function d(m,_,v){switch(a.calls++,_){case 4:a.triangles+=v*(m/3);break;case 1:a.lines+=v*(m/2);break;case 3:a.lines+=v*(m-1);break;case 2:a.lines+=v*m;break;case 0:a.points+=v*m;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",_)}}}}function wP(u,s){return u[0]-s[0]}function Oy(u,s){return Math.abs(s[1])-Math.abs(u[1])}function GT(u){const s={},a=new Float32Array(8),d=[];for(let m=0;m<8;m++)d[m]=[m,0];return{update:function f(m,_,v,b){const w=m.morphTargetInfluences,A=void 0===w?0:w.length;let E=s[_.id];if(void 0===E){E=[];for(let V=0;V<A;V++)E[V]=[V,0];s[_.id]=E}for(let V=0;V<A;V++){const N=E[V];N[0]=V,N[1]=w[V]}E.sort(Oy);for(let V=0;V<8;V++)V<A&&E[V][1]?(d[V][0]=E[V][0],d[V][1]=E[V][1]):(d[V][0]=Number.MAX_SAFE_INTEGER,d[V][1]=0);d.sort(wP);const D=v.morphTargets&&_.morphAttributes.position,R=v.morphNormals&&_.morphAttributes.normal;let I=0;for(let V=0;V<8;V++){const N=d[V],L=N[0],j=N[1];L!==Number.MAX_SAFE_INTEGER&&j?(D&&_.getAttribute("morphTarget"+V)!==D[L]&&_.setAttribute("morphTarget"+V,D[L]),R&&_.getAttribute("morphNormal"+V)!==R[L]&&_.setAttribute("morphNormal"+V,R[L]),a[V]=j,I+=j):(D&&!0===_.hasAttribute("morphTarget"+V)&&_.deleteAttribute("morphTarget"+V),R&&!0===_.hasAttribute("morphNormal"+V)&&_.deleteAttribute("morphNormal"+V),a[V]=0)}const F=_.morphTargetsRelative?1:1-I;b.getUniforms().setValue(u,"morphTargetBaseInfluence",F),b.getUniforms().setValue(u,"morphTargetInfluences",a)}}}function Ub(u,s,a,d){let f=new WeakMap;function v(b){const w=b.target;w.removeEventListener("dispose",v),a.remove(w.instanceMatrix),null!==w.instanceColor&&a.remove(w.instanceColor)}return{update:function m(b){const w=d.render.frame,E=s.get(b,b.geometry);return f.get(E)!==w&&(s.update(E),f.set(E,w)),b.isInstancedMesh&&(!1===b.hasEventListener("dispose",v)&&b.addEventListener("dispose",v),a.update(b.instanceMatrix,34962),null!==b.instanceColor&&a.update(b.instanceColor,34962)),E},dispose:function _(){f=new WeakMap}}}Yo.physical={uniforms:ds([Yo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new qe(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new At(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Un.meshphysical_vert,fragmentShader:Un.meshphysical_frag};class ju extends Rr{constructor(s=null,a=1,d=1,f=1){super(null),this.image={data:s,width:a,height:d,depth:f},this.magFilter=kr,this.minFilter=kr,this.wrapR=Rs,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}ju.prototype.isDataTexture2DArray=!0;class Lh extends Rr{constructor(s=null,a=1,d=1,f=1){super(null),this.image={data:s,width:a,height:d,depth:f},this.magFilter=kr,this.minFilter=kr,this.wrapR=Rs,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}Lh.prototype.isDataTexture3D=!0;const mc=new Rr,WT=new ju,jT=new Lh,qT=new Iu,Ph=[],Qp=[],ky=new Float32Array(16),By=new Float32Array(9),Vy=new Float32Array(4);function Co(u,s,a){const d=u[0];if(d<=0||d>0)return u;const f=s*a;let m=Ph[f];if(void 0===m&&(m=new Float32Array(f),Ph[f]=m),0!==s){d.toArray(m,0);for(let _=1,v=0;_!==s;++_)v+=a,u[_].toArray(m,v)}return m}function To(u,s){if(u.length!==s.length)return!1;for(let a=0,d=u.length;a<d;a++)if(u[a]!==s[a])return!1;return!0}function ro(u,s){for(let a=0,d=s.length;a<d;a++)u[a]=s[a]}function zb(u,s){let a=Qp[s];void 0===a&&(a=new Int32Array(s),Qp[s]=a);for(let d=0;d!==s;++d)a[d]=u.allocateTextureUnit();return a}function $T(u,s){const a=this.cache;a[0]!==s&&(u.uniform1f(this.addr,s),a[0]=s)}function XT(u,s){const a=this.cache;if(void 0!==s.x)(a[0]!==s.x||a[1]!==s.y)&&(u.uniform2f(this.addr,s.x,s.y),a[0]=s.x,a[1]=s.y);else{if(To(a,s))return;u.uniform2fv(this.addr,s),ro(a,s)}}function so(u,s){const a=this.cache;if(void 0!==s.x)(a[0]!==s.x||a[1]!==s.y||a[2]!==s.z)&&(u.uniform3f(this.addr,s.x,s.y,s.z),a[0]=s.x,a[1]=s.y,a[2]=s.z);else if(void 0!==s.r)(a[0]!==s.r||a[1]!==s.g||a[2]!==s.b)&&(u.uniform3f(this.addr,s.r,s.g,s.b),a[0]=s.r,a[1]=s.g,a[2]=s.b);else{if(To(a,s))return;u.uniform3fv(this.addr,s),ro(a,s)}}function Ea(u,s){const a=this.cache;if(void 0!==s.x)(a[0]!==s.x||a[1]!==s.y||a[2]!==s.z||a[3]!==s.w)&&(u.uniform4f(this.addr,s.x,s.y,s.z,s.w),a[0]=s.x,a[1]=s.y,a[2]=s.z,a[3]=s.w);else{if(To(a,s))return;u.uniform4fv(this.addr,s),ro(a,s)}}function ZT(u,s){const a=this.cache,d=s.elements;if(void 0===d){if(To(a,s))return;u.uniformMatrix2fv(this.addr,!1,s),ro(a,s)}else{if(To(a,d))return;Vy.set(d),u.uniformMatrix2fv(this.addr,!1,Vy),ro(a,d)}}function YT(u,s){const a=this.cache,d=s.elements;if(void 0===d){if(To(a,s))return;u.uniformMatrix3fv(this.addr,!1,s),ro(a,s)}else{if(To(a,d))return;By.set(d),u.uniformMatrix3fv(this.addr,!1,By),ro(a,d)}}function JT(u,s){const a=this.cache,d=s.elements;if(void 0===d){if(To(a,s))return;u.uniformMatrix4fv(this.addr,!1,s),ro(a,s)}else{if(To(a,d))return;ky.set(d),u.uniformMatrix4fv(this.addr,!1,ky),ro(a,d)}}function KT(u,s,a){const d=this.cache,f=a.allocateTextureUnit();d[0]!==f&&(u.uniform1i(this.addr,f),d[0]=f),a.safeSetTexture2D(s||mc,f)}function QT(u,s,a){const d=this.cache,f=a.allocateTextureUnit();d[0]!==f&&(u.uniform1i(this.addr,f),d[0]=f),a.setTexture2DArray(s||WT,f)}function e1(u,s,a){const d=this.cache,f=a.allocateTextureUnit();d[0]!==f&&(u.uniform1i(this.addr,f),d[0]=f),a.setTexture3D(s||jT,f)}function Hb(u,s,a){const d=this.cache,f=a.allocateTextureUnit();d[0]!==f&&(u.uniform1i(this.addr,f),d[0]=f),a.safeSetTextureCube(s||qT,f)}function t1(u,s){const a=this.cache;a[0]!==s&&(u.uniform1i(this.addr,s),a[0]=s)}function n1(u,s){const a=this.cache;To(a,s)||(u.uniform2iv(this.addr,s),ro(a,s))}function r1(u,s){const a=this.cache;To(a,s)||(u.uniform3iv(this.addr,s),ro(a,s))}function s1(u,s){const a=this.cache;To(a,s)||(u.uniform4iv(this.addr,s),ro(a,s))}function MP(u,s){const a=this.cache;a[0]!==s&&(u.uniform1ui(this.addr,s),a[0]=s)}function Fh(u,s){u.uniform1fv(this.addr,s)}function Gb(u,s){u.uniform1iv(this.addr,s)}function Ca(u,s){u.uniform2iv(this.addr,s)}function Nh(u,s){u.uniform3iv(this.addr,s)}function Wb(u,s){u.uniform4iv(this.addr,s)}function jb(u,s){const a=Co(s,this.size,2);u.uniform2fv(this.addr,a)}function qb(u,s){const a=Co(s,this.size,3);u.uniform3fv(this.addr,a)}function SP(u,s){const a=Co(s,this.size,4);u.uniform4fv(this.addr,a)}function EP(u,s){const a=Co(s,this.size,4);u.uniformMatrix2fv(this.addr,!1,a)}function CP(u,s){const a=Co(s,this.size,9);u.uniformMatrix3fv(this.addr,!1,a)}function Uy(u,s){const a=Co(s,this.size,16);u.uniformMatrix4fv(this.addr,!1,a)}function zy(u,s,a){const d=s.length,f=zb(a,d);u.uniform1iv(this.addr,f);for(let m=0;m!==d;++m)a.safeSetTexture2D(s[m]||mc,f[m])}function Hy(u,s,a){const d=s.length,f=zb(a,d);u.uniform1iv(this.addr,f);for(let m=0;m!==d;++m)a.safeSetTextureCube(s[m]||qT,f[m])}function AP(u,s,a){this.id=u,this.addr=a,this.cache=[],this.setValue=function o1(u){switch(u){case 5126:return $T;case 35664:return XT;case 35665:return so;case 35666:return Ea;case 35674:return ZT;case 35675:return YT;case 35676:return JT;case 5124:case 35670:return t1;case 35667:case 35671:return n1;case 35668:case 35672:return r1;case 35669:case 35673:return s1;case 5125:return MP;case 35678:case 36198:case 36298:case 36306:case 35682:return KT;case 35679:case 36299:case 36307:return e1;case 35680:case 36300:case 36308:case 36293:return Hb;case 36289:case 36303:case 36311:case 36292:return QT}}(s.type)}function Gy(u,s,a){this.id=u,this.addr=a,this.cache=[],this.size=s.size,this.setValue=function TP(u){switch(u){case 5126:return Fh;case 35664:return jb;case 35665:return qb;case 35666:return SP;case 35674:return EP;case 35675:return CP;case 35676:return Uy;case 5124:case 35670:return Gb;case 35667:case 35671:return Ca;case 35668:case 35672:return Nh;case 35669:case 35673:return Wb;case 35678:case 36198:case 36298:case 36306:case 35682:return zy;case 35680:case 36300:case 36308:case 36293:return Hy}}(s.type)}function $b(u){this.id=u,this.seq=[],this.map={}}Gy.prototype.updateCache=function(u){const s=this.cache;u instanceof Float32Array&&s.length!==u.length&&(this.cache=new Float32Array(u.length)),ro(s,u)},$b.prototype.setValue=function(u,s,a){const d=this.seq;for(let f=0,m=d.length;f!==m;++f){const _=d[f];_.setValue(u,s[_.id],a)}};const Wy=/(\w+)(\])?(\[|\.)?/g;function Xb(u,s){u.seq.push(s),u.map[s.id]=s}function a1(u,s,a){const d=u.name,f=d.length;for(Wy.lastIndex=0;;){const m=Wy.exec(d),_=Wy.lastIndex;let v=m[1];const w=m[3];if("]"===m[2]&&(v|=0),void 0===w||"["===w&&_+2===f){Xb(a,void 0===w?new AP(v,u,s):new Gy(v,u,s));break}{let E=a.map[v];void 0===E&&(E=new $b(v),Xb(a,E)),a=E}}}function il(u,s){this.seq=[],this.map={};const a=u.getProgramParameter(s,35718);for(let d=0;d<a;++d){const f=u.getActiveUniform(s,d);a1(f,u.getUniformLocation(s,f.name),this)}}function Oh(u,s,a){const d=u.createShader(s);return u.shaderSource(d,a),u.compileShader(d),d}il.prototype.setValue=function(u,s,a,d){const f=this.map[s];void 0!==f&&f.setValue(u,a,d)},il.prototype.setOptional=function(u,s,a){const d=s[a];void 0!==d&&this.setValue(u,a,d)},il.upload=function(u,s,a,d){for(let f=0,m=s.length;f!==m;++f){const _=s[f],v=a[_.id];!1!==v.needsUpdate&&_.setValue(u,v.value,d)}},il.seqWithValue=function(u,s){const a=[];for(let d=0,f=u.length;d!==f;++d){const m=u[d];m.id in s&&a.push(m)}return a};let Zb=0;function Yb(u){switch(u){case os:return["Linear","( value )"];case yl:return["sRGB","( value )"];case lh:return["RGBE","( value )"];case Yt:return["RGBM","( value, 7.0 )"];case ch:return["RGBM","( value, 16.0 )"];case hy:return["RGBD","( value, 256.0 )"];case pu:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Jx:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",u),["Linear","( value )"]}}function di(u,s,a){const d=u.getShaderParameter(s,35713),f=u.getShaderInfoLog(s).trim();return d&&""===f?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+a+"\n"+f+function jy(u){const s=u.split("\n");for(let a=0;a<s.length;a++)s[a]=a+1+": "+s[a];return s.join("\n")}(u.getShaderSource(s))}function kh(u,s){const a=Yb(s);return"vec4 "+u+"( vec4 value ) { return "+a[0]+"ToLinear"+a[1]+"; }"}function l1(u,s){const a=Yb(s);return"vec4 "+u+"( vec4 value ) { return LinearTo"+a[0]+a[1]+"; }"}function qy(u,s){let a;switch(s){case Bx:a="Linear";break;case BC:a="Reinhard";break;case q_:a="OptimizedCineon";break;case VC:a="ACESFilmic";break;case $_:a="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",s),a="Linear"}return"vec3 "+u+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}function Bh(u){return""!==u}function Kb(u,s){return u.replace(/NUM_DIR_LIGHTS/g,s.numDirLights).replace(/NUM_SPOT_LIGHTS/g,s.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,s.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,s.numPointLights).replace(/NUM_HEMI_LIGHTS/g,s.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,s.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,s.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,s.numPointLightShadows)}function Qb(u,s){return u.replace(/NUM_CLIPPING_PLANES/g,s.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,s.numClippingPlanes-s.numClipIntersection)}const DP=/^[ \t]*#include +<([\w\d./]+)>/gm;function ew(u){return u.replace(DP,Vh)}function Vh(u,s){const a=Un[s];if(void 0===a)throw new Error("Can not resolve #include <"+s+">");return ew(a)}const $y=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,tw=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Xy(u){return u.replace(tw,iw).replace($y,nw)}function nw(u,s,a,d){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),iw(0,s,a,d)}function iw(u,s,a,d){let f="";for(let m=parseInt(s);m<parseInt(a);m++)f+=d.replace(/\[\s*i\s*\]/g,"[ "+m+" ]").replace(/UNROLLED_LOOP_INDEX/g,m);return f}function Zy(u){let s="precision "+u.precision+" float;\nprecision "+u.precision+" int;";return"highp"===u.precision?s+="\n#define HIGH_PRECISION":"mediump"===u.precision?s+="\n#define MEDIUM_PRECISION":"lowp"===u.precision&&(s+="\n#define LOW_PRECISION"),s}function Jy(u,s,a,d){const f=u.getContext(),m=a.defines;let _=a.vertexShader,v=a.fragmentShader;const b=function rw(u){let s="SHADOWMAP_TYPE_BASIC";return u.shadowMapType===Mt?s="SHADOWMAP_TYPE_PCF":u.shadowMapType===ht?s="SHADOWMAP_TYPE_PCF_SOFT":u.shadowMapType===Nn&&(s="SHADOWMAP_TYPE_VSM"),s}(a),w=function Yy(u){let s="ENVMAP_TYPE_CUBE";if(u.envMap)switch(u.envMapMode){case gp:case _p:s="ENVMAP_TYPE_CUBE";break;case ou:case yp:s="ENVMAP_TYPE_CUBE_UV"}return s}(a),A=function RP(u){let s="ENVMAP_MODE_REFLECTION";if(u.envMap)switch(u.envMapMode){case _p:case yp:s="ENVMAP_MODE_REFRACTION"}return s}(a),E=function d1(u){let s="ENVMAP_BLENDING_NONE";if(u.envMap)switch(u.combine){case pp:s="ENVMAP_BLENDING_MULTIPLY";break;case OC:s="ENVMAP_BLENDING_MIX";break;case kC:s="ENVMAP_BLENDING_ADD"}return s}(a),D=u.gammaFactor>0?u.gammaFactor:1,R=a.isWebGL2?"":function Jb(u){return[u.extensionDerivatives||u.envMapCubeUV||u.bumpMap||u.tangentSpaceNormalMap||u.clearcoatNormalMap||u.flatShading||"physical"===u.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(u.extensionFragDepth||u.logarithmicDepthBuffer)&&u.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",u.extensionDrawBuffers&&u.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(u.extensionShaderTextureLOD||u.envMap)&&u.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Bh).join("\n")}(a),I=function c1(u){const s=[];for(const a in u){const d=u[a];!1!==d&&s.push("#define "+a+" "+d)}return s.join("\n")}(m),F=f.createProgram();let V,N,L=a.glslVersion?"#version "+a.glslVersion+"\n":"";a.isRawShaderMaterial?(V=[I].filter(Bh).join("\n"),V.length>0&&(V+="\n"),N=[R,I].filter(Bh).join("\n"),N.length>0&&(N+="\n")):(V=[Zy(a),"#define SHADER_NAME "+a.shaderName,I,a.instancing?"#define USE_INSTANCING":"",a.instancingColor?"#define USE_INSTANCING_COLOR":"",a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+D,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+A:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+b:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Bh).join("\n"),N=[R,Zy(a),"#define SHADER_NAME "+a.shaderName,I,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+D,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+w:"",a.envMap?"#define "+A:"",a.envMap?"#define "+E:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatMap?"#define USE_CLEARCOATMAP":"",a.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.sheen?"#define USE_SHEEN":"",a.transmissionMap?"#define USE_TRANSMISSIONMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors||a.instancingColor?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+b:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",a.toneMapping!==su?"#define TONE_MAPPING":"",a.toneMapping!==su?Un.tonemapping_pars_fragment:"",a.toneMapping!==su?qy("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",Un.encodings_pars_fragment,a.map?kh("mapTexelToLinear",a.mapEncoding):"",a.matcap?kh("matcapTexelToLinear",a.matcapEncoding):"",a.envMap?kh("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMap?kh("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.lightMap?kh("lightMapTexelToLinear",a.lightMapEncoding):"",l1("linearToOutputTexel",a.outputEncoding),a.depthPacking?"#define DEPTH_PACKING "+a.depthPacking:"","\n"].filter(Bh).join("\n")),_=ew(_),_=Kb(_,a),_=Qb(_,a),v=ew(v),v=Kb(v,a),v=Qb(v,a),_=Xy(_),v=Xy(v),a.isWebGL2&&!0!==a.isRawShaderMaterial&&(L="#version 300 es\n",V=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+V,N=["#define varying in",a.glslVersion===gi?"":"out highp vec4 pc_fragColor;",a.glslVersion===gi?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+N);const G=L+N+v,K=Oh(f,35633,L+V+_),H=Oh(f,35632,G);if(f.attachShader(F,K),f.attachShader(F,H),void 0!==a.index0AttributeName?f.bindAttribLocation(F,0,a.index0AttributeName):!0===a.morphTargets&&f.bindAttribLocation(F,0,"position"),f.linkProgram(F),u.debug.checkShaderErrors){const se=f.getProgramInfoLog(F).trim(),fe=f.getShaderInfoLog(K).trim(),we=f.getShaderInfoLog(H).trim();let Ce=!0,be=!0;if(!1===f.getProgramParameter(F,35714)){Ce=!1;const de=di(f,K,"vertex"),ve=di(f,H,"fragment");console.error("THREE.WebGLProgram: shader error: ",f.getError(),"35715",f.getProgramParameter(F,35715),"gl.getProgramInfoLog",se,de,ve)}else""!==se?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",se):(""===fe||""===we)&&(be=!1);be&&(this.diagnostics={runnable:Ce,programLog:se,vertexShader:{log:fe,prefix:V},fragmentShader:{log:we,prefix:N}})}let re,he;return f.deleteShader(K),f.deleteShader(H),this.getUniforms=function(){return void 0===re&&(re=new il(f,F)),re},this.getAttributes=function(){return void 0===he&&(he=function u1(u,s){const a={},d=u.getProgramParameter(s,35721);for(let f=0;f<d;f++){const _=u.getActiveAttrib(s,f).name;a[_]=u.getAttribLocation(s,_)}return a}(f,F)),he},this.destroy=function(){d.releaseStatesOfProgram(this),f.deleteProgram(F),this.program=void 0},this.name=a.shaderName,this.id=Zb++,this.cacheKey=s,this.usedTimes=1,this.program=F,this.vertexShader=K,this.fragmentShader=H,this}function sw(u,s,a,d,f,m){const _=[],v=d.isWebGL2,b=d.logarithmicDepthBuffer,w=d.floatVertexTextures,A=d.maxVertexUniforms,E=d.vertexTextures;let D=d.precision;const R={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},I=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function V(H){let re;return H&&H.isTexture?re=H.encoding:H&&H.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),re=H.texture.encoding):re=os,re}return{getParameters:function N(H,re,he,se,fe){const we=se.fog,be=s.get(H.envMap||(H.isMeshStandardMaterial?se.environment:null)),de=R[H.type],ve=fe.isSkinnedMesh?function F(H){const he=H.skeleton.bones;if(w)return 1024;{const fe=Math.floor((A-20)/4),we=Math.min(fe,he.length);return we<he.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+he.length+" bones. This GPU supports "+we+"."),0):we}}(fe):0;let Ae,He;if(null!==H.precision&&(D=d.getMaxPrecision(H.precision),D!==H.precision&&console.warn("THREE.WebGLProgram.getParameters:",H.precision,"not supported, using",D,"instead.")),de){const Ot=Yo[de];Ae=Ot.vertexShader,He=Ot.fragmentShader}else Ae=H.vertexShader,He=H.fragmentShader;const Ze=u.getRenderTarget();return{isWebGL2:v,shaderID:de,shaderName:H.type,vertexShader:Ae,fragmentShader:He,defines:H.defines,isRawShaderMaterial:!0===H.isRawShaderMaterial,glslVersion:H.glslVersion,precision:D,instancing:!0===fe.isInstancedMesh,instancingColor:!0===fe.isInstancedMesh&&null!==fe.instanceColor,supportsVertexTextures:E,outputEncoding:null!==Ze?V(Ze.texture):u.outputEncoding,map:!!H.map,mapEncoding:V(H.map),matcap:!!H.matcap,matcapEncoding:V(H.matcap),envMap:!!be,envMapMode:be&&be.mapping,envMapEncoding:V(be),envMapCubeUV:!!be&&(be.mapping===ou||be.mapping===yp),lightMap:!!H.lightMap,lightMapEncoding:V(H.lightMap),aoMap:!!H.aoMap,emissiveMap:!!H.emissiveMap,emissiveMapEncoding:V(H.emissiveMap),bumpMap:!!H.bumpMap,normalMap:!!H.normalMap,objectSpaceNormalMap:H.normalMapType===ja,tangentSpaceNormalMap:H.normalMapType===mu,clearcoatMap:!!H.clearcoatMap,clearcoatRoughnessMap:!!H.clearcoatRoughnessMap,clearcoatNormalMap:!!H.clearcoatNormalMap,displacementMap:!!H.displacementMap,roughnessMap:!!H.roughnessMap,metalnessMap:!!H.metalnessMap,specularMap:!!H.specularMap,alphaMap:!!H.alphaMap,gradientMap:!!H.gradientMap,sheen:!!H.sheen,transmissionMap:!!H.transmissionMap,combine:H.combine,vertexTangents:H.normalMap&&H.vertexTangents,vertexColors:H.vertexColors,vertexUvs:!!(H.map||H.bumpMap||H.normalMap||H.specularMap||H.alphaMap||H.emissiveMap||H.roughnessMap||H.metalnessMap||H.clearcoatMap||H.clearcoatRoughnessMap||H.clearcoatNormalMap||H.displacementMap||H.transmissionMap),uvsVertexOnly:!(H.map||H.bumpMap||H.normalMap||H.specularMap||H.alphaMap||H.emissiveMap||H.roughnessMap||H.metalnessMap||H.clearcoatNormalMap||H.transmissionMap||!H.displacementMap),fog:!!we,useFog:H.fog,fogExp2:we&&we.isFogExp2,flatShading:!!H.flatShading,sizeAttenuation:H.sizeAttenuation,logarithmicDepthBuffer:b,skinning:H.skinning&&ve>0,maxBones:ve,useVertexTexture:w,morphTargets:H.morphTargets,morphNormals:H.morphNormals,maxMorphTargets:u.maxMorphTargets,maxMorphNormals:u.maxMorphNormals,numDirLights:re.directional.length,numPointLights:re.point.length,numSpotLights:re.spot.length,numRectAreaLights:re.rectArea.length,numHemiLights:re.hemi.length,numDirLightShadows:re.directionalShadowMap.length,numPointLightShadows:re.pointShadowMap.length,numSpotLightShadows:re.spotShadowMap.length,numClippingPlanes:m.numPlanes,numClipIntersection:m.numIntersection,dithering:H.dithering,shadowMapEnabled:u.shadowMap.enabled&&he.length>0,shadowMapType:u.shadowMap.type,toneMapping:H.toneMapped?u.toneMapping:su,physicallyCorrectLights:u.physicallyCorrectLights,premultipliedAlpha:H.premultipliedAlpha,alphaTest:H.alphaTest,doubleSided:H.side===Nt,flipSided:H.side===X,depthPacking:void 0!==H.depthPacking&&H.depthPacking,index0AttributeName:H.index0AttributeName,extensionDerivatives:H.extensions&&H.extensions.derivatives,extensionFragDepth:H.extensions&&H.extensions.fragDepth,extensionDrawBuffers:H.extensions&&H.extensions.drawBuffers,extensionShaderTextureLOD:H.extensions&&H.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||a.has("EXT_frag_depth"),rendererExtensionDrawBuffers:v||a.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||a.has("EXT_shader_texture_lod"),customProgramCacheKey:H.customProgramCacheKey()}},getProgramCacheKey:function L(H){const re=[];if(H.shaderID?re.push(H.shaderID):(re.push(H.fragmentShader),re.push(H.vertexShader)),void 0!==H.defines)for(const he in H.defines)re.push(he),re.push(H.defines[he]);if(!1===H.isRawShaderMaterial){for(let he=0;he<I.length;he++)re.push(H[I[he]]);re.push(u.outputEncoding),re.push(u.gammaFactor)}return re.push(H.customProgramCacheKey),re.join()},getUniforms:function j(H){const re=R[H.type];let he;return he=re?hb.clone(Yo[re].uniforms):H.uniforms,he},acquireProgram:function G(H,re){let he;for(let se=0,fe=_.length;se<fe;se++){const we=_[se];if(we.cacheKey===re){he=we,++he.usedTimes;break}}return void 0===he&&(he=new Jy(u,re,H,f),_.push(he)),he},releaseProgram:function K(H){if(0==--H.usedTimes){const re=_.indexOf(H);_[re]=_[_.length-1],_.pop(),H.destroy()}},programs:_}}function ow(){let u=new WeakMap;return{get:function s(m){let _=u.get(m);return void 0===_&&(_={},u.set(m,_)),_},remove:function a(m){u.delete(m)},update:function d(m,_,v){u.get(m)[_]=v},dispose:function f(){u=new WeakMap}}}function gc(u,s){return u.groupOrder!==s.groupOrder?u.groupOrder-s.groupOrder:u.renderOrder!==s.renderOrder?u.renderOrder-s.renderOrder:u.program!==s.program?u.program.id-s.program.id:u.material.id!==s.material.id?u.material.id-s.material.id:u.z!==s.z?u.z-s.z:u.id-s.id}function h1(u,s){return u.groupOrder!==s.groupOrder?u.groupOrder-s.groupOrder:u.renderOrder!==s.renderOrder?u.renderOrder-s.renderOrder:u.z!==s.z?s.z-u.z:u.id-s.id}function em(u){const s=[];let a=0;const d=[],f=[],m={id:-1};function v(D,R,I,F,V,N){let L=s[a];const j=u.get(I);return void 0===L?(L={id:D.id,object:D,geometry:R,material:I,program:j.program||m,groupOrder:F,renderOrder:D.renderOrder,z:V,group:N},s[a]=L):(L.id=D.id,L.object=D,L.geometry=R,L.material=I,L.program=j.program||m,L.groupOrder=F,L.renderOrder=D.renderOrder,L.z=V,L.group=N),a++,L}return{opaque:d,transparent:f,init:function _(){a=0,d.length=0,f.length=0},push:function b(D,R,I,F,V,N){const L=v(D,R,I,F,V,N);(!0===I.transparent?f:d).push(L)},unshift:function w(D,R,I,F,V,N){const L=v(D,R,I,F,V,N);(!0===I.transparent?f:d).unshift(L)},finish:function E(){for(let D=a,R=s.length;D<R;D++){const I=s[D];if(null===I.id)break;I.id=null,I.object=null,I.geometry=null,I.material=null,I.program=null,I.group=null}},sort:function A(D,R){d.length>1&&d.sort(D||gc),f.length>1&&f.sort(R||h1)}}}function tm(u){let s=new WeakMap;return{get:function a(f,m){let _;return!1===s.has(f)?(_=new em(u),s.set(f,[_])):m>=s.get(f).length?(_=new em(u),s.get(f).push(_)):_=s.get(f)[m],_},dispose:function d(){s=new WeakMap}}}function f1(){const u={};return{get:function(s){if(void 0!==u[s.id])return u[s.id];let a;switch(s.type){case"DirectionalLight":a={direction:new W,color:new At};break;case"SpotLight":a={position:new W,direction:new W,color:new At,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":a={position:new W,color:new At,distance:0,decay:0};break;case"HemisphereLight":a={direction:new W,skyColor:new At,groundColor:new At};break;case"RectAreaLight":a={color:new At,position:new W,halfWidth:new W,halfHeight:new W}}return u[s.id]=a,a}}}let nm=0;function Pl(u,s){return(s.castShadow?1:0)-(u.castShadow?1:0)}function aw(u,s){const a=new f1,d=function Ky(){const u={};return{get:function(s){if(void 0!==u[s.id])return u[s.id];let a;switch(s.type){case"DirectionalLight":case"SpotLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe};break;case"PointLight":a={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new qe,shadowCameraNear:1,shadowCameraFar:1e3}}return u[s.id]=a,a}}}(),f={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let A=0;A<9;A++)f.probe.push(new W);const m=new W,_=new Ht,v=new Ht;return{setup:function b(A){let E=0,D=0,R=0;for(let re=0;re<9;re++)f.probe[re].set(0,0,0);let I=0,F=0,V=0,N=0,L=0,j=0,G=0,K=0;A.sort(Pl);for(let re=0,he=A.length;re<he;re++){const se=A[re],fe=se.color,we=se.intensity,Ce=se.distance,be=se.shadow&&se.shadow.map?se.shadow.map.texture:null;if(se.isAmbientLight)E+=fe.r*we,D+=fe.g*we,R+=fe.b*we;else if(se.isLightProbe)for(let de=0;de<9;de++)f.probe[de].addScaledVector(se.sh.coefficients[de],we);else if(se.isDirectionalLight){const de=a.get(se);if(de.color.copy(se.color).multiplyScalar(se.intensity),se.castShadow){const ve=se.shadow,Ae=d.get(se);Ae.shadowBias=ve.bias,Ae.shadowNormalBias=ve.normalBias,Ae.shadowRadius=ve.radius,Ae.shadowMapSize=ve.mapSize,f.directionalShadow[I]=Ae,f.directionalShadowMap[I]=be,f.directionalShadowMatrix[I]=se.shadow.matrix,j++}f.directional[I]=de,I++}else if(se.isSpotLight){const de=a.get(se);if(de.position.setFromMatrixPosition(se.matrixWorld),de.color.copy(fe).multiplyScalar(we),de.distance=Ce,de.coneCos=Math.cos(se.angle),de.penumbraCos=Math.cos(se.angle*(1-se.penumbra)),de.decay=se.decay,se.castShadow){const ve=se.shadow,Ae=d.get(se);Ae.shadowBias=ve.bias,Ae.shadowNormalBias=ve.normalBias,Ae.shadowRadius=ve.radius,Ae.shadowMapSize=ve.mapSize,f.spotShadow[V]=Ae,f.spotShadowMap[V]=be,f.spotShadowMatrix[V]=se.shadow.matrix,K++}f.spot[V]=de,V++}else if(se.isRectAreaLight){const de=a.get(se);de.color.copy(fe).multiplyScalar(we),de.halfWidth.set(.5*se.width,0,0),de.halfHeight.set(0,.5*se.height,0),f.rectArea[N]=de,N++}else if(se.isPointLight){const de=a.get(se);if(de.color.copy(se.color).multiplyScalar(se.intensity),de.distance=se.distance,de.decay=se.decay,se.castShadow){const ve=se.shadow,Ae=d.get(se);Ae.shadowBias=ve.bias,Ae.shadowNormalBias=ve.normalBias,Ae.shadowRadius=ve.radius,Ae.shadowMapSize=ve.mapSize,Ae.shadowCameraNear=ve.camera.near,Ae.shadowCameraFar=ve.camera.far,f.pointShadow[F]=Ae,f.pointShadowMap[F]=be,f.pointShadowMatrix[F]=se.shadow.matrix,G++}f.point[F]=de,F++}else if(se.isHemisphereLight){const de=a.get(se);de.skyColor.copy(se.color).multiplyScalar(we),de.groundColor.copy(se.groundColor).multiplyScalar(we),f.hemi[L]=de,L++}}N>0&&(s.isWebGL2||!0===u.has("OES_texture_float_linear")?(f.rectAreaLTC1=mt.LTC_FLOAT_1,f.rectAreaLTC2=mt.LTC_FLOAT_2):!0===u.has("OES_texture_half_float_linear")?(f.rectAreaLTC1=mt.LTC_HALF_1,f.rectAreaLTC2=mt.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),f.ambient[0]=E,f.ambient[1]=D,f.ambient[2]=R;const H=f.hash;(H.directionalLength!==I||H.pointLength!==F||H.spotLength!==V||H.rectAreaLength!==N||H.hemiLength!==L||H.numDirectionalShadows!==j||H.numPointShadows!==G||H.numSpotShadows!==K)&&(f.directional.length=I,f.spot.length=V,f.rectArea.length=N,f.point.length=F,f.hemi.length=L,f.directionalShadow.length=j,f.directionalShadowMap.length=j,f.pointShadow.length=G,f.pointShadowMap.length=G,f.spotShadow.length=K,f.spotShadowMap.length=K,f.directionalShadowMatrix.length=j,f.pointShadowMatrix.length=G,f.spotShadowMatrix.length=K,H.directionalLength=I,H.pointLength=F,H.spotLength=V,H.rectAreaLength=N,H.hemiLength=L,H.numDirectionalShadows=j,H.numPointShadows=G,H.numSpotShadows=K,f.version=nm++)},setupView:function w(A,E){let D=0,R=0,I=0,F=0,V=0;const N=E.matrixWorldInverse;for(let L=0,j=A.length;L<j;L++){const G=A[L];if(G.isDirectionalLight){const K=f.directional[D];K.direction.setFromMatrixPosition(G.matrixWorld),m.setFromMatrixPosition(G.target.matrixWorld),K.direction.sub(m),K.direction.transformDirection(N),D++}else if(G.isSpotLight){const K=f.spot[I];K.position.setFromMatrixPosition(G.matrixWorld),K.position.applyMatrix4(N),K.direction.setFromMatrixPosition(G.matrixWorld),m.setFromMatrixPosition(G.target.matrixWorld),K.direction.sub(m),K.direction.transformDirection(N),I++}else if(G.isRectAreaLight){const K=f.rectArea[F];K.position.setFromMatrixPosition(G.matrixWorld),K.position.applyMatrix4(N),v.identity(),_.copy(G.matrixWorld),_.premultiply(N),v.extractRotation(_),K.halfWidth.set(.5*G.width,0,0),K.halfHeight.set(0,.5*G.height,0),K.halfWidth.applyMatrix4(v),K.halfHeight.applyMatrix4(v),F++}else if(G.isPointLight){const K=f.point[R];K.position.setFromMatrixPosition(G.matrixWorld),K.position.applyMatrix4(N),R++}else if(G.isHemisphereLight){const K=f.hemi[V];K.direction.setFromMatrixPosition(G.matrixWorld),K.direction.transformDirection(N),K.direction.normalize(),V++}}},state:f}}function im(u,s){const a=new aw(u,s),d=[],f=[];return{init:function m(){d.length=0,f.length=0},state:{lightsArray:d,shadowsArray:f,lights:a},setupLights:function b(){a.setup(d)},setupLightsView:function w(E){a.setupView(d,E)},pushLight:function _(E){d.push(E)},pushShadow:function v(E){f.push(E)}}}function p1(u,s){let a=new WeakMap;return{get:function d(m,_=0){let v;return!1===a.has(m)?(v=new im(u,s),a.set(m,[v])):_>=a.get(m).length?(v=new im(u,s),a.get(m).push(v)):v=a.get(m)[_],v},dispose:function f(){a=new WeakMap}}}class rm extends Wn{constructor(s){super(),this.type="MeshDepthMaterial",this.depthPacking=Zs,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(s)}copy(s){return super.copy(s),this.depthPacking=s.depthPacking,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this}}rm.prototype.isMeshDepthMaterial=!0;class Uh extends Wn{constructor(s){super(),this.type="MeshDistanceMaterial",this.referencePosition=new W,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(s)}copy(s){return super.copy(s),this.referencePosition.copy(s.referencePosition),this.nearDistance=s.nearDistance,this.farDistance=s.farDistance,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this}}function lw(u,s,a){let d=new Pu;const f=new qe,m=new qe,_=new $e,v=[],b=[],w={},A={0:X,1:hn,2:Nt},E=new Yn({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new qe},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),D=E.clone();D.defines.HORIZONTAL_PASS=1;const R=new jt;R.setAttribute("position",new Ke(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new Ni(R,E),F=this;function V(K,H){const re=s.update(I);E.uniforms.shadow_pass.value=K.map.texture,E.uniforms.resolution.value=K.mapSize,E.uniforms.radius.value=K.radius,u.setRenderTarget(K.mapPass),u.clear(),u.renderBufferDirect(H,null,re,E,I,null),D.uniforms.shadow_pass.value=K.mapPass.texture,D.uniforms.resolution.value=K.mapSize,D.uniforms.radius.value=K.radius,u.setRenderTarget(K.map),u.clear(),u.renderBufferDirect(H,null,re,D,I,null)}function N(K,H,re){const he=K<<0|H<<1|re<<2;let se=v[he];return void 0===se&&(se=new rm({depthPacking:fy,morphTargets:K,skinning:H}),v[he]=se),se}function L(K,H,re){const he=K<<0|H<<1|re<<2;let se=b[he];return void 0===se&&(se=new Uh({morphTargets:K,skinning:H}),b[he]=se),se}function j(K,H,re,he,se,fe,we){let Ce=null,be=N,de=K.customDepthMaterial;if(!0===he.isPointLight&&(be=L,de=K.customDistanceMaterial),void 0===de){let ve=!1;!0===re.morphTargets&&(ve=H.morphAttributes&&H.morphAttributes.position&&H.morphAttributes.position.length>0);let Ae=!1;!0===K.isSkinnedMesh&&(!0===re.skinning?Ae=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",K)),Ce=be(ve,Ae,!0===K.isInstancedMesh)}else Ce=de;if(u.localClippingEnabled&&!0===re.clipShadows&&0!==re.clippingPlanes.length){const ve=Ce.uuid,Ae=re.uuid;let He=w[ve];void 0===He&&(He={},w[ve]=He);let Ze=He[Ae];void 0===Ze&&(Ze=Ce.clone(),He[Ae]=Ze),Ce=Ze}return Ce.visible=re.visible,Ce.wireframe=re.wireframe,Ce.side=we===Nn?null!==re.shadowSide?re.shadowSide:re.side:null!==re.shadowSide?re.shadowSide:A[re.side],Ce.clipShadows=re.clipShadows,Ce.clippingPlanes=re.clippingPlanes,Ce.clipIntersection=re.clipIntersection,Ce.wireframeLinewidth=re.wireframeLinewidth,Ce.linewidth=re.linewidth,!0===he.isPointLight&&!0===Ce.isMeshDistanceMaterial&&(Ce.referencePosition.setFromMatrixPosition(he.matrixWorld),Ce.nearDistance=se,Ce.farDistance=fe),Ce}function G(K,H,re,he,se){if(!1===K.visible)return;if(K.layers.test(H.layers)&&(K.isMesh||K.isLine||K.isPoints)&&(K.castShadow||K.receiveShadow&&se===Nn)&&(!K.frustumCulled||d.intersectsObject(K))){K.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,K.matrixWorld);const Ce=s.update(K),be=K.material;if(Array.isArray(be)){const de=Ce.groups;for(let ve=0,Ae=de.length;ve<Ae;ve++){const He=de[ve],Ze=be[He.materialIndex];if(Ze&&Ze.visible){const bt=j(K,Ce,Ze,he,re.near,re.far,se);u.renderBufferDirect(re,null,Ce,bt,K,He)}}}else if(be.visible){const de=j(K,Ce,be,he,re.near,re.far,se);u.renderBufferDirect(re,null,Ce,de,K,null)}}const we=K.children;for(let Ce=0,be=we.length;Ce<be;Ce++)G(we[Ce],H,re,he,se)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Mt,this.render=function(K,H,re){if(!1===F.enabled||!1===F.autoUpdate&&!1===F.needsUpdate||0===K.length)return;const he=u.getRenderTarget(),se=u.getActiveCubeFace(),fe=u.getActiveMipmapLevel(),we=u.state;we.setBlending(yr),we.buffers.color.setClear(1,1,1,1),we.buffers.depth.setTest(!0),we.setScissorTest(!1);for(let Ce=0,be=K.length;Ce<be;Ce++){const de=K[Ce],ve=de.shadow;if(void 0===ve){console.warn("THREE.WebGLShadowMap:",de,"has no shadow.");continue}if(!1===ve.autoUpdate&&!1===ve.needsUpdate)continue;f.copy(ve.mapSize);const Ae=ve.getFrameExtents();if(f.multiply(Ae),m.copy(ve.mapSize),(f.x>a||f.y>a)&&(f.x>a&&(m.x=Math.floor(a/Ae.x),f.x=m.x*Ae.x,ve.mapSize.x=m.x),f.y>a&&(m.y=Math.floor(a/Ae.y),f.y=m.y*Ae.y,ve.mapSize.y=m.y)),null===ve.map&&!ve.isPointLightShadow&&this.type===Nn){const Ze={minFilter:fr,magFilter:fr,format:Xs};ve.map=new rn(f.x,f.y,Ze),ve.map.texture.name=de.name+".shadowMap",ve.mapPass=new rn(f.x,f.y,Ze),ve.camera.updateProjectionMatrix()}null===ve.map&&(ve.map=new rn(f.x,f.y,{minFilter:kr,magFilter:kr,format:Xs}),ve.map.texture.name=de.name+".shadowMap",ve.camera.updateProjectionMatrix()),u.setRenderTarget(ve.map),u.clear();const He=ve.getViewportCount();for(let Ze=0;Ze<He;Ze++){const bt=ve.getViewport(Ze);_.set(m.x*bt.x,m.y*bt.y,m.x*bt.z,m.y*bt.w),we.viewport(_),ve.updateMatrices(de,Ze),d=ve.getFrustum(),G(H,re,ve.camera,de,this.type)}!ve.isPointLightShadow&&this.type===Nn&&V(ve,re),ve.needsUpdate=!1}F.needsUpdate=!1,u.setRenderTarget(he,se,fe)}}function g1(u,s,a){const d=a.isWebGL2,v=new function f(){let ue=!1;const nt=new $e;let St=null;const Lt=new $e(0,0,0,0);return{setMask:function(it){St!==it&&!ue&&(u.colorMask(it,it,it,it),St=it)},setLocked:function(it){ue=it},setClear:function(it,tn,nn,Zt,Bt){!0===Bt&&(it*=Zt,tn*=Zt,nn*=Zt),nt.set(it,tn,nn,Zt),!1===Lt.equals(nt)&&(u.clearColor(it,tn,nn,Zt),Lt.copy(nt))},reset:function(){ue=!1,St=null,Lt.set(-1,0,0,0)}}},b=new function m(){let ue=!1,nt=null,St=null,Lt=null;return{setTest:function(it){it?Ot(2929):It(2929)},setMask:function(it){nt!==it&&!ue&&(u.depthMask(it),nt=it)},setFunc:function(it){if(St!==it){if(it)switch(it){case W_:u.depthFunc(512);break;case Zi:u.depthFunc(519);break;case ji:u.depthFunc(513);break;case hp:u.depthFunc(515);break;case an:u.depthFunc(514);break;case fp:u.depthFunc(518);break;case NC:u.depthFunc(516);break;case j_:u.depthFunc(517);break;default:u.depthFunc(515)}else u.depthFunc(515);St=it}},setLocked:function(it){ue=it},setClear:function(it){Lt!==it&&(u.clearDepth(it),Lt=it)},reset:function(){ue=!1,nt=null,St=null,Lt=null}}},w=new function _(){let ue=!1,nt=null,St=null,Lt=null,it=null,tn=null,nn=null,Zt=null,Bt=null;return{setTest:function(wt){ue||(wt?Ot(2960):It(2960))},setMask:function(wt){nt!==wt&&!ue&&(u.stencilMask(wt),nt=wt)},setFunc:function(wt,fi,zs){(St!==wt||Lt!==fi||it!==zs)&&(u.stencilFunc(wt,fi,zs),St=wt,Lt=fi,it=zs)},setOp:function(wt,fi,zs){(tn!==wt||nn!==fi||Zt!==zs)&&(u.stencilOp(wt,fi,zs),tn=wt,nn=fi,Zt=zs)},setLocked:function(wt){ue=wt},setClear:function(wt){Bt!==wt&&(u.clearStencil(wt),Bt=wt)},reset:function(){ue=!1,nt=null,St=null,Lt=null,it=null,tn=null,nn=null,Zt=null,Bt=null}}};let A={},E=null,D=!1,R=null,I=null,F=null,V=null,N=null,L=null,j=null,G=!1,K=null,H=null,re=null,he=null,se=null;const fe=u.getParameter(35661);let we=!1,Ce=0;const be=u.getParameter(7938);-1!==be.indexOf("WebGL")?(Ce=parseFloat(/^WebGL (\d)/.exec(be)[1]),we=Ce>=1):-1!==be.indexOf("OpenGL ES")&&(Ce=parseFloat(/^OpenGL ES (\d)/.exec(be)[1]),we=Ce>=2);let de=null,ve={};const Ae=new $e,He=new $e;function Ze(ue,nt,St){const Lt=new Uint8Array(4),it=u.createTexture();u.bindTexture(ue,it),u.texParameteri(ue,10241,9728),u.texParameteri(ue,10240,9728);for(let tn=0;tn<St;tn++)u.texImage2D(nt+tn,0,6408,1,1,0,6408,5121,Lt);return it}const bt={};function Ot(ue){!0!==A[ue]&&(u.enable(ue),A[ue]=!0)}function It(ue){!1!==A[ue]&&(u.disable(ue),A[ue]=!1)}bt[3553]=Ze(3553,3553,1),bt[34067]=Ze(34067,34069,6),v.setClear(0,0,0,1),b.setClear(1),w.setClear(0),Ot(2929),b.setFunc(hp),Gi(!1),ii(Or),Ot(2884),oi(yr);const fn={[zo]:32774,[eh]:32778,[Px]:32779};if(d)fn[th]=32775,fn[z_]=32776;else{const ue=s.get("EXT_blend_minmax");null!==ue&&(fn[th]=ue.MIN_EXT,fn[z_]=ue.MAX_EXT)}const Li={[up]:0,[Ga]:1,[Fx]:768,[Ci]:770,[G_]:776,[kx]:774,[Nx]:772,[H_]:769,[dp]:771,[ri]:775,[Ox]:773};function oi(ue,nt,St,Lt,it,tn,nn,Zt){if(ue!==yr){if(!1===D&&(Ot(3042),D=!0),ue===Lx)it=it||nt,tn=tn||St,nn=nn||Lt,(nt!==I||it!==N)&&(u.blendEquationSeparate(fn[nt],fn[it]),I=nt,N=it),(St!==F||Lt!==V||tn!==L||nn!==j)&&(u.blendFuncSeparate(Li[St],Li[Lt],Li[tn],Li[nn]),F=St,V=Lt,L=tn,j=nn),R=ue,G=null;else if(ue!==R||Zt!==G){if((I!==zo||N!==zo)&&(u.blendEquation(32774),I=zo,N=zo),Zt)switch(ue){case wo:u.blendFuncSeparate(1,771,1,771);break;case Uo:u.blendFunc(1,1);break;case U_:u.blendFuncSeparate(0,0,769,771);break;case Qd:u.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue)}else switch(ue){case wo:u.blendFuncSeparate(770,771,1,771);break;case Uo:u.blendFunc(770,1);break;case U_:u.blendFunc(0,769);break;case Qd:u.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue)}F=null,V=null,L=null,j=null,R=ue,G=Zt}}else!0===D&&(It(3042),D=!1)}function Gi(ue){K!==ue&&(u.frontFace(ue?2304:2305),K=ue)}function ii(ue){ue!==Ei?(Ot(2884),ue!==H&&u.cullFace(ue===Or?1029:ue===rr?1028:1032)):It(2884),H=ue}function pn(ue,nt,St){ue?(Ot(32823),(he!==nt||se!==St)&&(u.polygonOffset(nt,St),he=nt,se=St)):It(32823)}function Qe(ue){void 0===ue&&(ue=33984+fe-1),de!==ue&&(u.activeTexture(ue),de=ue)}return{buffers:{color:v,depth:b,stencil:w},enable:Ot,disable:It,useProgram:function kn(ue){return E!==ue&&(u.useProgram(ue),E=ue,!0)},setBlending:oi,setMaterial:function Ue(ue,nt){ue.side===Nt?It(2884):Ot(2884);let St=ue.side===X;nt&&(St=!St),Gi(St),ue.blending===wo&&!1===ue.transparent?oi(yr):oi(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.premultipliedAlpha),b.setFunc(ue.depthFunc),b.setTest(ue.depthTest),b.setMask(ue.depthWrite),v.setMask(ue.colorWrite);const Lt=ue.stencilWrite;w.setTest(Lt),Lt&&(w.setMask(ue.stencilWriteMask),w.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),w.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),pn(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits)},setFlipSided:Gi,setCullFace:ii,setLineWidth:function yi(ue){ue!==re&&(we&&u.lineWidth(ue),re=ue)},setPolygonOffset:pn,setScissorTest:function vi(ue){ue?Ot(3089):It(3089)},activeTexture:Qe,bindTexture:function lt(ue,nt){null===de&&Qe();let St=ve[de];void 0===St&&(St={type:void 0,texture:void 0},ve[de]=St),(St.type!==ue||St.texture!==nt)&&(u.bindTexture(ue,nt||bt[ue]),St.type=ue,St.texture=nt)},unbindTexture:function et(){const ue=ve[de];void 0!==ue&&void 0!==ue.type&&(u.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)},compressedTexImage2D:function Xt(){try{u.compressedTexImage2D.apply(u,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texImage2D:function Rt(){try{u.texImage2D.apply(u,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},texImage3D:function ie(){try{u.texImage3D.apply(u,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}},scissor:function Q(ue){!1===Ae.equals(ue)&&(u.scissor(ue.x,ue.y,ue.z,ue.w),Ae.copy(ue))},viewport:function We(ue){!1===He.equals(ue)&&(u.viewport(ue.x,ue.y,ue.z,ue.w),He.copy(ue))},reset:function Ye(){u.disable(3042),u.disable(2884),u.disable(2929),u.disable(32823),u.disable(3089),u.disable(2960),u.blendEquation(32774),u.blendFunc(1,0),u.blendFuncSeparate(1,0,1,0),u.colorMask(!0,!0,!0,!0),u.clearColor(0,0,0,0),u.depthMask(!0),u.depthFunc(513),u.clearDepth(1),u.stencilMask(4294967295),u.stencilFunc(519,0,4294967295),u.stencilOp(7680,7680,7680),u.clearStencil(0),u.cullFace(1029),u.frontFace(2305),u.polygonOffset(0,0),u.activeTexture(33984),u.useProgram(null),u.lineWidth(1),u.scissor(0,0,u.canvas.width,u.canvas.height),u.viewport(0,0,u.canvas.width,u.canvas.height),A={},de=null,ve={},E=null,D=!1,R=null,I=null,F=null,V=null,N=null,L=null,j=null,G=!1,K=null,H=null,re=null,he=null,se=null,v.reset(),b.reset(),w.reset()}}}function _1(u,s,a,d,f,m,_){const v=f.isWebGL2,b=f.maxTextures,w=f.maxCubemapSize,A=f.maxTextureSize,E=f.maxSamples,D=new WeakMap;let R,I=!1;try{I="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(ie){}function F(ie,Q){return I?new OffscreenCanvas(ie,Q):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function V(ie,Q,We,Ye){let ue=1;if((ie.width>Ye||ie.height>Ye)&&(ue=Ye/Math.max(ie.width,ie.height)),ue<1||!0===Q){if("undefined"!=typeof HTMLImageElement&&ie instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&ie instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&ie instanceof ImageBitmap){const nt=Q?Jt.floorPowerOfTwo:Math.floor,St=nt(ue*ie.width),Lt=nt(ue*ie.height);void 0===R&&(R=F(St,Lt));const it=We?F(St,Lt):R;return it.width=St,it.height=Lt,it.getContext("2d").drawImage(ie,0,0,St,Lt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ie.width+"x"+ie.height+") to ("+St+"x"+Lt+")."),it}return"data"in ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ie.width+"x"+ie.height+")."),ie}return ie}function N(ie){return Jt.isPowerOfTwo(ie.width)&&Jt.isPowerOfTwo(ie.height)}function j(ie,Q){return ie.generateMipmaps&&Q&&ie.minFilter!==kr&&ie.minFilter!==fr}function G(ie,Q,We,Ye){u.generateMipmap(ie),d.get(Q).__maxMipLevel=Math.log2(Math.max(We,Ye))}function K(ie,Q,We){if(!1===v)return Q;if(null!==ie){if(void 0!==u[ie])return u[ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ie+"'")}let Ye=Q;return 6403===Q&&(5126===We&&(Ye=33326),5131===We&&(Ye=33325),5121===We&&(Ye=33321)),6407===Q&&(5126===We&&(Ye=34837),5131===We&&(Ye=34843),5121===We&&(Ye=32849)),6408===Q&&(5126===We&&(Ye=34836),5131===We&&(Ye=34842),5121===We&&(Ye=32856)),(33325===Ye||33326===Ye||34842===Ye||34836===Ye)&&s.get("EXT_color_buffer_float"),Ye}function H(ie){return ie===kr||ie===Z_||ie===Y_?9728:9729}function re(ie){const Q=ie.target;Q.removeEventListener("dispose",re),function se(ie){const Q=d.get(ie);void 0!==Q.__webglInit&&(u.deleteTexture(Q.__webglTexture),d.remove(ie))}(Q),Q.isVideoTexture&&D.delete(Q),_.memory.textures--}function he(ie){const Q=ie.target;Q.removeEventListener("dispose",he),function fe(ie){const Q=ie.texture,We=d.get(ie),Ye=d.get(Q);if(ie){if(void 0!==Ye.__webglTexture&&u.deleteTexture(Ye.__webglTexture),ie.depthTexture&&ie.depthTexture.dispose(),ie.isWebGLCubeRenderTarget)for(let ue=0;ue<6;ue++)u.deleteFramebuffer(We.__webglFramebuffer[ue]),We.__webglDepthbuffer&&u.deleteRenderbuffer(We.__webglDepthbuffer[ue]);else u.deleteFramebuffer(We.__webglFramebuffer),We.__webglDepthbuffer&&u.deleteRenderbuffer(We.__webglDepthbuffer),We.__webglMultisampledFramebuffer&&u.deleteFramebuffer(We.__webglMultisampledFramebuffer),We.__webglColorRenderbuffer&&u.deleteRenderbuffer(We.__webglColorRenderbuffer),We.__webglDepthRenderbuffer&&u.deleteRenderbuffer(We.__webglDepthRenderbuffer);d.remove(Q),d.remove(ie)}}(Q),_.memory.textures--}let we=0;function de(ie,Q){const We=d.get(ie);if(ie.isVideoTexture&&function Qe(ie){const Q=_.render.frame;D.get(ie)!==Q&&(D.set(ie,Q),ie.update())}(ie),ie.version>0&&We.__version!==ie.version){const Ye=ie.image;if(void 0===Ye)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Ye.complete)return void kn(We,ie,Q);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}a.activeTexture(33984+Q),a.bindTexture(3553,We.__webglTexture)}function He(ie,Q){const We=d.get(ie);ie.version>0&&We.__version!==ie.version?function fn(ie,Q,We){if(6!==Q.image.length)return;It(ie,Q),a.activeTexture(33984+We),a.bindTexture(34067,ie.__webglTexture),u.pixelStorei(37440,Q.flipY),u.pixelStorei(37441,Q.premultiplyAlpha),u.pixelStorei(3317,Q.unpackAlignment),u.pixelStorei(37443,0);const Ye=Q&&(Q.isCompressedTexture||Q.image[0].isCompressedTexture),ue=Q.image[0]&&Q.image[0].isDataTexture,nt=[];for(let Bt=0;Bt<6;Bt++)nt[Bt]=Ye||ue?ue?Q.image[Bt].image:Q.image[Bt]:V(Q.image[Bt],!1,!0,w);const St=nt[0],Lt=N(St)||v,it=m.convert(Q.format),tn=m.convert(Q.type),nn=K(Q.internalFormat,it,tn);let Zt;if(Ot(34067,Q,Lt),Ye){for(let Bt=0;Bt<6;Bt++){Zt=nt[Bt].mipmaps;for(let wt=0;wt<Zt.length;wt++){const fi=Zt[wt];Q.format!==Xs&&Q.format!==ss?null!==it?a.compressedTexImage2D(34069+Bt,wt,nn,fi.width,fi.height,0,fi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):a.texImage2D(34069+Bt,wt,nn,fi.width,fi.height,0,it,tn,fi.data)}}ie.__maxMipLevel=Zt.length-1}else{Zt=Q.mipmaps;for(let Bt=0;Bt<6;Bt++)if(ue){a.texImage2D(34069+Bt,0,nn,nt[Bt].width,nt[Bt].height,0,it,tn,nt[Bt].data);for(let wt=0;wt<Zt.length;wt++){const zs=Zt[wt].image[Bt].image;a.texImage2D(34069+Bt,wt+1,nn,zs.width,zs.height,0,it,tn,zs.data)}}else{a.texImage2D(34069+Bt,0,nn,it,tn,nt[Bt]);for(let wt=0;wt<Zt.length;wt++)a.texImage2D(34069+Bt,wt+1,nn,it,tn,Zt[wt].image[Bt])}ie.__maxMipLevel=Zt.length}j(Q,Lt)&&G(34067,Q,St.width,St.height),ie.__version=Q.version,Q.onUpdate&&Q.onUpdate(Q)}(We,ie,Q):(a.activeTexture(33984+Q),a.bindTexture(34067,We.__webglTexture))}const Ze={[nh]:10497,[Rs]:33071,[ih]:33648},bt={[kr]:9728,[Z_]:9984,[Y_]:9986,[fr]:9729,[vp]:9985,[oc]:9987};function Ot(ie,Q,We){if(We?(u.texParameteri(ie,10242,Ze[Q.wrapS]),u.texParameteri(ie,10243,Ze[Q.wrapT]),(32879===ie||35866===ie)&&u.texParameteri(ie,32882,Ze[Q.wrapR]),u.texParameteri(ie,10240,bt[Q.magFilter]),u.texParameteri(ie,10241,bt[Q.minFilter])):(u.texParameteri(ie,10242,33071),u.texParameteri(ie,10243,33071),(32879===ie||35866===ie)&&u.texParameteri(ie,32882,33071),(Q.wrapS!==Rs||Q.wrapT!==Rs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),u.texParameteri(ie,10240,H(Q.magFilter)),u.texParameteri(ie,10241,H(Q.minFilter)),Q.minFilter!==kr&&Q.minFilter!==fr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===s.has("EXT_texture_filter_anisotropic")){const Ye=s.get("EXT_texture_filter_anisotropic");if(Q.type===Wa&&!1===s.has("OES_texture_float_linear")||!1===v&&Q.type===rh&&!1===s.has("OES_texture_half_float_linear"))return;(Q.anisotropy>1||d.get(Q).__currentAnisotropy)&&(u.texParameterf(ie,Ye.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Q.anisotropy,f.getMaxAnisotropy())),d.get(Q).__currentAnisotropy=Q.anisotropy)}}function It(ie,Q){void 0===ie.__webglInit&&(ie.__webglInit=!0,Q.addEventListener("dispose",re),ie.__webglTexture=u.createTexture(),_.memory.textures++)}function kn(ie,Q,We){let Ye=3553;Q.isDataTexture2DArray&&(Ye=35866),Q.isDataTexture3D&&(Ye=32879),It(ie,Q),a.activeTexture(33984+We),a.bindTexture(Ye,ie.__webglTexture),u.pixelStorei(37440,Q.flipY),u.pixelStorei(37441,Q.premultiplyAlpha),u.pixelStorei(3317,Q.unpackAlignment),u.pixelStorei(37443,0);const ue=function L(ie){return!v&&(ie.wrapS!==Rs||ie.wrapT!==Rs||ie.minFilter!==kr&&ie.minFilter!==fr)}(Q)&&!1===N(Q.image),nt=V(Q.image,ue,!1,A),St=N(nt)||v,Lt=m.convert(Q.format);let nn,it=m.convert(Q.type),tn=K(Q.internalFormat,Lt,it);Ot(Ye,Q,St);const Zt=Q.mipmaps;if(Q.isDepthTexture)tn=6402,v?tn=Q.type===Wa?36012:Q.type===Br?33190:Q.type===cu?35056:33189:Q.type===Wa&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Q.format===uu&&6402===tn&&Q.type!==lu&&Q.type!==Br&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Q.type=lu,it=m.convert(Q.type)),Q.format===du&&6402===tn&&(tn=34041,Q.type!==cu&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Q.type=cu,it=m.convert(Q.type))),a.texImage2D(3553,0,tn,nt.width,nt.height,0,Lt,it,null);else if(Q.isDataTexture)if(Zt.length>0&&St){for(let Bt=0,wt=Zt.length;Bt<wt;Bt++)nn=Zt[Bt],a.texImage2D(3553,Bt,tn,nn.width,nn.height,0,Lt,it,nn.data);Q.generateMipmaps=!1,ie.__maxMipLevel=Zt.length-1}else a.texImage2D(3553,0,tn,nt.width,nt.height,0,Lt,it,nt.data),ie.__maxMipLevel=0;else if(Q.isCompressedTexture){for(let Bt=0,wt=Zt.length;Bt<wt;Bt++)nn=Zt[Bt],Q.format!==Xs&&Q.format!==ss?null!==Lt?a.compressedTexImage2D(3553,Bt,tn,nn.width,nn.height,0,nn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):a.texImage2D(3553,Bt,tn,nn.width,nn.height,0,Lt,it,nn.data);ie.__maxMipLevel=Zt.length-1}else if(Q.isDataTexture2DArray)a.texImage3D(35866,0,tn,nt.width,nt.height,nt.depth,0,Lt,it,nt.data),ie.__maxMipLevel=0;else if(Q.isDataTexture3D)a.texImage3D(32879,0,tn,nt.width,nt.height,nt.depth,0,Lt,it,nt.data),ie.__maxMipLevel=0;else if(Zt.length>0&&St){for(let Bt=0,wt=Zt.length;Bt<wt;Bt++)nn=Zt[Bt],a.texImage2D(3553,Bt,tn,Lt,it,nn);Q.generateMipmaps=!1,ie.__maxMipLevel=Zt.length-1}else a.texImage2D(3553,0,tn,Lt,it,nt),ie.__maxMipLevel=0;j(Q,St)&&G(Ye,Q,nt.width,nt.height),ie.__version=Q.version,Q.onUpdate&&Q.onUpdate(Q)}function Li(ie,Q,We,Ye){const ue=Q.texture,nt=m.convert(ue.format),St=m.convert(ue.type),Lt=K(ue.internalFormat,nt,St);32879===Ye||35866===Ye?a.texImage3D(Ye,0,Lt,Q.width,Q.height,Q.depth,0,nt,St,null):a.texImage2D(Ye,0,Lt,Q.width,Q.height,0,nt,St,null),u.bindFramebuffer(36160,ie),u.framebufferTexture2D(36160,We,Ye,d.get(ue).__webglTexture,0),u.bindFramebuffer(36160,null)}function oi(ie,Q,We){if(u.bindRenderbuffer(36161,ie),Q.depthBuffer&&!Q.stencilBuffer){let Ye=33189;if(We){const ue=Q.depthTexture;ue&&ue.isDepthTexture&&(ue.type===Wa?Ye=36012:ue.type===Br&&(Ye=33190));const nt=vi(Q);u.renderbufferStorageMultisample(36161,nt,Ye,Q.width,Q.height)}else u.renderbufferStorage(36161,Ye,Q.width,Q.height);u.framebufferRenderbuffer(36160,36096,36161,ie)}else if(Q.depthBuffer&&Q.stencilBuffer){if(We){const Ye=vi(Q);u.renderbufferStorageMultisample(36161,Ye,35056,Q.width,Q.height)}else u.renderbufferStorage(36161,34041,Q.width,Q.height);u.framebufferRenderbuffer(36160,33306,36161,ie)}else{const Ye=Q.texture,ue=m.convert(Ye.format),nt=m.convert(Ye.type),St=K(Ye.internalFormat,ue,nt);if(We){const Lt=vi(Q);u.renderbufferStorageMultisample(36161,Lt,St,Q.width,Q.height)}else u.renderbufferStorage(36161,St,Q.width,Q.height)}u.bindRenderbuffer(36161,null)}function vi(ie){return v&&ie.isWebGLMultisampleRenderTarget?Math.min(E,ie.samples):0}let lt=!1,et=!1;this.allocateTextureUnit=function be(){const ie=we;return ie>=b&&console.warn("THREE.WebGLTextures: Trying to use "+ie+" texture units while this GPU supports only "+b),we+=1,ie},this.resetTextureUnits=function Ce(){we=0},this.setTexture2D=de,this.setTexture2DArray=function ve(ie,Q){const We=d.get(ie);ie.version>0&&We.__version!==ie.version?kn(We,ie,Q):(a.activeTexture(33984+Q),a.bindTexture(35866,We.__webglTexture))},this.setTexture3D=function Ae(ie,Q){const We=d.get(ie);ie.version>0&&We.__version!==ie.version?kn(We,ie,Q):(a.activeTexture(33984+Q),a.bindTexture(32879,We.__webglTexture))},this.setTextureCube=He,this.setupRenderTarget=function ii(ie){const Q=ie.texture,We=d.get(ie),Ye=d.get(Q);ie.addEventListener("dispose",he),Ye.__webglTexture=u.createTexture(),_.memory.textures++;const ue=!0===ie.isWebGLCubeRenderTarget,nt=!0===ie.isWebGLMultisampleRenderTarget,St=Q.isDataTexture3D||Q.isDataTexture2DArray,Lt=N(ie)||v;if(v&&Q.format===ss&&(Q.type===Wa||Q.type===rh)&&(Q.format=Xs,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),ue){We.__webglFramebuffer=[];for(let it=0;it<6;it++)We.__webglFramebuffer[it]=u.createFramebuffer()}else if(We.__webglFramebuffer=u.createFramebuffer(),nt)if(v){We.__webglMultisampledFramebuffer=u.createFramebuffer(),We.__webglColorRenderbuffer=u.createRenderbuffer(),u.bindRenderbuffer(36161,We.__webglColorRenderbuffer);const it=m.convert(Q.format),tn=m.convert(Q.type),nn=K(Q.internalFormat,it,tn),Zt=vi(ie);u.renderbufferStorageMultisample(36161,Zt,nn,ie.width,ie.height),u.bindFramebuffer(36160,We.__webglMultisampledFramebuffer),u.framebufferRenderbuffer(36160,36064,36161,We.__webglColorRenderbuffer),u.bindRenderbuffer(36161,null),ie.depthBuffer&&(We.__webglDepthRenderbuffer=u.createRenderbuffer(),oi(We.__webglDepthRenderbuffer,ie,!0)),u.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(ue){a.bindTexture(34067,Ye.__webglTexture),Ot(34067,Q,Lt);for(let it=0;it<6;it++)Li(We.__webglFramebuffer[it],ie,36064,34069+it);j(Q,Lt)&&G(34067,Q,ie.width,ie.height),a.bindTexture(34067,null)}else{let it=3553;St&&(v?it=Q.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),a.bindTexture(it,Ye.__webglTexture),Ot(it,Q,Lt),Li(We.__webglFramebuffer,ie,36064,it),j(Q,Lt)&&G(3553,Q,ie.width,ie.height),a.bindTexture(3553,null)}ie.depthBuffer&&function Gi(ie){const Q=d.get(ie),We=!0===ie.isWebGLCubeRenderTarget;if(ie.depthTexture){if(We)throw new Error("target.depthTexture not supported in Cube render targets");!function Ue(ie,Q){if(Q&&Q.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(u.bindFramebuffer(36160,ie),!Q.depthTexture||!Q.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!d.get(Q.depthTexture).__webglTexture||Q.depthTexture.image.width!==Q.width||Q.depthTexture.image.height!==Q.height)&&(Q.depthTexture.image.width=Q.width,Q.depthTexture.image.height=Q.height,Q.depthTexture.needsUpdate=!0),de(Q.depthTexture,0);const Ye=d.get(Q.depthTexture).__webglTexture;if(Q.depthTexture.format===uu)u.framebufferTexture2D(36160,36096,3553,Ye,0);else{if(Q.depthTexture.format!==du)throw new Error("Unknown depthTexture format");u.framebufferTexture2D(36160,33306,3553,Ye,0)}}(Q.__webglFramebuffer,ie)}else if(We){Q.__webglDepthbuffer=[];for(let Ye=0;Ye<6;Ye++)u.bindFramebuffer(36160,Q.__webglFramebuffer[Ye]),Q.__webglDepthbuffer[Ye]=u.createRenderbuffer(),oi(Q.__webglDepthbuffer[Ye],ie,!1)}else u.bindFramebuffer(36160,Q.__webglFramebuffer),Q.__webglDepthbuffer=u.createRenderbuffer(),oi(Q.__webglDepthbuffer,ie,!1);u.bindFramebuffer(36160,null)}(ie)},this.updateRenderTargetMipmap=function yi(ie){const Q=ie.texture;if(j(Q,N(ie)||v)){const Ye=ie.isWebGLCubeRenderTarget?34067:3553,ue=d.get(Q).__webglTexture;a.bindTexture(Ye,ue),G(Ye,Q,ie.width,ie.height),a.bindTexture(Ye,null)}},this.updateMultisampleRenderTarget=function pn(ie){if(ie.isWebGLMultisampleRenderTarget)if(v){const Q=d.get(ie);u.bindFramebuffer(36008,Q.__webglMultisampledFramebuffer),u.bindFramebuffer(36009,Q.__webglFramebuffer);const We=ie.width,Ye=ie.height;let ue=16384;ie.depthBuffer&&(ue|=256),ie.stencilBuffer&&(ue|=1024),u.blitFramebuffer(0,0,We,Ye,0,0,We,Ye,ue,9728),u.bindFramebuffer(36160,Q.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function Xt(ie,Q){ie&&ie.isWebGLRenderTarget&&(!1===lt&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),lt=!0),ie=ie.texture),de(ie,Q)},this.safeSetTextureCube=function Rt(ie,Q){ie&&ie.isWebGLCubeRenderTarget&&(!1===et&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),et=!0),ie=ie.texture),He(ie,Q)}}function sm(u,s,a){const d=a.isWebGL2;return{convert:function f(m){let _;if(m===au)return 5121;if(m===zx)return 32819;if(m===Hx)return 32820;if(m===ey)return 33635;if(m===J_)return 5120;if(m===K_)return 5122;if(m===lu)return 5123;if(m===Q_)return 5124;if(m===Br)return 5125;if(m===Wa)return 5126;if(m===rh)return d?5131:(_=s.get("OES_texture_half_float"),null!==_?_.HALF_FLOAT_OES:null);if(m===Gx)return 6406;if(m===ss)return 6407;if(m===Xs)return 6408;if(m===Dr)return 6409;if(m===ac)return 6410;if(m===uu)return 6402;if(m===du)return 34041;if(m===ty)return 6403;if(m===xp)return 36244;if(m===ny)return 33319;if(m===hu)return 33320;if(m===Wx)return 36248;if(m===iy)return 36249;if(m===bp||m===ry||m===sy||m===oy){if(_=s.get("WEBGL_compressed_texture_s3tc"),null===_)return null;if(m===bp)return _.COMPRESSED_RGB_S3TC_DXT1_EXT;if(m===ry)return _.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(m===sy)return _.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(m===oy)return _.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(m===ay||m===wp||m===ly||m===cy){if(_=s.get("WEBGL_compressed_texture_pvrtc"),null===_)return null;if(m===ay)return _.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(m===wp)return _.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(m===ly)return _.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(m===cy)return _.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(m===sr)return _=s.get("WEBGL_compressed_texture_etc1"),null!==_?_.COMPRESSED_RGB_ETC1_WEBGL:null;if((m===Mp||m===Sp)&&(_=s.get("WEBGL_compressed_texture_etc"),null!==_)){if(m===Mp)return _.COMPRESSED_RGB8_ETC2;if(m===Sp)return _.COMPRESSED_RGBA8_ETC2_EAC}return m===Ep||m===Ti||m===Cp||m===Ai||m===Tp||m===jx||m===ci||m===sn||m===Ap||m===UC||m===ke||m===sh||m===mn||m===ui||m===zC||m===$x||m===oh||m===Is||m===HC||m===Xx||m===GC||m===va||m===WC||m===jC||m===qC||m===$C||m===Zx||m===XC?(_=s.get("WEBGL_compressed_texture_astc"),null!==_?m:null):m===qx?(_=s.get("EXT_texture_compression_bptc"),null!==_?m:null):m===cu?d?34042:(_=s.get("WEBGL_depth_texture"),null!==_?_.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function om(u=[]){wr.call(this),this.cameras=u}Uh.prototype.isMeshDistanceMaterial=!0,om.prototype=Object.assign(Object.create(wr.prototype),{constructor:om,isArrayCamera:!0});class Fl extends en{constructor(){super(),this.type="Group"}}function zh(){this._targetRay=null,this._grip=null,this._hand=null}function Qy(u,s){const a=this;let d=null,f=1,m=null,_="local-floor",v=null;const b=[],w=new Map,A=new wr;A.layers.enable(1),A.viewport=new $e;const E=new wr;E.layers.enable(2),E.viewport=new $e;const D=[A,E],R=new om;R.layers.enable(1),R.layers.enable(2);let I=null,F=null;function V(fe){const we=w.get(fe.inputSource);we&&we.dispatchEvent({type:fe.type,data:fe.inputSource})}function N(){w.forEach(function(fe,we){fe.disconnect(we)}),w.clear(),I=null,F=null,u.setFramebuffer(null),u.setRenderTarget(u.getRenderTarget()),se.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function L(fe){const we=d.inputSources;for(let Ce=0;Ce<b.length;Ce++)w.set(we[Ce],b[Ce]);for(let Ce=0;Ce<fe.removed.length;Ce++){const be=fe.removed[Ce],de=w.get(be);de&&(de.dispatchEvent({type:"disconnected",data:be}),w.delete(be))}for(let Ce=0;Ce<fe.added.length;Ce++){const be=fe.added[Ce],de=w.get(be);de&&de.dispatchEvent({type:"connected",data:be})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(fe){let we=b[fe];return void 0===we&&(we=new zh,b[fe]=we),we.getTargetRaySpace()},this.getControllerGrip=function(fe){let we=b[fe];return void 0===we&&(we=new zh,b[fe]=we),we.getGripSpace()},this.getHand=function(fe){let we=b[fe];return void 0===we&&(we=new zh,b[fe]=we),we.getHandSpace()},this.setFramebufferScaleFactor=function(fe){f=fe,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(fe){_=fe,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return m},this.getSession=function(){return d},this.setSession=function(){var fe=(0,Mn.Z)(function*(we){if(d=we,null!==d){d.addEventListener("select",V),d.addEventListener("selectstart",V),d.addEventListener("selectend",V),d.addEventListener("squeeze",V),d.addEventListener("squeezestart",V),d.addEventListener("squeezeend",V),d.addEventListener("end",N),d.addEventListener("inputsourceschange",L);const Ce=s.getContextAttributes();!0!==Ce.xrCompatible&&(yield s.makeXRCompatible());const de=new XRWebGLLayer(d,s,{antialias:Ce.antialias,alpha:Ce.alpha,depth:Ce.depth,stencil:Ce.stencil,framebufferScaleFactor:f});d.updateRenderState({baseLayer:de}),m=yield d.requestReferenceSpace(_),se.setContext(d),se.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}});return function(we){return fe.apply(this,arguments)}}();const j=new W,G=new W;function H(fe,we){null===we?fe.matrixWorld.copy(fe.matrix):fe.matrixWorld.multiplyMatrices(we.matrixWorld,fe.matrix),fe.matrixWorldInverse.copy(fe.matrixWorld).invert()}this.getCamera=function(fe){R.near=E.near=A.near=fe.near,R.far=E.far=A.far=fe.far,(I!==R.near||F!==R.far)&&(d.updateRenderState({depthNear:R.near,depthFar:R.far}),I=R.near,F=R.far);const we=fe.parent,Ce=R.cameras;H(R,we);for(let de=0;de<Ce.length;de++)H(Ce[de],we);fe.matrixWorld.copy(R.matrixWorld),fe.matrix.copy(R.matrix),fe.matrix.decompose(fe.position,fe.quaternion,fe.scale);const be=fe.children;for(let de=0,ve=be.length;de<ve;de++)be[de].updateMatrixWorld(!0);return 2===Ce.length?function K(fe,we,Ce){j.setFromMatrixPosition(we.matrixWorld),G.setFromMatrixPosition(Ce.matrixWorld);const be=j.distanceTo(G),de=we.projectionMatrix.elements,ve=Ce.projectionMatrix.elements,Ae=de[14]/(de[10]-1),He=de[14]/(de[10]+1),Ze=(de[9]+1)/de[5],bt=(de[9]-1)/de[5],Ot=(de[8]-1)/de[0],It=(ve[8]+1)/ve[0],kn=Ae*Ot,fn=Ae*It,Li=be/(-Ot+It),oi=Li*-Ot;we.matrixWorld.decompose(fe.position,fe.quaternion,fe.scale),fe.translateX(oi),fe.translateZ(Li),fe.matrixWorld.compose(fe.position,fe.quaternion,fe.scale),fe.matrixWorldInverse.copy(fe.matrixWorld).invert();const Ue=Ae+Li,Gi=He+Li;fe.projectionMatrix.makePerspective(kn-oi,fn+(be-oi),Ze*He/Gi*Ue,bt*He/Gi*Ue,Ue,Gi)}(R,A,E):R.projectionMatrix.copy(A.projectionMatrix),R};let re=null;const se=new fb;se.setAnimationLoop(function he(fe,we){if(v=we.getViewerPose(m),null!==v){const be=v.views,de=d.renderState.baseLayer;u.setFramebuffer(de.framebuffer);let ve=!1;be.length!==R.cameras.length&&(R.cameras.length=0,ve=!0);for(let Ae=0;Ae<be.length;Ae++){const He=be[Ae],Ze=de.getViewport(He),bt=D[Ae];bt.matrix.fromArray(He.transform.matrix),bt.projectionMatrix.fromArray(He.projectionMatrix),bt.viewport.set(Ze.x,Ze.y,Ze.width,Ze.height),0===Ae&&R.matrix.copy(bt.matrix),!0===ve&&R.cameras.push(bt)}}const Ce=d.inputSources;for(let be=0;be<b.length;be++)b[be].update(Ce[be],we,m);re&&re(fe,we)}),this.setAnimationLoop=function(fe){re=fe},this.dispose=function(){}}function IP(u){function d(N,L){N.opacity.value=L.opacity,L.color&&N.diffuse.value.copy(L.color),L.emissive&&N.emissive.value.copy(L.emissive).multiplyScalar(L.emissiveIntensity),L.map&&(N.map.value=L.map),L.alphaMap&&(N.alphaMap.value=L.alphaMap),L.specularMap&&(N.specularMap.value=L.specularMap);const j=u.get(L).envMap;if(j){N.envMap.value=j,N.flipEnvMap.value=j.isCubeTexture&&j._needsFlipEnvMap?-1:1,N.reflectivity.value=L.reflectivity,N.refractionRatio.value=L.refractionRatio;const H=u.get(j).__maxMipLevel;void 0!==H&&(N.maxMipLevel.value=H)}let G,K;L.lightMap&&(N.lightMap.value=L.lightMap,N.lightMapIntensity.value=L.lightMapIntensity),L.aoMap&&(N.aoMap.value=L.aoMap,N.aoMapIntensity.value=L.aoMapIntensity),L.map?G=L.map:L.specularMap?G=L.specularMap:L.displacementMap?G=L.displacementMap:L.normalMap?G=L.normalMap:L.bumpMap?G=L.bumpMap:L.roughnessMap?G=L.roughnessMap:L.metalnessMap?G=L.metalnessMap:L.alphaMap?G=L.alphaMap:L.emissiveMap?G=L.emissiveMap:L.clearcoatMap?G=L.clearcoatMap:L.clearcoatNormalMap?G=L.clearcoatNormalMap:L.clearcoatRoughnessMap&&(G=L.clearcoatRoughnessMap),void 0!==G&&(G.isWebGLRenderTarget&&(G=G.texture),!0===G.matrixAutoUpdate&&G.updateMatrix(),N.uvTransform.value.copy(G.matrix)),L.aoMap?K=L.aoMap:L.lightMap&&(K=L.lightMap),void 0!==K&&(K.isWebGLRenderTarget&&(K=K.texture),!0===K.matrixAutoUpdate&&K.updateMatrix(),N.uv2Transform.value.copy(K.matrix))}function E(N,L){N.roughness.value=L.roughness,N.metalness.value=L.metalness,L.roughnessMap&&(N.roughnessMap.value=L.roughnessMap),L.metalnessMap&&(N.metalnessMap.value=L.metalnessMap),L.emissiveMap&&(N.emissiveMap.value=L.emissiveMap),L.bumpMap&&(N.bumpMap.value=L.bumpMap,N.bumpScale.value=L.bumpScale,L.side===X&&(N.bumpScale.value*=-1)),L.normalMap&&(N.normalMap.value=L.normalMap,N.normalScale.value.copy(L.normalScale),L.side===X&&N.normalScale.value.negate()),L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias),u.get(L).envMap&&(N.envMapIntensity.value=L.envMapIntensity)}return{refreshFogUniforms:function s(N,L){N.fogColor.value.copy(L.color),L.isFog?(N.fogNear.value=L.near,N.fogFar.value=L.far):L.isFogExp2&&(N.fogDensity.value=L.density)},refreshMaterialUniforms:function a(N,L,j,G){L.isMeshBasicMaterial?d(N,L):L.isMeshLambertMaterial?(d(N,L),function b(N,L){L.emissiveMap&&(N.emissiveMap.value=L.emissiveMap)}(N,L)):L.isMeshToonMaterial?(d(N,L),function A(N,L){L.gradientMap&&(N.gradientMap.value=L.gradientMap),L.emissiveMap&&(N.emissiveMap.value=L.emissiveMap),L.bumpMap&&(N.bumpMap.value=L.bumpMap,N.bumpScale.value=L.bumpScale,L.side===X&&(N.bumpScale.value*=-1)),L.normalMap&&(N.normalMap.value=L.normalMap,N.normalScale.value.copy(L.normalScale),L.side===X&&N.normalScale.value.negate()),L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias)}(N,L)):L.isMeshPhongMaterial?(d(N,L),function w(N,L){N.specular.value.copy(L.specular),N.shininess.value=Math.max(L.shininess,1e-4),L.emissiveMap&&(N.emissiveMap.value=L.emissiveMap),L.bumpMap&&(N.bumpMap.value=L.bumpMap,N.bumpScale.value=L.bumpScale,L.side===X&&(N.bumpScale.value*=-1)),L.normalMap&&(N.normalMap.value=L.normalMap,N.normalScale.value.copy(L.normalScale),L.side===X&&N.normalScale.value.negate()),L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias)}(N,L)):L.isMeshStandardMaterial?(d(N,L),L.isMeshPhysicalMaterial?function D(N,L){E(N,L),N.reflectivity.value=L.reflectivity,N.clearcoat.value=L.clearcoat,N.clearcoatRoughness.value=L.clearcoatRoughness,L.sheen&&N.sheen.value.copy(L.sheen),L.clearcoatMap&&(N.clearcoatMap.value=L.clearcoatMap),L.clearcoatRoughnessMap&&(N.clearcoatRoughnessMap.value=L.clearcoatRoughnessMap),L.clearcoatNormalMap&&(N.clearcoatNormalScale.value.copy(L.clearcoatNormalScale),N.clearcoatNormalMap.value=L.clearcoatNormalMap,L.side===X&&N.clearcoatNormalScale.value.negate()),N.transmission.value=L.transmission,L.transmissionMap&&(N.transmissionMap.value=L.transmissionMap)}(N,L):E(N,L)):L.isMeshMatcapMaterial?(d(N,L),function R(N,L){L.matcap&&(N.matcap.value=L.matcap),L.bumpMap&&(N.bumpMap.value=L.bumpMap,N.bumpScale.value=L.bumpScale,L.side===X&&(N.bumpScale.value*=-1)),L.normalMap&&(N.normalMap.value=L.normalMap,N.normalScale.value.copy(L.normalScale),L.side===X&&N.normalScale.value.negate()),L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias)}(N,L)):L.isMeshDepthMaterial?(d(N,L),function I(N,L){L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias)}(N,L)):L.isMeshDistanceMaterial?(d(N,L),function F(N,L){L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias),N.referencePosition.value.copy(L.referencePosition),N.nearDistance.value=L.nearDistance,N.farDistance.value=L.farDistance}(N,L)):L.isMeshNormalMaterial?(d(N,L),function V(N,L){L.bumpMap&&(N.bumpMap.value=L.bumpMap,N.bumpScale.value=L.bumpScale,L.side===X&&(N.bumpScale.value*=-1)),L.normalMap&&(N.normalMap.value=L.normalMap,N.normalScale.value.copy(L.normalScale),L.side===X&&N.normalScale.value.negate()),L.displacementMap&&(N.displacementMap.value=L.displacementMap,N.displacementScale.value=L.displacementScale,N.displacementBias.value=L.displacementBias)}(N,L)):L.isLineBasicMaterial?(function f(N,L){N.diffuse.value.copy(L.color),N.opacity.value=L.opacity}(N,L),L.isLineDashedMaterial&&function m(N,L){N.dashSize.value=L.dashSize,N.totalSize.value=L.dashSize+L.gapSize,N.scale.value=L.scale}(N,L)):L.isPointsMaterial?function _(N,L,j,G){let K;N.diffuse.value.copy(L.color),N.opacity.value=L.opacity,N.size.value=L.size*j,N.scale.value=.5*G,L.map&&(N.map.value=L.map),L.alphaMap&&(N.alphaMap.value=L.alphaMap),L.map?K=L.map:L.alphaMap&&(K=L.alphaMap),void 0!==K&&(!0===K.matrixAutoUpdate&&K.updateMatrix(),N.uvTransform.value.copy(K.matrix))}(N,L,j,G):L.isSpriteMaterial?function v(N,L){let j;N.diffuse.value.copy(L.color),N.opacity.value=L.opacity,N.rotation.value=L.rotation,L.map&&(N.map.value=L.map),L.alphaMap&&(N.alphaMap.value=L.alphaMap),L.map?j=L.map:L.alphaMap&&(j=L.alphaMap),void 0!==j&&(!0===j.matrixAutoUpdate&&j.updateMatrix(),N.uvTransform.value.copy(j.matrix))}(N,L):L.isShadowMaterial?(N.color.value.copy(L.color),N.opacity.value=L.opacity):L.isShaderMaterial&&(L.uniformsNeedUpdate=!1)}}}function hi(u){const s=void 0!==(u=u||{}).canvas?u.canvas:function y1(){const u=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return u.style.display="block",u}(),a=void 0!==u.context?u.context:null,d=void 0!==u.alpha&&u.alpha,f=void 0===u.depth||u.depth,m=void 0===u.stencil||u.stencil,_=void 0!==u.antialias&&u.antialias,v=void 0===u.premultipliedAlpha||u.premultipliedAlpha,b=void 0!==u.preserveDrawingBuffer&&u.preserveDrawingBuffer,w=void 0!==u.powerPreference?u.powerPreference:"default",A=void 0!==u.failIfMajorPerformanceCaveat&&u.failIfMajorPerformanceCaveat;let E=null,D=null;const R=[],I=[];this.domElement=s,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=os,this.physicallyCorrectLights=!1,this.toneMapping=su,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const F=this;let V=!1,N=null,L=0,j=0,G=null,K=null,H=-1,re=null;const he=new $e,se=new $e;let fe=null,we=s.width,Ce=s.height,be=1,de=null,ve=null;const Ae=new $e(0,0,we,Ce),He=new $e(0,0,we,Ce);let Ze=!1;const bt=new Pu;let Ot=!1,It=!1;const kn=new Ht,fn=new W,Li={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function oi(){return null===G?be:1}let ii,yi,pn,vi,Qe,lt,et,Xt,Rt,ie,Q,We,Ye,ue,nt,St,Lt,it,tn,nn,Zt,Ue=a;function Gi(Y,De){for(let Ee=0;Ee<Y.length;Ee++){const gt=s.getContext(Y[Ee],De);if(null!==gt)return gt}return null}try{const Y={alpha:d,depth:f,stencil:m,antialias:_,premultipliedAlpha:v,preserveDrawingBuffer:b,powerPreference:w,failIfMajorPerformanceCaveat:A};if(s.addEventListener("webglcontextlost",zs,!1),s.addEventListener("webglcontextrestored",hM,!1),null===Ue){const De=["webgl2","webgl","experimental-webgl"];if(!0===F.isWebGL1Renderer&&De.shift(),Ue=Gi(De,Y),null===Ue)throw Gi(De)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Ue.getShaderPrecisionFormat&&(Ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Y){throw console.error("THREE.WebGLRenderer: "+Y.message),Y}function Bt(){ii=new HT(Ue),yi=new zT(Ue,ii,u),ii.init(yi),nn=new sm(Ue,ii,yi),pn=new g1(Ue,ii,yi),pn.scissor(se.copy(He).multiplyScalar(be).floor()),pn.viewport(he.copy(Ae).multiplyScalar(be).floor()),vi=new Vb(Ue),Qe=new ow,lt=new _1(Ue,ii,pn,Qe,yi,nn,vi),et=new kb(F),Xt=new Il(Ue,yi),Zt=new VT(Ue,ii,Xt,yi),Rt=new Bb(Ue,Xt,vi,Zt),ie=new Ub(Ue,Rt,Xt,vi),Lt=new GT(Ue),nt=new Kp(Qe),Q=new sw(F,et,ii,yi,Zt,nt),We=new IP(Qe),Ye=new tm(Qe),ue=new p1(ii,yi),St=new xP(F,et,pn,ie,v),it=new UT(Ue,ii,vi,yi),tn=new bP(Ue,ii,vi,yi),vi.programs=Q.programs,F.capabilities=yi,F.extensions=ii,F.properties=Qe,F.renderLists=Ye,F.state=pn,F.info=vi}Bt();const wt=new Qy(F,Ue);this.xr=wt;const fi=new lw(F,ie,yi.maxTextureSize);function zs(Y){Y.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),V=!0}function hM(){console.log("THREE.WebGLRenderer: Context Restored."),V=!1,Bt()}function ra(Y){const De=Y.target;De.removeEventListener("dispose",ra),function sa(Y){No(Y),Qe.remove(Y)}(De)}function No(Y){const De=Qe.get(Y).program;void 0!==De&&Q.releaseProgram(De)}this.shadowMap=fi,this.getContext=function(){return Ue},this.getContextAttributes=function(){return Ue.getContextAttributes()},this.forceContextLoss=function(){const Y=ii.get("WEBGL_lose_context");Y&&Y.loseContext()},this.forceContextRestore=function(){const Y=ii.get("WEBGL_lose_context");Y&&Y.restoreContext()},this.getPixelRatio=function(){return be},this.setPixelRatio=function(Y){void 0!==Y&&(be=Y,this.setSize(we,Ce,!1))},this.getSize=function(Y){return void 0===Y&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Y=new qe),Y.set(we,Ce)},this.setSize=function(Y,De,Ee){wt.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(we=Y,Ce=De,s.width=Math.floor(Y*be),s.height=Math.floor(De*be),!1!==Ee&&(s.style.width=Y+"px",s.style.height=De+"px"),this.setViewport(0,0,Y,De))},this.getDrawingBufferSize=function(Y){return void 0===Y&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Y=new qe),Y.set(we*be,Ce*be).floor()},this.setDrawingBufferSize=function(Y,De,Ee){we=Y,Ce=De,be=Ee,s.width=Math.floor(Y*Ee),s.height=Math.floor(De*Ee),this.setViewport(0,0,Y,De)},this.getCurrentViewport=function(Y){return void 0===Y&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Y=new $e),Y.copy(he)},this.getViewport=function(Y){return Y.copy(Ae)},this.setViewport=function(Y,De,Ee,Fe){Y.isVector4?Ae.set(Y.x,Y.y,Y.z,Y.w):Ae.set(Y,De,Ee,Fe),pn.viewport(he.copy(Ae).multiplyScalar(be).floor())},this.getScissor=function(Y){return Y.copy(He)},this.setScissor=function(Y,De,Ee,Fe){Y.isVector4?He.set(Y.x,Y.y,Y.z,Y.w):He.set(Y,De,Ee,Fe),pn.scissor(se.copy(He).multiplyScalar(be).floor())},this.getScissorTest=function(){return Ze},this.setScissorTest=function(Y){pn.setScissorTest(Ze=Y)},this.setOpaqueSort=function(Y){de=Y},this.setTransparentSort=function(Y){ve=Y},this.getClearColor=function(Y){return void 0===Y&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),Y=new At),Y.copy(St.getClearColor())},this.setClearColor=function(){St.setClearColor.apply(St,arguments)},this.getClearAlpha=function(){return St.getClearAlpha()},this.setClearAlpha=function(){St.setClearAlpha.apply(St,arguments)},this.clear=function(Y,De,Ee){let Fe=0;(void 0===Y||Y)&&(Fe|=16384),(void 0===De||De)&&(Fe|=256),(void 0===Ee||Ee)&&(Fe|=1024),Ue.clear(Fe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){s.removeEventListener("webglcontextlost",zs,!1),s.removeEventListener("webglcontextrestored",hM,!1),Ye.dispose(),ue.dispose(),Qe.dispose(),et.dispose(),ie.dispose(),Zt.dispose(),wt.dispose(),Sf.stop()},this.renderBufferImmediate=function(Y,De){Zt.initAttributes();const Ee=Qe.get(Y);Y.hasPositions&&!Ee.position&&(Ee.position=Ue.createBuffer()),Y.hasNormals&&!Ee.normal&&(Ee.normal=Ue.createBuffer()),Y.hasUvs&&!Ee.uv&&(Ee.uv=Ue.createBuffer()),Y.hasColors&&!Ee.color&&(Ee.color=Ue.createBuffer());const Fe=De.getAttributes();Y.hasPositions&&(Ue.bindBuffer(34962,Ee.position),Ue.bufferData(34962,Y.positionArray,35048),Zt.enableAttribute(Fe.position),Ue.vertexAttribPointer(Fe.position,3,5126,!1,0,0)),Y.hasNormals&&(Ue.bindBuffer(34962,Ee.normal),Ue.bufferData(34962,Y.normalArray,35048),Zt.enableAttribute(Fe.normal),Ue.vertexAttribPointer(Fe.normal,3,5126,!1,0,0)),Y.hasUvs&&(Ue.bindBuffer(34962,Ee.uv),Ue.bufferData(34962,Y.uvArray,35048),Zt.enableAttribute(Fe.uv),Ue.vertexAttribPointer(Fe.uv,2,5126,!1,0,0)),Y.hasColors&&(Ue.bindBuffer(34962,Ee.color),Ue.bufferData(34962,Y.colorArray,35048),Zt.enableAttribute(Fe.color),Ue.vertexAttribPointer(Fe.color,3,5126,!1,0,0)),Zt.disableUnusedAttributes(),Ue.drawArrays(4,0,Y.count),Y.count=0},this.renderBufferDirect=function(Y,De,Ee,Fe,gt,Pt){null===De&&(De=Li);const Ut=gt.isMesh&&gt.matrixWorld.determinant()<0,ln=gM(Y,De,Fe,gt);pn.setMaterial(Fe,Ut);let En=Ee.index;const tr=Ee.attributes.position;if(null===En){if(void 0===tr||0===tr.count)return}else if(0===En.count)return;let Oi=1;!0===Fe.wireframe&&(En=Rt.getWireframeAttribute(Ee),Oi=2),(Fe.morphTargets||Fe.morphNormals)&&Lt.update(gt,Ee,Fe,ln),Zt.setup(gt,Fe,ln,Ee,En);let vn,xi=it;null!==En&&(vn=Xt.get(En),xi=tn,xi.setIndex(vn));const Oo=null!==En?En.count:tr.count,ki=Ee.drawRange.start*Oi,La=Ee.drawRange.count*Oi,Hr=null!==Pt?Pt.start*Oi:0,r0=null!==Pt?Pt.count*Oi:1/0,Hs=Math.max(ki,Hr),Ef=Math.min(Oo,ki+La,Hr+r0)-1,Sd=Math.max(0,Ef-Hs+1);if(0!==Sd){if(gt.isMesh)!0===Fe.wireframe?(pn.setLineWidth(Fe.wireframeLinewidth*oi()),xi.setMode(1)):xi.setMode(4);else if(gt.isLine){let Cf=Fe.linewidth;void 0===Cf&&(Cf=1),pn.setLineWidth(Cf*oi()),xi.setMode(gt.isLineSegments?1:gt.isLineLoop?2:3)}else gt.isPoints?xi.setMode(0):gt.isSprite&&xi.setMode(4);if(gt.isInstancedMesh)xi.renderInstances(Hs,Sd,gt.count);else if(Ee.isInstancedBufferGeometry){const Cf=Math.min(Ee.instanceCount,Ee._maxInstanceCount);xi.renderInstances(Hs,Sd,Cf)}else xi.render(Hs,Sd)}},this.compile=function(Y,De){D=ue.get(Y),D.init(),Y.traverseVisible(function(Fe){Fe.isLight&&Fe.layers.test(De.layers)&&(D.pushLight(Fe),Fe.castShadow&&D.pushShadow(Fe))}),D.setupLights();const Ee=new WeakMap;Y.traverse(function(Fe){const gt=Fe.material;if(gt)if(Array.isArray(gt))for(let Pt=0;Pt<gt.length;Pt++){const Ut=gt[Pt];!1===Ee.has(Ut)&&(co(Ut,Y,Fe),Ee.set(Ut))}else!1===Ee.has(gt)&&(co(gt,Y,Fe),Ee.set(gt))})};let _g=null;const Sf=new fb;function pM(Y,De,Ee,Fe){if(!1===Y.visible)return;if(Y.layers.test(De.layers))if(Y.isGroup)Ee=Y.renderOrder;else if(Y.isLOD)!0===Y.autoUpdate&&Y.update(De);else if(Y.isLight)D.pushLight(Y),Y.castShadow&&D.pushShadow(Y);else if(Y.isSprite){if(!Y.frustumCulled||bt.intersectsSprite(Y)){Fe&&fn.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(kn);const Ut=ie.update(Y),ln=Y.material;ln.visible&&E.push(Y,Ut,ln,Ee,fn.z,null)}}else if(Y.isImmediateRenderObject)Fe&&fn.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(kn),E.push(Y,null,Y.material,Ee,fn.z,null);else if((Y.isMesh||Y.isLine||Y.isPoints)&&(Y.isSkinnedMesh&&Y.skeleton.frame!==vi.render.frame&&(Y.skeleton.update(),Y.skeleton.frame=vi.render.frame),!Y.frustumCulled||bt.intersectsObject(Y))){Fe&&fn.setFromMatrixPosition(Y.matrixWorld).applyMatrix4(kn);const Ut=ie.update(Y),ln=Y.material;if(Array.isArray(ln)){const En=Ut.groups;for(let tr=0,Oi=En.length;tr<Oi;tr++){const vn=En[tr],xi=ln[vn.materialIndex];xi&&xi.visible&&E.push(Y,Ut,xi,Ee,fn.z,vn)}}else ln.visible&&E.push(Y,Ut,ln,Ee,fn.z,null)}const Pt=Y.children;for(let Ut=0,ln=Pt.length;Ut<ln;Ut++)pM(Pt[Ut],De,Ee,Fe)}function mM(Y,De,Ee){const Fe=!0===De.isScene?De.overrideMaterial:null;for(let gt=0,Pt=Y.length;gt<Pt;gt++){const Ut=Y[gt],ln=Ut.object,En=Ut.geometry,tr=null===Fe?Ut.material:Fe,Oi=Ut.group;if(Ee.isArrayCamera){const vn=Ee.cameras;for(let xi=0,Oo=vn.length;xi<Oo;xi++){const ki=vn[xi];ln.layers.test(ki.layers)&&(pn.viewport(he.copy(ki.viewport)),D.setupLightsView(ki),yg(ln,De,ki,En,tr,Oi))}}else yg(ln,De,Ee,En,tr,Oi)}}function yg(Y,De,Ee,Fe,gt,Pt){if(Y.onBeforeRender(F,De,Ee,Fe,gt,Pt),Y.modelViewMatrix.multiplyMatrices(Ee.matrixWorldInverse,Y.matrixWorld),Y.normalMatrix.getNormalMatrix(Y.modelViewMatrix),Y.isImmediateRenderObject){const Ut=gM(Ee,De,gt,Y);pn.setMaterial(gt),Zt.reset(),function fM(Y,De){Y.render(function(Ee){F.renderBufferImmediate(Ee,De)})}(Y,Ut)}else F.renderBufferDirect(Ee,De,Fe,gt,Y,Pt);Y.onAfterRender(F,De,Ee,Fe,gt,Pt)}function co(Y,De,Ee){!0!==De.isScene&&(De=Li);const Fe=Qe.get(Y),gt=D.state.lights,Ut=gt.state.version,ln=Q.getParameters(Y,gt.state,D.state.shadowsArray,De,Ee),En=Q.getProgramCacheKey(ln);let tr=Fe.program,Oi=!0;if(Fe.environment=Y.isMeshStandardMaterial?De.environment:null,Fe.fog=De.fog,Fe.envMap=et.get(Y.envMap||Fe.environment),void 0===tr)Y.addEventListener("dispose",ra);else if(tr.cacheKey!==En)No(Y);else if(Fe.lightsStateVersion!==Ut)Oi=!1;else{if(void 0!==ln.shaderID)return;Oi=!1}Oi&&(ln.uniforms=Q.getUniforms(Y),Y.onBeforeCompile(ln,F),tr=Q.acquireProgram(ln,En),Fe.program=tr,Fe.uniforms=ln.uniforms,Fe.outputEncoding=ln.outputEncoding);const vn=Fe.uniforms;(!Y.isShaderMaterial&&!Y.isRawShaderMaterial||!0===Y.clipping)&&(Fe.numClippingPlanes=nt.numPlanes,Fe.numIntersection=nt.numIntersection,vn.clippingPlanes=nt.uniform),Fe.needsLights=function mA(Y){return Y.isMeshLambertMaterial||Y.isMeshToonMaterial||Y.isMeshPhongMaterial||Y.isMeshStandardMaterial||Y.isShadowMaterial||Y.isShaderMaterial&&!0===Y.lights}(Y),Fe.lightsStateVersion=Ut,Fe.needsLights&&(vn.ambientLightColor.value=gt.state.ambient,vn.lightProbe.value=gt.state.probe,vn.directionalLights.value=gt.state.directional,vn.directionalLightShadows.value=gt.state.directionalShadow,vn.spotLights.value=gt.state.spot,vn.spotLightShadows.value=gt.state.spotShadow,vn.rectAreaLights.value=gt.state.rectArea,vn.ltc_1.value=gt.state.rectAreaLTC1,vn.ltc_2.value=gt.state.rectAreaLTC2,vn.pointLights.value=gt.state.point,vn.pointLightShadows.value=gt.state.pointShadow,vn.hemisphereLights.value=gt.state.hemi,vn.directionalShadowMap.value=gt.state.directionalShadowMap,vn.directionalShadowMatrix.value=gt.state.directionalShadowMatrix,vn.spotShadowMap.value=gt.state.spotShadowMap,vn.spotShadowMatrix.value=gt.state.spotShadowMatrix,vn.pointShadowMap.value=gt.state.pointShadowMap,vn.pointShadowMatrix.value=gt.state.pointShadowMatrix);const xi=Fe.program.getUniforms(),Oo=il.seqWithValue(xi.seq,vn);Fe.uniformsList=Oo}function gM(Y,De,Ee,Fe){!0!==De.isScene&&(De=Li),lt.resetTextureUnits();const gt=De.fog,Pt=Ee.isMeshStandardMaterial?De.environment:null,Ut=null===G?F.outputEncoding:G.texture.encoding,ln=et.get(Ee.envMap||Pt),En=Qe.get(Ee),tr=D.state.lights;!0!==Ot||!0!==It&&Y===re||nt.setState(Ee,Y,Y===re&&Ee.id===H),Ee.version===En.__version?(Ee.fog&&En.fog!==gt||En.environment!==Pt||En.needsLights&&En.lightsStateVersion!==tr.state.version||void 0!==En.numClippingPlanes&&(En.numClippingPlanes!==nt.numPlanes||En.numIntersection!==nt.numIntersection)||En.outputEncoding!==Ut||En.envMap!==ln)&&co(Ee,De,Fe):(co(Ee,De,Fe),En.__version=Ee.version);let Oi=!1,vn=!1,xi=!1;const Oo=En.program,ki=Oo.getUniforms(),La=En.uniforms;if(pn.useProgram(Oo.program)&&(Oi=!0,vn=!0,xi=!0),Ee.id!==H&&(H=Ee.id,vn=!0),Oi||re!==Y){if(ki.setValue(Ue,"projectionMatrix",Y.projectionMatrix),yi.logarithmicDepthBuffer&&ki.setValue(Ue,"logDepthBufFC",2/(Math.log(Y.far+1)/Math.LN2)),re!==Y&&(re=Y,vn=!0,xi=!0),Ee.isShaderMaterial||Ee.isMeshPhongMaterial||Ee.isMeshToonMaterial||Ee.isMeshStandardMaterial||Ee.envMap){const Hr=ki.map.cameraPosition;void 0!==Hr&&Hr.setValue(Ue,fn.setFromMatrixPosition(Y.matrixWorld))}(Ee.isMeshPhongMaterial||Ee.isMeshToonMaterial||Ee.isMeshLambertMaterial||Ee.isMeshBasicMaterial||Ee.isMeshStandardMaterial||Ee.isShaderMaterial)&&ki.setValue(Ue,"isOrthographic",!0===Y.isOrthographicCamera),(Ee.isMeshPhongMaterial||Ee.isMeshToonMaterial||Ee.isMeshLambertMaterial||Ee.isMeshBasicMaterial||Ee.isMeshStandardMaterial||Ee.isShaderMaterial||Ee.isShadowMaterial||Ee.skinning)&&ki.setValue(Ue,"viewMatrix",Y.matrixWorldInverse)}if(Ee.skinning){ki.setOptional(Ue,Fe,"bindMatrix"),ki.setOptional(Ue,Fe,"bindMatrixInverse");const Hr=Fe.skeleton;if(Hr){const r0=Hr.bones;if(yi.floatVertexTextures){if(null===Hr.boneTexture){let Hs=Math.sqrt(4*r0.length);Hs=Jt.ceilPowerOfTwo(Hs),Hs=Math.max(Hs,4);const Ef=new Float32Array(Hs*Hs*4);Ef.set(Hr.boneMatrices);const Sd=new Qa(Ef,Hs,Hs,Xs,Wa);Hr.boneMatrices=Ef,Hr.boneTexture=Sd,Hr.boneTextureSize=Hs}ki.setValue(Ue,"boneTexture",Hr.boneTexture,lt),ki.setValue(Ue,"boneTextureSize",Hr.boneTextureSize)}else ki.setOptional(Ue,Hr,"boneMatrices")}}return(vn||En.receiveShadow!==Fe.receiveShadow)&&(En.receiveShadow=Fe.receiveShadow,ki.setValue(Ue,"receiveShadow",Fe.receiveShadow)),vn&&(ki.setValue(Ue,"toneMappingExposure",F.toneMappingExposure),En.needsLights&&function _M(Y,De){Y.ambientLightColor.needsUpdate=De,Y.lightProbe.needsUpdate=De,Y.directionalLights.needsUpdate=De,Y.directionalLightShadows.needsUpdate=De,Y.pointLights.needsUpdate=De,Y.pointLightShadows.needsUpdate=De,Y.spotLights.needsUpdate=De,Y.spotLightShadows.needsUpdate=De,Y.rectAreaLights.needsUpdate=De,Y.hemisphereLights.needsUpdate=De}(La,xi),gt&&Ee.fog&&We.refreshFogUniforms(La,gt),We.refreshMaterialUniforms(La,Ee,be,Ce),il.upload(Ue,En.uniformsList,La,lt)),Ee.isShaderMaterial&&!0===Ee.uniformsNeedUpdate&&(il.upload(Ue,En.uniformsList,La,lt),Ee.uniformsNeedUpdate=!1),Ee.isSpriteMaterial&&ki.setValue(Ue,"center",Fe.center),ki.setValue(Ue,"modelViewMatrix",Fe.modelViewMatrix),ki.setValue(Ue,"normalMatrix",Fe.normalMatrix),ki.setValue(Ue,"modelMatrix",Fe.matrixWorld),Oo}Sf.setAnimationLoop(function pA(Y){wt.isPresenting||_g&&_g(Y)}),"undefined"!=typeof window&&Sf.setContext(window),this.setAnimationLoop=function(Y){_g=Y,wt.setAnimationLoop(Y),null===Y?Sf.stop():Sf.start()},this.render=function(Y,De){let Ee,Fe;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ee=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),Fe=arguments[3]),void 0!==De&&!0!==De.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===V)return;Zt.resetDefaultState(),H=-1,re=null,!0===Y.autoUpdate&&Y.updateMatrixWorld(),null===De.parent&&De.updateMatrixWorld(),!0===wt.enabled&&!0===wt.isPresenting&&(De=wt.getCamera(De)),!0===Y.isScene&&Y.onBeforeRender(F,Y,De,Ee||G),D=ue.get(Y,I.length),D.init(),I.push(D),kn.multiplyMatrices(De.projectionMatrix,De.matrixWorldInverse),bt.setFromProjectionMatrix(kn),It=this.localClippingEnabled,Ot=nt.init(this.clippingPlanes,It,De),E=Ye.get(Y,R.length),E.init(),R.push(E),pM(Y,De,0,F.sortObjects),E.finish(),!0===F.sortObjects&&E.sort(de,ve),!0===Ot&&nt.beginShadows();const gt=D.state.shadowsArray;fi.render(gt,Y,De),D.setupLights(),D.setupLightsView(De),!0===Ot&&nt.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==Ee&&this.setRenderTarget(Ee),St.render(E,Y,De,Fe);const Pt=E.opaque,Ut=E.transparent;Pt.length>0&&mM(Pt,Y,De),Ut.length>0&&mM(Ut,Y,De),!0===Y.isScene&&Y.onAfterRender(F,Y,De),null!==G&&(lt.updateRenderTargetMipmap(G),lt.updateMultisampleRenderTarget(G)),pn.buffers.depth.setTest(!0),pn.buffers.depth.setMask(!0),pn.buffers.color.setMask(!0),pn.setPolygonOffset(!1),I.pop(),D=I.length>0?I[I.length-1]:null,R.pop(),E=R.length>0?R[R.length-1]:null},this.setFramebuffer=function(Y){N!==Y&&null===G&&Ue.bindFramebuffer(36160,Y),N=Y},this.getActiveCubeFace=function(){return L},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return G},this.setRenderTarget=function(Y,De=0,Ee=0){G=Y,L=De,j=Ee,Y&&void 0===Qe.get(Y).__webglFramebuffer&&lt.setupRenderTarget(Y);let Fe=N,gt=!1,Pt=!1;if(Y){const Ut=Y.texture;(Ut.isDataTexture3D||Ut.isDataTexture2DArray)&&(Pt=!0);const ln=Qe.get(Y).__webglFramebuffer;Y.isWebGLCubeRenderTarget?(Fe=ln[De],gt=!0):Fe=Y.isWebGLMultisampleRenderTarget?Qe.get(Y).__webglMultisampledFramebuffer:ln,he.copy(Y.viewport),se.copy(Y.scissor),fe=Y.scissorTest}else he.copy(Ae).multiplyScalar(be).floor(),se.copy(He).multiplyScalar(be).floor(),fe=Ze;if(K!==Fe&&(Ue.bindFramebuffer(36160,Fe),K=Fe),pn.viewport(he),pn.scissor(se),pn.setScissorTest(fe),gt){const Ut=Qe.get(Y.texture);Ue.framebufferTexture2D(36160,36064,34069+De,Ut.__webglTexture,Ee)}else if(Pt){const Ut=Qe.get(Y.texture);Ue.framebufferTextureLayer(36160,36064,Ut.__webglTexture,Ee||0,De||0)}},this.readRenderTargetPixels=function(Y,De,Ee,Fe,gt,Pt,Ut){if(!Y||!Y.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ln=Qe.get(Y).__webglFramebuffer;if(Y.isWebGLCubeRenderTarget&&void 0!==Ut&&(ln=ln[Ut]),ln){let En=!1;ln!==K&&(Ue.bindFramebuffer(36160,ln),En=!0);try{const tr=Y.texture,Oi=tr.format,vn=tr.type;if(Oi!==Xs&&nn.convert(Oi)!==Ue.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const xi=vn===rh&&(ii.has("EXT_color_buffer_half_float")||yi.isWebGL2&&ii.has("EXT_color_buffer_float"));if(!(vn===au||nn.convert(vn)===Ue.getParameter(35738)||vn===Wa&&(yi.isWebGL2||ii.has("OES_texture_float")||ii.has("WEBGL_color_buffer_float"))||xi))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Ue.checkFramebufferStatus(36160)?De>=0&&De<=Y.width-Fe&&Ee>=0&&Ee<=Y.height-gt&&Ue.readPixels(De,Ee,Fe,gt,nn.convert(Oi),nn.convert(vn),Pt):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{En&&Ue.bindFramebuffer(36160,K)}}},this.copyFramebufferToTexture=function(Y,De,Ee=0){const Fe=Math.pow(2,-Ee),gt=Math.floor(De.image.width*Fe),Pt=Math.floor(De.image.height*Fe),Ut=nn.convert(De.format);lt.setTexture2D(De,0),Ue.copyTexImage2D(3553,Ee,Ut,Y.x,Y.y,gt,Pt,0),pn.unbindTexture()},this.copyTextureToTexture=function(Y,De,Ee,Fe=0){const gt=De.image.width,Pt=De.image.height,Ut=nn.convert(Ee.format),ln=nn.convert(Ee.type);lt.setTexture2D(Ee,0),Ue.pixelStorei(37440,Ee.flipY),Ue.pixelStorei(37441,Ee.premultiplyAlpha),Ue.pixelStorei(3317,Ee.unpackAlignment),De.isDataTexture?Ue.texSubImage2D(3553,Fe,Y.x,Y.y,gt,Pt,Ut,ln,De.image.data):De.isCompressedTexture?Ue.compressedTexSubImage2D(3553,Fe,Y.x,Y.y,De.mipmaps[0].width,De.mipmaps[0].height,Ut,De.mipmaps[0].data):Ue.texSubImage2D(3553,Fe,Y.x,Y.y,Ut,ln,De.image),0===Fe&&Ee.generateMipmaps&&Ue.generateMipmap(3553),pn.unbindTexture()},this.copyTextureToTexture3D=function(Y,De,Ee,Fe,gt=0){if(F.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const{width:Pt,height:Ut,data:ln}=Ee.image,En=nn.convert(Fe.format),tr=nn.convert(Fe.type);let Oi;if(Fe.isDataTexture3D)lt.setTexture3D(Fe,0),Oi=32879;else{if(!Fe.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");lt.setTexture2DArray(Fe,0),Oi=35866}Ue.pixelStorei(37440,Fe.flipY),Ue.pixelStorei(37441,Fe.premultiplyAlpha),Ue.pixelStorei(3317,Fe.unpackAlignment);const vn=Ue.getParameter(3314),xi=Ue.getParameter(32878),Oo=Ue.getParameter(3316),ki=Ue.getParameter(3315),La=Ue.getParameter(32877);Ue.pixelStorei(3314,Pt),Ue.pixelStorei(32878,Ut),Ue.pixelStorei(3316,Y.min.x),Ue.pixelStorei(3315,Y.min.y),Ue.pixelStorei(32877,Y.min.z),Ue.texSubImage3D(Oi,gt,De.x,De.y,De.z,Y.max.x-Y.min.x+1,Y.max.y-Y.min.y+1,Y.max.z-Y.min.z+1,En,tr,ln),Ue.pixelStorei(3314,vn),Ue.pixelStorei(32878,xi),Ue.pixelStorei(3316,Oo),Ue.pixelStorei(3315,ki),Ue.pixelStorei(32877,La),0===gt&&Fe.generateMipmaps&&Ue.generateMipmap(Oi),pn.unbindTexture()},this.initTexture=function(Y){lt.setTexture2D(Y,0),pn.unbindTexture()},this.resetState=function(){pn.reset(),Zt.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Fl.prototype.isGroup=!0,Object.assign(zh.prototype,{constructor:zh,getHandSpace:function(){return null===this._hand&&(this._hand=new Fl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Fl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Fl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(u){return null!==this._targetRay&&this._targetRay.dispatchEvent(u),null!==this._grip&&this._grip.dispatchEvent(u),null!==this._hand&&this._hand.dispatchEvent(u),this},disconnect:function(u){return this.dispatchEvent({type:"disconnected",data:u}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(u,s,a){let d=null,f=null,m=null;const _=this._targetRay,v=this._grip,b=this._hand;if(u&&"visible-blurred"!==s.session.visibilityState)if(b&&u.hand){m=!0;for(const I of u.hand.values()){const F=s.getJointPose(I,a);if(void 0===b.joints[I.jointName]){const N=new Fl;N.matrixAutoUpdate=!1,N.visible=!1,b.joints[I.jointName]=N,b.add(N)}const V=b.joints[I.jointName];null!==F&&(V.matrix.fromArray(F.transform.matrix),V.matrix.decompose(V.position,V.rotation,V.scale),V.jointRadius=F.radius),V.visible=null!==F}const E=b.joints["index-finger-tip"].position.distanceTo(b.joints["thumb-tip"].position),D=.02,R=.005;b.inputState.pinching&&E>D+R?(b.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:u.handedness,target:this})):!b.inputState.pinching&&E<=D-R&&(b.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:u.handedness,target:this}))}else null!==_&&(d=s.getPose(u.targetRaySpace,a),null!==d&&(_.matrix.fromArray(d.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale))),null!==v&&u.gripSpace&&(f=s.getPose(u.gripSpace,a),null!==f&&(v.matrix.fromArray(f.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale)));return null!==_&&(_.visible=null!==d),null!==v&&(v.visible=null!==f),null!==b&&(b.visible=null!==m),this}}),Object.assign(Qy.prototype,Yi.prototype);class cw extends hi{}cw.prototype.isWebGL1Renderer=!0;class Ta{constructor(s,a){this.name="",this.color=new At(s),this.density=void 0!==a?a:25e-5}clone(){return new Ta(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Ta.prototype.isFogExp2=!0;class In{constructor(s,a,d){this.name="",this.color=new At(s),this.near=void 0!==a?a:1,this.far=void 0!==d?d:1e3}clone(){return new In(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}In.prototype.isFog=!0;class am extends en{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(s,a){return super.copy(s,a),null!==s.background&&(this.background=s.background.clone()),null!==s.environment&&(this.environment=s.environment.clone()),null!==s.fog&&(this.fog=s.fog.clone()),null!==s.overrideMaterial&&(this.overrideMaterial=s.overrideMaterial.clone()),this.autoUpdate=s.autoUpdate,this.matrixAutoUpdate=s.matrixAutoUpdate,this}toJSON(s){const a=super.toJSON(s);return null!==this.background&&(a.object.background=this.background.toJSON(s)),null!==this.environment&&(a.object.environment=this.environment.toJSON(s)),null!==this.fog&&(a.object.fog=this.fog.toJSON()),a}}function oo(u,s){this.array=u,this.stride=s,this.count=void 0!==u?u.length/s:0,this.usage=si,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Jt.generateUUID()}am.prototype.isScene=!0,Object.defineProperty(oo.prototype,"needsUpdate",{set:function(u){!0===u&&this.version++}}),Object.assign(oo.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(u){return this.usage=u,this},copy:function(u){return this.array=new u.array.constructor(u.array),this.count=u.count,this.stride=u.stride,this.usage=u.usage,this},copyAt:function(u,s,a){u*=this.stride,a*=s.stride;for(let d=0,f=this.stride;d<f;d++)this.array[u+d]=s.array[a+d];return this},set:function(u,s=0){return this.array.set(u,s),this},clone:function(u){void 0===u.arrayBuffers&&(u.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Jt.generateUUID()),void 0===u.arrayBuffers[this.array.buffer._uuid]&&(u.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const a=new oo(new this.array.constructor(u.arrayBuffers[this.array.buffer._uuid]),this.stride);return a.setUsage(this.usage),a},onUpload:function(u){return this.onUploadCallback=u,this},toJSON:function(u){return void 0===u.arrayBuffers&&(u.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Jt.generateUUID()),void 0===u.arrayBuffers[this.array.buffer._uuid]&&(u.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Jo=new W;function hs(u,s,a,d){this.name="",this.data=u,this.itemSize=s,this.offset=a,this.normalized=!0===d}Object.defineProperties(hs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(u){this.data.needsUpdate=u}}}),Object.assign(hs.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(u){for(let s=0,a=this.data.count;s<a;s++)Jo.x=this.getX(s),Jo.y=this.getY(s),Jo.z=this.getZ(s),Jo.applyMatrix4(u),this.setXYZ(s,Jo.x,Jo.y,Jo.z);return this},setX:function(u,s){return this.data.array[u*this.data.stride+this.offset]=s,this},setY:function(u,s){return this.data.array[u*this.data.stride+this.offset+1]=s,this},setZ:function(u,s){return this.data.array[u*this.data.stride+this.offset+2]=s,this},setW:function(u,s){return this.data.array[u*this.data.stride+this.offset+3]=s,this},getX:function(u){return this.data.array[u*this.data.stride+this.offset]},getY:function(u){return this.data.array[u*this.data.stride+this.offset+1]},getZ:function(u){return this.data.array[u*this.data.stride+this.offset+2]},getW:function(u){return this.data.array[u*this.data.stride+this.offset+3]},setXY:function(u,s,a){return this.data.array[(u=u*this.data.stride+this.offset)+0]=s,this.data.array[u+1]=a,this},setXYZ:function(u,s,a,d){return this.data.array[(u=u*this.data.stride+this.offset)+0]=s,this.data.array[u+1]=a,this.data.array[u+2]=d,this},setXYZW:function(u,s,a,d,f){return this.data.array[(u=u*this.data.stride+this.offset)+0]=s,this.data.array[u+1]=a,this.data.array[u+2]=d,this.data.array[u+3]=f,this},clone:function(u){if(void 0===u){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const s=[];for(let a=0;a<this.count;a++){const d=a*this.data.stride+this.offset;for(let f=0;f<this.itemSize;f++)s.push(this.data.array[d+f])}return new Ke(new this.array.constructor(s),this.itemSize,this.normalized)}return void 0===u.interleavedBuffers&&(u.interleavedBuffers={}),void 0===u.interleavedBuffers[this.data.uuid]&&(u.interleavedBuffers[this.data.uuid]=this.data.clone(u)),new hs(u.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(u){if(void 0===u){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const s=[];for(let a=0;a<this.count;a++){const d=a*this.data.stride+this.offset;for(let f=0;f<this.itemSize;f++)s.push(this.data.array[d+f])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:s,normalized:this.normalized}}return void 0===u.interleavedBuffers&&(u.interleavedBuffers={}),void 0===u.interleavedBuffers[this.data.uuid]&&(u.interleavedBuffers[this.data.uuid]=this.data.toJSON(u)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});class lm extends Wn{constructor(s){super(),this.type="SpriteMaterial",this.color=new At(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.rotation=s.rotation,this.sizeAttenuation=s.sizeAttenuation,this}}let $u;lm.prototype.isSpriteMaterial=!0;const Ko=new W,Xu=new W,Nl=new W,Zu=new qe,Hh=new qe,cm=new Ht,ev=new W,um=new W,Yu=new W,v1=new qe,uw=new qe,x1=new qe;class tv extends en{constructor(s){if(super(),this.type="Sprite",void 0===$u){$u=new jt;const d=new oo(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);$u.setIndex([0,1,2,0,2,3]),$u.setAttribute("position",new hs(d,3,0,!1)),$u.setAttribute("uv",new hs(d,2,3,!1))}this.geometry=$u,this.material=void 0!==s?s:new lm,this.center=new qe(.5,.5)}raycast(s,a){null===s.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Xu.setFromMatrixScale(this.matrixWorld),cm.copy(s.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(s.camera.matrixWorldInverse,this.matrixWorld),Nl.setFromMatrixPosition(this.modelViewMatrix),s.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Xu.multiplyScalar(-Nl.z);const d=this.material.rotation;let f,m;0!==d&&(m=Math.cos(d),f=Math.sin(d));const _=this.center;nv(ev.set(-.5,-.5,0),Nl,_,Xu,f,m),nv(um.set(.5,-.5,0),Nl,_,Xu,f,m),nv(Yu.set(.5,.5,0),Nl,_,Xu,f,m),v1.set(0,0),uw.set(1,0),x1.set(1,1);let v=s.ray.intersectTriangle(ev,um,Yu,!1,Ko);if(null===v&&(nv(um.set(-.5,.5,0),Nl,_,Xu,f,m),uw.set(0,1),v=s.ray.intersectTriangle(ev,Yu,um,!1,Ko),null===v))return;const b=s.ray.origin.distanceTo(Ko);b<s.near||b>s.far||a.push({distance:b,point:Ko.clone(),uv:xr.getUV(Ko,ev,um,Yu,v1,uw,x1,new qe),face:null,object:this})}copy(s){return super.copy(s),void 0!==s.center&&this.center.copy(s.center),this.material=s.material,this}}function nv(u,s,a,d,f,m){Zu.subVectors(u,a).addScalar(.5).multiply(d),void 0!==f?(Hh.x=m*Zu.x-f*Zu.y,Hh.y=f*Zu.x+m*Zu.y):Hh.copy(Zu),u.copy(s),u.x+=Hh.x,u.y+=Hh.y,u.applyMatrix4(cm)}tv.prototype.isSprite=!0;const dm=new W,iv=new W;class Gh extends en{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(s){super.copy(s,!1);const a=s.levels;for(let d=0,f=a.length;d<f;d++){const m=a[d];this.addLevel(m.object.clone(),m.distance)}return this.autoUpdate=s.autoUpdate,this}addLevel(s,a=0){a=Math.abs(a);const d=this.levels;let f;for(f=0;f<d.length&&!(a<d[f].distance);f++);return d.splice(f,0,{distance:a,object:s}),this.add(s),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(s){const a=this.levels;if(a.length>0){let d,f;for(d=1,f=a.length;d<f&&!(s<a[d].distance);d++);return a[d-1].object}return null}raycast(s,a){if(this.levels.length>0){dm.setFromMatrixPosition(this.matrixWorld);const f=s.ray.origin.distanceTo(dm);this.getObjectForDistance(f).raycast(s,a)}}update(s){const a=this.levels;if(a.length>1){dm.setFromMatrixPosition(s.matrixWorld),iv.setFromMatrixPosition(this.matrixWorld);const d=dm.distanceTo(iv)/s.zoom;let f,m;for(a[0].object.visible=!0,f=1,m=a.length;f<m&&d>=a[f].distance;f++)a[f-1].object.visible=!1,a[f].object.visible=!0;for(this._currentLevel=f-1;f<m;f++)a[f].object.visible=!1}}toJSON(s){const a=super.toJSON(s);!1===this.autoUpdate&&(a.object.autoUpdate=!1),a.object.levels=[];const d=this.levels;for(let f=0,m=d.length;f<m;f++){const _=d[f];a.object.levels.push({object:_.object.uuid,distance:_.distance})}return a}}const rv=new W,dw=new $e,sv=new $e,ov=new W,hw=new Ht;function _c(u,s){Ni.call(this,u,s),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ht,this.bindMatrixInverse=new Ht}function ao(){en.call(this),this.type="Bone"}_c.prototype=Object.assign(Object.create(Ni.prototype),{constructor:_c,isSkinnedMesh:!0,copy:function(u){return Ni.prototype.copy.call(this,u),this.bindMode=u.bindMode,this.bindMatrix.copy(u.bindMatrix),this.bindMatrixInverse.copy(u.bindMatrixInverse),this.skeleton=u.skeleton,this},bind:function(u,s){this.skeleton=u,void 0===s&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),s=this.matrixWorld),this.bindMatrix.copy(s),this.bindMatrixInverse.copy(s).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const u=new $e,s=this.geometry.attributes.skinWeight;for(let a=0,d=s.count;a<d;a++){u.x=s.getX(a),u.y=s.getY(a),u.z=s.getZ(a),u.w=s.getW(a);const f=1/u.manhattanLength();f!==1/0?u.multiplyScalar(f):u.set(1,0,0,0),s.setXYZW(a,u.x,u.y,u.z,u.w)}},updateMatrixWorld:function(u){Ni.prototype.updateMatrixWorld.call(this,u),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(u,s){const a=this.skeleton,d=this.geometry;dw.fromBufferAttribute(d.attributes.skinIndex,u),sv.fromBufferAttribute(d.attributes.skinWeight,u),rv.fromBufferAttribute(d.attributes.position,u).applyMatrix4(this.bindMatrix),s.set(0,0,0);for(let f=0;f<4;f++){const m=sv.getComponent(f);if(0!==m){const _=dw.getComponent(f);hw.multiplyMatrices(a.bones[_].matrixWorld,a.boneInverses[_]),s.addScaledVector(ov.copy(rv).applyMatrix4(hw),m)}}return s.applyMatrix4(this.bindMatrixInverse)}}),ao.prototype=Object.assign(Object.create(en.prototype),{constructor:ao,isBone:!0});const fw=new Ht,b1=new Ht;class Wh{constructor(s=[],a=[]){this.uuid=Jt.generateUUID(),this.bones=s.slice(0),this.boneInverses=a,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const s=this.bones,a=this.boneInverses;if(this.boneMatrices=new Float32Array(16*s.length),0===a.length)this.calculateInverses();else if(s.length!==a.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let d=0,f=this.bones.length;d<f;d++)this.boneInverses.push(new Ht)}}calculateInverses(){this.boneInverses.length=0;for(let s=0,a=this.bones.length;s<a;s++){const d=new Ht;this.bones[s]&&d.copy(this.bones[s].matrixWorld).invert(),this.boneInverses.push(d)}}pose(){for(let s=0,a=this.bones.length;s<a;s++){const d=this.bones[s];d&&d.matrixWorld.copy(this.boneInverses[s]).invert()}for(let s=0,a=this.bones.length;s<a;s++){const d=this.bones[s];d&&(d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(d.matrixWorld)):d.matrix.copy(d.matrixWorld),d.matrix.decompose(d.position,d.quaternion,d.scale))}}update(){const s=this.bones,a=this.boneInverses,d=this.boneMatrices,f=this.boneTexture;for(let m=0,_=s.length;m<_;m++)fw.multiplyMatrices(s[m]?s[m].matrixWorld:b1,a[m]),fw.toArray(d,16*m);null!==f&&(f.needsUpdate=!0)}clone(){return new Wh(this.bones,this.boneInverses)}getBoneByName(s){for(let a=0,d=this.bones.length;a<d;a++){const f=this.bones[a];if(f.name===s)return f}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(s,a){this.uuid=s.uuid;for(let d=0,f=s.bones.length;d<f;d++){const m=s.bones[d];let _=a[m];void 0===_&&(console.warn("THREE.Skeleton: No bone found with UUID:",m),_=new ao),this.bones.push(_),this.boneInverses.push((new Ht).fromArray(s.boneInverses[d]))}return this.init(),this}toJSON(){const s={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};s.uuid=this.uuid;const a=this.bones,d=this.boneInverses;for(let f=0,m=a.length;f<m;f++)s.bones.push(a[f].uuid),s.boneInverses.push(d[f].toArray());return s}}const av=new Ht,pw=new Ht,hm=[],jh=new Ni;function fm(u,s,a){Ni.call(this,u,s),this.instanceMatrix=new Ke(new Float32Array(16*a),16),this.instanceColor=null,this.count=a,this.frustumCulled=!1}fm.prototype=Object.assign(Object.create(Ni.prototype),{constructor:fm,isInstancedMesh:!0,copy:function(u){return Ni.prototype.copy.call(this,u),this.instanceMatrix.copy(u.instanceMatrix),null!==u.instanceColor&&(this.instanceColor=u.instanceColor.clone()),this.count=u.count,this},getColorAt:function(u,s){s.fromArray(this.instanceColor.array,3*u)},getMatrixAt:function(u,s){s.fromArray(this.instanceMatrix.array,16*u)},raycast:function(u,s){const a=this.matrixWorld,d=this.count;if(jh.geometry=this.geometry,jh.material=this.material,void 0!==jh.material)for(let f=0;f<d;f++){this.getMatrixAt(f,av),pw.multiplyMatrices(a,av),jh.matrixWorld=pw,jh.raycast(u,hm);for(let m=0,_=hm.length;m<_;m++){const v=hm[m];v.instanceId=f,v.object=this,s.push(v)}hm.length=0}},setColorAt:function(u,s){null===this.instanceColor&&(this.instanceColor=new Ke(new Float32Array(3*this.count),3)),s.toArray(this.instanceColor.array,3*u)},setMatrixAt:function(u,s){s.toArray(this.instanceMatrix.array,16*u)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Mr extends Wn{constructor(s){super(),this.type="LineBasicMaterial",this.color=new At(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.linewidth=s.linewidth,this.linecap=s.linecap,this.linejoin=s.linejoin,this.morphTargets=s.morphTargets,this}}Mr.prototype.isLineBasicMaterial=!0;const mw=new W,gw=new W,_w=new Ht,pm=new cc,mm=new wl;function Qo(u=new jt,s=new Mr){en.call(this),this.type="Line",this.geometry=u,this.material=s,this.updateMorphTargets()}Qo.prototype=Object.assign(Object.create(en.prototype),{constructor:Qo,isLine:!0,copy:function(u){return en.prototype.copy.call(this,u),this.material=u.material,this.geometry=u.geometry,this},computeLineDistances:function(){const u=this.geometry;if(u.isBufferGeometry)if(null===u.index){const s=u.attributes.position,a=[0];for(let d=1,f=s.count;d<f;d++)mw.fromBufferAttribute(s,d-1),gw.fromBufferAttribute(s,d),a[d]=a[d-1],a[d]+=mw.distanceTo(gw);u.setAttribute("lineDistance",new pe(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else u.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(u,s){const a=this.geometry,d=this.matrixWorld,f=u.params.Line.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),mm.copy(a.boundingSphere),mm.applyMatrix4(d),mm.radius+=f,!1===u.ray.intersectsSphere(mm))return;_w.copy(d).invert(),pm.copy(u.ray).applyMatrix4(_w);const m=f/((this.scale.x+this.scale.y+this.scale.z)/3),_=m*m,v=new W,b=new W,w=new W,A=new W,E=this.isLineSegments?2:1;if(a.isBufferGeometry){const D=a.index,I=a.attributes.position;if(null!==D){const F=D.array;for(let V=0,N=F.length-1;V<N;V+=E){const j=F[V+1];if(v.fromBufferAttribute(I,F[V]),b.fromBufferAttribute(I,j),pm.distanceSqToSegment(v,b,A,w)>_)continue;A.applyMatrix4(this.matrixWorld);const K=u.ray.origin.distanceTo(A);K<u.near||K>u.far||s.push({distance:K,point:w.clone().applyMatrix4(this.matrixWorld),index:V,face:null,faceIndex:null,object:this})}}else for(let F=0,V=I.count-1;F<V;F+=E){if(v.fromBufferAttribute(I,F),b.fromBufferAttribute(I,F+1),pm.distanceSqToSegment(v,b,A,w)>_)continue;A.applyMatrix4(this.matrixWorld);const L=u.ray.origin.distanceTo(A);L<u.near||L>u.far||s.push({distance:L,point:w.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}else a.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const u=this.geometry;if(u.isBufferGeometry){const s=u.morphAttributes,a=Object.keys(s);if(a.length>0){const d=s[a[0]];if(void 0!==d){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let f=0,m=d.length;f<m;f++){const _=d[f].name||String(f);this.morphTargetInfluences.push(0),this.morphTargetDictionary[_]=f}}}}else{const s=u.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const fs=new W,gm=new W;function ps(u,s){Qo.call(this,u,s),this.type="LineSegments"}ps.prototype=Object.assign(Object.create(Qo.prototype),{constructor:ps,isLineSegments:!0,computeLineDistances:function(){const u=this.geometry;if(u.isBufferGeometry)if(null===u.index){const s=u.attributes.position,a=[];for(let d=0,f=s.count;d<f;d+=2)fs.fromBufferAttribute(s,d),gm.fromBufferAttribute(s,d+1),a[d]=0===d?0:a[d-1],a[d+1]=a[d]+fs.distanceTo(gm);u.setAttribute("lineDistance",new pe(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else u.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});class qh extends Qo{constructor(s,a){super(s,a),this.type="LineLoop"}}qh.prototype.isLineLoop=!0;class lr extends Wn{constructor(s){super(),this.type="PointsMaterial",this.color=new At(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.size=s.size,this.sizeAttenuation=s.sizeAttenuation,this.morphTargets=s.morphTargets,this}}lr.prototype.isPointsMaterial=!0;const Ju=new Ht,$h=new cc,_m=new wl,ym=new W;function yc(u=new jt,s=new lr){en.call(this),this.type="Points",this.geometry=u,this.material=s,this.updateMorphTargets()}function yw(u,s,a,d,f,m,_){const v=$h.distanceSqToPoint(u);if(v<a){const b=new W;$h.closestPointToPoint(u,b),b.applyMatrix4(d);const w=f.ray.origin.distanceTo(b);if(w<f.near||w>f.far)return;m.push({distance:w,distanceToRay:Math.sqrt(v),point:b,index:s,face:null,object:_})}}yc.prototype=Object.assign(Object.create(en.prototype),{constructor:yc,isPoints:!0,copy:function(u){return en.prototype.copy.call(this,u),this.material=u.material,this.geometry=u.geometry,this},raycast:function(u,s){const a=this.geometry,d=this.matrixWorld,f=u.params.Points.threshold;if(null===a.boundingSphere&&a.computeBoundingSphere(),_m.copy(a.boundingSphere),_m.applyMatrix4(d),_m.radius+=f,!1===u.ray.intersectsSphere(_m))return;Ju.copy(d).invert(),$h.copy(u.ray).applyMatrix4(Ju);const m=f/((this.scale.x+this.scale.y+this.scale.z)/3),_=m*m;if(a.isBufferGeometry){const v=a.index,w=a.attributes.position;if(null!==v){const A=v.array;for(let E=0,D=A.length;E<D;E++){const R=A[E];ym.fromBufferAttribute(w,R),yw(ym,R,_,d,u,s,this)}}else for(let A=0,E=w.count;A<E;A++)ym.fromBufferAttribute(w,A),yw(ym,A,_,d,u,s,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const u=this.geometry;if(u.isBufferGeometry){const s=u.morphAttributes,a=Object.keys(s);if(a.length>0){const d=s[a[0]];if(void 0!==d){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let f=0,m=d.length;f<m;f++){const _=d[f].name||String(f);this.morphTargetInfluences.push(0),this.morphTargetDictionary[_]=f}}}}else{const s=u.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});class lv extends Rr{constructor(s,a,d,f,m,_,v,b,w){super(s,a,d,f,m,_,v,b,w),this.format=void 0!==v?v:ss,this.minFilter=void 0!==_?_:fr,this.magFilter=void 0!==m?m:fr,this.generateMipmaps=!1;const A=this;"requestVideoFrameCallback"in s&&s.requestVideoFrameCallback(function E(){A.needsUpdate=!0,s.requestVideoFrameCallback(E)})}clone(){return new this.constructor(this.image).copy(this)}update(){const s=this.image;"requestVideoFrameCallback"in s==0&&s.readyState>=s.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}lv.prototype.isVideoTexture=!0;class cv extends Rr{constructor(s,a,d,f,m,_,v,b,w,A,E,D){super(null,_,v,b,w,A,f,m,E,D),this.image={width:a,height:d},this.mipmaps=s,this.flipY=!1,this.generateMipmaps=!1}}cv.prototype.isCompressedTexture=!0;class uv extends Rr{constructor(s,a,d,f,m,_,v,b,w){super(s,a,d,f,m,_,v,b,w),this.needsUpdate=!0}}uv.prototype.isCanvasTexture=!0;class vw extends Rr{constructor(s,a,d,f,m,_,v,b,w,A){if((A=void 0!==A?A:uu)!==uu&&A!==du)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===d&&A===uu&&(d=lu),void 0===d&&A===du&&(d=cu),super(null,f,m,_,v,b,A,d,w),this.image={width:s,height:a},this.magFilter=void 0!==v?v:kr,this.minFilter=void 0!==b?b:kr,this.flipY=!1,this.generateMipmaps=!1}}vw.prototype.isDepthTexture=!0;class vm extends jt{constructor(s=1,a=8,d=0,f=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:s,segments:a,thetaStart:d,thetaLength:f},a=Math.max(3,a);const m=[],_=[],v=[],b=[],w=new W,A=new qe;_.push(0,0,0),v.push(0,0,1),b.push(.5,.5);for(let E=0,D=3;E<=a;E++,D+=3){const R=d+E/a*f;w.x=s*Math.cos(R),w.y=s*Math.sin(R),_.push(w.x,w.y,w.z),v.push(0,0,1),A.x=(_[D]/s+1)/2,A.y=(_[D+1]/s+1)/2,b.push(A.x,A.y)}for(let E=1;E<=a;E++)m.push(E,E+1,0);this.setIndex(m),this.setAttribute("position",new pe(_,3)),this.setAttribute("normal",new pe(v,3)),this.setAttribute("uv",new pe(b,2))}}class Ku extends jt{constructor(s=1,a=1,d=1,f=8,m=1,_=!1,v=0,b=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:s,radiusBottom:a,height:d,radialSegments:f,heightSegments:m,openEnded:_,thetaStart:v,thetaLength:b};const w=this;f=Math.floor(f),m=Math.floor(m);const A=[],E=[],D=[],R=[];let I=0;const F=[],V=d/2;let N=0;function j(G){const K=I,H=new qe,re=new W;let he=0;const se=!0===G?s:a,fe=!0===G?1:-1;for(let Ce=1;Ce<=f;Ce++)E.push(0,V*fe,0),D.push(0,fe,0),R.push(.5,.5),I++;const we=I;for(let Ce=0;Ce<=f;Ce++){const de=Ce/f*b+v,ve=Math.cos(de),Ae=Math.sin(de);re.x=se*Ae,re.y=V*fe,re.z=se*ve,E.push(re.x,re.y,re.z),D.push(0,fe,0),H.x=.5*ve+.5,H.y=.5*Ae*fe+.5,R.push(H.x,H.y),I++}for(let Ce=0;Ce<f;Ce++){const be=K+Ce,de=we+Ce;!0===G?A.push(de,de+1,be):A.push(de+1,de,be),he+=3}w.addGroup(N,he,!0===G?1:2),N+=he}(function L(){const G=new W,K=new W;let H=0;const re=(a-s)/d;for(let he=0;he<=m;he++){const se=[],fe=he/m,we=fe*(a-s)+s;for(let Ce=0;Ce<=f;Ce++){const be=Ce/f,de=be*b+v,ve=Math.sin(de),Ae=Math.cos(de);K.x=we*ve,K.y=-fe*d+V,K.z=we*Ae,E.push(K.x,K.y,K.z),G.set(ve,re,Ae).normalize(),D.push(G.x,G.y,G.z),R.push(be,1-fe),se.push(I++)}F.push(se)}for(let he=0;he<f;he++)for(let se=0;se<m;se++){const we=F[se+1][he],Ce=F[se+1][he+1],be=F[se][he+1];A.push(F[se][he],we,be),A.push(we,Ce,be),H+=6}w.addGroup(N,H,0),N+=H})(),!1===_&&(s>0&&j(!0),a>0&&j(!1)),this.setIndex(A),this.setAttribute("position",new pe(E,3)),this.setAttribute("normal",new pe(D,3)),this.setAttribute("uv",new pe(R,2))}}class Xh extends Ku{constructor(s=1,a=1,d=8,f=1,m=!1,_=0,v=2*Math.PI){super(0,s,a,d,f,m,_,v),this.type="ConeGeometry",this.parameters={radius:s,height:a,radialSegments:d,heightSegments:f,openEnded:m,thetaStart:_,thetaLength:v}}}class Ol extends jt{constructor(s,a,d=1,f=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:s,indices:a,radius:d,detail:f};const m=[],_=[];function b(L,j,G,K){const H=K+1,re=[];for(let he=0;he<=H;he++){re[he]=[];const se=L.clone().lerp(G,he/H),fe=j.clone().lerp(G,he/H),we=H-he;for(let Ce=0;Ce<=we;Ce++)re[he][Ce]=0===Ce&&he===H?se:se.clone().lerp(fe,Ce/we)}for(let he=0;he<H;he++)for(let se=0;se<2*(H-he)-1;se++){const fe=Math.floor(se/2);se%2==0?(D(re[he][fe+1]),D(re[he+1][fe]),D(re[he][fe])):(D(re[he][fe+1]),D(re[he+1][fe+1]),D(re[he+1][fe]))}}function D(L){m.push(L.x,L.y,L.z)}function R(L,j){const G=3*L;j.x=s[G+0],j.y=s[G+1],j.z=s[G+2]}function F(L,j,G,K){K<0&&1===L.x&&(_[j]=L.x-1),0===G.x&&0===G.z&&(_[j]=K/2/Math.PI+.5)}function V(L){return Math.atan2(L.z,-L.x)}function N(L){return Math.atan2(-L.y,Math.sqrt(L.x*L.x+L.z*L.z))}(function v(L){const j=new W,G=new W,K=new W;for(let H=0;H<a.length;H+=3)R(a[H+0],j),R(a[H+1],G),R(a[H+2],K),b(j,G,K,L)})(f),function w(L){const j=new W;for(let G=0;G<m.length;G+=3)j.x=m[G+0],j.y=m[G+1],j.z=m[G+2],j.normalize().multiplyScalar(L),m[G+0]=j.x,m[G+1]=j.y,m[G+2]=j.z}(d),function A(){const L=new W;for(let j=0;j<m.length;j+=3){L.x=m[j+0],L.y=m[j+1],L.z=m[j+2];const G=V(L)/2/Math.PI+.5,K=N(L)/Math.PI+.5;_.push(G,1-K)}(function I(){const L=new W,j=new W,G=new W,K=new W,H=new qe,re=new qe,he=new qe;for(let se=0,fe=0;se<m.length;se+=9,fe+=6){L.set(m[se+0],m[se+1],m[se+2]),j.set(m[se+3],m[se+4],m[se+5]),G.set(m[se+6],m[se+7],m[se+8]),H.set(_[fe+0],_[fe+1]),re.set(_[fe+2],_[fe+3]),he.set(_[fe+4],_[fe+5]),K.copy(L).add(j).add(G).divideScalar(3);const we=V(K);F(H,fe+0,L,we),F(re,fe+2,j,we),F(he,fe+4,G,we)}})(),function E(){for(let L=0;L<_.length;L+=6){const j=_[L+0],G=_[L+2],K=_[L+4],H=Math.max(j,G,K),re=Math.min(j,G,K);H>.9&&re<.1&&(j<.2&&(_[L+0]+=1),G<.2&&(_[L+2]+=1),K<.2&&(_[L+4]+=1))}}()}(),this.setAttribute("position",new pe(m,3)),this.setAttribute("normal",new pe(m.slice(),3)),this.setAttribute("uv",new pe(_,2)),0===f?this.computeVertexNormals():this.normalizeNormals()}}class xm extends Ol{constructor(s=1,a=0){const d=(1+Math.sqrt(5))/2,f=1/d;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-f,-d,0,-f,d,0,f,-d,0,f,d,-f,-d,0,-f,d,0,f,-d,0,f,d,0,-d,0,-f,d,0,-f,-d,0,f,d,0,f],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s,a),this.type="DodecahedronGeometry",this.parameters={radius:s,detail:a}}}const rl=new W,Ao=new W,dv=new W,bm=new xr;class xw extends jt{constructor(s,a){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:a},a=void 0!==a?a:1,!0===s.isGeometry)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const f=Math.pow(10,4),m=Math.cos(Jt.DEG2RAD*a),_=s.getIndex(),v=s.getAttribute("position"),b=_?_.count:v.count,w=[0,0,0],A=["a","b","c"],E=new Array(3),D={},R=[];for(let I=0;I<b;I+=3){_?(w[0]=_.getX(I),w[1]=_.getX(I+1),w[2]=_.getX(I+2)):(w[0]=I,w[1]=I+1,w[2]=I+2);const{a:F,b:V,c:N}=bm;if(F.fromBufferAttribute(v,w[0]),V.fromBufferAttribute(v,w[1]),N.fromBufferAttribute(v,w[2]),bm.getNormal(dv),E[0]=`${Math.round(F.x*f)},${Math.round(F.y*f)},${Math.round(F.z*f)}`,E[1]=`${Math.round(V.x*f)},${Math.round(V.y*f)},${Math.round(V.z*f)}`,E[2]=`${Math.round(N.x*f)},${Math.round(N.y*f)},${Math.round(N.z*f)}`,E[0]!==E[1]&&E[1]!==E[2]&&E[2]!==E[0])for(let L=0;L<3;L++){const j=(L+1)%3,G=E[L],K=E[j],H=bm[A[L]],re=bm[A[j]],he=`${G}_${K}`,se=`${K}_${G}`;se in D&&D[se]?(dv.dot(D[se].normal)<=m&&(R.push(H.x,H.y,H.z),R.push(re.x,re.y,re.z)),D[se]=null):he in D||(D[he]={index0:w[L],index1:w[j],normal:dv.clone()})}}for(const I in D)if(D[I]){const{index0:F,index1:V}=D[I];rl.fromBufferAttribute(v,F),Ao.fromBufferAttribute(v,V),R.push(rl.x,rl.y,rl.z),R.push(Ao.x,Ao.y,Ao.z)}this.setAttribute("position",new pe(R,3))}}function hv(u,s,a,d,f){let m,_;if(f===function T1(u,s,a,d){let f=0;for(let m=s,_=a-d;m<a;m+=d)f+=(u[_]-u[m])*(u[m+1]+u[_+1]),_=m;return f}(u,s,a,d)>0)for(m=s;m<a;m+=d)_=Sm(m,u[m],u[m+1],_);else for(m=a-d;m>=s;m-=d)_=Sm(m,u[m],u[m+1],_);return _&&ed(_,_.next)&&(td(_),_=_.next),_}function vc(u,s){if(!u)return u;s||(s=u);let d,a=u;do{if(d=!1,a.steiner||!ed(a,a.next)&&0!==er(a.prev,a,a.next))a=a.next;else{if(td(a),a=s=a.prev,a===a.next)break;d=!0}}while(d||a!==s);return s}function Ur(u,s,a,d,f,m,_){if(!u)return;!_&&m&&function gv(u,s,a,d){let f=u;do{null===f.z&&(f.z=Sw(f.x,f.y,s,a,d)),f.prevZ=f.prev,f.nextZ=f.next,f=f.next}while(f!==u);f.prevZ.nextZ=null,f.prevZ=null,function Mw(u){let s,a,d,f,m,_,v,b,w=1;do{for(a=u,u=null,m=null,_=0;a;){for(_++,d=a,v=0,s=0;s<w&&(v++,d=d.nextZ,d);s++);for(b=w;v>0||b>0&&d;)0!==v&&(0===b||!d||a.z<=d.z)?(f=a,a=a.nextZ,v--):(f=d,d=d.nextZ,b--),m?m.nextZ=f:u=f,f.prevZ=m,m=f;a=d}m.nextZ=null,w*=2}while(_>1)}(f)}(u,d,f,m);let b,w,v=u;for(;u.prev!==u.next;)if(b=u.prev,w=u.next,m?pv(u,d,f,m):fv(u))s.push(b.i/a),s.push(u.i/a),s.push(w.i/a),td(u),u=w.next,v=w.next;else if((u=w)===v){_?1===_?Ur(u=w1(vc(u),s,a),s,a,d,f,m,2):2===_&&bw(u,s,a,d,f,m):Ur(vc(u),s,a,d,f,m,1);break}}function fv(u){const s=u.prev,a=u,d=u.next;if(er(s,a,d)>=0)return!1;let f=u.next.next;for(;f!==u.prev;){if(kl(s.x,s.y,a.x,a.y,d.x,d.y,f.x,f.y)&&er(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function pv(u,s,a,d){const f=u.prev,m=u,_=u.next;if(er(f,m,_)>=0)return!1;const w=f.x>m.x?f.x>_.x?f.x:_.x:m.x>_.x?m.x:_.x,A=f.y>m.y?f.y>_.y?f.y:_.y:m.y>_.y?m.y:_.y,E=Sw(f.x<m.x?f.x<_.x?f.x:_.x:m.x<_.x?m.x:_.x,f.y<m.y?f.y<_.y?f.y:_.y:m.y<_.y?m.y:_.y,s,a,d),D=Sw(w,A,s,a,d);let R=u.prevZ,I=u.nextZ;for(;R&&R.z>=E&&I&&I.z<=D;){if(R!==u.prev&&R!==u.next&&kl(f.x,f.y,m.x,m.y,_.x,_.y,R.x,R.y)&&er(R.prev,R,R.next)>=0||(R=R.prevZ,I!==u.prev&&I!==u.next&&kl(f.x,f.y,m.x,m.y,_.x,_.y,I.x,I.y)&&er(I.prev,I,I.next)>=0))return!1;I=I.nextZ}for(;R&&R.z>=E;){if(R!==u.prev&&R!==u.next&&kl(f.x,f.y,m.x,m.y,_.x,_.y,R.x,R.y)&&er(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;I&&I.z<=D;){if(I!==u.prev&&I!==u.next&&kl(f.x,f.y,m.x,m.y,_.x,_.y,I.x,I.y)&&er(I.prev,I,I.next)>=0)return!1;I=I.nextZ}return!0}function w1(u,s,a){let d=u;do{const f=d.prev,m=d.next.next;!ed(f,m)&&Cw(f,d,d.next,m)&&Yh(f,m)&&Yh(m,f)&&(s.push(f.i/a),s.push(d.i/a),s.push(m.i/a),td(d),td(d.next),d=u=m),d=d.next}while(d!==u);return vc(d)}function bw(u,s,a,d,f,m){let _=u;do{let v=_.next.next;for(;v!==_.prev;){if(_.i!==v.i&&Ew(_,v)){let b=_v(_,v);return _=vc(_,_.next),b=vc(b,b.next),Ur(_,s,a,d,f,m),void Ur(b,s,a,d,f,m)}v=v.next}_=_.next}while(_!==u)}function Zh(u,s){return u.x-s.x}function S1(u,s){if(s=function ww(u,s){let a=s;const d=u.x,f=u.y;let _,m=-1/0;do{if(f<=a.y&&f>=a.next.y&&a.next.y!==a.y){const D=a.x+(f-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(D<=d&&D>m){if(m=D,D===d){if(f===a.y)return a;if(f===a.next.y)return a.next}_=a.x<a.next.x?a:a.next}}a=a.next}while(a!==s);if(!_)return null;if(d===m)return _;const v=_,b=_.x,w=_.y;let E,A=1/0;a=_;do{d>=a.x&&a.x>=b&&d!==a.x&&kl(f<w?d:m,f,b,w,f<w?m:d,f,a.x,a.y)&&(E=Math.abs(f-a.y)/(d-a.x),Yh(a,u)&&(E<A||E===A&&(a.x>_.x||a.x===_.x&&mv(_,a)))&&(_=a,A=E)),a=a.next}while(a!==v);return _}(u,s),s){const a=_v(s,u);vc(s,s.next),vc(a,a.next)}}function mv(u,s){return er(u.prev,u,s.prev)<0&&er(s.next,u,u.next)<0}function Sw(u,s,a,d,f){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-a)*f)|u<<8))|u<<4))|u<<2))|u<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-d)*f)|s<<8))|s<<4))|s<<2))|s<<1))<<1}function Qu(u){let s=u,a=u;do{(s.x<a.x||s.x===a.x&&s.y<a.y)&&(a=s),s=s.next}while(s!==u);return a}function kl(u,s,a,d,f,m,_,v){return(f-_)*(s-v)-(u-_)*(m-v)>=0&&(u-_)*(d-v)-(a-_)*(s-v)>=0&&(a-_)*(m-v)-(f-_)*(d-v)>=0}function Ew(u,s){return u.next.i!==s.i&&u.prev.i!==s.i&&!function E1(u,s){let a=u;do{if(a.i!==u.i&&a.next.i!==u.i&&a.i!==s.i&&a.next.i!==s.i&&Cw(a,a.next,u,s))return!0;a=a.next}while(a!==u);return!1}(u,s)&&(Yh(u,s)&&Yh(s,u)&&function C1(u,s){let a=u,d=!1;const f=(u.x+s.x)/2,m=(u.y+s.y)/2;do{a.y>m!=a.next.y>m&&a.next.y!==a.y&&f<(a.next.x-a.x)*(m-a.y)/(a.next.y-a.y)+a.x&&(d=!d),a=a.next}while(a!==u);return d}(u,s)&&(er(u.prev,u,s.prev)||er(u,s.prev,s))||ed(u,s)&&er(u.prev,u,u.next)>0&&er(s.prev,s,s.next)>0)}function er(u,s,a){return(s.y-u.y)*(a.x-s.x)-(s.x-u.x)*(a.y-s.y)}function ed(u,s){return u.x===s.x&&u.y===s.y}function Cw(u,s,a,d){const f=Mm(er(u,s,a)),m=Mm(er(u,s,d)),_=Mm(er(a,d,u)),v=Mm(er(a,d,s));return!!(f!==m&&_!==v||0===f&&wm(u,a,s)||0===m&&wm(u,d,s)||0===_&&wm(a,u,d)||0===v&&wm(a,s,d))}function wm(u,s,a){return s.x<=Math.max(u.x,a.x)&&s.x>=Math.min(u.x,a.x)&&s.y<=Math.max(u.y,a.y)&&s.y>=Math.min(u.y,a.y)}function Mm(u){return u>0?1:u<0?-1:0}function Yh(u,s){return er(u.prev,u,u.next)<0?er(u,s,u.next)>=0&&er(u,u.prev,s)>=0:er(u,s,u.prev)<0||er(u,u.next,s)<0}function _v(u,s){const a=new Jh(u.i,u.x,u.y),d=new Jh(s.i,s.x,s.y),f=u.next,m=s.prev;return u.next=s,s.prev=u,a.next=f,f.prev=a,d.next=a,a.prev=d,m.next=d,d.prev=m,d}function Sm(u,s,a,d){const f=new Jh(u,s,a);return d?(f.next=d.next,f.prev=d,d.next.prev=f,d.next=f):(f.prev=f,f.next=f),f}function td(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Jh(u,s,a){this.i=u,this.x=s,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}const sl={area:function(u){const s=u.length;let a=0;for(let d=s-1,f=0;f<s;d=f++)a+=u[d].x*u[f].y-u[f].x*u[d].y;return.5*a},isClockWise:function(u){return sl.area(u)<0},triangulateShape:function(u,s){const a=[],d=[],f=[];yv(u),vv(a,u);let m=u.length;s.forEach(yv);for(let v=0;v<s.length;v++)d.push(m),m+=s[v].length,vv(a,s[v]);const _=function(u,s,a){a=a||2;const d=s&&s.length,f=d?s[0]*a:u.length;let m=hv(u,0,f,a,!0);const _=[];if(!m||m.next===m.prev)return _;let v,b,w,A,E,D,R;if(d&&(m=function M1(u,s,a,d){const f=[];let m,_,v,b,w;for(m=0,_=s.length;m<_;m++)v=s[m]*d,b=m<_-1?s[m+1]*d:u.length,w=hv(u,v,b,d,!1),w===w.next&&(w.steiner=!0),f.push(Qu(w));for(f.sort(Zh),m=0;m<f.length;m++)S1(f[m],a),a=vc(a,a.next);return a}(u,s,m,a)),u.length>80*a){v=w=u[0],b=A=u[1];for(let I=a;I<f;I+=a)E=u[I],D=u[I+1],E<v&&(v=E),D<b&&(b=D),E>w&&(w=E),D>A&&(A=D);R=Math.max(w-v,A-b),R=0!==R?1/R:0}return Ur(m,_,a,v,b,R),_}(a,d);for(let v=0;v<_.length;v+=3)f.push(_.slice(v,v+3));return f}};function yv(u){const s=u.length;s>2&&u[s-1].equals(u[0])&&u.pop()}function vv(u,s){for(let a=0;a<s.length;a++)u.push(s[a].x),u.push(s[a].y)}class Ss extends jt{constructor(s,a){super(),this.type="ExtrudeGeometry",this.parameters={shapes:s,options:a},s=Array.isArray(s)?s:[s];const d=this,f=[],m=[];for(let v=0,b=s.length;v<b;v++)_(s[v]);function _(v){const b=[],w=void 0!==a.curveSegments?a.curveSegments:12,A=void 0!==a.steps?a.steps:1;let E=void 0!==a.depth?a.depth:100,D=void 0===a.bevelEnabled||a.bevelEnabled,R=void 0!==a.bevelThickness?a.bevelThickness:6,I=void 0!==a.bevelSize?a.bevelSize:R-2,F=void 0!==a.bevelOffset?a.bevelOffset:0,V=void 0!==a.bevelSegments?a.bevelSegments:3;const N=a.extrudePath,L=void 0!==a.UVGenerator?a.UVGenerator:Tw;void 0!==a.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),E=a.amount);let j,K,H,re,he,G=!1;N&&(j=N.getSpacedPoints(A),G=!0,D=!1,K=N.computeFrenetFrames(A,!1),H=new W,re=new W,he=new W),D||(V=0,R=0,I=0,F=0);const se=v.extractPoints(w);let fe=se.shape;const we=se.holes;if(!sl.isClockWise(fe)){fe=fe.reverse();for(let Qe=0,lt=we.length;Qe<lt;Qe++){const et=we[Qe];sl.isClockWise(et)&&(we[Qe]=et.reverse())}}const be=sl.triangulateShape(fe,we),de=fe;for(let Qe=0,lt=we.length;Qe<lt;Qe++)fe=fe.concat(we[Qe]);function ve(Qe,lt,et){return lt||console.error("THREE.ExtrudeGeometry: vec does not exist"),lt.clone().multiplyScalar(et).add(Qe)}const Ae=fe.length,He=be.length;function Ze(Qe,lt,et){let Xt,Rt,ie;const Q=Qe.x-lt.x,We=Qe.y-lt.y,Ye=et.x-Qe.x,ue=et.y-Qe.y,nt=Q*Q+We*We;if(Math.abs(Q*ue-We*Ye)>Number.EPSILON){const Lt=Math.sqrt(nt),it=Math.sqrt(Ye*Ye+ue*ue),tn=lt.x-We/Lt,nn=lt.y+Q/Lt,wt=((et.x-ue/it-tn)*ue-(et.y+Ye/it-nn)*Ye)/(Q*ue-We*Ye);Xt=tn+Q*wt-Qe.x,Rt=nn+We*wt-Qe.y;const fi=Xt*Xt+Rt*Rt;if(fi<=2)return new qe(Xt,Rt);ie=Math.sqrt(fi/2)}else{let Lt=!1;Q>Number.EPSILON?Ye>Number.EPSILON&&(Lt=!0):Q<-Number.EPSILON?Ye<-Number.EPSILON&&(Lt=!0):Math.sign(We)===Math.sign(ue)&&(Lt=!0),Lt?(Xt=-We,Rt=Q,ie=Math.sqrt(nt)):(Xt=Q,Rt=We,ie=Math.sqrt(nt/2))}return new qe(Xt/ie,Rt/ie)}const bt=[];for(let Qe=0,lt=de.length,et=lt-1,Xt=Qe+1;Qe<lt;Qe++,et++,Xt++)et===lt&&(et=0),Xt===lt&&(Xt=0),bt[Qe]=Ze(de[Qe],de[et],de[Xt]);const Ot=[];let It,kn=bt.concat();for(let Qe=0,lt=we.length;Qe<lt;Qe++){const et=we[Qe];It=[];for(let Xt=0,Rt=et.length,ie=Rt-1,Q=Xt+1;Xt<Rt;Xt++,ie++,Q++)ie===Rt&&(ie=0),Q===Rt&&(Q=0),It[Xt]=Ze(et[Xt],et[ie],et[Q]);Ot.push(It),kn=kn.concat(It)}for(let Qe=0;Qe<V;Qe++){const lt=Qe/V,et=R*Math.cos(lt*Math.PI/2),Xt=I*Math.sin(lt*Math.PI/2)+F;for(let Rt=0,ie=de.length;Rt<ie;Rt++){const Q=ve(de[Rt],bt[Rt],Xt);Gi(Q.x,Q.y,-et)}for(let Rt=0,ie=we.length;Rt<ie;Rt++){const Q=we[Rt];It=Ot[Rt];for(let We=0,Ye=Q.length;We<Ye;We++){const ue=ve(Q[We],It[We],Xt);Gi(ue.x,ue.y,-et)}}}const fn=I+F;for(let Qe=0;Qe<Ae;Qe++){const lt=D?ve(fe[Qe],kn[Qe],fn):fe[Qe];G?(re.copy(K.normals[0]).multiplyScalar(lt.x),H.copy(K.binormals[0]).multiplyScalar(lt.y),he.copy(j[0]).add(re).add(H),Gi(he.x,he.y,he.z)):Gi(lt.x,lt.y,0)}for(let Qe=1;Qe<=A;Qe++)for(let lt=0;lt<Ae;lt++){const et=D?ve(fe[lt],kn[lt],fn):fe[lt];G?(re.copy(K.normals[Qe]).multiplyScalar(et.x),H.copy(K.binormals[Qe]).multiplyScalar(et.y),he.copy(j[Qe]).add(re).add(H),Gi(he.x,he.y,he.z)):Gi(et.x,et.y,E/A*Qe)}for(let Qe=V-1;Qe>=0;Qe--){const lt=Qe/V,et=R*Math.cos(lt*Math.PI/2),Xt=I*Math.sin(lt*Math.PI/2)+F;for(let Rt=0,ie=de.length;Rt<ie;Rt++){const Q=ve(de[Rt],bt[Rt],Xt);Gi(Q.x,Q.y,E+et)}for(let Rt=0,ie=we.length;Rt<ie;Rt++){const Q=we[Rt];It=Ot[Rt];for(let We=0,Ye=Q.length;We<Ye;We++){const ue=ve(Q[We],It[We],Xt);G?Gi(ue.x,ue.y+j[A-1].y,j[A-1].x+et):Gi(ue.x,ue.y,E+et)}}}function Ue(Qe,lt){let et=Qe.length;for(;--et>=0;){const Xt=et;let Rt=et-1;Rt<0&&(Rt=Qe.length-1);for(let ie=0,Q=A+2*V;ie<Q;ie++){const We=Ae*ie,Ye=Ae*(ie+1);yi(lt+Xt+We,lt+Rt+We,lt+Rt+Ye,lt+Xt+Ye)}}}function Gi(Qe,lt,et){b.push(Qe),b.push(lt),b.push(et)}function ii(Qe,lt,et){pn(Qe),pn(lt),pn(et);const Xt=f.length/3,Rt=L.generateTopUV(d,f,Xt-3,Xt-2,Xt-1);vi(Rt[0]),vi(Rt[1]),vi(Rt[2])}function yi(Qe,lt,et,Xt){pn(Qe),pn(lt),pn(Xt),pn(lt),pn(et),pn(Xt);const Rt=f.length/3,ie=L.generateSideWallUV(d,f,Rt-6,Rt-3,Rt-2,Rt-1);vi(ie[0]),vi(ie[1]),vi(ie[3]),vi(ie[1]),vi(ie[2]),vi(ie[3])}function pn(Qe){f.push(b[3*Qe+0]),f.push(b[3*Qe+1]),f.push(b[3*Qe+2])}function vi(Qe){m.push(Qe.x),m.push(Qe.y)}(function Li(){const Qe=f.length/3;if(D){let lt=0,et=Ae*lt;for(let Xt=0;Xt<He;Xt++){const Rt=be[Xt];ii(Rt[2]+et,Rt[1]+et,Rt[0]+et)}lt=A+2*V,et=Ae*lt;for(let Xt=0;Xt<He;Xt++){const Rt=be[Xt];ii(Rt[0]+et,Rt[1]+et,Rt[2]+et)}}else{for(let lt=0;lt<He;lt++){const et=be[lt];ii(et[2],et[1],et[0])}for(let lt=0;lt<He;lt++){const et=be[lt];ii(et[0]+Ae*A,et[1]+Ae*A,et[2]+Ae*A)}}d.addGroup(Qe,f.length/3-Qe,0)})(),function oi(){const Qe=f.length/3;let lt=0;Ue(de,lt),lt+=de.length;for(let et=0,Xt=we.length;et<Xt;et++){const Rt=we[et];Ue(Rt,lt),lt+=Rt.length}d.addGroup(Qe,f.length/3-Qe,1)}()}this.setAttribute("position",new pe(f,3)),this.setAttribute("uv",new pe(m,2)),this.computeVertexNormals()}toJSON(){const s=jt.prototype.toJSON.call(this);return function Aw(u,s,a){if(a.shapes=[],Array.isArray(u))for(let d=0,f=u.length;d<f;d++)a.shapes.push(u[d].uuid);else a.shapes.push(u.uuid);return void 0!==s.extrudePath&&(a.options.extrudePath=s.extrudePath.toJSON()),a}(this.parameters.shapes,this.parameters.options,s)}}const Tw={generateTopUV:function(u,s,a,d,f){const v=s[3*d],b=s[3*d+1],w=s[3*f],A=s[3*f+1];return[new qe(s[3*a],s[3*a+1]),new qe(v,b),new qe(w,A)]},generateSideWallUV:function(u,s,a,d,f,m){const _=s[3*a],v=s[3*a+1],b=s[3*a+2],w=s[3*d],A=s[3*d+1],E=s[3*d+2],D=s[3*f],R=s[3*f+1],I=s[3*f+2],F=s[3*m],V=s[3*m+1],N=s[3*m+2];return Math.abs(v-A)<.01?[new qe(_,1-b),new qe(w,1-E),new qe(D,1-I),new qe(F,1-N)]:[new qe(v,1-b),new qe(A,1-E),new qe(R,1-I),new qe(V,1-N)]}};class Em extends Ol{constructor(s=1,a=0){const d=(1+Math.sqrt(5))/2;super([-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],s,a),this.type="IcosahedronGeometry",this.parameters={radius:s,detail:a}}}class xv extends jt{constructor(s,a=12,d=0,f=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:s,segments:a,phiStart:d,phiLength:f},a=Math.floor(a),f=Jt.clamp(f,0,2*Math.PI);const m=[],_=[],v=[],b=1/a,w=new W,A=new qe;for(let E=0;E<=a;E++){const D=d+E*b*f,R=Math.sin(D),I=Math.cos(D);for(let F=0;F<=s.length-1;F++)w.x=s[F].x*R,w.y=s[F].y,w.z=s[F].x*I,_.push(w.x,w.y,w.z),A.x=E/a,A.y=F/(s.length-1),v.push(A.x,A.y)}for(let E=0;E<a;E++)for(let D=0;D<s.length-1;D++){const R=D+E*s.length,F=R+s.length,V=R+s.length+1,N=R+1;m.push(R,F,N),m.push(F,V,N)}if(this.setIndex(m),this.setAttribute("position",new pe(_,3)),this.setAttribute("uv",new pe(v,2)),this.computeVertexNormals(),f===2*Math.PI){const E=this.attributes.normal.array,D=new W,R=new W,I=new W,F=a*s.length*3;for(let V=0,N=0;V<s.length;V++,N+=3)D.x=E[N+0],D.y=E[N+1],D.z=E[N+2],R.x=E[F+N+0],R.y=E[F+N+1],R.z=E[F+N+2],I.addVectors(D,R).normalize(),E[N+0]=E[F+N+0]=I.x,E[N+1]=E[F+N+1]=I.y,E[N+2]=E[F+N+2]=I.z}}}class Bl extends Ol{constructor(s=1,a=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],s,a),this.type="OctahedronGeometry",this.parameters={radius:s,detail:a}}}function xc(u,s,a){jt.call(this),this.type="ParametricGeometry",this.parameters={func:u,slices:s,stacks:a};const d=[],f=[],m=[],_=[],v=1e-5,b=new W,w=new W,A=new W,E=new W,D=new W;u.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const R=s+1;for(let I=0;I<=a;I++){const F=I/a;for(let V=0;V<=s;V++){const N=V/s;u(N,F,w),f.push(w.x,w.y,w.z),N-v>=0?(u(N-v,F,A),E.subVectors(w,A)):(u(N+v,F,A),E.subVectors(A,w)),F-v>=0?(u(N,F-v,A),D.subVectors(w,A)):(u(N,F+v,A),D.subVectors(A,w)),b.crossVectors(E,D).normalize(),m.push(b.x,b.y,b.z),_.push(N,F)}}for(let I=0;I<a;I++)for(let F=0;F<s;F++){const N=I*R+F+1,L=(I+1)*R+F+1,j=(I+1)*R+F;d.push(I*R+F,N,j),d.push(N,L,j)}this.setIndex(d),this.setAttribute("position",new pe(f,3)),this.setAttribute("normal",new pe(m,3)),this.setAttribute("uv",new pe(_,2))}(xc.prototype=Object.create(jt.prototype)).constructor=xc;class Kh extends jt{constructor(s=.5,a=1,d=8,f=1,m=0,_=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:s,outerRadius:a,thetaSegments:d,phiSegments:f,thetaStart:m,thetaLength:_},d=Math.max(3,d);const v=[],b=[],w=[],A=[];let E=s;const D=(a-s)/(f=Math.max(1,f)),R=new W,I=new qe;for(let F=0;F<=f;F++){for(let V=0;V<=d;V++){const N=m+V/d*_;R.x=E*Math.cos(N),R.y=E*Math.sin(N),b.push(R.x,R.y,R.z),w.push(0,0,1),I.x=(R.x/a+1)/2,I.y=(R.y/a+1)/2,A.push(I.x,I.y)}E+=D}for(let F=0;F<f;F++){const V=F*(d+1);for(let N=0;N<d;N++){const L=N+V,G=L+d+1,K=L+d+2,H=L+1;v.push(L,G,H),v.push(G,K,H)}}this.setIndex(v),this.setAttribute("position",new pe(b,3)),this.setAttribute("normal",new pe(w,3)),this.setAttribute("uv",new pe(A,2))}}class nd extends jt{constructor(s,a=12){super(),this.type="ShapeGeometry",this.parameters={shapes:s,curveSegments:a};const d=[],f=[],m=[],_=[];let v=0,b=0;if(!1===Array.isArray(s))w(s);else for(let A=0;A<s.length;A++)w(s[A]),this.addGroup(v,b,A),v+=b,b=0;function w(A){const E=f.length/3,D=A.extractPoints(a);let R=D.shape;const I=D.holes;!1===sl.isClockWise(R)&&(R=R.reverse());for(let V=0,N=I.length;V<N;V++){const L=I[V];!0===sl.isClockWise(L)&&(I[V]=L.reverse())}const F=sl.triangulateShape(R,I);for(let V=0,N=I.length;V<N;V++)R=R.concat(I[V]);for(let V=0,N=R.length;V<N;V++){const L=R[V];f.push(L.x,L.y,0),m.push(0,0,1),_.push(L.x,L.y)}for(let V=0,N=F.length;V<N;V++){const L=F[V];d.push(L[0]+E,L[1]+E,L[2]+E),b+=3}}this.setIndex(d),this.setAttribute("position",new pe(f,3)),this.setAttribute("normal",new pe(m,3)),this.setAttribute("uv",new pe(_,2))}toJSON(){const s=jt.prototype.toJSON.call(this);return function Dw(u,s){if(s.shapes=[],Array.isArray(u))for(let a=0,d=u.length;a<d;a++)s.shapes.push(u[a].uuid);else s.shapes.push(u.uuid);return s}(this.parameters.shapes,s)}}class bc extends jt{constructor(s=1,a=8,d=6,f=0,m=2*Math.PI,_=0,v=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:s,widthSegments:a,heightSegments:d,phiStart:f,phiLength:m,thetaStart:_,thetaLength:v},a=Math.max(3,Math.floor(a)),d=Math.max(2,Math.floor(d));const b=Math.min(_+v,Math.PI);let w=0;const A=[],E=new W,D=new W,R=[],I=[],F=[],V=[];for(let N=0;N<=d;N++){const L=[],j=N/d;let G=0;0==N&&0==_?G=.5/a:N==d&&b==Math.PI&&(G=-.5/a);for(let K=0;K<=a;K++){const H=K/a;E.x=-s*Math.cos(f+H*m)*Math.sin(_+j*v),E.y=s*Math.cos(_+j*v),E.z=s*Math.sin(f+H*m)*Math.sin(_+j*v),I.push(E.x,E.y,E.z),D.copy(E).normalize(),F.push(D.x,D.y,D.z),V.push(H+G,1-j),L.push(w++)}A.push(L)}for(let N=0;N<d;N++)for(let L=0;L<a;L++){const j=A[N][L+1],G=A[N][L],K=A[N+1][L],H=A[N+1][L+1];(0!==N||_>0)&&R.push(j,G,H),(N!==d-1||b<Math.PI)&&R.push(G,K,H)}this.setIndex(R),this.setAttribute("position",new pe(I,3)),this.setAttribute("normal",new pe(F,3)),this.setAttribute("uv",new pe(V,2))}}class Qh extends Ol{constructor(s=1,a=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],s,a),this.type="TetrahedronGeometry",this.parameters={radius:s,detail:a}}}class wc extends Ss{constructor(s,a={}){const d=a.font;if(!d||!d.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new jt;const f=d.generateShapes(s,a.size);a.depth=void 0!==a.height?a.height:50,void 0===a.bevelThickness&&(a.bevelThickness=10),void 0===a.bevelSize&&(a.bevelSize=8),void 0===a.bevelEnabled&&(a.bevelEnabled=!1),super(f,a),this.type="TextGeometry"}}class Mc extends jt{constructor(s=1,a=.4,d=8,f=6,m=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:s,tube:a,radialSegments:d,tubularSegments:f,arc:m},d=Math.floor(d),f=Math.floor(f);const _=[],v=[],b=[],w=[],A=new W,E=new W,D=new W;for(let R=0;R<=d;R++)for(let I=0;I<=f;I++){const F=I/f*m,V=R/d*Math.PI*2;E.x=(s+a*Math.cos(V))*Math.cos(F),E.y=(s+a*Math.cos(V))*Math.sin(F),E.z=a*Math.sin(V),v.push(E.x,E.y,E.z),A.x=s*Math.cos(F),A.y=s*Math.sin(F),D.subVectors(E,A).normalize(),b.push(D.x,D.y,D.z),w.push(I/f),w.push(R/d)}for(let R=1;R<=d;R++)for(let I=1;I<=f;I++){const V=(f+1)*(R-1)+I-1,N=(f+1)*(R-1)+I,L=(f+1)*R+I;_.push((f+1)*R+I-1,V,L),_.push(V,N,L)}this.setIndex(_),this.setAttribute("position",new pe(v,3)),this.setAttribute("normal",new pe(b,3)),this.setAttribute("uv",new pe(w,2))}}class ef extends jt{constructor(s=1,a=.4,d=64,f=8,m=2,_=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:s,tube:a,tubularSegments:d,radialSegments:f,p:m,q:_},d=Math.floor(d),f=Math.floor(f);const v=[],b=[],w=[],A=[],E=new W,D=new W,R=new W,I=new W,F=new W,V=new W,N=new W;for(let j=0;j<=d;++j){const G=j/d*m*Math.PI*2;L(G,m,_,s,R),L(G+.01,m,_,s,I),V.subVectors(I,R),N.addVectors(I,R),F.crossVectors(V,N),N.crossVectors(F,V),F.normalize(),N.normalize();for(let K=0;K<=f;++K){const H=K/f*Math.PI*2,re=-a*Math.cos(H),he=a*Math.sin(H);E.x=R.x+(re*N.x+he*F.x),E.y=R.y+(re*N.y+he*F.y),E.z=R.z+(re*N.z+he*F.z),b.push(E.x,E.y,E.z),D.subVectors(E,R).normalize(),w.push(D.x,D.y,D.z),A.push(j/d),A.push(K/f)}}for(let j=1;j<=d;j++)for(let G=1;G<=f;G++){const H=(f+1)*j+(G-1),re=(f+1)*j+G,he=(f+1)*(j-1)+G;v.push((f+1)*(j-1)+(G-1),H,he),v.push(H,re,he)}function L(j,G,K,H,re){const he=Math.cos(j),se=Math.sin(j),fe=K/G*j,we=Math.cos(fe);re.x=H*(2+we)*.5*he,re.y=H*(2+we)*se*.5,re.z=H*Math.sin(fe)*.5}this.setIndex(v),this.setAttribute("position",new pe(b,3)),this.setAttribute("normal",new pe(w,3)),this.setAttribute("uv",new pe(A,2))}}class id extends jt{constructor(s,a=64,d=1,f=8,m=!1){super(),this.type="TubeGeometry",this.parameters={path:s,tubularSegments:a,radius:d,radialSegments:f,closed:m};const _=s.computeFrenetFrames(a,m);this.tangents=_.tangents,this.normals=_.normals,this.binormals=_.binormals;const v=new W,b=new W,w=new qe;let A=new W;const E=[],D=[],R=[],I=[];function V(j){A=s.getPointAt(j/a,A);const G=_.normals[j],K=_.binormals[j];for(let H=0;H<=f;H++){const re=H/f*Math.PI*2,he=Math.sin(re),se=-Math.cos(re);b.x=se*G.x+he*K.x,b.y=se*G.y+he*K.y,b.z=se*G.z+he*K.z,b.normalize(),D.push(b.x,b.y,b.z),v.x=A.x+d*b.x,v.y=A.y+d*b.y,v.z=A.z+d*b.z,E.push(v.x,v.y,v.z)}}(function F(){for(let j=0;j<a;j++)V(j);V(!1===m?a:0),function L(){for(let j=0;j<=a;j++)for(let G=0;G<=f;G++)w.x=j/a,w.y=G/f,R.push(w.x,w.y)}(),function N(){for(let j=1;j<=a;j++)for(let G=1;G<=f;G++){const H=(f+1)*j+(G-1),re=(f+1)*j+G,he=(f+1)*(j-1)+G;I.push((f+1)*(j-1)+(G-1),H,he),I.push(H,re,he)}}()})(),this.setIndex(I),this.setAttribute("position",new pe(E,3)),this.setAttribute("normal",new pe(D,3)),this.setAttribute("uv",new pe(R,2))}toJSON(){const s=jt.prototype.toJSON.call(this);return s.path=this.parameters.path.toJSON(),s}}class Cm extends jt{constructor(s){if(super(),this.type="WireframeGeometry",!0===s.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const a=[],d=[0,0],f={},m=new W;if(null!==s.index){const _=s.attributes.position,v=s.index;let b=s.groups;0===b.length&&(b=[{start:0,count:v.count,materialIndex:0}]);for(let w=0,A=b.length;w<A;++w){const E=b[w],D=E.start;for(let I=D,F=D+E.count;I<F;I+=3)for(let V=0;V<3;V++){const N=v.getX(I+V),L=v.getX(I+(V+1)%3);d[0]=Math.min(N,L),d[1]=Math.max(N,L);const j=d[0]+","+d[1];void 0===f[j]&&(f[j]={index1:d[0],index2:d[1]})}}for(const w in f){const A=f[w];m.fromBufferAttribute(_,A.index1),a.push(m.x,m.y,m.z),m.fromBufferAttribute(_,A.index2),a.push(m.x,m.y,m.z)}}else{const _=s.attributes.position;for(let v=0,b=_.count/3;v<b;v++)for(let w=0;w<3;w++)m.fromBufferAttribute(_,3*v+w),a.push(m.x,m.y,m.z),m.fromBufferAttribute(_,3*v+(w+1)%3),a.push(m.x,m.y,m.z)}this.setAttribute("position",new pe(a,3))}}var es=Object.freeze({__proto__:null,BoxGeometry:Tl,BoxBufferGeometry:Tl,CircleGeometry:vm,CircleBufferGeometry:vm,ConeGeometry:Xh,ConeBufferGeometry:Xh,CylinderGeometry:Ku,CylinderBufferGeometry:Ku,DodecahedronGeometry:xm,DodecahedronBufferGeometry:xm,EdgesGeometry:xw,ExtrudeGeometry:Ss,ExtrudeBufferGeometry:Ss,IcosahedronGeometry:Em,IcosahedronBufferGeometry:Em,LatheGeometry:xv,LatheBufferGeometry:xv,OctahedronGeometry:Bl,OctahedronBufferGeometry:Bl,ParametricGeometry:xc,ParametricBufferGeometry:xc,PlaneGeometry:tl,PlaneBufferGeometry:tl,PolyhedronGeometry:Ol,PolyhedronBufferGeometry:Ol,RingGeometry:Kh,RingBufferGeometry:Kh,ShapeGeometry:nd,ShapeBufferGeometry:nd,SphereGeometry:bc,SphereBufferGeometry:bc,TetrahedronGeometry:Qh,TetrahedronBufferGeometry:Qh,TextGeometry:wc,TextBufferGeometry:wc,TorusGeometry:Mc,TorusBufferGeometry:Mc,TorusKnotGeometry:ef,TorusKnotBufferGeometry:ef,TubeGeometry:id,TubeBufferGeometry:id,WireframeGeometry:Cm});class Sc extends Wn{constructor(s){super(),this.type="ShadowMaterial",this.color=new At(0),this.transparent=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this}}Sc.prototype.isShadowMaterial=!0;class rd extends Yn{constructor(s){super(s),this.type="RawShaderMaterial"}}function ea(u){Wn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new At(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new At(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(u)}function Vl(u){ea.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new qe(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(s){this.reflectivity=Jt.clamp(2.5*(s-1)/(s+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(u)}rd.prototype.isRawShaderMaterial=!0,(ea.prototype=Object.create(Wn.prototype)).constructor=ea,ea.prototype.isMeshStandardMaterial=!0,ea.prototype.copy=function(u){return Wn.prototype.copy.call(this,u),this.defines={STANDARD:""},this.color.copy(u.color),this.roughness=u.roughness,this.metalness=u.metalness,this.map=u.map,this.lightMap=u.lightMap,this.lightMapIntensity=u.lightMapIntensity,this.aoMap=u.aoMap,this.aoMapIntensity=u.aoMapIntensity,this.emissive.copy(u.emissive),this.emissiveMap=u.emissiveMap,this.emissiveIntensity=u.emissiveIntensity,this.bumpMap=u.bumpMap,this.bumpScale=u.bumpScale,this.normalMap=u.normalMap,this.normalMapType=u.normalMapType,this.normalScale.copy(u.normalScale),this.displacementMap=u.displacementMap,this.displacementScale=u.displacementScale,this.displacementBias=u.displacementBias,this.roughnessMap=u.roughnessMap,this.metalnessMap=u.metalnessMap,this.alphaMap=u.alphaMap,this.envMap=u.envMap,this.envMapIntensity=u.envMapIntensity,this.refractionRatio=u.refractionRatio,this.wireframe=u.wireframe,this.wireframeLinewidth=u.wireframeLinewidth,this.wireframeLinecap=u.wireframeLinecap,this.wireframeLinejoin=u.wireframeLinejoin,this.skinning=u.skinning,this.morphTargets=u.morphTargets,this.morphNormals=u.morphNormals,this.flatShading=u.flatShading,this.vertexTangents=u.vertexTangents,this},(Vl.prototype=Object.create(ea.prototype)).constructor=Vl,Vl.prototype.isMeshPhysicalMaterial=!0,Vl.prototype.copy=function(u){return ea.prototype.copy.call(this,u),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=u.clearcoat,this.clearcoatMap=u.clearcoatMap,this.clearcoatRoughness=u.clearcoatRoughness,this.clearcoatRoughnessMap=u.clearcoatRoughnessMap,this.clearcoatNormalMap=u.clearcoatNormalMap,this.clearcoatNormalScale.copy(u.clearcoatNormalScale),this.reflectivity=u.reflectivity,this.sheen=u.sheen?(this.sheen||new At).copy(u.sheen):null,this.transmission=u.transmission,this.transmissionMap=u.transmissionMap,this};class Tm extends Wn{constructor(s){super(),this.type="MeshPhongMaterial",this.color=new At(16777215),this.specular=new At(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new At(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.specular.copy(s.specular),this.shininess=s.shininess,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this.flatShading=s.flatShading,this}}Tm.prototype.isMeshPhongMaterial=!0;class Am extends Wn{constructor(s){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new At(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new At(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.gradientMap=s.gradientMap,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this}}Am.prototype.isMeshToonMaterial=!0;class tf extends Wn{constructor(s){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this.flatShading=s.flatShading,this}}tf.prototype.isMeshNormalMaterial=!0;class Dm extends Wn{constructor(s){super(),this.type="MeshLambertMaterial",this.color=new At(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new At(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=pp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this}}Dm.prototype.isMeshLambertMaterial=!0;class Rw extends Wn{constructor(s){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new At(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=mu,this.normalScale=new qe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.defines={MATCAP:""},this.color.copy(s.color),this.matcap=s.matcap,this.map=s.map,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this.flatShading=s.flatShading,this}}Rw.prototype.isMeshMatcapMaterial=!0;class Rm extends Mr{constructor(s){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(s)}copy(s){return super.copy(s),this.scale=s.scale,this.dashSize=s.dashSize,this.gapSize=s.gapSize,this}}Rm.prototype.isLineDashedMaterial=!0;var A1=Object.freeze({__proto__:null,ShadowMaterial:Sc,SpriteMaterial:lm,RawShaderMaterial:rd,ShaderMaterial:Yn,PointsMaterial:lr,MeshPhysicalMaterial:Vl,MeshStandardMaterial:ea,MeshPhongMaterial:Tm,MeshToonMaterial:Am,MeshNormalMaterial:tf,MeshLambertMaterial:Dm,MeshDepthMaterial:rm,MeshDistanceMaterial:Uh,MeshBasicMaterial:cs,MeshMatcapMaterial:Rw,LineDashedMaterial:Rm,LineBasicMaterial:Mr,Material:Wn});const Hi={arraySlice:function(u,s,a){return Hi.isTypedArray(u)?new u.constructor(u.subarray(s,void 0!==a?a:u.length)):u.slice(s,a)},convertArray:function(u,s,a){return!u||!a&&u.constructor===s?u:"number"==typeof s.BYTES_PER_ELEMENT?new s(u):Array.prototype.slice.call(u)},isTypedArray:function(u){return ArrayBuffer.isView(u)&&!(u instanceof DataView)},getKeyframeOrder:function(u){const a=u.length,d=new Array(a);for(let f=0;f!==a;++f)d[f]=f;return d.sort(function s(f,m){return u[f]-u[m]}),d},sortedArray:function(u,s,a){const d=u.length,f=new u.constructor(d);for(let m=0,_=0;_!==d;++m){const v=a[m]*s;for(let b=0;b!==s;++b)f[_++]=u[v+b]}return f},flattenJSON:function(u,s,a,d){let f=1,m=u[0];for(;void 0!==m&&void 0===m[d];)m=u[f++];if(void 0===m)return;let _=m[d];if(void 0!==_)if(Array.isArray(_))do{_=m[d],void 0!==_&&(s.push(m.time),a.push.apply(a,_)),m=u[f++]}while(void 0!==m);else if(void 0!==_.toArray)do{_=m[d],void 0!==_&&(s.push(m.time),_.toArray(a,a.length)),m=u[f++]}while(void 0!==m);else do{_=m[d],void 0!==_&&(s.push(m.time),a.push(_)),m=u[f++]}while(void 0!==m)},subclip:function(u,s,a,d,f=30){const m=u.clone();m.name=s;const _=[];for(let b=0;b<m.tracks.length;++b){const w=m.tracks[b],A=w.getValueSize(),E=[],D=[];for(let R=0;R<w.times.length;++R){const I=w.times[R]*f;if(!(I<a||I>=d)){E.push(w.times[R]);for(let F=0;F<A;++F)D.push(w.values[R*A+F])}}0!==E.length&&(w.times=Hi.convertArray(E,w.times.constructor),w.values=Hi.convertArray(D,w.values.constructor),_.push(w))}m.tracks=_;let v=1/0;for(let b=0;b<m.tracks.length;++b)v>m.tracks[b].times[0]&&(v=m.tracks[b].times[0]);for(let b=0;b<m.tracks.length;++b)m.tracks[b].shift(-1*v);return m.resetDuration(),m},makeClipAdditive:function(u,s=0,a=u,d=30){d<=0&&(d=30);const f=a.tracks.length,m=s/d;for(let _=0;_<f;++_){const v=a.tracks[_],b=v.ValueTypeName;if("bool"===b||"string"===b)continue;const w=u.tracks.find(function(N){return N.name===v.name&&N.ValueTypeName===b});if(void 0===w)continue;let A=0;const E=v.getValueSize();v.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=E/3);let D=0;const R=w.getValueSize();w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(D=R/3);const I=v.times.length-1;let F;if(m<=v.times[0])F=Hi.arraySlice(v.values,A,E-A);else if(m>=v.times[I]){const N=I*E+A;F=Hi.arraySlice(v.values,N,N+E-A)}else{const N=v.createInterpolant(),L=A,j=E-A;N.evaluate(m),F=Hi.arraySlice(N.resultBuffer,L,j)}"quaternion"===b&&(new wi).fromArray(F).normalize().conjugate().toArray(F);const V=w.times.length;for(let N=0;N<V;++N){const L=N*R+D;if("quaternion"===b)wi.multiplyQuaternionsFlat(w.values,L,F,0,w.values,L);else{const j=R-2*D;for(let G=0;G<j;++G)w.values[L+G]-=F[G]}}}return u.blendMode=ah,u}};function lo(u,s,a,d){this.parameterPositions=u,this._cachedIndex=0,this.resultBuffer=void 0!==d?d:new s.constructor(a),this.sampleValues=s,this.valueSize=a}function Im(u,s,a,d){lo.call(this,u,s,a,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Es(u,s,a,d){lo.call(this,u,s,a,d)}function Lm(u,s,a,d){lo.call(this,u,s,a,d)}Object.assign(lo.prototype,{evaluate:function(u){const s=this.parameterPositions;let a=this._cachedIndex,d=s[a],f=s[a-1];e:{t:{let m;n:{i:if(!(u<d)){for(let _=a+2;;){if(void 0===d){if(u<f)break i;return a=s.length,this._cachedIndex=a,this.afterEnd_(a-1,u,f)}if(a===_)break;if(f=d,d=s[++a],u<d)break t}m=s.length;break n}if(u>=f)break e;{const _=s[1];u<_&&(a=2,f=_);for(let v=a-2;;){if(void 0===f)return this._cachedIndex=0,this.beforeStart_(0,u,d);if(a===v)break;if(d=f,f=s[--a-1],u>=f)break t}m=a,a=0}}for(;a<m;){const _=a+m>>>1;u<s[_]?m=_:a=_+1}if(d=s[a],f=s[a-1],void 0===f)return this._cachedIndex=0,this.beforeStart_(0,u,d);if(void 0===d)return a=s.length,this._cachedIndex=a,this.afterEnd_(a-1,f,u)}this._cachedIndex=a,this.intervalChanged_(a,f,d)}return this.interpolate_(a,f,u,d)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(u){const s=this.resultBuffer,a=this.sampleValues,d=this.valueSize,f=u*d;for(let m=0;m!==d;++m)s[m]=a[f+m];return s},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(lo.prototype,{beforeStart_:lo.prototype.copySampleValue_,afterEnd_:lo.prototype.copySampleValue_}),Im.prototype=Object.assign(Object.create(lo.prototype),{constructor:Im,DefaultSettings_:{endingStart:fu,endingEnd:fu},intervalChanged_:function(u,s,a){const d=this.parameterPositions;let f=u-2,m=u+1,_=d[f],v=d[m];if(void 0===_)switch(this.getSettings_().endingStart){case yt:f=u,_=2*s-a;break;case Rp:f=d.length-2,_=s+d[f]-d[f+1];break;default:f=u,_=a}if(void 0===v)switch(this.getSettings_().endingEnd){case yt:m=u,v=2*a-s;break;case Rp:m=1,v=a+d[1]-d[0];break;default:m=u-1,v=s}const b=.5*(a-s),w=this.valueSize;this._weightPrev=b/(s-_),this._weightNext=b/(v-a),this._offsetPrev=f*w,this._offsetNext=m*w},interpolate_:function(u,s,a,d){const f=this.resultBuffer,m=this.sampleValues,_=this.valueSize,v=u*_,b=v-_,w=this._offsetPrev,A=this._offsetNext,E=this._weightPrev,D=this._weightNext,R=(a-s)/(d-s),I=R*R,F=I*R,V=-E*F+2*E*I-E*R,N=(1+E)*F+(-1.5-2*E)*I+(-.5+E)*R+1,L=(-1-D)*F+(1.5+D)*I+.5*R,j=D*F-D*I;for(let G=0;G!==_;++G)f[G]=V*m[w+G]+N*m[b+G]+L*m[v+G]+j*m[A+G];return f}}),Es.prototype=Object.assign(Object.create(lo.prototype),{constructor:Es,interpolate_:function(u,s,a,d){const f=this.resultBuffer,m=this.sampleValues,_=this.valueSize,v=u*_,b=v-_,w=(a-s)/(d-s),A=1-w;for(let E=0;E!==_;++E)f[E]=m[b+E]*A+m[v+E]*w;return f}}),Lm.prototype=Object.assign(Object.create(lo.prototype),{constructor:Lm,interpolate_:function(u){return this.copySampleValue_(u-1)}});class Do{constructor(s,a,d,f){if(void 0===s)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===a||0===a.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+s);this.name=s,this.times=Hi.convertArray(a,this.TimeBufferType),this.values=Hi.convertArray(d,this.ValueBufferType),this.setInterpolation(f||this.DefaultInterpolation)}static toJSON(s){const a=s.constructor;let d;if(a.toJSON!==this.toJSON)d=a.toJSON(s);else{d={name:s.name,times:Hi.convertArray(s.times,Array),values:Hi.convertArray(s.values,Array)};const f=s.getInterpolation();f!==s.DefaultInterpolation&&(d.interpolation=f)}return d.type=s.ValueTypeName,d}InterpolantFactoryMethodDiscrete(s){return new Lm(this.times,this.values,this.getValueSize(),s)}InterpolantFactoryMethodLinear(s){return new Es(this.times,this.values,this.getValueSize(),s)}InterpolantFactoryMethodSmooth(s){return new Im(this.times,this.values,this.getValueSize(),s)}setInterpolation(s){let a;switch(s){case ti:a=this.InterpolantFactoryMethodDiscrete;break;case Dp:a=this.InterpolantFactoryMethodLinear;break;case uy:a=this.InterpolantFactoryMethodSmooth}if(void 0===a){const d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(s===this.DefaultInterpolation)throw new Error(d);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=a,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ti;case this.InterpolantFactoryMethodLinear:return Dp;case this.InterpolantFactoryMethodSmooth:return uy}}getValueSize(){return this.values.length/this.times.length}shift(s){if(0!==s){const a=this.times;for(let d=0,f=a.length;d!==f;++d)a[d]+=s}return this}scale(s){if(1!==s){const a=this.times;for(let d=0,f=a.length;d!==f;++d)a[d]*=s}return this}trim(s,a){const d=this.times,f=d.length;let m=0,_=f-1;for(;m!==f&&d[m]<s;)++m;for(;-1!==_&&d[_]>a;)--_;if(++_,0!==m||_!==f){m>=_&&(_=Math.max(_,1),m=_-1);const v=this.getValueSize();this.times=Hi.arraySlice(d,m,_),this.values=Hi.arraySlice(this.values,m*v,_*v)}return this}validate(){let s=!0;const a=this.getValueSize();a-Math.floor(a)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),s=!1);const d=this.times,f=this.values,m=d.length;0===m&&(console.error("THREE.KeyframeTrack: Track is empty.",this),s=!1);let _=null;for(let v=0;v!==m;v++){const b=d[v];if("number"==typeof b&&isNaN(b)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,v,b),s=!1;break}if(null!==_&&_>b){console.error("THREE.KeyframeTrack: Out of order keys.",this,v,b,_),s=!1;break}_=b}if(void 0!==f&&Hi.isTypedArray(f))for(let v=0,b=f.length;v!==b;++v){const w=f[v];if(isNaN(w)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,v,w),s=!1;break}}return s}optimize(){const s=Hi.arraySlice(this.times),a=Hi.arraySlice(this.values),d=this.getValueSize(),f=this.getInterpolation()===uy,m=s.length-1;let _=1;for(let v=1;v<m;++v){let b=!1;const w=s[v];if(w!==s[v+1]&&(1!==v||w!==s[0]))if(f)b=!0;else{const E=v*d,D=E-d,R=E+d;for(let I=0;I!==d;++I){const F=a[E+I];if(F!==a[D+I]||F!==a[R+I]){b=!0;break}}}if(b){if(v!==_){s[_]=s[v];const E=v*d,D=_*d;for(let R=0;R!==d;++R)a[D+R]=a[E+R]}++_}}if(m>0){s[_]=s[m];for(let v=m*d,b=_*d,w=0;w!==d;++w)a[b+w]=a[v+w];++_}return _!==s.length?(this.times=Hi.arraySlice(s,0,_),this.values=Hi.arraySlice(a,0,_*d)):(this.times=s,this.values=a),this}clone(){const s=Hi.arraySlice(this.times,0),a=Hi.arraySlice(this.values,0),f=new(0,this.constructor)(this.name,s,a);return f.createInterpolant=this.createInterpolant,f}}Do.prototype.TimeBufferType=Float32Array,Do.prototype.ValueBufferType=Float32Array,Do.prototype.DefaultInterpolation=Dp;class Ec extends Do{}Ec.prototype.ValueTypeName="bool",Ec.prototype.ValueBufferType=Array,Ec.prototype.DefaultInterpolation=ti,Ec.prototype.InterpolantFactoryMethodLinear=void 0,Ec.prototype.InterpolantFactoryMethodSmooth=void 0;class bv extends Do{}bv.prototype.ValueTypeName="color";class nf extends Do{}function Pm(u,s,a,d){lo.call(this,u,s,a,d)}nf.prototype.ValueTypeName="number",Pm.prototype=Object.assign(Object.create(lo.prototype),{constructor:Pm,interpolate_:function(u,s,a,d){const f=this.resultBuffer,m=this.sampleValues,_=this.valueSize,v=(a-s)/(d-s);let b=u*_;for(let w=b+_;b!==w;b+=4)wi.slerpFlat(f,0,m,b-_,m,b,v);return f}});class Cc extends Do{InterpolantFactoryMethodLinear(s){return new Pm(this.times,this.values,this.getValueSize(),s)}}Cc.prototype.ValueTypeName="quaternion",Cc.prototype.DefaultInterpolation=Dp,Cc.prototype.InterpolantFactoryMethodSmooth=void 0;class Tc extends Do{}Tc.prototype.ValueTypeName="string",Tc.prototype.ValueBufferType=Array,Tc.prototype.DefaultInterpolation=ti,Tc.prototype.InterpolantFactoryMethodLinear=void 0,Tc.prototype.InterpolantFactoryMethodSmooth=void 0;class rf extends Do{}rf.prototype.ValueTypeName="vector";class sf{constructor(s,a=-1,d,f=Rn){this.name=s,this.tracks=d,this.duration=a,this.blendMode=f,this.uuid=Jt.generateUUID(),this.duration<0&&this.resetDuration()}static parse(s){const a=[],d=s.tracks,f=1/(s.fps||1);for(let _=0,v=d.length;_!==v;++_)a.push(jn(d[_]).scale(f));const m=new this(s.name,s.duration,a,s.blendMode);return m.uuid=s.uuid,m}static toJSON(s){const a=[],d=s.tracks,f={name:s.name,duration:s.duration,tracks:a,uuid:s.uuid,blendMode:s.blendMode};for(let m=0,_=d.length;m!==_;++m)a.push(Do.toJSON(d[m]));return f}static CreateFromMorphTargetSequence(s,a,d,f){const m=a.length,_=[];for(let v=0;v<m;v++){let b=[],w=[];b.push((v+m-1)%m,v,(v+1)%m),w.push(0,1,0);const A=Hi.getKeyframeOrder(b);b=Hi.sortedArray(b,1,A),w=Hi.sortedArray(w,1,A),!f&&0===b[0]&&(b.push(m),w.push(w[0])),_.push(new nf(".morphTargetInfluences["+a[v].name+"]",b,w).scale(1/d))}return new this(s,-1,_)}static findByName(s,a){let d=s;if(!Array.isArray(s)){const f=s;d=f.geometry&&f.geometry.animations||f.animations}for(let f=0;f<d.length;f++)if(d[f].name===a)return d[f];return null}static CreateClipsFromMorphTargetSequences(s,a,d){const f={},m=/^([\w-]*?)([\d]+)$/;for(let v=0,b=s.length;v<b;v++){const w=s[v],A=w.name.match(m);if(A&&A.length>1){const E=A[1];let D=f[E];D||(f[E]=D=[]),D.push(w)}}const _=[];for(const v in f)_.push(this.CreateFromMorphTargetSequence(v,f[v],a,d));return _}static parseAnimation(s,a){if(!s)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const d=function(E,D,R,I,F){if(0!==R.length){const V=[],N=[];Hi.flattenJSON(R,V,N,I),0!==V.length&&F.push(new E(D,V,N))}},f=[],m=s.name||"default",_=s.fps||30,v=s.blendMode;let b=s.length||-1;const w=s.hierarchy||[];for(let E=0;E<w.length;E++){const D=w[E].keys;if(D&&0!==D.length)if(D[0].morphTargets){const R={};let I;for(I=0;I<D.length;I++)if(D[I].morphTargets)for(let F=0;F<D[I].morphTargets.length;F++)R[D[I].morphTargets[F]]=-1;for(const F in R){const V=[],N=[];for(let L=0;L!==D[I].morphTargets.length;++L){const j=D[I];V.push(j.time),N.push(j.morphTarget===F?1:0)}f.push(new nf(".morphTargetInfluence["+F+"]",V,N))}b=R.length*(_||1)}else{const R=".bones["+a[E].name+"]";d(rf,R+".position",D,"pos",f),d(Cc,R+".quaternion",D,"rot",f),d(rf,R+".scale",D,"scl",f)}}return 0===f.length?null:new this(m,b,f,v)}resetDuration(){let a=0;for(let d=0,f=this.tracks.length;d!==f;++d){const m=this.tracks[d];a=Math.max(a,m.times[m.times.length-1])}return this.duration=a,this}trim(){for(let s=0;s<this.tracks.length;s++)this.tracks[s].trim(0,this.duration);return this}validate(){let s=!0;for(let a=0;a<this.tracks.length;a++)s=s&&this.tracks[a].validate();return s}optimize(){for(let s=0;s<this.tracks.length;s++)this.tracks[s].optimize();return this}clone(){const s=[];for(let a=0;a<this.tracks.length;a++)s.push(this.tracks[a].clone());return new this.constructor(this.name,this.duration,s,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function jn(u){if(void 0===u.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const s=function yn(u){switch(u.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return nf;case"vector":case"vector2":case"vector3":case"vector4":return rf;case"color":return bv;case"quaternion":return Cc;case"bool":case"boolean":return Ec;case"string":return Tc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+u)}(u.type);if(void 0===u.times){const a=[],d=[];Hi.flattenJSON(u.keys,a,d,"value"),u.times=a,u.values=d}return void 0!==s.parse?s.parse(u):new s(u.name,u.times,u.values,u.interpolation)}const Ul={enabled:!1,files:{},add:function(u,s){!1!==this.enabled&&(this.files[u]=s)},get:function(u){if(!1!==this.enabled)return this.files[u]},remove:function(u){delete this.files[u]},clear:function(){this.files={}}};function Fm(u,s,a){const d=this;let v,f=!1,m=0,_=0;const b=[];this.onStart=void 0,this.onLoad=u,this.onProgress=s,this.onError=a,this.itemStart=function(w){_++,!1===f&&void 0!==d.onStart&&d.onStart(w,m,_),f=!0},this.itemEnd=function(w){m++,void 0!==d.onProgress&&d.onProgress(w,m,_),m===_&&(f=!1,void 0!==d.onLoad&&d.onLoad())},this.itemError=function(w){void 0!==d.onError&&d.onError(w)},this.resolveURL=function(w){return v?v(w):w},this.setURLModifier=function(w){return v=w,this},this.addHandler=function(w,A){return b.push(w,A),this},this.removeHandler=function(w){const A=b.indexOf(w);return-1!==A&&b.splice(A,2),this},this.getHandler=function(w){for(let A=0,E=b.length;A<E;A+=2){const D=b[A],R=b[A+1];if(D.global&&(D.lastIndex=0),D.test(w))return R}return null}}const Iw=new Fm;function cr(u){this.manager=void 0!==u?u:Iw,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(cr.prototype,{load:function(){},loadAsync:function(u,s){const a=this;return new Promise(function(d,f){a.load(u,d,s,f)})},parse:function(){},setCrossOrigin:function(u){return this.crossOrigin=u,this},setWithCredentials:function(u){return this.withCredentials=u,this},setPath:function(u){return this.path=u,this},setResourcePath:function(u){return this.resourcePath=u,this},setRequestHeader:function(u){return this.requestHeader=u,this}});const Ro={};function Io(u){cr.call(this,u)}Io.prototype=Object.assign(Object.create(cr.prototype),{constructor:Io,load:function(u,s,a,d){void 0===u&&(u=""),void 0!==this.path&&(u=this.path+u),u=this.manager.resolveURL(u);const f=this,m=Ul.get(u);if(void 0!==m)return f.manager.itemStart(u),setTimeout(function(){s&&s(m),f.manager.itemEnd(u)},0),m;if(void 0!==Ro[u])return void Ro[u].push({onLoad:s,onProgress:a,onError:d});const v=u.match(/^data:(.*?)(;base64)?,(.*)$/);let b;if(v){const w=v[1],A=!!v[2];let E=v[3];E=decodeURIComponent(E),A&&(E=atob(E));try{let D;const R=(this.responseType||"").toLowerCase();switch(R){case"arraybuffer":case"blob":const I=new Uint8Array(E.length);for(let V=0;V<E.length;V++)I[V]=E.charCodeAt(V);D="blob"===R?new Blob([I.buffer],{type:w}):I.buffer;break;case"document":D=(new DOMParser).parseFromString(E,w);break;case"json":D=JSON.parse(E);break;default:D=E}setTimeout(function(){s&&s(D),f.manager.itemEnd(u)},0)}catch(D){setTimeout(function(){d&&d(D),f.manager.itemError(u),f.manager.itemEnd(u)},0)}}else{Ro[u]=[],Ro[u].push({onLoad:s,onProgress:a,onError:d}),b=new XMLHttpRequest,b.open("GET",u,!0),b.addEventListener("load",function(w){const A=this.response,E=Ro[u];if(delete Ro[u],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ul.add(u,A);for(let D=0,R=E.length;D<R;D++){const I=E[D];I.onLoad&&I.onLoad(A)}f.manager.itemEnd(u)}else{for(let D=0,R=E.length;D<R;D++){const I=E[D];I.onError&&I.onError(w)}f.manager.itemError(u),f.manager.itemEnd(u)}},!1),b.addEventListener("progress",function(w){const A=Ro[u];for(let E=0,D=A.length;E<D;E++){const R=A[E];R.onProgress&&R.onProgress(w)}},!1),b.addEventListener("error",function(w){const A=Ro[u];delete Ro[u];for(let E=0,D=A.length;E<D;E++){const R=A[E];R.onError&&R.onError(w)}f.manager.itemError(u),f.manager.itemEnd(u)},!1),b.addEventListener("abort",function(w){const A=Ro[u];delete Ro[u];for(let E=0,D=A.length;E<D;E++){const R=A[E];R.onError&&R.onError(w)}f.manager.itemError(u),f.manager.itemEnd(u)},!1),void 0!==this.responseType&&(b.responseType=this.responseType),void 0!==this.withCredentials&&(b.withCredentials=this.withCredentials),b.overrideMimeType&&b.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const w in this.requestHeader)b.setRequestHeader(w,this.requestHeader[w]);b.send(null)}return f.manager.itemStart(u),b},setResponseType:function(u){return this.responseType=u,this},setMimeType:function(u){return this.mimeType=u,this}});class Lw extends cr{constructor(s){super(s)}load(s,a,d,f){const m=this,_=new Io(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials),_.load(s,function(v){try{a(m.parse(JSON.parse(v)))}catch(b){f?f(b):console.error(b),m.manager.itemError(s)}},d,f)}parse(s){const a=[];for(let d=0;d<s.length;d++){const f=sf.parse(s[d]);a.push(f)}return a}}function wv(u){cr.call(this,u)}wv.prototype=Object.assign(Object.create(cr.prototype),{constructor:wv,load:function(u,s,a,d){const f=this,m=[],_=new cv,v=new Io(this.manager);v.setPath(this.path),v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setWithCredentials(f.withCredentials);let b=0;function w(A){v.load(u[A],function(E){const D=f.parse(E,!0);m[A]={width:D.width,height:D.height,format:D.format,mipmaps:D.mipmaps},b+=1,6===b&&(1===D.mipmapCount&&(_.minFilter=fr),_.image=m,_.format=D.format,_.needsUpdate=!0,s&&s(_))},a,d)}if(Array.isArray(u))for(let A=0,E=u.length;A<E;++A)w(A);else v.load(u,function(A){const E=f.parse(A,!0);if(E.isCubemap){const D=E.mipmaps.length/E.mipmapCount;for(let R=0;R<D;R++){m[R]={mipmaps:[]};for(let I=0;I<E.mipmapCount;I++)m[R].mipmaps.push(E.mipmaps[R*E.mipmapCount+I]),m[R].format=E.format,m[R].width=E.width,m[R].height=E.height}_.image=m}else _.image.width=E.width,_.image.height=E.height,_.mipmaps=E.mipmaps;1===E.mipmapCount&&(_.minFilter=fr),_.format=E.format,_.needsUpdate=!0,s&&s(_)},a,d);return _}});class Nm extends cr{constructor(s){super(s)}load(s,a,d,f){void 0!==this.path&&(s=this.path+s),s=this.manager.resolveURL(s);const m=this,_=Ul.get(s);if(void 0!==_)return m.manager.itemStart(s),setTimeout(function(){a&&a(_),m.manager.itemEnd(s)},0),_;const v=document.createElementNS("http://www.w3.org/1999/xhtml","img");function b(){v.removeEventListener("load",b,!1),v.removeEventListener("error",w,!1),Ul.add(s,this),a&&a(this),m.manager.itemEnd(s)}function w(A){v.removeEventListener("load",b,!1),v.removeEventListener("error",w,!1),f&&f(A),m.manager.itemError(s),m.manager.itemEnd(s)}return v.addEventListener("load",b,!1),v.addEventListener("error",w,!1),"data:"!==s.substr(0,5)&&void 0!==this.crossOrigin&&(v.crossOrigin=this.crossOrigin),m.manager.itemStart(s),v.src=s,v}}class D1 extends cr{constructor(s){super(s)}load(s,a,d,f){const m=new Iu,_=new Nm(this.manager);_.setCrossOrigin(this.crossOrigin),_.setPath(this.path);let v=0;function b(w){_.load(s[w],function(A){m.images[w]=A,v++,6===v&&(m.needsUpdate=!0,a&&a(m))},void 0,f)}for(let w=0;w<s.length;++w)b(w);return m}}function af(u){cr.call(this,u)}function lf(u){cr.call(this,u)}function Ii(){this.type="Curve",this.arcLengthDivisions=200}af.prototype=Object.assign(Object.create(cr.prototype),{constructor:af,load:function(u,s,a,d){const f=this,m=new Qa,_=new Io(this.manager);return _.setResponseType("arraybuffer"),_.setRequestHeader(this.requestHeader),_.setPath(this.path),_.setWithCredentials(f.withCredentials),_.load(u,function(v){const b=f.parse(v);!b||(void 0!==b.image?m.image=b.image:void 0!==b.data&&(m.image.width=b.width,m.image.height=b.height,m.image.data=b.data),m.wrapS=void 0!==b.wrapS?b.wrapS:Rs,m.wrapT=void 0!==b.wrapT?b.wrapT:Rs,m.magFilter=void 0!==b.magFilter?b.magFilter:fr,m.minFilter=void 0!==b.minFilter?b.minFilter:fr,m.anisotropy=void 0!==b.anisotropy?b.anisotropy:1,void 0!==b.encoding&&(m.encoding=b.encoding),void 0!==b.flipY&&(m.flipY=b.flipY),void 0!==b.format&&(m.format=b.format),void 0!==b.type&&(m.type=b.type),void 0!==b.mipmaps&&(m.mipmaps=b.mipmaps,m.minFilter=oc),1===b.mipmapCount&&(m.minFilter=fr),m.needsUpdate=!0,s&&s(m,b))},a,d),m}}),lf.prototype=Object.assign(Object.create(cr.prototype),{constructor:lf,load:function(u,s,a,d){const f=new Rr,m=new Nm(this.manager);return m.setCrossOrigin(this.crossOrigin),m.setPath(this.path),m.load(u,function(_){f.image=_;const v=u.search(/\.jpe?g($|\?)/i)>0||0===u.search(/^data\:image\/jpeg/);f.format=v?ss:Xs,f.needsUpdate=!0,void 0!==s&&s(f)},a,d),f}}),Object.assign(Ii.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(u,s){const a=this.getUtoTmapping(u);return this.getPoint(a,s)},getPoints:function(u=5){const s=[];for(let a=0;a<=u;a++)s.push(this.getPoint(a/u));return s},getSpacedPoints:function(u=5){const s=[];for(let a=0;a<=u;a++)s.push(this.getPointAt(a/u));return s},getLength:function(){const u=this.getLengths();return u[u.length-1]},getLengths:function(u){if(void 0===u&&(u=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===u+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const s=[];let a,d=this.getPoint(0),f=0;s.push(0);for(let m=1;m<=u;m++)a=this.getPoint(m/u),f+=a.distanceTo(d),s.push(f),d=a;return this.cacheArcLengths=s,s},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(u,s){const a=this.getLengths();let d=0;const f=a.length;let m;m=s||u*a[f-1];let b,_=0,v=f-1;for(;_<=v;)if(d=Math.floor(_+(v-_)/2),b=a[d]-m,b<0)_=d+1;else{if(!(b>0)){v=d;break}v=d-1}if(d=v,a[d]===m)return d/(f-1);const w=a[d];return(d+(m-w)/(a[d+1]-w))/(f-1)},getTangent:function(u,s){let d=u-1e-4,f=u+1e-4;d<0&&(d=0),f>1&&(f=1);const m=this.getPoint(d),_=this.getPoint(f),v=s||(m.isVector2?new qe:new W);return v.copy(_).sub(m).normalize(),v},getTangentAt:function(u,s){const a=this.getUtoTmapping(u);return this.getTangent(a,s)},computeFrenetFrames:function(u,s){const a=new W,d=[],f=[],m=[],_=new W,v=new Ht;for(let D=0;D<=u;D++)d[D]=this.getTangentAt(D/u,new W),d[D].normalize();f[0]=new W,m[0]=new W;let b=Number.MAX_VALUE;const w=Math.abs(d[0].x),A=Math.abs(d[0].y),E=Math.abs(d[0].z);w<=b&&(b=w,a.set(1,0,0)),A<=b&&(b=A,a.set(0,1,0)),E<=b&&a.set(0,0,1),_.crossVectors(d[0],a).normalize(),f[0].crossVectors(d[0],_),m[0].crossVectors(d[0],f[0]);for(let D=1;D<=u;D++){if(f[D]=f[D-1].clone(),m[D]=m[D-1].clone(),_.crossVectors(d[D-1],d[D]),_.length()>Number.EPSILON){_.normalize();const R=Math.acos(Jt.clamp(d[D-1].dot(d[D]),-1,1));f[D].applyMatrix4(v.makeRotationAxis(_,R))}m[D].crossVectors(d[D],f[D])}if(!0===s){let D=Math.acos(Jt.clamp(f[0].dot(f[u]),-1,1));D/=u,d[0].dot(_.crossVectors(f[0],f[u]))>0&&(D=-D);for(let R=1;R<=u;R++)f[R].applyMatrix4(v.makeRotationAxis(d[R],D*R)),m[R].crossVectors(d[R],f[R])}return{tangents:d,normals:f,binormals:m}},clone:function(){return(new this.constructor).copy(this)},copy:function(u){return this.arcLengthDivisions=u.arcLengthDivisions,this},toJSON:function(){const u={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return u.arcLengthDivisions=this.arcLengthDivisions,u.type=this.type,u},fromJSON:function(u){return this.arcLengthDivisions=u.arcLengthDivisions,this}});class cf extends Ii{constructor(s=0,a=0,d=1,f=1,m=0,_=2*Math.PI,v=!1,b=0){super(),this.type="EllipseCurve",this.aX=s,this.aY=a,this.xRadius=d,this.yRadius=f,this.aStartAngle=m,this.aEndAngle=_,this.aClockwise=v,this.aRotation=b}getPoint(s,a){const d=a||new qe,f=2*Math.PI;let m=this.aEndAngle-this.aStartAngle;const _=Math.abs(m)<Number.EPSILON;for(;m<0;)m+=f;for(;m>f;)m-=f;m<Number.EPSILON&&(m=_?0:f),!0===this.aClockwise&&!_&&(m===f?m=-f:m-=f);const v=this.aStartAngle+s*m;let b=this.aX+this.xRadius*Math.cos(v),w=this.aY+this.yRadius*Math.sin(v);if(0!==this.aRotation){const A=Math.cos(this.aRotation),E=Math.sin(this.aRotation),D=b-this.aX,R=w-this.aY;b=D*A-R*E+this.aX,w=D*E+R*A+this.aY}return d.set(b,w)}copy(s){return super.copy(s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this}toJSON(){const s=super.toJSON();return s.aX=this.aX,s.aY=this.aY,s.xRadius=this.xRadius,s.yRadius=this.yRadius,s.aStartAngle=this.aStartAngle,s.aEndAngle=this.aEndAngle,s.aClockwise=this.aClockwise,s.aRotation=this.aRotation,s}fromJSON(s){return super.fromJSON(s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this}}cf.prototype.isEllipseCurve=!0;class uf extends cf{constructor(s,a,d,f,m,_){super(s,a,d,d,f,m,_),this.type="ArcCurve"}}function df(){let u=0,s=0,a=0,d=0;function f(m,_,v,b){u=m,s=v,a=-3*m+3*_-2*v-b,d=2*m-2*_+v+b}return{initCatmullRom:function(m,_,v,b,w){f(_,v,w*(v-m),w*(b-_))},initNonuniformCatmullRom:function(m,_,v,b,w,A,E){let D=(_-m)/w-(v-m)/(w+A)+(v-_)/A,R=(v-_)/A-(b-_)/(A+E)+(b-v)/E;D*=A,R*=A,f(_,v,D,R)},calc:function(m){const _=m*m;return u+s*m+a*_+d*(_*m)}}}uf.prototype.isArcCurve=!0;const Om=new W,Pw=new df,Fw=new df,Nw=new df;class Mv extends Ii{constructor(s=[],a=!1,d="centripetal",f=.5){super(),this.type="CatmullRomCurve3",this.points=s,this.closed=a,this.curveType=d,this.tension=f}getPoint(s,a=new W){const d=a,f=this.points,m=f.length,_=(m-(this.closed?0:1))*s;let w,A,v=Math.floor(_),b=_-v;this.closed?v+=v>0?0:(Math.floor(Math.abs(v)/m)+1)*m:0===b&&v===m-1&&(v=m-2,b=1),this.closed||v>0?w=f[(v-1)%m]:(Om.subVectors(f[0],f[1]).add(f[0]),w=Om);const E=f[v%m],D=f[(v+1)%m];if(this.closed||v+2<m?A=f[(v+2)%m]:(Om.subVectors(f[m-1],f[m-2]).add(f[m-1]),A=Om),"centripetal"===this.curveType||"chordal"===this.curveType){const R="chordal"===this.curveType?.5:.25;let I=Math.pow(w.distanceToSquared(E),R),F=Math.pow(E.distanceToSquared(D),R),V=Math.pow(D.distanceToSquared(A),R);F<1e-4&&(F=1),I<1e-4&&(I=F),V<1e-4&&(V=F),Pw.initNonuniformCatmullRom(w.x,E.x,D.x,A.x,I,F,V),Fw.initNonuniformCatmullRom(w.y,E.y,D.y,A.y,I,F,V),Nw.initNonuniformCatmullRom(w.z,E.z,D.z,A.z,I,F,V)}else"catmullrom"===this.curveType&&(Pw.initCatmullRom(w.x,E.x,D.x,A.x,this.tension),Fw.initCatmullRom(w.y,E.y,D.y,A.y,this.tension),Nw.initCatmullRom(w.z,E.z,D.z,A.z,this.tension));return d.set(Pw.calc(b),Fw.calc(b),Nw.calc(b)),d}copy(s){super.copy(s),this.points=[];for(let a=0,d=s.points.length;a<d;a++)this.points.push(s.points[a].clone());return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this}toJSON(){const s=super.toJSON();s.points=[];for(let a=0,d=this.points.length;a<d;a++)s.points.push(this.points[a].toArray());return s.closed=this.closed,s.curveType=this.curveType,s.tension=this.tension,s}fromJSON(s){super.fromJSON(s),this.points=[];for(let a=0,d=s.points.length;a<d;a++){const f=s.points[a];this.points.push((new W).fromArray(f))}return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this}}function Sv(u,s,a,d,f){const m=.5*(d-s),_=.5*(f-a),v=u*u;return(2*a-2*d+m+_)*(u*v)+(-3*a+3*d-2*m-_)*v+m*u+a}function hf(u,s,a,d){return function PP(u,s){const a=1-u;return a*a*s}(u,s)+function R1(u,s){return 2*(1-u)*u*s}(u,a)+function sd(u,s){return u*u*s}(u,d)}function ff(u,s,a,d,f){return function Ow(u,s){const a=1-u;return a*a*a*s}(u,s)+function km(u,s){const a=1-u;return 3*a*a*u*s}(u,a)+function I1(u,s){return 3*(1-u)*u*u*s}(u,d)+function kw(u,s){return u*u*u*s}(u,f)}Mv.prototype.isCatmullRomCurve3=!0;class Bm extends Ii{constructor(s=new qe,a=new qe,d=new qe,f=new qe){super(),this.type="CubicBezierCurve",this.v0=s,this.v1=a,this.v2=d,this.v3=f}getPoint(s,a=new qe){const d=a,f=this.v0,m=this.v1,_=this.v2,v=this.v3;return d.set(ff(s,f.x,m.x,_.x,v.x),ff(s,f.y,m.y,_.y,v.y)),d}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this}}Bm.prototype.isCubicBezierCurve=!0;class Ev extends Ii{constructor(s=new W,a=new W,d=new W,f=new W){super(),this.type="CubicBezierCurve3",this.v0=s,this.v1=a,this.v2=d,this.v3=f}getPoint(s,a=new W){const d=a,f=this.v0,m=this.v1,_=this.v2,v=this.v3;return d.set(ff(s,f.x,m.x,_.x,v.x),ff(s,f.y,m.y,_.y,v.y),ff(s,f.z,m.z,_.z,v.z)),d}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this}}Ev.prototype.isCubicBezierCurve3=!0;class pf extends Ii{constructor(s=new qe,a=new qe){super(),this.type="LineCurve",this.v1=s,this.v2=a}getPoint(s,a=new qe){const d=a;return 1===s?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(s).add(this.v1)),d}getPointAt(s,a){return this.getPoint(s,a)}getTangent(s,a){const d=a||new qe;return d.copy(this.v2).sub(this.v1).normalize(),d}copy(s){return super.copy(s),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}pf.prototype.isLineCurve=!0;class Bw extends Ii{constructor(s=new W,a=new W){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=s,this.v2=a}getPoint(s,a=new W){const d=a;return 1===s?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(s).add(this.v1)),d}getPointAt(s,a){return this.getPoint(s,a)}copy(s){return super.copy(s),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}class mf extends Ii{constructor(s=new qe,a=new qe,d=new qe){super(),this.type="QuadraticBezierCurve",this.v0=s,this.v1=a,this.v2=d}getPoint(s,a=new qe){const d=a,f=this.v0,m=this.v1,_=this.v2;return d.set(hf(s,f.x,m.x,_.x),hf(s,f.y,m.y,_.y)),d}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}mf.prototype.isQuadraticBezierCurve=!0;class Cv extends Ii{constructor(s=new W,a=new W,d=new W){super(),this.type="QuadraticBezierCurve3",this.v0=s,this.v1=a,this.v2=d}getPoint(s,a=new W){const d=a,f=this.v0,m=this.v1,_=this.v2;return d.set(hf(s,f.x,m.x,_.x),hf(s,f.y,m.y,_.y),hf(s,f.z,m.z,_.z)),d}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}Cv.prototype.isQuadraticBezierCurve3=!0;class gf extends Ii{constructor(s=[]){super(),this.type="SplineCurve",this.points=s}getPoint(s,a=new qe){const d=a,f=this.points,m=(f.length-1)*s,_=Math.floor(m),v=m-_,b=f[0===_?_:_-1],w=f[_],A=f[_>f.length-2?f.length-1:_+1],E=f[_>f.length-3?f.length-1:_+2];return d.set(Sv(v,b.x,w.x,A.x,E.x),Sv(v,b.y,w.y,A.y,E.y)),d}copy(s){super.copy(s),this.points=[];for(let a=0,d=s.points.length;a<d;a++)this.points.push(s.points[a].clone());return this}toJSON(){const s=super.toJSON();s.points=[];for(let a=0,d=this.points.length;a<d;a++)s.points.push(this.points[a].toArray());return s}fromJSON(s){super.fromJSON(s),this.points=[];for(let a=0,d=s.points.length;a<d;a++){const f=s.points[a];this.points.push((new qe).fromArray(f))}return this}}gf.prototype.isSplineCurve=!0;var Vm=Object.freeze({__proto__:null,ArcCurve:uf,CatmullRomCurve3:Mv,CubicBezierCurve:Bm,CubicBezierCurve3:Ev,EllipseCurve:cf,LineCurve:pf,LineCurve3:Bw,QuadraticBezierCurve:mf,QuadraticBezierCurve3:Cv,SplineCurve:gf});class Um extends Ii{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(s){this.curves.push(s)}closePath(){const s=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);s.equals(a)||this.curves.push(new pf(a,s))}getPoint(s){const a=s*this.getLength(),d=this.getCurveLengths();let f=0;for(;f<d.length;){if(d[f]>=a){const m=d[f]-a,_=this.curves[f],v=_.getLength();return _.getPointAt(0===v?0:1-m/v)}f++}return null}getLength(){const s=this.getCurveLengths();return s[s.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const s=[];let a=0;for(let d=0,f=this.curves.length;d<f;d++)a+=this.curves[d].getLength(),s.push(a);return this.cacheLengths=s,s}getSpacedPoints(s=40){const a=[];for(let d=0;d<=s;d++)a.push(this.getPoint(d/s));return this.autoClose&&a.push(a[0]),a}getPoints(s=12){const a=[];let d;for(let f=0,m=this.curves;f<m.length;f++){const _=m[f],b=_.getPoints(_&&_.isEllipseCurve?2*s:_&&(_.isLineCurve||_.isLineCurve3)?1:_&&_.isSplineCurve?s*_.points.length:s);for(let w=0;w<b.length;w++){const A=b[w];d&&d.equals(A)||(a.push(A),d=A)}}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a}copy(s){super.copy(s),this.curves=[];for(let a=0,d=s.curves.length;a<d;a++)this.curves.push(s.curves[a].clone());return this.autoClose=s.autoClose,this}toJSON(){const s=super.toJSON();s.autoClose=this.autoClose,s.curves=[];for(let a=0,d=this.curves.length;a<d;a++)s.curves.push(this.curves[a].toJSON());return s}fromJSON(s){super.fromJSON(s),this.autoClose=s.autoClose,this.curves=[];for(let a=0,d=s.curves.length;a<d;a++){const f=s.curves[a];this.curves.push((new Vm[f.type]).fromJSON(f))}return this}}class zm extends Um{constructor(s){super(),this.type="Path",this.currentPoint=new qe,s&&this.setFromPoints(s)}setFromPoints(s){this.moveTo(s[0].x,s[0].y);for(let a=1,d=s.length;a<d;a++)this.lineTo(s[a].x,s[a].y);return this}moveTo(s,a){return this.currentPoint.set(s,a),this}lineTo(s,a){const d=new pf(this.currentPoint.clone(),new qe(s,a));return this.curves.push(d),this.currentPoint.set(s,a),this}quadraticCurveTo(s,a,d,f){const m=new mf(this.currentPoint.clone(),new qe(s,a),new qe(d,f));return this.curves.push(m),this.currentPoint.set(d,f),this}bezierCurveTo(s,a,d,f,m,_){const v=new Bm(this.currentPoint.clone(),new qe(s,a),new qe(d,f),new qe(m,_));return this.curves.push(v),this.currentPoint.set(m,_),this}splineThru(s){const a=[this.currentPoint.clone()].concat(s),d=new gf(a);return this.curves.push(d),this.currentPoint.copy(s[s.length-1]),this}arc(s,a,d,f,m,_){return this.absarc(s+this.currentPoint.x,a+this.currentPoint.y,d,f,m,_),this}absarc(s,a,d,f,m,_){return this.absellipse(s,a,d,d,f,m,_),this}ellipse(s,a,d,f,m,_,v,b){return this.absellipse(s+this.currentPoint.x,a+this.currentPoint.y,d,f,m,_,v,b),this}absellipse(s,a,d,f,m,_,v,b){const w=new cf(s,a,d,f,m,_,v,b);if(this.curves.length>0){const E=w.getPoint(0);E.equals(this.currentPoint)||this.lineTo(E.x,E.y)}this.curves.push(w);const A=w.getPoint(1);return this.currentPoint.copy(A),this}copy(s){return super.copy(s),this.currentPoint.copy(s.currentPoint),this}toJSON(){const s=super.toJSON();return s.currentPoint=this.currentPoint.toArray(),s}fromJSON(s){return super.fromJSON(s),this.currentPoint.fromArray(s.currentPoint),this}}class Aa extends zm{constructor(s){super(s),this.uuid=Jt.generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(s){const a=[];for(let d=0,f=this.holes.length;d<f;d++)a[d]=this.holes[d].getPoints(s);return a}extractPoints(s){return{shape:this.getPoints(s),holes:this.getPointsHoles(s)}}copy(s){super.copy(s),this.holes=[];for(let a=0,d=s.holes.length;a<d;a++)this.holes.push(s.holes[a].clone());return this}toJSON(){const s=super.toJSON();s.uuid=this.uuid,s.holes=[];for(let a=0,d=this.holes.length;a<d;a++)s.holes.push(this.holes[a].toJSON());return s}fromJSON(s){super.fromJSON(s),this.uuid=s.uuid,this.holes=[];for(let a=0,d=s.holes.length;a<d;a++){const f=s.holes[a];this.holes.push((new zm).fromJSON(f))}return this}}class ta extends en{constructor(s,a=1){super(),this.type="Light",this.color=new At(s),this.intensity=a}copy(s){return super.copy(s),this.color.copy(s.color),this.intensity=s.intensity,this}toJSON(s){const a=super.toJSON(s);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(a.object.distance=this.distance),void 0!==this.angle&&(a.object.angle=this.angle),void 0!==this.decay&&(a.object.decay=this.decay),void 0!==this.penumbra&&(a.object.penumbra=this.penumbra),void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON()),a}}ta.prototype.isLight=!0;class Vw extends ta{constructor(s,a,d){super(s,d),this.type="HemisphereLight",this.position.copy(en.DefaultUp),this.updateMatrix(),this.groundColor=new At(a)}copy(s){return ta.prototype.copy.call(this,s),this.groundColor.copy(s.groundColor),this}}Vw.prototype.isHemisphereLight=!0;const oe=new Ht,Hm=new W,Tv=new W;class od{constructor(s){this.camera=s,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new qe(512,512),this.map=null,this.mapPass=null,this.matrix=new Ht,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Pu,this._frameExtents=new qe(1,1),this._viewportCount=1,this._viewports=[new $e(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(s){const a=this.camera,d=this.matrix;Hm.setFromMatrixPosition(s.matrixWorld),a.position.copy(Hm),Tv.setFromMatrixPosition(s.target.matrixWorld),a.lookAt(Tv),a.updateMatrixWorld(),oe.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(oe),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(a.projectionMatrix),d.multiply(a.matrixWorldInverse)}getViewport(s){return this._viewports[s]}getFrameExtents(){return this._frameExtents}copy(s){return this.camera=s.camera.clone(),this.bias=s.bias,this.radius=s.radius,this.mapSize.copy(s.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const s={};return 0!==this.bias&&(s.bias=this.bias),0!==this.normalBias&&(s.normalBias=this.normalBias),1!==this.radius&&(s.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(s.mapSize=this.mapSize.toArray()),s.camera=this.camera.toJSON(!1).object,delete s.camera.matrix,s}}class Lo extends od{constructor(){super(new wr(50,1,.5,500)),this.focus=1}updateMatrices(s){const a=this.camera,d=2*Jt.RAD2DEG*s.angle*this.focus,f=this.mapSize.width/this.mapSize.height,m=s.distance||a.far;(d!==a.fov||f!==a.aspect||m!==a.far)&&(a.fov=d,a.aspect=f,a.far=m,a.updateProjectionMatrix()),super.updateMatrices(s)}}Lo.prototype.isSpotLightShadow=!0;class Gm extends ta{constructor(s,a,d=0,f=Math.PI/3,m=0,_=1){super(s,a),this.type="SpotLight",this.position.copy(en.DefaultUp),this.updateMatrix(),this.target=new en,this.distance=d,this.angle=f,this.penumbra=m,this.decay=_,this.shadow=new Lo}get power(){return this.intensity*Math.PI}set power(s){this.intensity=s/Math.PI}copy(s){return super.copy(s),this.distance=s.distance,this.angle=s.angle,this.penumbra=s.penumbra,this.decay=s.decay,this.target=s.target.clone(),this.shadow=s.shadow.clone(),this}}Gm.prototype.isSpotLight=!0;const Uw=new Ht,Ac=new W,na=new W;class Wm extends od{constructor(){super(new wr(90,1,.5,500)),this._frameExtents=new qe(4,2),this._viewportCount=6,this._viewports=[new $e(2,1,1,1),new $e(0,1,1,1),new $e(3,1,1,1),new $e(1,1,1,1),new $e(3,0,1,1),new $e(1,0,1,1)],this._cubeDirections=[new W(1,0,0),new W(-1,0,0),new W(0,0,1),new W(0,0,-1),new W(0,1,0),new W(0,-1,0)],this._cubeUps=[new W(0,1,0),new W(0,1,0),new W(0,1,0),new W(0,1,0),new W(0,0,1),new W(0,0,-1)]}updateMatrices(s,a=0){const d=this.camera,f=this.matrix;Ac.setFromMatrixPosition(s.matrixWorld),d.position.copy(Ac),na.copy(d.position),na.add(this._cubeDirections[a]),d.up.copy(this._cubeUps[a]),d.lookAt(na),d.updateMatrixWorld(),f.makeTranslation(-Ac.x,-Ac.y,-Ac.z),Uw.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Uw)}}Wm.prototype.isPointLightShadow=!0;class jm extends ta{constructor(s,a,d=0,f=1){super(s,a),this.type="PointLight",this.distance=d,this.decay=f,this.shadow=new Wm}get power(){return 4*this.intensity*Math.PI}set power(s){this.intensity=s/(4*Math.PI)}copy(s){return super.copy(s),this.distance=s.distance,this.decay=s.decay,this.shadow=s.shadow.clone(),this}}jm.prototype.isPointLight=!0;class Dc extends Rl{constructor(s=-1,a=1,d=1,f=-1,m=.1,_=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=s,this.right=a,this.top=d,this.bottom=f,this.near=m,this.far=_,this.updateProjectionMatrix()}copy(s,a){return super.copy(s,a),this.left=s.left,this.right=s.right,this.top=s.top,this.bottom=s.bottom,this.near=s.near,this.far=s.far,this.zoom=s.zoom,this.view=null===s.view?null:Object.assign({},s.view),this}setViewOffset(s,a,d,f,m,_){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=s,this.view.fullHeight=a,this.view.offsetX=d,this.view.offsetY=f,this.view.width=m,this.view.height=_,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const s=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,f=(this.top+this.bottom)/2;let m=d-s,_=d+s,v=f+a,b=f-a;if(null!==this.view&&this.view.enabled){const w=(this.right-this.left)/this.view.fullWidth/this.zoom,A=(this.top-this.bottom)/this.view.fullHeight/this.zoom;m+=w*this.view.offsetX,_=m+w*this.view.width,v-=A*this.view.offsetY,b=v-A*this.view.height}this.projectionMatrix.makeOrthographic(m,_,v,b,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(s){const a=en.prototype.toJSON.call(this,s);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,null!==this.view&&(a.object.view=Object.assign({},this.view)),a}}Dc.prototype.isOrthographicCamera=!0;class L1 extends od{constructor(){super(new Dc(-5,5,5,-5,.5,500))}}L1.prototype.isDirectionalLightShadow=!0;class qm extends ta{constructor(s,a){super(s,a),this.type="DirectionalLight",this.position.copy(en.DefaultUp),this.updateMatrix(),this.target=new en,this.shadow=new L1}copy(s){return super.copy(s),this.target=s.target.clone(),this.shadow=s.shadow.clone(),this}}qm.prototype.isDirectionalLight=!0;class zw extends ta{constructor(s,a){super(s,a),this.type="AmbientLight"}}zw.prototype.isAmbientLight=!0;class ad extends ta{constructor(s,a,d=10,f=10){super(s,a),this.type="RectAreaLight",this.width=d,this.height=f}copy(s){return super.copy(s),this.width=s.width,this.height=s.height,this}toJSON(s){const a=super.toJSON(s);return a.object.width=this.width,a.object.height=this.height,a}}ad.prototype.isRectAreaLight=!0;class ld{constructor(){this.coefficients=[];for(let s=0;s<9;s++)this.coefficients.push(new W)}set(s){for(let a=0;a<9;a++)this.coefficients[a].copy(s[a]);return this}zero(){for(let s=0;s<9;s++)this.coefficients[s].set(0,0,0);return this}getAt(s,a){const d=s.x,f=s.y,m=s.z,_=this.coefficients;return a.copy(_[0]).multiplyScalar(.282095),a.addScaledVector(_[1],.488603*f),a.addScaledVector(_[2],.488603*m),a.addScaledVector(_[3],.488603*d),a.addScaledVector(_[4],d*f*1.092548),a.addScaledVector(_[5],f*m*1.092548),a.addScaledVector(_[6],.315392*(3*m*m-1)),a.addScaledVector(_[7],d*m*1.092548),a.addScaledVector(_[8],.546274*(d*d-f*f)),a}getIrradianceAt(s,a){const d=s.x,f=s.y,m=s.z,_=this.coefficients;return a.copy(_[0]).multiplyScalar(.886227),a.addScaledVector(_[1],1.023328*f),a.addScaledVector(_[2],1.023328*m),a.addScaledVector(_[3],1.023328*d),a.addScaledVector(_[4],.858086*d*f),a.addScaledVector(_[5],.858086*f*m),a.addScaledVector(_[6],.743125*m*m-.247708),a.addScaledVector(_[7],.858086*d*m),a.addScaledVector(_[8],.429043*(d*d-f*f)),a}add(s){for(let a=0;a<9;a++)this.coefficients[a].add(s.coefficients[a]);return this}addScaledSH(s,a){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(s.coefficients[d],a);return this}scale(s){for(let a=0;a<9;a++)this.coefficients[a].multiplyScalar(s);return this}lerp(s,a){for(let d=0;d<9;d++)this.coefficients[d].lerp(s.coefficients[d],a);return this}equals(s){for(let a=0;a<9;a++)if(!this.coefficients[a].equals(s.coefficients[a]))return!1;return!0}copy(s){return this.set(s.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(s,a=0){const d=this.coefficients;for(let f=0;f<9;f++)d[f].fromArray(s,a+3*f);return this}toArray(s=[],a=0){const d=this.coefficients;for(let f=0;f<9;f++)d[f].toArray(s,a+3*f);return s}static getBasisAt(s,a){const d=s.x,f=s.y,m=s.z;a[0]=.282095,a[1]=.488603*f,a[2]=.488603*m,a[3]=.488603*d,a[4]=1.092548*d*f,a[5]=1.092548*f*m,a[6]=.315392*(3*m*m-1),a[7]=1.092548*d*m,a[8]=.546274*(d*d-f*f)}}ld.prototype.isSphericalHarmonics3=!0;class Rc extends ta{constructor(s=new ld,a=1){super(void 0,a),this.sh=s}copy(s){return super.copy(s),this.sh.copy(s.sh),this}fromJSON(s){return this.intensity=s.intensity,this.sh.fromArray(s.sh),this}toJSON(s){const a=super.toJSON(s);return a.object.sh=this.sh.toArray(),a}}Rc.prototype.isLightProbe=!0;class $m extends cr{constructor(s){super(s),this.textures={}}load(s,a,d,f){const m=this,_=new Io(m.manager);_.setPath(m.path),_.setRequestHeader(m.requestHeader),_.setWithCredentials(m.withCredentials),_.load(s,function(v){try{a(m.parse(JSON.parse(v)))}catch(b){f?f(b):console.error(b),m.manager.itemError(s)}},d,f)}parse(s){const a=this.textures;function d(m){return void 0===a[m]&&console.warn("THREE.MaterialLoader: Undefined texture",m),a[m]}const f=new A1[s.type];if(void 0!==s.uuid&&(f.uuid=s.uuid),void 0!==s.name&&(f.name=s.name),void 0!==s.color&&void 0!==f.color&&f.color.setHex(s.color),void 0!==s.roughness&&(f.roughness=s.roughness),void 0!==s.metalness&&(f.metalness=s.metalness),void 0!==s.sheen&&(f.sheen=(new At).setHex(s.sheen)),void 0!==s.emissive&&void 0!==f.emissive&&f.emissive.setHex(s.emissive),void 0!==s.specular&&void 0!==f.specular&&f.specular.setHex(s.specular),void 0!==s.shininess&&(f.shininess=s.shininess),void 0!==s.clearcoat&&(f.clearcoat=s.clearcoat),void 0!==s.clearcoatRoughness&&(f.clearcoatRoughness=s.clearcoatRoughness),void 0!==s.fog&&(f.fog=s.fog),void 0!==s.flatShading&&(f.flatShading=s.flatShading),void 0!==s.blending&&(f.blending=s.blending),void 0!==s.combine&&(f.combine=s.combine),void 0!==s.side&&(f.side=s.side),void 0!==s.opacity&&(f.opacity=s.opacity),void 0!==s.transparent&&(f.transparent=s.transparent),void 0!==s.alphaTest&&(f.alphaTest=s.alphaTest),void 0!==s.depthTest&&(f.depthTest=s.depthTest),void 0!==s.depthWrite&&(f.depthWrite=s.depthWrite),void 0!==s.colorWrite&&(f.colorWrite=s.colorWrite),void 0!==s.stencilWrite&&(f.stencilWrite=s.stencilWrite),void 0!==s.stencilWriteMask&&(f.stencilWriteMask=s.stencilWriteMask),void 0!==s.stencilFunc&&(f.stencilFunc=s.stencilFunc),void 0!==s.stencilRef&&(f.stencilRef=s.stencilRef),void 0!==s.stencilFuncMask&&(f.stencilFuncMask=s.stencilFuncMask),void 0!==s.stencilFail&&(f.stencilFail=s.stencilFail),void 0!==s.stencilZFail&&(f.stencilZFail=s.stencilZFail),void 0!==s.stencilZPass&&(f.stencilZPass=s.stencilZPass),void 0!==s.wireframe&&(f.wireframe=s.wireframe),void 0!==s.wireframeLinewidth&&(f.wireframeLinewidth=s.wireframeLinewidth),void 0!==s.wireframeLinecap&&(f.wireframeLinecap=s.wireframeLinecap),void 0!==s.wireframeLinejoin&&(f.wireframeLinejoin=s.wireframeLinejoin),void 0!==s.rotation&&(f.rotation=s.rotation),1!==s.linewidth&&(f.linewidth=s.linewidth),void 0!==s.dashSize&&(f.dashSize=s.dashSize),void 0!==s.gapSize&&(f.gapSize=s.gapSize),void 0!==s.scale&&(f.scale=s.scale),void 0!==s.polygonOffset&&(f.polygonOffset=s.polygonOffset),void 0!==s.polygonOffsetFactor&&(f.polygonOffsetFactor=s.polygonOffsetFactor),void 0!==s.polygonOffsetUnits&&(f.polygonOffsetUnits=s.polygonOffsetUnits),void 0!==s.skinning&&(f.skinning=s.skinning),void 0!==s.morphTargets&&(f.morphTargets=s.morphTargets),void 0!==s.morphNormals&&(f.morphNormals=s.morphNormals),void 0!==s.dithering&&(f.dithering=s.dithering),void 0!==s.vertexTangents&&(f.vertexTangents=s.vertexTangents),void 0!==s.visible&&(f.visible=s.visible),void 0!==s.toneMapped&&(f.toneMapped=s.toneMapped),void 0!==s.userData&&(f.userData=s.userData),void 0!==s.vertexColors&&(f.vertexColors="number"==typeof s.vertexColors?s.vertexColors>0:s.vertexColors),void 0!==s.uniforms)for(const m in s.uniforms){const _=s.uniforms[m];switch(f.uniforms[m]={},_.type){case"t":f.uniforms[m].value=d(_.value);break;case"c":f.uniforms[m].value=(new At).setHex(_.value);break;case"v2":f.uniforms[m].value=(new qe).fromArray(_.value);break;case"v3":f.uniforms[m].value=(new W).fromArray(_.value);break;case"v4":f.uniforms[m].value=(new $e).fromArray(_.value);break;case"m3":f.uniforms[m].value=(new Ji).fromArray(_.value);break;case"m4":f.uniforms[m].value=(new Ht).fromArray(_.value);break;default:f.uniforms[m].value=_.value}}if(void 0!==s.defines&&(f.defines=s.defines),void 0!==s.vertexShader&&(f.vertexShader=s.vertexShader),void 0!==s.fragmentShader&&(f.fragmentShader=s.fragmentShader),void 0!==s.extensions)for(const m in s.extensions)f.extensions[m]=s.extensions[m];if(void 0!==s.shading&&(f.flatShading=1===s.shading),void 0!==s.size&&(f.size=s.size),void 0!==s.sizeAttenuation&&(f.sizeAttenuation=s.sizeAttenuation),void 0!==s.map&&(f.map=d(s.map)),void 0!==s.matcap&&(f.matcap=d(s.matcap)),void 0!==s.alphaMap&&(f.alphaMap=d(s.alphaMap)),void 0!==s.bumpMap&&(f.bumpMap=d(s.bumpMap)),void 0!==s.bumpScale&&(f.bumpScale=s.bumpScale),void 0!==s.normalMap&&(f.normalMap=d(s.normalMap)),void 0!==s.normalMapType&&(f.normalMapType=s.normalMapType),void 0!==s.normalScale){let m=s.normalScale;!1===Array.isArray(m)&&(m=[m,m]),f.normalScale=(new qe).fromArray(m)}return void 0!==s.displacementMap&&(f.displacementMap=d(s.displacementMap)),void 0!==s.displacementScale&&(f.displacementScale=s.displacementScale),void 0!==s.displacementBias&&(f.displacementBias=s.displacementBias),void 0!==s.roughnessMap&&(f.roughnessMap=d(s.roughnessMap)),void 0!==s.metalnessMap&&(f.metalnessMap=d(s.metalnessMap)),void 0!==s.emissiveMap&&(f.emissiveMap=d(s.emissiveMap)),void 0!==s.emissiveIntensity&&(f.emissiveIntensity=s.emissiveIntensity),void 0!==s.specularMap&&(f.specularMap=d(s.specularMap)),void 0!==s.envMap&&(f.envMap=d(s.envMap)),void 0!==s.envMapIntensity&&(f.envMapIntensity=s.envMapIntensity),void 0!==s.reflectivity&&(f.reflectivity=s.reflectivity),void 0!==s.refractionRatio&&(f.refractionRatio=s.refractionRatio),void 0!==s.lightMap&&(f.lightMap=d(s.lightMap)),void 0!==s.lightMapIntensity&&(f.lightMapIntensity=s.lightMapIntensity),void 0!==s.aoMap&&(f.aoMap=d(s.aoMap)),void 0!==s.aoMapIntensity&&(f.aoMapIntensity=s.aoMapIntensity),void 0!==s.gradientMap&&(f.gradientMap=d(s.gradientMap)),void 0!==s.clearcoatMap&&(f.clearcoatMap=d(s.clearcoatMap)),void 0!==s.clearcoatRoughnessMap&&(f.clearcoatRoughnessMap=d(s.clearcoatRoughnessMap)),void 0!==s.clearcoatNormalMap&&(f.clearcoatNormalMap=d(s.clearcoatNormalMap)),void 0!==s.clearcoatNormalScale&&(f.clearcoatNormalScale=(new qe).fromArray(s.clearcoatNormalScale)),void 0!==s.transmission&&(f.transmission=s.transmission),void 0!==s.transmissionMap&&(f.transmissionMap=d(s.transmissionMap)),f}setTextures(s){return this.textures=s,this}}const _f={decodeText:function(u){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(u);let s="";for(let a=0,d=u.length;a<d;a++)s+=String.fromCharCode(u[a]);try{return decodeURIComponent(escape(s))}catch(a){return s}},extractUrlBase:function(u){const s=u.lastIndexOf("/");return-1===s?"./":u.substr(0,s+1)}};function Xm(){jt.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Zm(u,s,a,d){"number"==typeof a&&(d=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ke.call(this,u,s,a),this.meshPerAttribute=d||1}Xm.prototype=Object.assign(Object.create(jt.prototype),{constructor:Xm,isInstancedBufferGeometry:!0,copy:function(u){return jt.prototype.copy.call(this,u),this.instanceCount=u.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const u=jt.prototype.toJSON.call(this);return u.instanceCount=this.instanceCount,u.isInstancedBufferGeometry=!0,u}}),Zm.prototype=Object.assign(Object.create(Ke.prototype),{constructor:Zm,isInstancedBufferAttribute:!0,copy:function(u){return Ke.prototype.copy.call(this,u),this.meshPerAttribute=u.meshPerAttribute,this},toJSON:function(){const u=Ke.prototype.toJSON.call(this);return u.meshPerAttribute=this.meshPerAttribute,u.isInstancedBufferAttribute=!0,u}});class Hw extends cr{constructor(s){super(s)}load(s,a,d,f){const m=this,_=new Io(m.manager);_.setPath(m.path),_.setRequestHeader(m.requestHeader),_.setWithCredentials(m.withCredentials),_.load(s,function(v){try{a(m.parse(JSON.parse(v)))}catch(b){f?f(b):console.error(b),m.manager.itemError(s)}},d,f)}parse(s){const a={},d={};function f(R,I){if(void 0!==a[I])return a[I];const V=R.interleavedBuffers[I],N=function m(R,I){if(void 0!==d[I])return d[I];const N=new Uint32Array(R.arrayBuffers[I]).buffer;return d[I]=N,N}(R,V.buffer),j=new oo(Qi(V.type,N),V.stride);return j.uuid=V.uuid,a[I]=j,j}const _=s.isInstancedBufferGeometry?new Xm:new jt,v=s.data.index;if(void 0!==v){const R=Qi(v.type,v.array);_.setIndex(new Ke(R,1))}const b=s.data.attributes;for(const R in b){const I=b[R];let F;if(I.isInterleavedBufferAttribute)F=new hs(f(s.data,I.data),I.itemSize,I.offset,I.normalized);else{const V=Qi(I.type,I.array);F=new(I.isInstancedBufferAttribute?Zm:Ke)(V,I.itemSize,I.normalized)}void 0!==I.name&&(F.name=I.name),_.setAttribute(R,F)}const w=s.data.morphAttributes;if(w)for(const R in w){const I=w[R],F=[];for(let V=0,N=I.length;V<N;V++){const L=I[V];let j;j=L.isInterleavedBufferAttribute?new hs(f(s.data,L.data),L.itemSize,L.offset,L.normalized):new Ke(Qi(L.type,L.array),L.itemSize,L.normalized),void 0!==L.name&&(j.name=L.name),F.push(j)}_.morphAttributes[R]=F}s.data.morphTargetsRelative&&(_.morphTargetsRelative=!0);const E=s.data.groups||s.data.drawcalls||s.data.offsets;if(void 0!==E)for(let R=0,I=E.length;R!==I;++R){const F=E[R];_.addGroup(F.start,F.count,F.materialIndex)}const D=s.data.boundingSphere;if(void 0!==D){const R=new W;void 0!==D.center&&R.fromArray(D.center),_.boundingSphere=new wl(R,D.radius)}return s.name&&(_.name=s.name),s.userData&&(_.userData=s.userData),_}}class P1 extends cr{constructor(s){super(s)}load(s,a,d,f){const m=this,_=""===this.path?_f.extractUrlBase(s):this.path;this.resourcePath=this.resourcePath||_;const v=new Io(this.manager);v.setPath(this.path),v.setRequestHeader(this.requestHeader),v.setWithCredentials(this.withCredentials),v.load(s,function(b){let w=null;try{w=JSON.parse(b)}catch(E){return void 0!==f&&f(E),void console.error("THREE:ObjectLoader: Can't parse "+s+".",E.message)}const A=w.metadata;void 0!==A&&void 0!==A.type&&"geometry"!==A.type.toLowerCase()?m.parse(w,a):console.error("THREE.ObjectLoader: Can't load "+s)},d,f)}parse(s,a){const d=this.parseAnimations(s.animations),f=this.parseShapes(s.shapes),m=this.parseGeometries(s.geometries,f),_=this.parseImages(s.images,function(){void 0!==a&&a(w)}),v=this.parseTextures(s.textures,_),b=this.parseMaterials(s.materials,v),w=this.parseObject(s.object,m,b,d),A=this.parseSkeletons(s.skeletons,w);if(this.bindSkeletons(w,A),void 0!==a){let E=!1;for(const D in _)if(_[D]instanceof HTMLImageElement){E=!0;break}!1===E&&a(w)}return w}parseShapes(s){const a={};if(void 0!==s)for(let d=0,f=s.length;d<f;d++){const m=(new Aa).fromJSON(s[d]);a[m.uuid]=m}return a}parseSkeletons(s,a){const d={},f={};if(a.traverse(function(m){m.isBone&&(f[m.uuid]=m)}),void 0!==s)for(let m=0,_=s.length;m<_;m++){const v=(new Wh).fromJSON(s[m],f);d[v.uuid]=v}return d}parseGeometries(s,a){const d={};let f;if(void 0!==s){const m=new Hw;for(let _=0,v=s.length;_<v;_++){let b;const w=s[_];switch(w.type){case"PlaneGeometry":case"PlaneBufferGeometry":b=new es[w.type](w.width,w.height,w.widthSegments,w.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":b=new es[w.type](w.width,w.height,w.depth,w.widthSegments,w.heightSegments,w.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":b=new es[w.type](w.radius,w.segments,w.thetaStart,w.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":b=new es[w.type](w.radiusTop,w.radiusBottom,w.height,w.radialSegments,w.heightSegments,w.openEnded,w.thetaStart,w.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":b=new es[w.type](w.radius,w.height,w.radialSegments,w.heightSegments,w.openEnded,w.thetaStart,w.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":b=new es[w.type](w.radius,w.widthSegments,w.heightSegments,w.phiStart,w.phiLength,w.thetaStart,w.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":b=new es[w.type](w.radius,w.detail);break;case"RingGeometry":case"RingBufferGeometry":b=new es[w.type](w.innerRadius,w.outerRadius,w.thetaSegments,w.phiSegments,w.thetaStart,w.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":b=new es[w.type](w.radius,w.tube,w.radialSegments,w.tubularSegments,w.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":b=new es[w.type](w.radius,w.tube,w.tubularSegments,w.radialSegments,w.p,w.q);break;case"TubeGeometry":case"TubeBufferGeometry":b=new es[w.type]((new Vm[w.path.type]).fromJSON(w.path),w.tubularSegments,w.radius,w.radialSegments,w.closed);break;case"LatheGeometry":case"LatheBufferGeometry":b=new es[w.type](w.points,w.segments,w.phiStart,w.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":b=new es[w.type](w.vertices,w.indices,w.radius,w.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":f=[];for(let E=0,D=w.shapes.length;E<D;E++)f.push(a[w.shapes[E]]);b=new es[w.type](f,w.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":f=[];for(let E=0,D=w.shapes.length;E<D;E++)f.push(a[w.shapes[E]]);const A=w.options.extrudePath;void 0!==A&&(w.options.extrudePath=(new Vm[A.type]).fromJSON(A)),b=new es[w.type](f,w.options);break;case"BufferGeometry":case"InstancedBufferGeometry":b=m.parse(w);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+w.type+'"');continue}b.uuid=w.uuid,void 0!==w.name&&(b.name=w.name),!0===b.isBufferGeometry&&void 0!==w.userData&&(b.userData=w.userData),d[w.uuid]=b}}return d}parseMaterials(s,a){const d={},f={};if(void 0!==s){const m=new $m;m.setTextures(a);for(let _=0,v=s.length;_<v;_++){const b=s[_];if("MultiMaterial"===b.type){const w=[];for(let A=0;A<b.materials.length;A++){const E=b.materials[A];void 0===d[E.uuid]&&(d[E.uuid]=m.parse(E)),w.push(d[E.uuid])}f[b.uuid]=w}else void 0===d[b.uuid]&&(d[b.uuid]=m.parse(b)),f[b.uuid]=d[b.uuid]}}return f}parseAnimations(s){const a={};if(void 0!==s)for(let d=0;d<s.length;d++){const m=sf.parse(s[d]);a[m.uuid]=m}return a}parseImages(s,a){const d=this,f={};let m;function v(b){if("string"==typeof b){const w=b;return function _(b){return d.manager.itemStart(b),m.load(b,function(){d.manager.itemEnd(b)},void 0,function(){d.manager.itemError(b),d.manager.itemEnd(b)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:d.resourcePath+w)}return b.data?{data:Qi(b.type,b.data),width:b.width,height:b.height}:null}if(void 0!==s&&s.length>0){const b=new Fm(a);m=new Nm(b),m.setCrossOrigin(this.crossOrigin);for(let w=0,A=s.length;w<A;w++){const E=s[w],D=E.url;if(Array.isArray(D)){f[E.uuid]=[];for(let R=0,I=D.length;R<I;R++){const V=v(D[R]);null!==V&&(V instanceof HTMLImageElement?f[E.uuid].push(V):f[E.uuid].push(new Qa(V.data,V.width,V.height)))}}else{const R=v(E.url);null!==R&&(f[E.uuid]=R)}}}return f}parseTextures(s,a){function d(m,_){return"number"==typeof m?m:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",m),_[m])}const f={};if(void 0!==s)for(let m=0,_=s.length;m<_;m++){const v=s[m];let b;void 0===v.image&&console.warn('THREE.ObjectLoader: No "image" specified for',v.uuid),void 0===a[v.image]&&console.warn("THREE.ObjectLoader: Undefined image",v.image);const w=a[v.image];Array.isArray(w)?(b=new Iu(w),6===w.length&&(b.needsUpdate=!0)):(b=w&&w.data?new Qa(w.data,w.width,w.height):new Rr(w),w&&(b.needsUpdate=!0)),b.uuid=v.uuid,void 0!==v.name&&(b.name=v.name),void 0!==v.mapping&&(b.mapping=d(v.mapping,F1)),void 0!==v.offset&&b.offset.fromArray(v.offset),void 0!==v.repeat&&b.repeat.fromArray(v.repeat),void 0!==v.center&&b.center.fromArray(v.center),void 0!==v.rotation&&(b.rotation=v.rotation),void 0!==v.wrap&&(b.wrapS=d(v.wrap[0],Av),b.wrapT=d(v.wrap[1],Av)),void 0!==v.format&&(b.format=v.format),void 0!==v.type&&(b.type=v.type),void 0!==v.encoding&&(b.encoding=v.encoding),void 0!==v.minFilter&&(b.minFilter=d(v.minFilter,N1)),void 0!==v.magFilter&&(b.magFilter=d(v.magFilter,N1)),void 0!==v.anisotropy&&(b.anisotropy=v.anisotropy),void 0!==v.flipY&&(b.flipY=v.flipY),void 0!==v.premultiplyAlpha&&(b.premultiplyAlpha=v.premultiplyAlpha),void 0!==v.unpackAlignment&&(b.unpackAlignment=v.unpackAlignment),f[v.uuid]=b}return f}parseObject(s,a,d,f){let m,b,w;function _(A){return void 0===a[A]&&console.warn("THREE.ObjectLoader: Undefined geometry",A),a[A]}function v(A){if(void 0!==A){if(Array.isArray(A)){const E=[];for(let D=0,R=A.length;D<R;D++){const I=A[D];void 0===d[I]&&console.warn("THREE.ObjectLoader: Undefined material",I),E.push(d[I])}return E}return void 0===d[A]&&console.warn("THREE.ObjectLoader: Undefined material",A),d[A]}}switch(s.type){case"Scene":m=new am,void 0!==s.background&&Number.isInteger(s.background)&&(m.background=new At(s.background)),void 0!==s.fog&&("Fog"===s.fog.type?m.fog=new In(s.fog.color,s.fog.near,s.fog.far):"FogExp2"===s.fog.type&&(m.fog=new Ta(s.fog.color,s.fog.density)));break;case"PerspectiveCamera":m=new wr(s.fov,s.aspect,s.near,s.far),void 0!==s.focus&&(m.focus=s.focus),void 0!==s.zoom&&(m.zoom=s.zoom),void 0!==s.filmGauge&&(m.filmGauge=s.filmGauge),void 0!==s.filmOffset&&(m.filmOffset=s.filmOffset),void 0!==s.view&&(m.view=Object.assign({},s.view));break;case"OrthographicCamera":m=new Dc(s.left,s.right,s.top,s.bottom,s.near,s.far),void 0!==s.zoom&&(m.zoom=s.zoom),void 0!==s.view&&(m.view=Object.assign({},s.view));break;case"AmbientLight":m=new zw(s.color,s.intensity);break;case"DirectionalLight":m=new qm(s.color,s.intensity);break;case"PointLight":m=new jm(s.color,s.intensity,s.distance,s.decay);break;case"RectAreaLight":m=new ad(s.color,s.intensity,s.width,s.height);break;case"SpotLight":m=new Gm(s.color,s.intensity,s.distance,s.angle,s.penumbra,s.decay);break;case"HemisphereLight":m=new Vw(s.color,s.groundColor,s.intensity);break;case"LightProbe":m=(new Rc).fromJSON(s);break;case"SkinnedMesh":b=_(s.geometry),w=v(s.material),m=new _c(b,w),void 0!==s.bindMode&&(m.bindMode=s.bindMode),void 0!==s.bindMatrix&&m.bindMatrix.fromArray(s.bindMatrix),void 0!==s.skeleton&&(m.skeleton=s.skeleton);break;case"Mesh":b=_(s.geometry),w=v(s.material),m=new Ni(b,w);break;case"InstancedMesh":b=_(s.geometry),w=v(s.material);const E=s.instanceMatrix;m=new fm(b,w,s.count),m.instanceMatrix=new Ke(new Float32Array(E.array),16);break;case"LOD":m=new Gh;break;case"Line":m=new Qo(_(s.geometry),v(s.material));break;case"LineLoop":m=new qh(_(s.geometry),v(s.material));break;case"LineSegments":m=new ps(_(s.geometry),v(s.material));break;case"PointCloud":case"Points":m=new yc(_(s.geometry),v(s.material));break;case"Sprite":m=new tv(v(s.material));break;case"Group":m=new Fl;break;case"Bone":m=new ao;break;default:m=new en}if(m.uuid=s.uuid,void 0!==s.name&&(m.name=s.name),void 0!==s.matrix?(m.matrix.fromArray(s.matrix),void 0!==s.matrixAutoUpdate&&(m.matrixAutoUpdate=s.matrixAutoUpdate),m.matrixAutoUpdate&&m.matrix.decompose(m.position,m.quaternion,m.scale)):(void 0!==s.position&&m.position.fromArray(s.position),void 0!==s.rotation&&m.rotation.fromArray(s.rotation),void 0!==s.quaternion&&m.quaternion.fromArray(s.quaternion),void 0!==s.scale&&m.scale.fromArray(s.scale)),void 0!==s.castShadow&&(m.castShadow=s.castShadow),void 0!==s.receiveShadow&&(m.receiveShadow=s.receiveShadow),s.shadow&&(void 0!==s.shadow.bias&&(m.shadow.bias=s.shadow.bias),void 0!==s.shadow.normalBias&&(m.shadow.normalBias=s.shadow.normalBias),void 0!==s.shadow.radius&&(m.shadow.radius=s.shadow.radius),void 0!==s.shadow.mapSize&&m.shadow.mapSize.fromArray(s.shadow.mapSize),void 0!==s.shadow.camera&&(m.shadow.camera=this.parseObject(s.shadow.camera))),void 0!==s.visible&&(m.visible=s.visible),void 0!==s.frustumCulled&&(m.frustumCulled=s.frustumCulled),void 0!==s.renderOrder&&(m.renderOrder=s.renderOrder),void 0!==s.userData&&(m.userData=s.userData),void 0!==s.layers&&(m.layers.mask=s.layers),void 0!==s.children){const A=s.children;for(let E=0;E<A.length;E++)m.add(this.parseObject(A[E],a,d,f))}if(void 0!==s.animations){const A=s.animations;for(let E=0;E<A.length;E++)m.animations.push(f[A[E]])}if("LOD"===s.type){void 0!==s.autoUpdate&&(m.autoUpdate=s.autoUpdate);const A=s.levels;for(let E=0;E<A.length;E++){const D=A[E],R=m.getObjectByProperty("uuid",D.object);void 0!==R&&m.addLevel(R,D.distance)}}return m}bindSkeletons(s,a){0!==Object.keys(a).length&&s.traverse(function(d){if(!0===d.isSkinnedMesh&&void 0!==d.skeleton){const f=a[d.skeleton];void 0===f?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(f,d.bindMatrix)}})}setTexturePath(s){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(s)}}const F1={UVMapping:mp,CubeReflectionMapping:gp,CubeRefractionMapping:_p,EquirectangularReflectionMapping:X_,EquirectangularRefractionMapping:_a,CubeUVReflectionMapping:ou,CubeUVRefractionMapping:yp},Av={RepeatWrapping:nh,ClampToEdgeWrapping:Rs,MirroredRepeatWrapping:ih},N1={NearestFilter:kr,NearestMipmapNearestFilter:Z_,NearestMipmapLinearFilter:Y_,LinearFilter:fr,LinearMipmapNearestFilter:vp,LinearMipmapLinearFilter:oc};function Dv(u){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),cr.call(this,u),this.options={premultiplyAlpha:"none"}}Dv.prototype=Object.assign(Object.create(cr.prototype),{constructor:Dv,isImageBitmapLoader:!0,setOptions:function(s){return this.options=s,this},load:function(u,s,a,d){void 0===u&&(u=""),void 0!==this.path&&(u=this.path+u),u=this.manager.resolveURL(u);const f=this,m=Ul.get(u);if(void 0!==m)return f.manager.itemStart(u),setTimeout(function(){s&&s(m),f.manager.itemEnd(u)},0),m;const _={};_.credentials="anonymous"===this.crossOrigin?"same-origin":"include",_.headers=this.requestHeader,fetch(u,_).then(function(v){return v.blob()}).then(function(v){return createImageBitmap(v,Object.assign(f.options,{colorSpaceConversion:"none"}))}).then(function(v){Ul.add(u,v),s&&s(v),f.manager.itemEnd(u)}).catch(function(v){d&&d(v),f.manager.itemError(u),f.manager.itemEnd(u)}),f.manager.itemStart(u)}});class O1{constructor(){this.type="ShapePath",this.color=new At,this.subPaths=[],this.currentPath=null}moveTo(s,a){return this.currentPath=new zm,this.subPaths.push(this.currentPath),this.currentPath.moveTo(s,a),this}lineTo(s,a){return this.currentPath.lineTo(s,a),this}quadraticCurveTo(s,a,d,f){return this.currentPath.quadraticCurveTo(s,a,d,f),this}bezierCurveTo(s,a,d,f,m,_){return this.currentPath.bezierCurveTo(s,a,d,f,m,_),this}splineThru(s){return this.currentPath.splineThru(s),this}toShapes(s,a){function d(L){const j=[];for(let G=0,K=L.length;G<K;G++){const H=L[G],re=new Aa;re.curves=H.curves,j.push(re)}return j}function f(L,j){const G=j.length;let K=!1;for(let H=G-1,re=0;re<G;H=re++){let he=j[H],se=j[re],fe=se.x-he.x,we=se.y-he.y;if(Math.abs(we)>Number.EPSILON){if(we<0&&(he=j[re],fe=-fe,se=j[H],we=-we),L.y<he.y||L.y>se.y)continue;if(L.y===he.y){if(L.x===he.x)return!0}else{const Ce=we*(L.x-he.x)-fe*(L.y-he.y);if(0===Ce)return!0;if(Ce<0)continue;K=!K}}else{if(L.y!==he.y)continue;if(se.x<=L.x&&L.x<=he.x||he.x<=L.x&&L.x<=se.x)return!0}}return K}const m=sl.isClockWise,_=this.subPaths;if(0===_.length)return[];if(!0===a)return d(_);let v,b,w;const A=[];if(1===_.length)return b=_[0],w=new Aa,w.curves=b.curves,A.push(w),A;let E=!m(_[0].getPoints());E=s?!E:E;const D=[],R=[];let V,N,I=[],F=0;R[F]=void 0,I[F]=[];for(let L=0,j=_.length;L<j;L++)b=_[L],V=b.getPoints(),v=m(V),v=s?!v:v,v?(!E&&R[F]&&F++,R[F]={s:new Aa,p:V},R[F].s.curves=b.curves,E&&F++,I[F]=[]):I[F].push({h:b,p:V[0]});if(!R[0])return d(_);if(R.length>1){let L=!1;const j=[];for(let G=0,K=R.length;G<K;G++)D[G]=[];for(let G=0,K=R.length;G<K;G++){const H=I[G];for(let re=0;re<H.length;re++){const he=H[re];let se=!0;for(let fe=0;fe<R.length;fe++)f(he.p,R[fe].p)&&(G!==fe&&j.push({froms:G,tos:fe,hole:re}),se?(se=!1,D[fe].push(he)):L=!0);se&&D[G].push(he)}}j.length>0&&(L||(I=D))}for(let L=0,j=R.length;L<j;L++){w=R[L].s,A.push(w),N=I[L];for(let G=0,K=N.length;G<K;G++)w.holes.push(N[G].h)}return A}}class Ym{constructor(s){this.type="Font",this.data=s}generateShapes(s,a=100){const d=[],f=function Gw(u,s,a){const d=Array.from(u),f=s/a.resolution,m=(a.boundingBox.yMax-a.boundingBox.yMin+a.underlineThickness)*f,_=[];let v=0,b=0;for(let w=0;w<d.length;w++){const A=d[w];if("\n"===A)v=0,b-=m;else{const E=k1(A,f,v,b,a);v+=E.offsetX,_.push(E.path)}}return _}(s,a,this.data);for(let m=0,_=f.length;m<_;m++)Array.prototype.push.apply(d,f[m].toShapes());return d}}function k1(u,s,a,d,f){const m=f.glyphs[u]||f.glyphs["?"];if(!m)return void console.error('THREE.Font: character "'+u+'" does not exists in font family '+f.familyName+".");const _=new O1;let v,b,w,A,E,D,R,I;if(m.o){const F=m._cachedOutline||(m._cachedOutline=m.o.split(" "));for(let V=0,N=F.length;V<N;)switch(F[V++]){case"m":v=F[V++]*s+a,b=F[V++]*s+d,_.moveTo(v,b);break;case"l":v=F[V++]*s+a,b=F[V++]*s+d,_.lineTo(v,b);break;case"q":w=F[V++]*s+a,A=F[V++]*s+d,E=F[V++]*s+a,D=F[V++]*s+d,_.quadraticCurveTo(E,D,w,A);break;case"b":w=F[V++]*s+a,A=F[V++]*s+d,E=F[V++]*s+a,D=F[V++]*s+d,R=F[V++]*s+a,I=F[V++]*s+d,_.bezierCurveTo(E,D,R,I,w,A)}}return{offsetX:m.ha*s,path:_}}Ym.prototype.isFont=!0;class Rv extends cr{constructor(s){super(s)}load(s,a,d,f){const m=this,_=new Io(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(m.withCredentials),_.load(s,function(v){let b;try{b=JSON.parse(v)}catch(A){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),b=JSON.parse(v.substring(65,v.length-2))}const w=m.parse(b);a&&a(w)},d,f)}parse(s){return new Ym(s)}}let Iv;const Ww={getContext:function(){return void 0===Iv&&(Iv=new(window.AudioContext||window.webkitAudioContext)),Iv},setContext:function(u){Iv=u}};class B1 extends cr{constructor(s){super(s)}load(s,a,d,f){const m=this,_=new Io(this.manager);_.setResponseType("arraybuffer"),_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials),_.load(s,function(v){try{const b=v.slice(0);Ww.getContext().decodeAudioData(b,function(A){a(A)})}catch(b){f?f(b):console.error(b),m.manager.itemError(s)}},d,f)}}class V1 extends Rc{constructor(s,a,d=1){super(void 0,d);const f=(new At).set(s),m=(new At).set(a),_=new W(f.r,f.g,f.b),v=new W(m.r,m.g,m.b),b=Math.sqrt(Math.PI),w=b*Math.sqrt(.75);this.sh.coefficients[0].copy(_).add(v).multiplyScalar(b),this.sh.coefficients[1].copy(_).sub(v).multiplyScalar(w)}}V1.prototype.isHemisphereLightProbe=!0;class U1 extends Rc{constructor(s,a=1){super(void 0,a);const d=(new At).set(s);this.sh.coefficients[0].set(d.r,d.g,d.b).multiplyScalar(2*Math.sqrt(Math.PI))}}U1.prototype.isAmbientLightProbe=!0;const z1=new Ht,H1=new Ht;class FP{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new wr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new wr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(s){const a=this._cache;if(a.focus!==s.focus||a.fov!==s.fov||a.aspect!==s.aspect*this.aspect||a.near!==s.near||a.far!==s.far||a.zoom!==s.zoom||a.eyeSep!==this.eyeSep){a.focus=s.focus,a.fov=s.fov,a.aspect=s.aspect*this.aspect,a.near=s.near,a.far=s.far,a.zoom=s.zoom,a.eyeSep=this.eyeSep;const f=s.projectionMatrix.clone(),m=a.eyeSep/2,_=m*a.near/a.focus,v=a.near*Math.tan(Jt.DEG2RAD*a.fov*.5)/a.zoom;let b,w;H1.elements[12]=-m,z1.elements[12]=m,b=-v*a.aspect+_,w=v*a.aspect+_,f.elements[0]=2*a.near/(w-b),f.elements[8]=(w+b)/(w-b),this.cameraL.projectionMatrix.copy(f),b=-v*a.aspect-_,w=v*a.aspect-_,f.elements[0]=2*a.near/(w-b),f.elements[8]=(w+b)/(w-b),this.cameraR.projectionMatrix.copy(f)}this.cameraL.matrixWorld.copy(s.matrixWorld).multiply(H1),this.cameraR.matrixWorld.copy(s.matrixWorld).multiply(z1)}}class G1{constructor(s){this.autoStart=void 0===s||s,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=W1(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let s=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const a=W1();s=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=s}return s}}function W1(){return("undefined"==typeof performance?Date:performance).now()}const Us=new W,Jm=new wi,j1=new W,zl=new W;class Lv extends en{constructor(){super(),this.type="AudioListener",this.context=Ww.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new G1}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(s){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=s,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this}updateMatrixWorld(s){super.updateMatrixWorld(s);const a=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Us,Jm,j1),zl.set(0,0,-1).applyQuaternion(Jm),a.positionX){const f=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(Us.x,f),a.positionY.linearRampToValueAtTime(Us.y,f),a.positionZ.linearRampToValueAtTime(Us.z,f),a.forwardX.linearRampToValueAtTime(zl.x,f),a.forwardY.linearRampToValueAtTime(zl.y,f),a.forwardZ.linearRampToValueAtTime(zl.z,f),a.upX.linearRampToValueAtTime(d.x,f),a.upY.linearRampToValueAtTime(d.y,f),a.upZ.linearRampToValueAtTime(d.z,f)}else a.setPosition(Us.x,Us.y,Us.z),a.setOrientation(zl.x,zl.y,zl.z,d.x,d.y,d.z)}}class Km extends en{constructor(s){super(),this.type="Audio",this.listener=s,this.context=s.context,this.gain=this.context.createGain(),this.gain.connect(s.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(s){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=s,this.connect(),this}setMediaElementSource(s){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(s),this.connect(),this}setMediaStreamSource(s){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(s),this.connect(),this}setBuffer(s){return this.buffer=s,this.sourceType="buffer",this.autoplay&&this.play(),this}play(s=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+s;const a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let s=1,a=this.filters.length;s<a;s++)this.filters[s-1].connect(this.filters[s]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let s=1,a=this.filters.length;s<a;s++)this.filters[s-1].disconnect(this.filters[s]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(s){return s||(s=[]),!0===this._connected?(this.disconnect(),this.filters=s.slice(),this.connect()):this.filters=s.slice(),this}setDetune(s){if(this.detune=s,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(s){return this.setFilters(s?[s]:[])}setPlaybackRate(s){if(!1!==this.hasPlaybackControl)return this.playbackRate=s,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(s){if(!1!==this.hasPlaybackControl)return this.loop=s,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(s){return this.loopStart=s,this}setLoopEnd(s){return this.loopEnd=s,this}getVolume(){return this.gain.gain.value}setVolume(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this}}const ol=new W,jw=new wi,Hl=new W,Gl=new W;class q1 extends Km{constructor(s){super(s),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(s){return this.panner.refDistance=s,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(s){return this.panner.rolloffFactor=s,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(s){return this.panner.distanceModel=s,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(s){return this.panner.maxDistance=s,this}setDirectionalCone(s,a,d){return this.panner.coneInnerAngle=s,this.panner.coneOuterAngle=a,this.panner.coneOuterGain=d,this}updateMatrixWorld(s){if(super.updateMatrixWorld(s),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(ol,jw,Hl),Gl.set(0,0,1).applyQuaternion(jw);const a=this.panner;if(a.positionX){const d=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(ol.x,d),a.positionY.linearRampToValueAtTime(ol.y,d),a.positionZ.linearRampToValueAtTime(ol.z,d),a.orientationX.linearRampToValueAtTime(Gl.x,d),a.orientationY.linearRampToValueAtTime(Gl.y,d),a.orientationZ.linearRampToValueAtTime(Gl.z,d)}else a.setPosition(ol.x,ol.y,ol.z),a.setOrientation(Gl.x,Gl.y,Gl.z)}}class Qm{constructor(s,a=2048){this.analyser=s.context.createAnalyser(),this.analyser.fftSize=a,this.data=new Uint8Array(this.analyser.frequencyBinCount),s.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let s=0;const a=this.getFrequencyData();for(let d=0;d<a.length;d++)s+=a[d];return s/a.length}}class qw{constructor(s,a,d){let f,m,_;switch(this.binding=s,this.valueSize=d,a){case"quaternion":f=this._slerp,m=this._slerpAdditive,_=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*d),this._workIndex=5;break;case"string":case"bool":f=this._select,m=this._select,_=this._setAdditiveIdentityOther,this.buffer=new Array(5*d);break;default:f=this._lerp,m=this._lerpAdditive,_=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*d)}this._mixBufferRegion=f,this._mixBufferRegionAdditive=m,this._setIdentity=_,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(s,a){const d=this.buffer,f=this.valueSize,m=s*f+f;let _=this.cumulativeWeight;if(0===_){for(let v=0;v!==f;++v)d[m+v]=d[v];_=a}else _+=a,this._mixBufferRegion(d,m,0,a/_,f);this.cumulativeWeight=_}accumulateAdditive(s){const a=this.buffer,d=this.valueSize,f=d*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(a,f,0,s,d),this.cumulativeWeightAdditive+=s}apply(s){const a=this.valueSize,d=this.buffer,f=s*a+a,m=this.cumulativeWeight,_=this.cumulativeWeightAdditive,v=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,m<1&&this._mixBufferRegion(d,f,a*this._origIndex,1-m,a),_>0&&this._mixBufferRegionAdditive(d,f,this._addIndex*a,1,a);for(let b=a,w=a+a;b!==w;++b)if(d[b]!==d[b+a]){v.setValue(d,f);break}}saveOriginalState(){const a=this.buffer,d=this.valueSize,f=d*this._origIndex;this.binding.getValue(a,f);for(let m=d,_=f;m!==_;++m)a[m]=a[f+m%d];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const s=this._addIndex*this.valueSize,a=s+this.valueSize;for(let d=s;d<a;d++)this.buffer[d]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const s=this._origIndex*this.valueSize,a=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[a+d]=this.buffer[s+d]}_select(s,a,d,f,m){if(f>=.5)for(let _=0;_!==m;++_)s[a+_]=s[d+_]}_slerp(s,a,d,f){wi.slerpFlat(s,a,s,a,s,d,f)}_slerpAdditive(s,a,d,f,m){const _=this._workIndex*m;wi.multiplyQuaternionsFlat(s,_,s,a,s,d),wi.slerpFlat(s,a,s,a,s,_,f)}_lerp(s,a,d,f,m){const _=1-f;for(let v=0;v!==m;++v){const b=a+v;s[b]=s[b]*_+s[d+v]*f}}_lerpAdditive(s,a,d,f,m){for(let _=0;_!==m;++_){const v=a+_;s[v]=s[v]+s[d+_]*f}}}const eg="\\[\\]\\.:\\/",$1=new RegExp("["+eg+"]","g"),Pv="[^"+eg+"]",tg="[^"+eg.replace("\\.","")+"]",cd=/((?:WC+[\/:])*)/.source.replace("WC",Pv),Fv=/(WCOD+)?/.source.replace("WCOD",tg),ud=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Pv),ng=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Pv),yf=new RegExp("^"+cd+Fv+ud+ng+"$"),X1=["material","materials","bones"];function Nv(u,s,a){const d=a||ts.parseTrackName(s);this._targetGroup=u,this._bindings=u.subscribe_(s,d)}function ts(u,s,a){this.path=s,this.parsedPath=a||ts.parseTrackName(s),this.node=ts.findNode(u,this.parsedPath.nodeName)||u,this.rootNode=u}Object.assign(Nv.prototype,{getValue:function(u,s){this.bind();const d=this._bindings[this._targetGroup.nCachedObjects_];void 0!==d&&d.getValue(u,s)},setValue:function(u,s){const a=this._bindings;for(let d=this._targetGroup.nCachedObjects_,f=a.length;d!==f;++d)a[d].setValue(u,s)},bind:function(){const u=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=u.length;s!==a;++s)u[s].bind()},unbind:function(){const u=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=u.length;s!==a;++s)u[s].unbind()}}),Object.assign(ts,{Composite:Nv,create:function(u,s,a){return u&&u.isAnimationObjectGroup?new ts.Composite(u,s,a):new ts(u,s,a)},sanitizeNodeName:function(u){return u.replace(/\s/g,"_").replace($1,"")},parseTrackName:function(u){const s=yf.exec(u);if(!s)throw new Error("PropertyBinding: Cannot parse trackName: "+u);const a={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},d=a.nodeName&&a.nodeName.lastIndexOf(".");if(void 0!==d&&-1!==d){const f=a.nodeName.substring(d+1);-1!==X1.indexOf(f)&&(a.nodeName=a.nodeName.substring(0,d),a.objectName=f)}if(null===a.propertyName||0===a.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+u);return a},findNode:function(u,s){if(!s||""===s||"."===s||-1===s||s===u.name||s===u.uuid)return u;if(u.skeleton){const a=u.skeleton.getBoneByName(s);if(void 0!==a)return a}if(u.children){const a=function(f){for(let m=0;m<f.length;m++){const _=f[m];if(_.name===s||_.uuid===s)return _;const v=a(_.children);if(v)return v}return null},d=a(u.children);if(d)return d}return null}}),Object.assign(ts.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(s,a){s[a]=this.node[this.propertyName]},function(s,a){const d=this.resolvedProperty;for(let f=0,m=d.length;f!==m;++f)s[a++]=d[f]},function(s,a){s[a]=this.resolvedProperty[this.propertyIndex]},function(s,a){this.resolvedProperty.toArray(s,a)}],SetterByBindingTypeAndVersioning:[[function(s,a){this.targetObject[this.propertyName]=s[a]},function(s,a){this.targetObject[this.propertyName]=s[a],this.targetObject.needsUpdate=!0},function(s,a){this.targetObject[this.propertyName]=s[a],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(s,a){const d=this.resolvedProperty;for(let f=0,m=d.length;f!==m;++f)d[f]=s[a++]},function(s,a){const d=this.resolvedProperty;for(let f=0,m=d.length;f!==m;++f)d[f]=s[a++];this.targetObject.needsUpdate=!0},function(s,a){const d=this.resolvedProperty;for(let f=0,m=d.length;f!==m;++f)d[f]=s[a++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(s,a){this.resolvedProperty[this.propertyIndex]=s[a]},function(s,a){this.resolvedProperty[this.propertyIndex]=s[a],this.targetObject.needsUpdate=!0},function(s,a){this.resolvedProperty[this.propertyIndex]=s[a],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(s,a){this.resolvedProperty.fromArray(s,a)},function(s,a){this.resolvedProperty.fromArray(s,a),this.targetObject.needsUpdate=!0},function(s,a){this.resolvedProperty.fromArray(s,a),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(s,a){this.bind(),this.getValue(s,a)},setValue:function(s,a){this.bind(),this.setValue(s,a)},bind:function(){let u=this.node;const s=this.parsedPath,a=s.objectName,d=s.propertyName;let f=s.propertyIndex;if(u||(u=ts.findNode(this.rootNode,s.nodeName)||this.rootNode,this.node=u),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!u)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(a){let b=s.objectIndex;switch(a){case"materials":if(!u.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!u.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);u=u.material.materials;break;case"bones":if(!u.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);u=u.skeleton.bones;for(let w=0;w<u.length;w++)if(u[w].name===b){b=w;break}break;default:if(void 0===u[a])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);u=u[a]}if(void 0!==b){if(void 0===u[b])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,u);u=u[b]}}const m=u[d];if(void 0===m)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+s.nodeName+"."+d+" but it wasn't found.",u);let _=this.Versioning.None;this.targetObject=u,void 0!==u.needsUpdate?_=this.Versioning.NeedsUpdate:void 0!==u.matrixWorldNeedsUpdate&&(_=this.Versioning.MatrixWorldNeedsUpdate);let v=this.BindingType.Direct;if(void 0!==f){if("morphTargetInfluences"===d){if(!u.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!u.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!u.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==u.morphTargetDictionary[f]&&(f=u.morphTargetDictionary[f])}v=this.BindingType.ArrayElement,this.resolvedProperty=m,this.propertyIndex=f}else void 0!==m.fromArray&&void 0!==m.toArray?(v=this.BindingType.HasFromToArray,this.resolvedProperty=m):Array.isArray(m)?(v=this.BindingType.EntireArray,this.resolvedProperty=m):this.propertyName=d;this.getValue=this.GetterByBindingType[v],this.setValue=this.SetterByBindingTypeAndVersioning[v][_]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(ts.prototype,{_getValue_unbound:ts.prototype.getValue,_setValue_unbound:ts.prototype.setValue});class ig{constructor(){this.uuid=Jt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const s={};this._indicesByUUID=s;for(let d=0,f=arguments.length;d!==f;++d)s[arguments[d].uuid]=d;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}add(){const s=this._objects,a=this._indicesByUUID,d=this._paths,f=this._parsedPaths,m=this._bindings,_=m.length;let v,b=s.length,w=this.nCachedObjects_;for(let A=0,E=arguments.length;A!==E;++A){const D=arguments[A],R=D.uuid;let I=a[R];if(void 0===I){I=b++,a[R]=I,s.push(D);for(let F=0,V=_;F!==V;++F)m[F].push(new ts(D,d[F],f[F]))}else if(I<w){v=s[I];const F=--w,V=s[F];a[V.uuid]=I,s[I]=V,a[R]=F,s[F]=D;for(let N=0,L=_;N!==L;++N){const j=m[N];let K=j[I];j[I]=j[F],void 0===K&&(K=new ts(D,d[N],f[N])),j[F]=K}}else s[I]!==v&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=w}remove(){const s=this._objects,a=this._indicesByUUID,d=this._bindings,f=d.length;let m=this.nCachedObjects_;for(let _=0,v=arguments.length;_!==v;++_){const b=arguments[_],w=b.uuid,A=a[w];if(void 0!==A&&A>=m){const E=m++,D=s[E];a[D.uuid]=A,s[A]=D,a[w]=E,s[E]=b;for(let R=0,I=f;R!==I;++R){const F=d[R],N=F[A];F[A]=F[E],F[E]=N}}}this.nCachedObjects_=m}uncache(){const s=this._objects,a=this._indicesByUUID,d=this._bindings,f=d.length;let m=this.nCachedObjects_,_=s.length;for(let v=0,b=arguments.length;v!==b;++v){const A=arguments[v].uuid,E=a[A];if(void 0!==E)if(delete a[A],E<m){const D=--m,R=s[D],I=--_,F=s[I];a[R.uuid]=E,s[E]=R,a[F.uuid]=D,s[D]=F,s.pop();for(let V=0,N=f;V!==N;++V){const L=d[V],G=L[I];L[E]=L[D],L[D]=G,L.pop()}}else{const D=--_,R=s[D];D>0&&(a[R.uuid]=E),s[E]=R,s.pop();for(let I=0,F=f;I!==F;++I){const V=d[I];V[E]=V[D],V.pop()}}}this.nCachedObjects_=m}subscribe_(s,a){const d=this._bindingsIndicesByPath;let f=d[s];const m=this._bindings;if(void 0!==f)return m[f];const _=this._paths,v=this._parsedPaths,b=this._objects,A=this.nCachedObjects_,E=new Array(b.length);f=m.length,d[s]=f,_.push(s),v.push(a),m.push(E);for(let D=A,R=b.length;D!==R;++D)E[D]=new ts(b[D],s,a);return E}unsubscribe_(s){const a=this._bindingsIndicesByPath,d=a[s];if(void 0!==d){const f=this._paths,m=this._parsedPaths,_=this._bindings,v=_.length-1,b=_[v];a[s[v]]=d,_[d]=b,_.pop(),m[d]=m[v],m.pop(),f[d]=f[v],f.pop()}}}ig.prototype.isAnimationObjectGroup=!0;class Ov{constructor(s,a,d=null,f=a.blendMode){this._mixer=s,this._clip=a,this._localRoot=d,this.blendMode=f;const m=a.tracks,_=m.length,v=new Array(_),b={endingStart:fu,endingEnd:fu};for(let w=0;w!==_;++w){const A=m[w].createInterpolant(null);v[w]=A,A.settings=b}this._interpolantSettings=b,this._interpolants=v,this._propertyBindings=new Array(_),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ZC,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(s){return this._startTime=s,this}setLoop(s,a){return this.loop=s,this.repetitions=a,this}setEffectiveWeight(s){return this.weight=s,this._effectiveWeight=this.enabled?s:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(s){return this._scheduleFading(s,0,1)}fadeOut(s){return this._scheduleFading(s,1,0)}crossFadeFrom(s,a,d){if(s.fadeOut(a),this.fadeIn(a),d){const f=this._clip.duration,m=s._clip.duration,v=f/m;s.warp(1,m/f,a),this.warp(v,1,a)}return this}crossFadeTo(s,a,d){return s.crossFadeFrom(this,a,d)}stopFading(){const s=this._weightInterpolant;return null!==s&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(s)),this}setEffectiveTimeScale(s){return this.timeScale=s,this._effectiveTimeScale=this.paused?0:s,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(s){return this.timeScale=this._clip.duration/s,this.stopWarping()}syncWith(s){return this.time=s.time,this.timeScale=s.timeScale,this.stopWarping()}halt(s){return this.warp(this._effectiveTimeScale,0,s)}warp(s,a,d){const f=this._mixer,m=f.time,_=this.timeScale;let v=this._timeScaleInterpolant;null===v&&(v=f._lendControlInterpolant(),this._timeScaleInterpolant=v);const b=v.parameterPositions,w=v.sampleValues;return b[0]=m,b[1]=m+d,w[0]=s/_,w[1]=a/_,this}stopWarping(){const s=this._timeScaleInterpolant;return null!==s&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(s)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(s,a,d,f){if(!this.enabled)return void this._updateWeight(s);const m=this._startTime;if(null!==m){const b=(s-m)*d;if(b<0||0===d)return;this._startTime=null,a=d*b}a*=this._updateTimeScale(s);const _=this._updateTime(a),v=this._updateWeight(s);if(v>0){const b=this._interpolants,w=this._propertyBindings;if(this.blendMode===ah)for(let A=0,E=b.length;A!==E;++A)b[A].evaluate(_),w[A].accumulateAdditive(v);else for(let A=0,E=b.length;A!==E;++A)b[A].evaluate(_),w[A].accumulate(f,v)}}_updateWeight(s){let a=0;if(this.enabled){a=this.weight;const d=this._weightInterpolant;if(null!==d){const f=d.evaluate(s)[0];a*=f,s>d.parameterPositions[1]&&(this.stopFading(),0===f&&(this.enabled=!1))}}return this._effectiveWeight=a,a}_updateTimeScale(s){let a=0;if(!this.paused){a=this.timeScale;const d=this._timeScaleInterpolant;null!==d&&(a*=d.evaluate(s)[0],s>d.parameterPositions[1]&&(this.stopWarping(),0===a?this.paused=!0:this.timeScale=a))}return this._effectiveTimeScale=a,a}_updateTime(s){const a=this._clip.duration,d=this.loop;let f=this.time+s,m=this._loopCount;const _=d===Ls;if(0===s)return-1===m?f:_&&1==(1&m)?a-f:f;if(d===Yx){-1===m&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(f>=a)f=a;else{if(!(f<0)){this.time=f;break e}f=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=f,this._mixer.dispatchEvent({type:"finished",action:this,direction:s<0?-1:1})}}else{if(-1===m&&(s>=0?(m=0,this._setEndings(!0,0===this.repetitions,_)):this._setEndings(0===this.repetitions,!0,_)),f>=a||f<0){const v=Math.floor(f/a);f-=a*v,m+=Math.abs(v);const b=this.repetitions-m;if(b<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,f=s>0?a:0,this.time=f,this._mixer.dispatchEvent({type:"finished",action:this,direction:s>0?1:-1});else{if(1===b){const w=s<0;this._setEndings(w,!w,_)}else this._setEndings(!1,!1,_);this._loopCount=m,this.time=f,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:v})}}else this.time=f;if(_&&1==(1&m))return a-f}return f}_setEndings(s,a,d){const f=this._interpolantSettings;d?(f.endingStart=yt,f.endingEnd=yt):(f.endingStart=s?this.zeroSlopeAtStart?yt:fu:Rp,f.endingEnd=a?this.zeroSlopeAtEnd?yt:fu:Rp)}_scheduleFading(s,a,d){const f=this._mixer,m=f.time;let _=this._weightInterpolant;null===_&&(_=f._lendControlInterpolant(),this._weightInterpolant=_);const v=_.parameterPositions,b=_.sampleValues;return v[0]=m,b[0]=a,v[1]=m+s,b[1]=d,this}}class kv extends Yi{constructor(s){super(),this._root=s,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(s,a){const d=s._localRoot||this._root,f=s._clip.tracks,m=f.length,_=s._propertyBindings,v=s._interpolants,b=d.uuid,w=this._bindingsByRootAndName;let A=w[b];void 0===A&&(A={},w[b]=A);for(let E=0;E!==m;++E){const D=f[E],R=D.name;let I=A[R];if(void 0!==I)_[E]=I;else{if(I=_[E],void 0!==I){null===I._cacheIndex&&(++I.referenceCount,this._addInactiveBinding(I,b,R));continue}I=new qw(ts.create(d,R,a&&a._propertyBindings[E].binding.parsedPath),D.ValueTypeName,D.getValueSize()),++I.referenceCount,this._addInactiveBinding(I,b,R),_[E]=I}v[E].resultBuffer=I.buffer}}_activateAction(s){if(!this._isActiveAction(s)){if(null===s._cacheIndex){const d=(s._localRoot||this._root).uuid,f=s._clip.uuid,m=this._actionsByClip[f];this._bindAction(s,m&&m.knownActions[0]),this._addInactiveAction(s,f,d)}const a=s._propertyBindings;for(let d=0,f=a.length;d!==f;++d){const m=a[d];0==m.useCount++&&(this._lendBinding(m),m.saveOriginalState())}this._lendAction(s)}}_deactivateAction(s){if(this._isActiveAction(s)){const a=s._propertyBindings;for(let d=0,f=a.length;d!==f;++d){const m=a[d];0==--m.useCount&&(m.restoreOriginalState(),this._takeBackBinding(m))}this._takeBackAction(s)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const s=this;this.stats={actions:{get total(){return s._actions.length},get inUse(){return s._nActiveActions}},bindings:{get total(){return s._bindings.length},get inUse(){return s._nActiveBindings}},controlInterpolants:{get total(){return s._controlInterpolants.length},get inUse(){return s._nActiveControlInterpolants}}}}_isActiveAction(s){const a=s._cacheIndex;return null!==a&&a<this._nActiveActions}_addInactiveAction(s,a,d){const f=this._actions,m=this._actionsByClip;let _=m[a];if(void 0===_)_={knownActions:[s],actionByRoot:{}},s._byClipCacheIndex=0,m[a]=_;else{const v=_.knownActions;s._byClipCacheIndex=v.length,v.push(s)}s._cacheIndex=f.length,f.push(s),_.actionByRoot[d]=s}_removeInactiveAction(s){const a=this._actions,d=a[a.length-1],f=s._cacheIndex;d._cacheIndex=f,a[f]=d,a.pop(),s._cacheIndex=null;const m=s._clip.uuid,_=this._actionsByClip,v=_[m],b=v.knownActions,w=b[b.length-1],A=s._byClipCacheIndex;w._byClipCacheIndex=A,b[A]=w,b.pop(),s._byClipCacheIndex=null,delete v.actionByRoot[(s._localRoot||this._root).uuid],0===b.length&&delete _[m],this._removeInactiveBindingsForAction(s)}_removeInactiveBindingsForAction(s){const a=s._propertyBindings;for(let d=0,f=a.length;d!==f;++d){const m=a[d];0==--m.referenceCount&&this._removeInactiveBinding(m)}}_lendAction(s){const a=this._actions,d=s._cacheIndex,f=this._nActiveActions++,m=a[f];s._cacheIndex=f,a[f]=s,m._cacheIndex=d,a[d]=m}_takeBackAction(s){const a=this._actions,d=s._cacheIndex,f=--this._nActiveActions,m=a[f];s._cacheIndex=f,a[f]=s,m._cacheIndex=d,a[d]=m}_addInactiveBinding(s,a,d){const f=this._bindingsByRootAndName,m=this._bindings;let _=f[a];void 0===_&&(_={},f[a]=_),_[d]=s,s._cacheIndex=m.length,m.push(s)}_removeInactiveBinding(s){const a=this._bindings,d=s.binding,f=d.rootNode.uuid,m=d.path,_=this._bindingsByRootAndName,v=_[f],b=a[a.length-1],w=s._cacheIndex;b._cacheIndex=w,a[w]=b,a.pop(),delete v[m],0===Object.keys(v).length&&delete _[f]}_lendBinding(s){const a=this._bindings,d=s._cacheIndex,f=this._nActiveBindings++,m=a[f];s._cacheIndex=f,a[f]=s,m._cacheIndex=d,a[d]=m}_takeBackBinding(s){const a=this._bindings,d=s._cacheIndex,f=--this._nActiveBindings,m=a[f];s._cacheIndex=f,a[f]=s,m._cacheIndex=d,a[d]=m}_lendControlInterpolant(){const s=this._controlInterpolants,a=this._nActiveControlInterpolants++;let d=s[a];return void 0===d&&(d=new Es(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),d.__cacheIndex=a,s[a]=d),d}_takeBackControlInterpolant(s){const a=this._controlInterpolants,d=s.__cacheIndex,f=--this._nActiveControlInterpolants,m=a[f];s.__cacheIndex=f,a[f]=s,m.__cacheIndex=d,a[d]=m}clipAction(s,a,d){const f=a||this._root,m=f.uuid;let _="string"==typeof s?sf.findByName(f,s):s;const v=null!==_?_.uuid:s,b=this._actionsByClip[v];let w=null;if(void 0===d&&(d=null!==_?_.blendMode:Rn),void 0!==b){const E=b.actionByRoot[m];if(void 0!==E&&E.blendMode===d)return E;w=b.knownActions[0],null===_&&(_=w._clip)}if(null===_)return null;const A=new Ov(this,_,a,d);return this._bindAction(A,w),this._addInactiveAction(A,v,m),A}existingAction(s,a){const d=a||this._root,f=d.uuid,m="string"==typeof s?sf.findByName(d,s):s,v=this._actionsByClip[m?m.uuid:s];return void 0!==v&&v.actionByRoot[f]||null}stopAllAction(){const s=this._actions;for(let d=this._nActiveActions-1;d>=0;--d)s[d].stop();return this}update(s){const a=this._actions,d=this._nActiveActions,f=this.time+=s*=this.timeScale,m=Math.sign(s),_=this._accuIndex^=1;for(let w=0;w!==d;++w)a[w]._update(f,s,m,_);const v=this._bindings,b=this._nActiveBindings;for(let w=0;w!==b;++w)v[w].apply(_);return this}setTime(s){this.time=0;for(let a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(s)}getRoot(){return this._root}uncacheClip(s){const a=this._actions,d=s.uuid,f=this._actionsByClip,m=f[d];if(void 0!==m){const _=m.knownActions;for(let v=0,b=_.length;v!==b;++v){const w=_[v];this._deactivateAction(w);const A=w._cacheIndex,E=a[a.length-1];w._cacheIndex=null,w._byClipCacheIndex=null,E._cacheIndex=A,a[A]=E,a.pop(),this._removeInactiveBindingsForAction(w)}delete f[d]}}uncacheRoot(s){const a=s.uuid,d=this._actionsByClip;for(const _ in d){const b=d[_].actionByRoot[a];void 0!==b&&(this._deactivateAction(b),this._removeInactiveAction(b))}const m=this._bindingsByRootAndName[a];if(void 0!==m)for(const _ in m){const v=m[_];v.restoreOriginalState(),this._removeInactiveBinding(v)}}uncacheAction(s,a){const d=this.existingAction(s,a);null!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}}kv.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class dd{constructor(s){"string"==typeof s&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),s=arguments[1]),this.value=s}clone(){return new dd(void 0===this.value.clone?this.value:this.value.clone())}}function Bv(u,s,a){oo.call(this,u,s),this.meshPerAttribute=a||1}function $w(u,s,a,d,f){this.buffer=u,this.type=s,this.itemSize=a,this.elementSize=d,this.count=f,this.version=0}function Vv(u,s,a=0,d=1/0){this.ray=new cc(u,s),this.near=a,this.far=d,this.camera=null,this.layers=new ib,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Uv(u,s){return u.distance-s.distance}function zv(u,s,a,d){if(u.layers.test(s.layers)&&u.raycast(s,a),!0===d){const f=u.children;for(let m=0,_=f.length;m<_;m++)zv(f[m],s,a,!0)}}Bv.prototype=Object.assign(Object.create(oo.prototype),{constructor:Bv,isInstancedInterleavedBuffer:!0,copy:function(u){return oo.prototype.copy.call(this,u),this.meshPerAttribute=u.meshPerAttribute,this},clone:function(u){const s=oo.prototype.clone.call(this,u);return s.meshPerAttribute=this.meshPerAttribute,s},toJSON:function(u){const s=oo.prototype.toJSON.call(this,u);return s.isInstancedInterleavedBuffer=!0,s.meshPerAttribute=this.meshPerAttribute,s}}),Object.defineProperty($w.prototype,"needsUpdate",{set:function(u){!0===u&&this.version++}}),Object.assign($w.prototype,{isGLBufferAttribute:!0,setBuffer:function(u){return this.buffer=u,this},setType:function(u,s){return this.type=u,this.elementSize=s,this},setItemSize:function(u){return this.itemSize=u,this},setCount:function(u){return this.count=u,this}}),Object.assign(Vv.prototype,{set:function(u,s){this.ray.set(u,s)},setFromCamera:function(u,s){s&&s.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(s.matrixWorld),this.ray.direction.set(u.x,u.y,.5).unproject(s).sub(this.ray.origin).normalize(),this.camera=s):s&&s.isOrthographicCamera?(this.ray.origin.set(u.x,u.y,(s.near+s.far)/(s.near-s.far)).unproject(s),this.ray.direction.set(0,0,-1).transformDirection(s.matrixWorld),this.camera=s):console.error("THREE.Raycaster: Unsupported camera type: "+s.type)},intersectObject:function(u,s=!1,a=[]){return zv(u,this,a,s),a.sort(Uv),a},intersectObjects:function(u,s=!1,a=[]){for(let d=0,f=u.length;d<f;d++)zv(u[d],this,a,s);return a.sort(Uv),a}});class Xw{constructor(s=1,a=0,d=0){return this.radius=s,this.phi=a,this.theta=d,this}set(s,a,d){return this.radius=s,this.phi=a,this.theta=d,this}copy(s){return this.radius=s.radius,this.phi=s.phi,this.theta=s.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(s){return this.setFromCartesianCoords(s.x,s.y,s.z)}setFromCartesianCoords(s,a,d){return this.radius=Math.sqrt(s*s+a*a+d*d),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(s,d),this.phi=Math.acos(Jt.clamp(a/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Zw{constructor(s=1,a=0,d=0){return this.radius=s,this.theta=a,this.y=d,this}set(s,a,d){return this.radius=s,this.theta=a,this.y=d,this}copy(s){return this.radius=s.radius,this.theta=s.theta,this.y=s.y,this}setFromVector3(s){return this.setFromCartesianCoords(s.x,s.y,s.z)}setFromCartesianCoords(s,a,d){return this.radius=Math.sqrt(s*s+d*d),this.theta=Math.atan2(s,d),this.y=a,this}clone(){return(new this.constructor).copy(this)}}const Yw=new qe;class zr{constructor(s=new qe(1/0,1/0),a=new qe(-1/0,-1/0)){this.min=s,this.max=a}set(s,a){return this.min.copy(s),this.max.copy(a),this}setFromPoints(s){this.makeEmpty();for(let a=0,d=s.length;a<d;a++)this.expandByPoint(s[a]);return this}setFromCenterAndSize(s,a){const d=Yw.copy(a).multiplyScalar(.5);return this.min.copy(s).sub(d),this.max.copy(s).add(d),this}clone(){return(new this.constructor).copy(this)}copy(s){return this.min.copy(s.min),this.max.copy(s.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(s){return void 0===s&&(console.warn("THREE.Box2: .getCenter() target is now required"),s=new qe),this.isEmpty()?s.set(0,0):s.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(s){return void 0===s&&(console.warn("THREE.Box2: .getSize() target is now required"),s=new qe),this.isEmpty()?s.set(0,0):s.subVectors(this.max,this.min)}expandByPoint(s){return this.min.min(s),this.max.max(s),this}expandByVector(s){return this.min.sub(s),this.max.add(s),this}expandByScalar(s){return this.min.addScalar(-s),this.max.addScalar(s),this}containsPoint(s){return!(s.x<this.min.x||s.x>this.max.x||s.y<this.min.y||s.y>this.max.y)}containsBox(s){return this.min.x<=s.min.x&&s.max.x<=this.max.x&&this.min.y<=s.min.y&&s.max.y<=this.max.y}getParameter(s,a){return void 0===a&&(console.warn("THREE.Box2: .getParameter() target is now required"),a=new qe),a.set((s.x-this.min.x)/(this.max.x-this.min.x),(s.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(s){return!(s.max.x<this.min.x||s.min.x>this.max.x||s.max.y<this.min.y||s.min.y>this.max.y)}clampPoint(s,a){return void 0===a&&(console.warn("THREE.Box2: .clampPoint() target is now required"),a=new qe),a.copy(s).clamp(this.min,this.max)}distanceToPoint(s){return Yw.copy(s).clamp(this.min,this.max).sub(s).length()}intersect(s){return this.min.max(s.min),this.max.min(s.max),this}union(s){return this.min.min(s.min),this.max.max(s.max),this}translate(s){return this.min.add(s),this.max.add(s),this}equals(s){return s.min.equals(this.min)&&s.max.equals(this.max)}}zr.prototype.isBox2=!0;const Hv=new W,rg=new W;class Z1{constructor(s=new W,a=new W){this.start=s,this.end=a}set(s,a){return this.start.copy(s),this.end.copy(a),this}copy(s){return this.start.copy(s.start),this.end.copy(s.end),this}getCenter(s){return void 0===s&&(console.warn("THREE.Line3: .getCenter() target is now required"),s=new W),s.addVectors(this.start,this.end).multiplyScalar(.5)}delta(s){return void 0===s&&(console.warn("THREE.Line3: .delta() target is now required"),s=new W),s.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(s,a){return void 0===a&&(console.warn("THREE.Line3: .at() target is now required"),a=new W),this.delta(a).multiplyScalar(s).add(this.start)}closestPointToPointParameter(s,a){Hv.subVectors(s,this.start),rg.subVectors(this.end,this.start);const d=rg.dot(rg);let m=rg.dot(Hv)/d;return a&&(m=Jt.clamp(m,0,1)),m}closestPointToPoint(s,a,d){const f=this.closestPointToPointParameter(s,a);return void 0===d&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),d=new W),this.delta(d).multiplyScalar(f).add(this.start)}applyMatrix4(s){return this.start.applyMatrix4(s),this.end.applyMatrix4(s),this}equals(s){return s.start.equals(this.start)&&s.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}function vf(u){en.call(this),this.material=u,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}(vf.prototype=Object.create(en.prototype)).constructor=vf,vf.prototype.isImmediateRenderObject=!0;const sg=new W;class Jw extends en{constructor(s,a){super(),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=a;const d=new jt,f=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let _=0,v=1,b=32;_<b;_++,v++){const w=_/b*Math.PI*2,A=v/b*Math.PI*2;f.push(Math.cos(w),Math.sin(w),1,Math.cos(A),Math.sin(A),1)}d.setAttribute("position",new pe(f,3));const m=new Mr({fog:!1,toneMapped:!1});this.cone=new ps(d,m),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const s=this.light.distance?this.light.distance:1e3,a=s*Math.tan(this.light.angle);this.cone.scale.set(a,a,s),sg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(sg),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Wl=new W,og=new Ht,Gv=new Ht;class Wv extends ps{constructor(s){const a=Kw(s),d=new jt,f=[],m=[],_=new At(0,0,1),v=new At(0,1,0);for(let w=0;w<a.length;w++){const A=a[w];A.parent&&A.parent.isBone&&(f.push(0,0,0),f.push(0,0,0),m.push(_.r,_.g,_.b),m.push(v.r,v.g,v.b))}d.setAttribute("position",new pe(f,3)),d.setAttribute("color",new pe(m,3)),super(d,new Mr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=s,this.bones=a,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(s){const a=this.bones,d=this.geometry,f=d.getAttribute("position");Gv.copy(this.root.matrixWorld).invert();for(let m=0,_=0;m<a.length;m++){const v=a[m];v.parent&&v.parent.isBone&&(og.multiplyMatrices(Gv,v.matrixWorld),Wl.setFromMatrixPosition(og),f.setXYZ(_,Wl.x,Wl.y,Wl.z),og.multiplyMatrices(Gv,v.parent.matrixWorld),Wl.setFromMatrixPosition(og),f.setXYZ(_+1,Wl.x,Wl.y,Wl.z),_+=2)}d.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(s)}}function Kw(u){const s=[];u&&u.isBone&&s.push(u);for(let a=0;a<u.children.length;a++)s.push.apply(s,Kw(u.children[a]));return s}class Qw extends Ni{constructor(s,a,d){super(new bc(a,4,2),new cs({wireframe:!0,fog:!1,toneMapped:!1})),this.light=s,this.light.updateMatrixWorld(),this.color=d,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Y1=new W,eM=new At,jv=new At;class tM extends en{constructor(s,a,d){super(),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=d;const f=new Bl(a);f.rotateY(.5*Math.PI),this.material=new cs({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const m=f.getAttribute("position"),_=new Float32Array(3*m.count);f.setAttribute("color",new Ke(_,3)),this.add(new Ni(f,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const s=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const a=s.geometry.getAttribute("color");eM.copy(this.light.color),jv.copy(this.light.groundColor);for(let d=0,f=a.count;d<f;d++){const m=d<f/2?eM:jv;a.setXYZ(d,m.r,m.g,m.b)}a.needsUpdate=!0}s.lookAt(Y1.setFromMatrixPosition(this.light.matrixWorld).negate())}}class nM extends ps{constructor(s=10,a=10,d=4473924,f=8947848){d=new At(d),f=new At(f);const m=a/2,_=s/a,v=s/2,b=[],w=[];for(let D=0,R=0,I=-v;D<=a;D++,I+=_){b.push(-v,0,I,v,0,I),b.push(I,0,-v,I,0,v);const F=D===m?d:f;F.toArray(w,R),R+=3,F.toArray(w,R),R+=3,F.toArray(w,R),R+=3,F.toArray(w,R),R+=3}const A=new jt;A.setAttribute("position",new pe(b,3)),A.setAttribute("color",new pe(w,3)),super(A,new Mr({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Da extends ps{constructor(s=10,a=16,d=8,f=64,m=4473924,_=8947848){m=new At(m),_=new At(_);const v=[],b=[];for(let E=0;E<=a;E++){const D=E/a*(2*Math.PI),R=Math.sin(D)*s,I=Math.cos(D)*s;v.push(0,0,0),v.push(R,0,I);const F=1&E?m:_;b.push(F.r,F.g,F.b),b.push(F.r,F.g,F.b)}for(let E=0;E<=d;E++){const D=1&E?m:_,R=s-s/d*E;for(let I=0;I<f;I++){let F=I/f*(2*Math.PI),V=Math.sin(F)*R,N=Math.cos(F)*R;v.push(V,0,N),b.push(D.r,D.g,D.b),F=(I+1)/f*(2*Math.PI),V=Math.sin(F)*R,N=Math.cos(F)*R,v.push(V,0,N),b.push(D.r,D.g,D.b)}}const w=new jt;w.setAttribute("position",new pe(v,3)),w.setAttribute("color",new pe(b,3)),super(w,new Mr({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const ag=new W,lg=new W,iM=new W;class NP extends en{constructor(s,a,d){super(),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,void 0===a&&(a=1);let f=new jt;f.setAttribute("position",new pe([-a,a,0,a,a,0,a,-a,0,-a,-a,0,-a,a,0],3));const m=new Mr({fog:!1,toneMapped:!1});this.lightPlane=new Qo(f,m),this.add(this.lightPlane),f=new jt,f.setAttribute("position",new pe([0,0,0,0,0,1],3)),this.targetLine=new Qo(f,m),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){ag.setFromMatrixPosition(this.light.matrixWorld),lg.setFromMatrixPosition(this.light.target.matrixWorld),iM.subVectors(lg,ag),this.lightPlane.lookAt(lg),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(lg),this.targetLine.scale.z=iM.length()}}const xf=new W,ur=new Rl;class J1 extends ps{constructor(s){const a=new jt,d=new Mr({color:16777215,vertexColors:!0,toneMapped:!1}),f=[],m=[],_={},v=new At(16755200),b=new At(16711680),w=new At(43775),A=new At(16777215),E=new At(3355443);function D(I,F,V){R(I,V),R(F,V)}function R(I,F){f.push(0,0,0),m.push(F.r,F.g,F.b),void 0===_[I]&&(_[I]=[]),_[I].push(f.length/3-1)}D("n1","n2",v),D("n2","n4",v),D("n4","n3",v),D("n3","n1",v),D("f1","f2",v),D("f2","f4",v),D("f4","f3",v),D("f3","f1",v),D("n1","f1",v),D("n2","f2",v),D("n3","f3",v),D("n4","f4",v),D("p","n1",b),D("p","n2",b),D("p","n3",b),D("p","n4",b),D("u1","u2",w),D("u2","u3",w),D("u3","u1",w),D("c","t",A),D("p","c",E),D("cn1","cn2",E),D("cn3","cn4",E),D("cf1","cf2",E),D("cf3","cf4",E),a.setAttribute("position",new pe(f,3)),a.setAttribute("color",new pe(m,3)),super(a,d),this.type="CameraHelper",this.camera=s,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=_,this.update()}update(){const s=this.geometry,a=this.pointMap;ur.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),pr("c",a,s,ur,0,0,-1),pr("t",a,s,ur,0,0,1),pr("n1",a,s,ur,-1,-1,-1),pr("n2",a,s,ur,1,-1,-1),pr("n3",a,s,ur,-1,1,-1),pr("n4",a,s,ur,1,1,-1),pr("f1",a,s,ur,-1,-1,1),pr("f2",a,s,ur,1,-1,1),pr("f3",a,s,ur,-1,1,1),pr("f4",a,s,ur,1,1,1),pr("u1",a,s,ur,.7,1.1,-1),pr("u2",a,s,ur,-.7,1.1,-1),pr("u3",a,s,ur,0,2,-1),pr("cf1",a,s,ur,-1,0,1),pr("cf2",a,s,ur,1,0,1),pr("cf3",a,s,ur,0,-1,1),pr("cf4",a,s,ur,0,1,1),pr("cn1",a,s,ur,-1,0,-1),pr("cn2",a,s,ur,1,0,-1),pr("cn3",a,s,ur,0,-1,-1),pr("cn4",a,s,ur,0,1,-1),s.getAttribute("position").needsUpdate=!0}}function pr(u,s,a,d,f,m,_){xf.set(f,m,_).unproject(d);const v=s[u];if(void 0!==v){const b=a.getAttribute("position");for(let w=0,A=v.length;w<A;w++)b.setXYZ(v[w],xf.x,xf.y,xf.z)}}const hd=new Zn;class rM extends ps{constructor(s,a=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),f=new Float32Array(24),m=new jt;m.setIndex(new Ke(d,1)),m.setAttribute("position",new Ke(f,3)),super(m,new Mr({color:a,toneMapped:!1})),this.object=s,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(s){if(void 0!==s&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&hd.setFromObject(this.object),hd.isEmpty())return;const a=hd.min,d=hd.max,f=this.geometry.attributes.position,m=f.array;m[0]=d.x,m[1]=d.y,m[2]=d.z,m[3]=a.x,m[4]=d.y,m[5]=d.z,m[6]=a.x,m[7]=a.y,m[8]=d.z,m[9]=d.x,m[10]=a.y,m[11]=d.z,m[12]=d.x,m[13]=d.y,m[14]=a.z,m[15]=a.x,m[16]=d.y,m[17]=a.z,m[18]=a.x,m[19]=a.y,m[20]=a.z,m[21]=d.x,m[22]=a.y,m[23]=a.z,f.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(s){return this.object=s,this.update(),this}copy(s){return ps.prototype.copy.call(this,s),this.object=s.object,this}}class K1 extends ps{constructor(s,a=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),m=new jt;m.setIndex(new Ke(d,1)),m.setAttribute("position",new pe([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(m,new Mr({color:a,toneMapped:!1})),this.box=s,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(s){const a=this.box;a.isEmpty()||(a.getCenter(this.position),a.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(s))}}class cg extends Qo{constructor(s,a=1,d=16776960){const f=d,_=new jt;_.setAttribute("position",new pe([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),_.computeBoundingSphere(),super(_,new Mr({color:f,toneMapped:!1})),this.type="PlaneHelper",this.plane=s,this.size=a;const b=new jt;b.setAttribute("position",new pe([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),b.computeBoundingSphere(),this.add(new Ni(b,new cs({color:f,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(s){let a=-this.plane.constant;Math.abs(a)<1e-8&&(a=1e-8),this.scale.set(.5*this.size,.5*this.size,a),this.children[0].material.side=a<0?X:hn,this.lookAt(this.plane.normal),super.updateMatrixWorld(s)}}const ug=new W;let dg,hg;class qv extends en{constructor(s=new W(0,0,1),a=new W(0,0,0),d=1,f=16776960,m=.2*d,_=.2*m){super(),this.type="ArrowHelper",void 0===dg&&(dg=new jt,dg.setAttribute("position",new pe([0,0,0,0,1,0],3)),hg=new Ku(0,.5,1,5,1),hg.translate(0,-.5,0)),this.position.copy(a),this.line=new Qo(dg,new Mr({color:f,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ni(hg,new cs({color:f,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(s),this.setLength(d,m,_)}setDirection(s){if(s.y>.99999)this.quaternion.set(0,0,0,1);else if(s.y<-.99999)this.quaternion.set(1,0,0,0);else{ug.set(s.z,0,-s.x).normalize();const a=Math.acos(s.y);this.quaternion.setFromAxisAngle(ug,a)}}setLength(s,a=.2*s,d=.2*a){this.line.scale.set(1,Math.max(1e-4,s-a),1),this.line.updateMatrix(),this.cone.scale.set(d,a,d),this.cone.position.y=s,this.cone.updateMatrix()}setColor(s){this.line.material.color.set(s),this.cone.material.color.set(s)}copy(s){return super.copy(s,!1),this.line.copy(s.line),this.cone.copy(s.cone),this}}class $v extends ps{constructor(s=1){const a=[0,0,0,s,0,0,0,0,0,0,s,0,0,0,0,0,0,s],f=new jt;f.setAttribute("position",new pe(a,3)),f.setAttribute("color",new pe([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(f,new Mr({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}}const Q1=new Float32Array(1),OP=new Int32Array(Q1.buffer),Xv={toHalfFloat:function(u){Q1[0]=u;const s=OP[0];let a=s>>16&32768,d=s>>12&2047;const f=s>>23&255;return f<103?a:f>142?(a|=31744,a|=(255==f?0:1)&&8388607&s,a):f<113?(d|=2048,a|=(d>>114-f)+(d>>113-f&1),a):(a|=f-112<<10|d>>1,a+=1&d,a)}},ia=Math.pow(2,8),Zv=[.125,.215,.35,.446,.526,.582],Yv=5+Zv.length,Po={[os]:0,[yl]:1,[lh]:2,[Yt]:3,[ch]:4,[hy]:5,[pu]:6},Cs=new cs({side:X,depthWrite:!1,depthTest:!1}),fg=new Ni(new Tl,Cs),fd=new Dc,{_lodPlanes:al,_sizeLods:sM,_sigmas:pd}=nA(),Jv=new At;let Kv=null;const Lc=(1+Math.sqrt(5))/2,Ra=1/Lc,oM=[new W(1,1,1),new W(-1,1,1),new W(1,1,-1),new W(-1,1,-1),new W(0,Lc,Ra),new W(0,Lc,-Ra),new W(Ra,0,Lc),new W(-Ra,0,Lc),new W(Lc,Ra,0),new W(-Lc,Ra,0)];function eA(u){const s=Math.max(u.r,u.g,u.b),a=Math.min(Math.max(Math.ceil(Math.log2(s)),-128),127);return u.multiplyScalar(Math.pow(2,-a)),(a+128)/255}class tA{constructor(s){this._renderer=s,this._pingPongRenderTarget=null,this._blurMaterial=function iA(u){const s=new Float32Array(u),a=new W(0,1,0);return new rd({name:"SphericalGaussianBlur",defines:{n:u},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a},inputEncoding:{value:Po[os]},outputEncoding:{value:Po[os]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:yr,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(s,a=0,d=.1,f=100){Kv=this._renderer.getRenderTarget();const m=this._allocateTargets();return this._sceneToCubeUV(s,d,f,m),a>0&&this._blur(m,0,0,a),this._applyPMREM(m),this._cleanup(m),m}fromEquirectangular(s){return this._fromTexture(s)}fromCubemap(s){return this._fromTexture(s)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Qv(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=rA(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let s=0;s<al.length;s++)al[s].dispose()}_cleanup(s){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Kv),s.scissorTest=!1,pg(s,0,0,s.width,s.height)}_fromTexture(s){Kv=this._renderer.getRenderTarget();const a=this._allocateTargets(s);return this._textureToCubeUV(s,a),this._applyPMREM(a),this._cleanup(a),a}_allocateTargets(s){const a={magFilter:kr,minFilter:kr,generateMipmaps:!1,type:au,format:ya,encoding:(u=s,void 0===u||u.type!==au||u.encoding!==os&&u.encoding!==yl&&u.encoding!==pu?lh:s.encoding),depthBuffer:!1},d=aM(a);var u;return d.depthBuffer=!s,this._pingPongRenderTarget=aM(a),d}_compileMaterial(s){const a=new Ni(al[0],s);this._renderer.compile(a,fd)}_sceneToCubeUV(s,a,d,f){const v=new wr(90,1,a,d),b=[1,-1,1,1,1,1],w=[1,1,1,-1,-1,-1],A=this._renderer,E=A.autoClear,D=A.outputEncoding,R=A.toneMapping;A.getClearColor(Jv),A.toneMapping=su,A.outputEncoding=os,A.autoClear=!1;let I=!1;const F=s.background;if(F){if(F.isColor){Cs.color.copy(F).convertSRGBToLinear(),s.background=null;const V=eA(Cs.color);Cs.opacity=V,I=!0}}else{Cs.color.copy(Jv).convertSRGBToLinear();const V=eA(Cs.color);Cs.opacity=V,I=!0}for(let V=0;V<6;V++){const N=V%3;0==N?(v.up.set(0,b[V],0),v.lookAt(w[V],0,0)):1==N?(v.up.set(0,0,b[V]),v.lookAt(0,w[V],0)):(v.up.set(0,b[V],0),v.lookAt(0,0,w[V])),pg(f,N*ia,V>2?ia:0,ia,ia),A.setRenderTarget(f),I&&A.render(fg,v),A.render(s,v)}A.toneMapping=R,A.outputEncoding=D,A.autoClear=E}_textureToCubeUV(s,a){const d=this._renderer;s.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Qv()):null==this._equirectShader&&(this._equirectShader=rA());const f=s.isCubeTexture?this._cubemapShader:this._equirectShader,m=new Ni(al[0],f),_=f.uniforms;_.envMap.value=s,s.isCubeTexture||_.texelSize.value.set(1/s.image.width,1/s.image.height),_.inputEncoding.value=Po[s.encoding],_.outputEncoding.value=Po[a.texture.encoding],pg(a,0,0,3*ia,2*ia),d.setRenderTarget(a),d.render(m,fd)}_applyPMREM(s){const a=this._renderer,d=a.autoClear;a.autoClear=!1;for(let f=1;f<Yv;f++){const m=Math.sqrt(pd[f]*pd[f]-pd[f-1]*pd[f-1]);this._blur(s,f-1,f,m,oM[(f-1)%oM.length])}a.autoClear=d}_blur(s,a,d,f,m){const _=this._pingPongRenderTarget;this._halfBlur(s,_,a,d,f,"latitudinal",m),this._halfBlur(_,s,d,d,f,"longitudinal",m)}_halfBlur(s,a,d,f,m,_,v){const b=this._renderer,w=this._blurMaterial;"latitudinal"!==_&&"longitudinal"!==_&&console.error("blur direction must be either latitudinal or longitudinal!");const E=new Ni(al[f],w),D=w.uniforms,R=sM[d]-1,I=isFinite(m)?Math.PI/(2*R):2*Math.PI/39,F=m/I,V=isFinite(m)?1+Math.floor(3*F):20;V>20&&console.warn(`sigmaRadians, ${m}, is too large and will clip, as it requested ${V} samples when the maximum is set to 20`);const N=[];let L=0;for(let H=0;H<20;++H){const re=H/F,he=Math.exp(-re*re/2);N.push(he),0==H?L+=he:H<V&&(L+=2*he)}for(let H=0;H<N.length;H++)N[H]=N[H]/L;D.envMap.value=s.texture,D.samples.value=V,D.weights.value=N,D.latitudinal.value="latitudinal"===_,v&&(D.poleAxis.value=v),D.dTheta.value=I,D.mipInt.value=8-d,D.inputEncoding.value=Po[s.texture.encoding],D.outputEncoding.value=Po[s.texture.encoding];const j=sM[f];pg(a,3*Math.max(0,ia-2*j),(0===f?0:2*ia)+2*j*(f>4?f-8+4:0),3*j,2*j),b.setRenderTarget(a),b.render(E,fd)}}function nA(){const u=[],s=[],a=[];let d=8;for(let f=0;f<Yv;f++){const m=Math.pow(2,d);s.push(m);let _=1/m;f>4?_=Zv[f-8+4-1]:0==f&&(_=0),a.push(_);const v=1/(m-1),b=-v/2,w=1+v/2,A=[b,b,w,b,w,w,b,b,w,w,b,w],E=6,D=6,R=3,I=2,F=1,V=new Float32Array(R*D*E),N=new Float32Array(I*D*E),L=new Float32Array(F*D*E);for(let G=0;G<E;G++){const K=G%3*2/3-1,H=G>2?0:-1;V.set([K,H,0,K+2/3,H,0,K+2/3,H+1,0,K,H,0,K+2/3,H+1,0,K,H+1,0],R*D*G),N.set(A,I*D*G),L.set([G,G,G,G,G,G],F*D*G)}const j=new jt;j.setAttribute("position",new Ke(V,R)),j.setAttribute("uv",new Ke(N,I)),j.setAttribute("faceIndex",new Ke(L,F)),u.push(j),d>4&&d--}return{_lodPlanes:u,_sizeLods:s,_sigmas:a}}function aM(u){const s=new rn(3*ia,3*ia,u);return s.texture.mapping=ou,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function pg(u,s,a,d,f){u.viewport.set(s,a,d,f),u.scissor.set(s,a,d,f)}function rA(){const u=new qe(1,1);return new rd({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:u},inputEncoding:{value:Po[os]},outputEncoding:{value:Po[os]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:yr,depthTest:!1,depthWrite:!1})}function Qv(){return new rd({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Po[os]},outputEncoding:{value:Po[os]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:yr,depthTest:!1,depthWrite:!1})}const t0=0,sA=1,oA=0,aA=1,lA=2;function cA(u){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),u}function uA(u=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),u.isMultiMaterial=!0,u.materials=u,u.clone=function(){return u.slice()},u}function mg(u,s){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new yc(u,s)}function Pc(u){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new tv(u)}function BP(u,s){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new yc(u,s)}function wf(u){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new lr(u)}function dA(u){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new lr(u)}function hA(u){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new lr(u)}function n0(u,s,a){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new W(u,s,a)}function fA(u,s){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Ke(u,s).setUsage(lc)}function Ia(u,s){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Mu(u,s)}function Mf(u,s){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Fp(u,s)}function ms(u,s){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ph(u,s)}function Fc(u,s){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new mh(u,s)}function gg(u,s){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new hc(u,s)}function Fo(u,s){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Su(u,s)}function gs(u,s){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new fc(u,s)}function md(u,s){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new pe(u,s)}function gd(u,s){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new On(u,s)}function _d(u){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new $v(u)}function yd(u,s){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new rM(u,s)}function vd(u,s){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ps(new xw(u.geometry),new Mr({color:void 0!==s?s:16777215}))}function xd(u,s){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ps(new Cm(u.geometry),new Mr({color:void 0!==s?s:16777215}))}function bd(u){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Io(u)}function wd(u){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new af(u)}function Md(u,s,a){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new pc(u,a)}function lM(){console.error("THREE.CanvasRenderer has been removed")}function cM(){console.error("THREE.JSONLoader has been removed.")}Ii.create=function(u,s){return console.log("THREE.Curve.create() has been deprecated"),u.prototype=Object.create(Ii.prototype),u.prototype.constructor=u,u.prototype.getPoint=s,u},zm.prototype.fromPoints=function(u){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(u)},nM.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Wv.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},cr.prototype.extractUrlBase=function(u){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),_f.extractUrlBase(u)},cr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},zr.prototype.center=function(u){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(u)},zr.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},zr.prototype.isIntersectionBox=function(u){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(u)},zr.prototype.size=function(u){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(u)},Zn.prototype.center=function(u){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(u)},Zn.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Zn.prototype.isIntersectionBox=function(u){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(u)},Zn.prototype.isIntersectionSphere=function(u){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(u)},Zn.prototype.size=function(u){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(u)},wl.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Pu.prototype.setFromMatrix=function(u){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(u)},Z1.prototype.center=function(u){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(u)},Jt.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},Jt.nearestPowerOfTwo=function(u){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Jt.floorPowerOfTwo(u)},Jt.nextPowerOfTwo=function(u){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Jt.ceilPowerOfTwo(u)},Ji.prototype.flattenToArrayOffset=function(u,s){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(u,s)},Ji.prototype.multiplyVector3=function(u){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),u.applyMatrix3(this)},Ji.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Ji.prototype.applyToBufferAttribute=function(u){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),u.applyMatrix3(this)},Ji.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Ji.prototype.getInverse=function(u){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(u).invert()},Ht.prototype.extractPosition=function(u){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(u)},Ht.prototype.flattenToArrayOffset=function(u,s){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(u,s)},Ht.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new W).setFromMatrixColumn(this,3)},Ht.prototype.setRotationFromQuaternion=function(u){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(u)},Ht.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Ht.prototype.multiplyVector3=function(u){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),u.applyMatrix4(this)},Ht.prototype.multiplyVector4=function(u){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),u.applyMatrix4(this)},Ht.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Ht.prototype.rotateAxis=function(u){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),u.transformDirection(this)},Ht.prototype.crossVector=function(u){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),u.applyMatrix4(this)},Ht.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Ht.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Ht.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Ht.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Ht.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Ht.prototype.applyToBufferAttribute=function(u){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),u.applyMatrix4(this)},Ht.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Ht.prototype.makeFrustum=function(u,s,a,d,f,m){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(u,s,d,a,f,m)},Ht.prototype.getInverse=function(u){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(u).invert()},$o.prototype.isIntersectionLine=function(u){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(u)},wi.prototype.multiplyVector3=function(u){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),u.applyQuaternion(this)},wi.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},cc.prototype.isIntersectionBox=function(u){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(u)},cc.prototype.isIntersectionPlane=function(u){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(u)},cc.prototype.isIntersectionSphere=function(u){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(u)},xr.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},xr.prototype.barycoordFromPoint=function(u,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(u,s)},xr.prototype.midpoint=function(u){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(u)},xr.prototypenormal=function(u){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(u)},xr.prototype.plane=function(u){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(u)},xr.barycoordFromPoint=function(u,s,a,d,f){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),xr.getBarycoord(u,s,a,d,f)},xr.normal=function(u,s,a,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),xr.getNormal(u,s,a,d)},Aa.prototype.extractAllPoints=function(u){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(u)},Aa.prototype.extrude=function(u){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ss(this,u)},Aa.prototype.makeGeometry=function(u){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new nd(this,u)},qe.prototype.fromAttribute=function(u,s,a){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(u,s,a)},qe.prototype.distanceToManhattan=function(u){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(u)},qe.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},W.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},W.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},W.prototype.getPositionFromMatrix=function(u){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(u)},W.prototype.getScaleFromMatrix=function(u){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(u)},W.prototype.getColumnFromMatrix=function(u,s){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(s,u)},W.prototype.applyProjection=function(u){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(u)},W.prototype.fromAttribute=function(u,s,a){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(u,s,a)},W.prototype.distanceToManhattan=function(u){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(u)},W.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},$e.prototype.fromAttribute=function(u,s,a){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(u,s,a)},$e.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},en.prototype.getChildByName=function(u){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(u)},en.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},en.prototype.translate=function(u,s){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(s,u)},en.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},en.prototype.applyMatrix=function(u){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(u)},Object.defineProperties(en.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(u){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=u}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ni.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ni.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),dy},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Gh.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Wh.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),_c.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ii.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(u){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=u}}),wr.prototype.setLens=function(u,s){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==s&&(this.filmGauge=s),this.setFocalLength(u)},Object.defineProperties(ta.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(u){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=u}},shadowCameraLeft:{set:function(u){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=u}},shadowCameraRight:{set:function(u){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=u}},shadowCameraTop:{set:function(u){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=u}},shadowCameraBottom:{set:function(u){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=u}},shadowCameraNear:{set:function(u){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=u}},shadowCameraFar:{set:function(u){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=u}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(u){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=u}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(u){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=u}},shadowMapHeight:{set:function(u){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=u}}}),Object.defineProperties(Ke.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===lc},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(lc)}}}),Ke.prototype.setDynamic=function(u){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===u?lc:si),this},Ke.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Ke.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},jt.prototype.addIndex=function(u){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(u)},jt.prototype.addAttribute=function(u,s){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),s&&s.isBufferAttribute||s&&s.isInterleavedBufferAttribute?"index"===u?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(s),this):this.setAttribute(u,s):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(u,new Ke(arguments[1],arguments[2])))},jt.prototype.addDrawCall=function(u,s,a){void 0!==a&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(u,s)},jt.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},jt.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},jt.prototype.removeAttribute=function(u){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(u)},jt.prototype.applyMatrix=function(u){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(u)},Object.defineProperties(jt.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Xm.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(u){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=u}}}),Object.defineProperties(Vv.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(u){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=u}}}),Object.defineProperties(oo.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===lc},set:function(u){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(u)}}}),oo.prototype.setDynamic=function(u){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===u?lc:si),this},oo.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ss.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ss.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ss.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},am.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Object.defineProperties(dd.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Wn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new At}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(u){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=u===Jr}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(u){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=u}}}),Object.defineProperties(Tm.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Vl.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(u){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=u}}}),Object.defineProperties(Yn.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(u){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=u}}}),hi.prototype.clearTarget=function(u,s,a,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(u),this.clear(s,a,d)},hi.prototype.animate=function(u){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(u)},hi.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},hi.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},hi.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},hi.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},hi.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},hi.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},hi.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},hi.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},hi.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},hi.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},hi.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},hi.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},hi.prototype.enableScissorTest=function(u){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(u)},hi.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},hi.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},hi.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},hi.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},hi.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},hi.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},hi.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},hi.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},hi.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},hi.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(hi.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(u){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=u}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(u){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=u}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(u){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===u?yl:os}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(lw.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(rn.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(u){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=u}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(u){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=u}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(u){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=u}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(u){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=u}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(u){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=u}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(u){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=u}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(u){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=u}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(u){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=u}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(u){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=u}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(u){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=u}}}),Object.defineProperties(Km.prototype,{load:{value:function(u){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const s=this;return(new B1).load(u,function(d){s.setBuffer(d)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Qm.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},zp.prototype.updateCubeMap=function(u,s){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(u,s)},zp.prototype.clear=function(u,s,a,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(u,s,a,d)},Ys.crossOrigin=void 0,Ys.loadTexture=function(u,s,a,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const f=new lf;f.setCrossOrigin(this.crossOrigin);const m=f.load(u,a,void 0,d);return s&&(m.mapping=s),m},Ys.loadTextureCube=function(u,s,a,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const f=new D1;f.setCrossOrigin(this.crossOrigin);const m=f.load(u,a,void 0,d);return s&&(m.mapping=s),m},Ys.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ys.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const uM={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function dM(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Vn}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Vn)},327:function(sc,Vo){var Vn;void 0!==(Vn=function(){"use strict";function Yr(Mt,ht,Nn){var hn=new XMLHttpRequest;hn.open("GET",Mt),hn.responseType="blob",hn.onload=function(){Wi(hn.response,ht,Nn)},hn.onerror=function(){console.error("could not download file")},hn.send()}function Ei(Mt){var ht=new XMLHttpRequest;ht.open("HEAD",Mt,!1);try{ht.send()}catch(Nn){}return 200<=ht.status&&299>=ht.status}function Or(Mt){try{Mt.dispatchEvent(new MouseEvent("click"))}catch(Nn){var ht=document.createEvent("MouseEvents");ht.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),Mt.dispatchEvent(ht)}}var rr="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,bo=rr.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Wi=rr.saveAs||("object"!=typeof window||window!==rr?function(){}:"download"in HTMLAnchorElement.prototype&&!bo?function(Mt,ht,Nn){var hn=rr.URL||rr.webkitURL,X=document.createElement("a");X.download=ht=ht||Mt.name||"download",X.rel="noopener","string"==typeof Mt?(X.href=Mt,X.origin===location.origin?Or(X):Ei(X.href)?Yr(Mt,ht,Nn):Or(X,X.target="_blank")):(X.href=hn.createObjectURL(Mt),setTimeout(function(){hn.revokeObjectURL(X.href)},4e4),setTimeout(function(){Or(X)},0))}:"msSaveOrOpenBlob"in navigator?function(Mt,ht,Nn){if(ht=ht||Mt.name||"download","string"!=typeof Mt)navigator.msSaveOrOpenBlob(function ei(Mt,ht){return void 0===ht?ht={autoBom:!1}:"object"!=typeof ht&&(console.warn("Deprecated: Expected third argument to be a object"),ht={autoBom:!ht}),ht.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Mt.type)?new Blob(["\ufeff",Mt],{type:Mt.type}):Mt}(Mt,Nn),ht);else if(Ei(Mt))Yr(Mt,ht,Nn);else{var hn=document.createElement("a");hn.href=Mt,hn.target="_blank",setTimeout(function(){Or(hn)})}}:function(Mt,ht,Nn,hn){if((hn=hn||open("","_blank"))&&(hn.document.title=hn.document.body.innerText="downloading..."),"string"==typeof Mt)return Yr(Mt,ht,Nn);var X="application/octet-stream"===Mt.type,Nt=/constructor/i.test(rr.HTMLElement)||rr.safari,Jr=/CriOS\/[\d]+/.test(navigator.userAgent);if((Jr||X&&Nt||bo)&&"undefined"!=typeof FileReader){var Kr=new FileReader;Kr.onloadend=function(){var Uo=Kr.result;Uo=Jr?Uo:Uo.replace(/^data:[^;]*;/,"data:attachment/file;"),hn?hn.location.href=Uo:location=Uo,hn=null},Kr.readAsDataURL(Mt)}else{var yr=rr.URL||rr.webkitURL,wo=yr.createObjectURL(Mt);hn?hn.location=wo:location.href=wo,hn=null,setTimeout(function(){yr.revokeObjectURL(wo)},4e4)}});rr.saveAs=Wi.saveAs=Wi,sc.exports=Wi}.apply(Vo,[]))&&(sc.exports=Vn)},861:(sc,Vo,xs)=>{"use strict";function Mn(ei,Yr,Ei,Or,rr,bo,Wi){try{var Mt=ei[bo](Wi),ht=Mt.value}catch(Nn){return void Ei(Nn)}Mt.done?Yr(ht):Promise.resolve(ht).then(Or,rr)}function Vn(ei){return function(){var Yr=this,Ei=arguments;return new Promise(function(Or,rr){var bo=ei.apply(Yr,Ei);function Wi(ht){Mn(bo,Or,rr,Wi,Mt,"next",ht)}function Mt(ht){Mn(bo,Or,rr,Wi,Mt,"throw",ht)}Wi(void 0)})}}xs.d(Vo,{Z:()=>Vn})}},sc=>{sc(sc.s=53)}]);